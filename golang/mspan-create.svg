<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: mspancreate Pages: 1 -->
<svg width="1000pt" height="440pt"
 viewBox="0.00 0.00 1000.00 440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 436)">
<title>mspancreate</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-436 996,-436 996,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_mcache</title>
<polygon fill="none" stroke="#000000" points="95,-308 95,-416 424,-416 424,-308 95,-308"/>
<text text-anchor="middle" x="259.5" y="-396" font-family="Times,serif" font-size="20.00" fill="#000000">mcache</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_mcentral</title>
<polygon fill="none" stroke="#000000" points="451.5,-300 451.5,-424 839,-424 839,-300 451.5,-300"/>
<text text-anchor="middle" x="645.25" y="-404" font-family="Times,serif" font-size="20.00" fill="#000000">mcentral</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_mheap</title>
<polygon fill="none" stroke="#000000" points="132,-154 132,-290 984,-290 984,-154 132,-154"/>
<text text-anchor="middle" x="558" y="-270" font-family="Times,serif" font-size="20.00" fill="#000000">mheap</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_linearAlloc</title>
<polygon fill="none" stroke="#000000" points="115,-46 115,-128 220,-128 220,-46 115,-46"/>
<text text-anchor="middle" x="167.5" y="-108" font-family="Times,serif" font-size="20.00" fill="#000000">linearAlloc</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_linux</title>
<polygon fill="none" stroke="#000000" points="499,-46 499,-128 784.5,-128 784.5,-46 499,-46"/>
<text text-anchor="middle" x="641.75" y="-108" font-family="Times,serif" font-size="20.00" fill="#000000">linxu</text>
</g>
<!-- nextFree -->
<g id="node1" class="node">
<title>nextFree</title>
<polygon fill="none" stroke="#000000" points="103,-316.5 103,-377.5 231,-377.5 231,-316.5 103,-316.5"/>
<text text-anchor="middle" x="167" y="-362.3" font-family="Times,serif" font-size="14.00" fill="#000000">nextFree</text>
<polyline fill="none" stroke="#000000" points="103,-354.5 231,-354.5 "/>
<text text-anchor="start" x="111" y="-339.3" font-family="Times,serif" font-size="14.00" fill="#000000">如果当前spec对应</text>
<text text-anchor="start" x="111" y="-324.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 的mspan没空间了</text>
</g>
<!-- refill -->
<g id="node2" class="node">
<title>refill</title>
<polygon fill="none" stroke="#000000" points="267,-316.5 267,-377.5 416,-377.5 416,-316.5 267,-316.5"/>
<text text-anchor="middle" x="341.5" y="-362.3" font-family="Times,serif" font-size="14.00" fill="#000000">refill</text>
<polyline fill="none" stroke="#000000" points="267,-354.5 416,-354.5 "/>
<text text-anchor="start" x="275" y="-339.3" font-family="Times,serif" font-size="14.00" fill="#000000">从spec对应的mcentral </text>
<text text-anchor="start" x="275" y="-324.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 中获取一个mspan</text>
</g>
<!-- nextFree&#45;&gt;refill -->
<g id="edge1" class="edge">
<title>nextFree&#45;&gt;refill</title>
<path fill="none" stroke="#000000" d="M231.4816,-347C231.4816,-347 256.9694,-347 256.9694,-347"/>
<polygon fill="#000000" stroke="#000000" points="256.9694,-350.5001 266.9694,-347 256.9693,-343.5001 256.9694,-350.5001"/>
</g>
<!-- cacheSpan -->
<g id="node3" class="node">
<title>cacheSpan</title>
<polygon fill="none" stroke="#000000" points="459.5,-309 459.5,-385 608.5,-385 608.5,-309 459.5,-309"/>
<text text-anchor="middle" x="534" y="-369.8" font-family="Times,serif" font-size="14.00" fill="#000000">cacheSpan</text>
<polyline fill="none" stroke="#000000" points="459.5,-362 608.5,-362 "/>
<text text-anchor="start" x="467.5" y="-346.8" font-family="Times,serif" font-size="14.00" fill="#000000">扫描noempty和empty </text>
<text text-anchor="start" x="467.5" y="-331.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 找一个空闲的mspan</text>
<text text-anchor="middle" x="534" y="-316.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 如果没有则分配一个</text>
</g>
<!-- refill&#45;&gt;cacheSpan -->
<g id="edge14" class="edge">
<title>refill&#45;&gt;cacheSpan</title>
<path fill="none" stroke="#000000" d="M416.201,-347C416.201,-347 449.3409,-347 449.3409,-347"/>
<polygon fill="#000000" stroke="#000000" points="449.341,-350.5001 459.3409,-347 449.3409,-343.5001 449.341,-350.5001"/>
</g>
<!-- mcentral_grow -->
<g id="node4" class="node">
<title>mcentral_grow</title>
<polygon fill="none" stroke="#000000" points="660,-316.5 660,-377.5 831,-377.5 831,-316.5 660,-316.5"/>
<text text-anchor="middle" x="745.5" y="-362.3" font-family="Times,serif" font-size="14.00" fill="#000000">grow</text>
<polyline fill="none" stroke="#000000" points="660,-354.5 831,-354.5 "/>
<text text-anchor="start" x="668" y="-339.3" font-family="Times,serif" font-size="14.00" fill="#000000">根据spec计算需要的pages</text>
<text text-anchor="start" x="668" y="-324.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 调用heap分配内存</text>
</g>
<!-- cacheSpan&#45;&gt;mcentral_grow -->
<g id="edge2" class="edge">
<title>cacheSpan&#45;&gt;mcentral_grow</title>
<path fill="none" stroke="#000000" d="M608.567,-347C608.567,-347 649.6857,-347 649.6857,-347"/>
<polygon fill="#000000" stroke="#000000" points="649.6857,-350.5001 659.6857,-347 649.6856,-343.5001 649.6857,-350.5001"/>
</g>
<!-- alloc -->
<g id="node7" class="node">
<title>alloc</title>
<polygon fill="none" stroke="#000000" points="194,-231 140,-231 140,-195 194,-195 194,-231"/>
<text text-anchor="middle" x="167" y="-209.3" font-family="Times,serif" font-size="14.00" fill="#000000">alloc</text>
</g>
<!-- mcentral_grow&#45;&gt;alloc -->
<g id="edge15" class="edge">
<title>mcentral_grow&#45;&gt;alloc</title>
<path fill="none" stroke="#000000" d="M746,-316.3601C746,-298.8126 746,-280.25 746,-280.25 746,-280.25 167,-280.25 167,-280.25 167,-280.25 167,-241.0218 167,-241.0218"/>
<polygon fill="#000000" stroke="#000000" points="170.5001,-241.0217 167,-231.0218 163.5001,-241.0218 170.5001,-241.0217"/>
</g>
<!-- allocSpanLocked -->
<g id="node5" class="node">
<title>allocSpanLocked</title>
<polygon fill="none" stroke="#000000" points="452,-175 452,-251 616,-251 616,-175 452,-175"/>
<text text-anchor="middle" x="534" y="-235.8" font-family="Times,serif" font-size="14.00" fill="#000000">allocSpanLocked</text>
<polyline fill="none" stroke="#000000" points="452,-228 616,-228 "/>
<text text-anchor="start" x="460" y="-212.8" font-family="Times,serif" font-size="14.00" fill="#000000">最终创建mspan的地方</text>
<text text-anchor="start" x="460" y="-197.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 先从free中找npages内存</text>
<text text-anchor="middle" x="534" y="-182.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 找不到的话grow</text>
</g>
<!-- grow -->
<g id="node6" class="node">
<title>grow</title>
<polygon fill="none" stroke="#000000" points="652,-182.5 652,-243.5 839,-243.5 839,-182.5 652,-182.5"/>
<text text-anchor="middle" x="745.5" y="-228.3" font-family="Times,serif" font-size="14.00" fill="#000000">grow</text>
<polyline fill="none" stroke="#000000" points="652,-220.5 839,-220.5 "/>
<text text-anchor="start" x="660" y="-205.3" font-family="Times,serif" font-size="14.00" fill="#000000">使用sysAlloc分配npages内存</text>
<text text-anchor="start" x="660" y="-190.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 使用fixalloc分配mspan</text>
</g>
<!-- allocSpanLocked&#45;&gt;grow -->
<g id="edge5" class="edge">
<title>allocSpanLocked&#45;&gt;grow</title>
<path fill="none" stroke="#000000" d="M616.0741,-213C616.0741,-213 641.8677,-213 641.8677,-213"/>
<polygon fill="#000000" stroke="#000000" points="641.8678,-216.5001 651.8677,-213 641.8677,-209.5001 641.8678,-216.5001"/>
</g>
<!-- sysAlloc -->
<g id="node9" class="node">
<title>sysAlloc</title>
<polygon fill="none" stroke="#000000" points="957.5,-198 893.5,-198 893.5,-162 957.5,-162 957.5,-198"/>
<text text-anchor="middle" x="925.5" y="-176.3" font-family="Times,serif" font-size="14.00" fill="#000000">sysAlloc</text>
</g>
<!-- grow&#45;&gt;sysAlloc -->
<g id="edge6" class="edge">
<title>grow&#45;&gt;sysAlloc</title>
<path fill="none" stroke="#000000" d="M839.1905,-190C839.1905,-190 883.2709,-190 883.2709,-190"/>
<polygon fill="#000000" stroke="#000000" points="883.271,-193.5001 893.2709,-190 883.2709,-186.5001 883.271,-193.5001"/>
</g>
<!-- spanalloc_alloc -->
<g id="node10" class="node">
<title>spanalloc_alloc</title>
<polygon fill="none" stroke="#000000" points="976,-252 875,-252 875,-216 976,-216 976,-252"/>
<text text-anchor="middle" x="925.5" y="-230.3" font-family="Times,serif" font-size="14.00" fill="#000000">spanalloc_alloc</text>
</g>
<!-- grow&#45;&gt;spanalloc_alloc -->
<g id="edge7" class="edge">
<title>grow&#45;&gt;spanalloc_alloc</title>
<path fill="none" stroke="#000000" d="M839.1905,-230C839.1905,-230 864.8959,-230 864.8959,-230"/>
<polygon fill="#000000" stroke="#000000" points="864.896,-233.5001 874.8959,-230 864.8959,-226.5001 864.896,-233.5001"/>
</g>
<!-- alloc_m -->
<g id="node8" class="node">
<title>alloc_m</title>
<polygon fill="none" stroke="#000000" points="372,-231 311,-231 311,-195 372,-195 372,-231"/>
<text text-anchor="middle" x="341.5" y="-209.3" font-family="Times,serif" font-size="14.00" fill="#000000">alloc_m</text>
</g>
<!-- alloc&#45;&gt;alloc_m -->
<g id="edge3" class="edge">
<title>alloc&#45;&gt;alloc_m</title>
<path fill="none" stroke="#000000" d="M194.2656,-213C194.2656,-213 300.9047,-213 300.9047,-213"/>
<polygon fill="#000000" stroke="#000000" points="300.9048,-216.5001 310.9047,-213 300.9047,-209.5001 300.9048,-216.5001"/>
</g>
<!-- alloc_m&#45;&gt;allocSpanLocked -->
<g id="edge4" class="edge">
<title>alloc_m&#45;&gt;allocSpanLocked</title>
<path fill="none" stroke="#000000" d="M372.0022,-213C372.0022,-213 441.7225,-213 441.7225,-213"/>
<polygon fill="#000000" stroke="#000000" points="441.7225,-216.5001 451.7225,-213 441.7224,-209.5001 441.7225,-216.5001"/>
</g>
<!-- linear_alloc -->
<g id="node11" class="node">
<title>linear_alloc</title>
<polygon fill="none" stroke="#000000" points="194,-90 140,-90 140,-54 194,-54 194,-90"/>
<text text-anchor="middle" x="167" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#000000">alloc</text>
</g>
<!-- sysAlloc&#45;&gt;linear_alloc -->
<g id="edge16" class="edge">
<title>sysAlloc&#45;&gt;linear_alloc</title>
<path fill="none" stroke="#000000" d="M893.3927,-168.25C749.0236,-168.25 167,-168.25 167,-168.25 167,-168.25 167,-100.1039 167,-100.1039"/>
<polygon fill="#000000" stroke="#000000" points="170.5001,-100.1039 167,-90.1039 163.5001,-100.1039 170.5001,-100.1039"/>
</g>
<!-- sysMap -->
<g id="node12" class="node">
<title>sysMap</title>
<polygon fill="none" stroke="#000000" points="371,-90 312,-90 312,-54 371,-54 371,-90"/>
<text text-anchor="middle" x="341.5" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#000000">sysMap</text>
</g>
<!-- linear_alloc&#45;&gt;sysMap -->
<g id="edge8" class="edge">
<title>linear_alloc&#45;&gt;sysMap</title>
<path fill="none" stroke="#000000" d="M194.2656,-72C194.2656,-72 301.7996,-72 301.7996,-72"/>
<polygon fill="#000000" stroke="#000000" points="301.7996,-75.5001 311.7996,-72 301.7996,-68.5001 301.7996,-75.5001"/>
</g>
<!-- sysUsed -->
<g id="node13" class="node">
<title>sysUsed</title>
<polygon fill="none" stroke="#000000" points="372.5,-36 310.5,-36 310.5,0 372.5,0 372.5,-36"/>
<text text-anchor="middle" x="341.5" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">sysUsed</text>
</g>
<!-- linear_alloc&#45;&gt;sysUsed -->
<g id="edge9" class="edge">
<title>linear_alloc&#45;&gt;sysUsed</title>
<path fill="none" stroke="#000000" d="M167,-53.7181C167,-38.0522 167,-18 167,-18 167,-18 300.3029,-18 300.3029,-18"/>
<polygon fill="#000000" stroke="#000000" points="300.3029,-21.5001 310.3029,-18 300.3029,-14.5001 300.3029,-21.5001"/>
</g>
<!-- mmap -->
<g id="node14" class="node">
<title>mmap</title>
<polygon fill="none" stroke="#000000" points="561,-90 507,-90 507,-54 561,-54 561,-90"/>
<text text-anchor="middle" x="534" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#000000">mmap</text>
</g>
<!-- sysMap&#45;&gt;mmap -->
<g id="edge10" class="edge">
<title>sysMap&#45;&gt;mmap</title>
<path fill="none" stroke="#000000" d="M371.1563,-72C371.1563,-72 496.8015,-72 496.8015,-72"/>
<polygon fill="#000000" stroke="#000000" points="496.8015,-75.5001 506.8015,-72 496.8015,-68.5001 496.8015,-75.5001"/>
</g>
<!-- sysHugePage -->
<g id="node16" class="node">
<title>sysHugePage</title>
<polygon fill="none" stroke="#000000" points="578.5,-36 489.5,-36 489.5,0 578.5,0 578.5,-36"/>
<text text-anchor="middle" x="534" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">sysHugePage</text>
</g>
<!-- sysUsed&#45;&gt;sysHugePage -->
<g id="edge11" class="edge">
<title>sysUsed&#45;&gt;sysHugePage</title>
<path fill="none" stroke="#000000" d="M372.8569,-18C372.8569,-18 479.3575,-18 479.3575,-18"/>
<polygon fill="#000000" stroke="#000000" points="479.3576,-21.5001 489.3575,-18 479.3575,-14.5001 479.3576,-21.5001"/>
</g>
<!-- madvise -->
<g id="node15" class="node">
<title>madvise</title>
<polygon fill="none" stroke="#000000" points="776.5,-90 714.5,-90 714.5,-54 776.5,-54 776.5,-90"/>
<text text-anchor="middle" x="745.5" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#000000">madvise</text>
</g>
<!-- sysHugePage&#45;&gt;madvise -->
<g id="edge12" class="edge">
<title>sysHugePage&#45;&gt;madvise</title>
<path fill="none" stroke="#000000" d="M570,-36.2819C570,-51.9478 570,-72 570,-72 570,-72 704.1241,-72 704.1241,-72"/>
<polygon fill="#000000" stroke="#000000" points="704.1242,-75.5001 714.1241,-72 704.1241,-68.5001 704.1242,-75.5001"/>
</g>
<!-- mallocgc -->
<g id="node17" class="node">
<title>mallocgc</title>
<polygon fill="none" stroke="#000000" points="67,-365 0,-365 0,-329 67,-329 67,-365"/>
<text text-anchor="middle" x="33.5" y="-343.3" font-family="Times,serif" font-size="14.00" fill="#000000">mallocgc</text>
</g>
<!-- mallocgc&#45;&gt;nextFree -->
<g id="edge13" class="edge">
<title>mallocgc&#45;&gt;nextFree</title>
<path fill="none" stroke="#000000" d="M67.1877,-347C67.1877,-347 92.8833,-347 92.8833,-347"/>
<polygon fill="#000000" stroke="#000000" points="92.8833,-350.5001 102.8833,-347 92.8833,-343.5001 92.8833,-350.5001"/>
</g>
</g>
</svg>
