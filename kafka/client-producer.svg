<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: client_producer Pages: 1 -->
<svg width="1894pt" height="693pt"
 viewBox="0.00 0.00 1893.84 693.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 689)">
<title>client_producer</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-689 1889.8408,-689 1889.8408,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_KafkaProducer</title>
<path fill="none" stroke="#000000" d="M20,-8C20,-8 1865.8408,-8 1865.8408,-8 1871.8408,-8 1877.8408,-14 1877.8408,-20 1877.8408,-20 1877.8408,-665 1877.8408,-665 1877.8408,-671 1871.8408,-677 1865.8408,-677 1865.8408,-677 20,-677 20,-677 14,-677 8,-671 8,-665 8,-665 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="942.9204" y="-657" font-family="Times,serif" font-size="20.00" fill="#000000">KafkaProducer</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_SenderThread</title>
<path fill="none" stroke="#000000" d="M476.0728,-100C476.0728,-100 1661.2061,-100 1661.2061,-100 1667.2061,-100 1673.2061,-106 1673.2061,-112 1673.2061,-112 1673.2061,-384 1673.2061,-384 1673.2061,-390 1667.2061,-396 1661.2061,-396 1661.2061,-396 476.0728,-396 476.0728,-396 470.0728,-396 464.0728,-390 464.0728,-384 464.0728,-384 464.0728,-112 464.0728,-112 464.0728,-106 470.0728,-100 476.0728,-100"/>
<text text-anchor="middle" x="1068.6394" y="-376" font-family="Times,serif" font-size="20.00" fill="#000000">Sender Thread</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_RecordAccumulator</title>
<path fill="none" stroke="#000000" d="M214.8691,-404C214.8691,-404 1857.8408,-404 1857.8408,-404 1863.8408,-404 1869.8408,-410 1869.8408,-416 1869.8408,-416 1869.8408,-629 1869.8408,-629 1869.8408,-635 1863.8408,-641 1857.8408,-641 1857.8408,-641 214.8691,-641 214.8691,-641 208.8691,-641 202.8691,-635 202.8691,-629 202.8691,-629 202.8691,-416 202.8691,-416 202.8691,-410 208.8691,-404 214.8691,-404"/>
<text text-anchor="middle" x="1036.355" y="-621" font-family="Times,serif" font-size="20.00" fill="#000000">RecordAccumulator</text>
</g>
<!-- keySerializer_serialize -->
<g id="node1" class="node">
<title>keySerializer_serialize</title>
<polygon fill="none" stroke="#000000" points="229.5723,-16.2 229.5723,-65.8 373.0557,-65.8 373.0557,-16.2 229.5723,-16.2"/>
<text text-anchor="middle" x="301.314" y="-50.6" font-family="Times,serif" font-size="14.00" fill="#000000">keySerializer_serialize</text>
<polyline fill="none" stroke="#000000" points="229.5723,-43.8 373.0557,-43.8 "/>
<text text-anchor="middle" x="301.314" y="-28.6" font-family="Times,serif" font-size="14.00" fill="#000000">key做序列化</text>
</g>
<!-- valueSerializer_serialize -->
<g id="node2" class="node">
<title>valueSerializer_serialize</title>
<polygon fill="none" stroke="#000000" points="224.5205,-85.2 224.5205,-134.8 378.1074,-134.8 378.1074,-85.2 224.5205,-85.2"/>
<text text-anchor="middle" x="301.314" y="-119.6" font-family="Times,serif" font-size="14.00" fill="#000000">valueSerializer_serialize</text>
<polyline fill="none" stroke="#000000" points="224.5205,-112.8 378.1074,-112.8 "/>
<text text-anchor="middle" x="301.314" y="-97.6" font-family="Times,serif" font-size="14.00" fill="#000000">value做序列化</text>
</g>
<!-- partition -->
<g id="node3" class="node">
<title>partition</title>
<polygon fill="none" stroke="#000000" points="220.5967,-154.2 220.5967,-203.8 382.0313,-203.8 382.0313,-154.2 220.5967,-154.2"/>
<text text-anchor="middle" x="301.314" y="-188.6" font-family="Times,serif" font-size="14.00" fill="#000000">partition</text>
<polyline fill="none" stroke="#000000" points="220.5967,-181.8 382.0313,-181.8 "/>
<text text-anchor="start" x="228.5967" y="-166.6" font-family="Times,serif" font-size="14.00" fill="#000000">计算消息对应的partition</text>
</g>
<!-- sender_wakeup -->
<g id="node4" class="node">
<title>sender_wakeup</title>
<polygon fill="none" stroke="#000000" points="249.7759,-223.2 249.7759,-272.8 352.8521,-272.8 352.8521,-223.2 249.7759,-223.2"/>
<text text-anchor="middle" x="301.314" y="-257.6" font-family="Times,serif" font-size="14.00" fill="#000000">sender_wakeup</text>
<polyline fill="none" stroke="#000000" points="249.7759,-250.8 352.8521,-250.8 "/>
<text text-anchor="middle" x="301.314" y="-235.6" font-family="Times,serif" font-size="14.00" fill="#000000">唤醒发送线程</text>
</g>
<!-- sender_run -->
<g id="node5" class="node">
<title>sender_run</title>
<polygon fill="#f38181" stroke="#000000" points="472.0728,-219.2 472.0728,-268.8 586.0728,-268.8 586.0728,-219.2 472.0728,-219.2"/>
<text text-anchor="middle" x="529.0728" y="-253.6" font-family="Times,serif" font-size="14.00" fill="#000000">sender_run</text>
<polyline fill="none" stroke="#000000" points="472.0728,-246.8 586.0728,-246.8 "/>
<text text-anchor="start" x="480.0728" y="-231.6" font-family="Times,serif" font-size="14.00" fill="#000000">发送线程主循环</text>
</g>
<!-- sender_wakeup&#45;&gt;sender_run -->
<g id="edge1" class="edge">
<title>sender_wakeup&#45;&gt;sender_run</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.996,-247.0923C385.2488,-246.5259 427.1034,-245.7908 461.9127,-245.1795"/>
<polygon fill="#000000" stroke="#000000" points="462.0622,-248.6775 471.9991,-245.0024 461.9392,-241.6786 462.0622,-248.6775"/>
</g>
<!-- runOnce -->
<g id="node11" class="node">
<title>runOnce</title>
<polygon fill="none" stroke="#000000" points="770.7562,-255 706.3552,-255 706.3552,-219 770.7562,-219 770.7562,-255"/>
<text text-anchor="middle" x="738.5557" y="-232.8" font-family="Times,serif" font-size="14.00" fill="#000000">runOnce</text>
</g>
<!-- sender_run&#45;&gt;runOnce -->
<g id="edge10" class="edge">
<title>sender_run&#45;&gt;runOnce</title>
<path fill="none" stroke="#000000" d="M586.3149,-242.0872C621.034,-240.9271 664.587,-239.4717 696.2052,-238.4152"/>
<polygon fill="#000000" stroke="#000000" points="696.5628,-241.9053 706.4403,-238.0732 696.329,-234.9092 696.5628,-241.9053"/>
</g>
<!-- waitOnMetadata -->
<g id="node6" class="node">
<title>waitOnMetadata</title>
<polygon fill="#f38181" stroke="#000000" points="246.6655,-292.2 246.6655,-341.8 355.9624,-341.8 355.9624,-292.2 246.6655,-292.2"/>
<text text-anchor="middle" x="301.314" y="-326.6" font-family="Times,serif" font-size="14.00" fill="#000000">waitOnMetadata</text>
<polyline fill="none" stroke="#000000" points="246.6655,-319.8 355.9624,-319.8 "/>
<text text-anchor="start" x="254.6655" y="-304.6" font-family="Times,serif" font-size="14.00" fill="#000000">等待元数据</text>
</g>
<!-- send -->
<g id="node7" class="node">
<title>send</title>
<polygon fill="none" stroke="#000000" points="70,-266 16,-266 16,-230 70,-230 70,-266"/>
<text text-anchor="middle" x="43" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#000000">send</text>
</g>
<!-- doSend -->
<g id="node8" class="node">
<title>doSend</title>
<polygon fill="none" stroke="#000000" points="164,-266 106,-266 106,-230 164,-230 164,-266"/>
<text text-anchor="middle" x="135" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#000000">doSend</text>
</g>
<!-- send&#45;&gt;doSend -->
<g id="edge2" class="edge">
<title>send&#45;&gt;doSend</title>
<path fill="none" stroke="#000000" d="M70.1054,-248C78.094,-248 87.0028,-248 95.5978,-248"/>
<polygon fill="#000000" stroke="#000000" points="95.8433,-251.5001 105.8432,-248 95.8432,-244.5001 95.8433,-251.5001"/>
</g>
<!-- doSend&#45;&gt;keySerializer_serialize -->
<g id="edge3" class="edge">
<title>doSend&#45;&gt;keySerializer_serialize</title>
<path fill="none" stroke="#000000" d="M136.8097,-229.9472C141.2332,-195.2865 155.7002,-119.0466 200,-76 205.865,-70.3009 212.7019,-65.5271 220.0042,-61.5288"/>
<polygon fill="#000000" stroke="#000000" points="222.041,-64.4271 229.4645,-56.8678 218.9473,-58.1478 222.041,-64.4271"/>
</g>
<!-- doSend&#45;&gt;valueSerializer_serialize -->
<g id="edge4" class="edge">
<title>doSend&#45;&gt;valueSerializer_serialize</title>
<path fill="none" stroke="#000000" d="M142.027,-229.7051C151.7267,-206.7724 171.3326,-167.7229 200,-145 204.718,-141.2603 209.8616,-137.9069 215.2478,-134.9018"/>
<polygon fill="#000000" stroke="#000000" points="217.1988,-137.8353 224.5092,-130.1666 214.0121,-131.6027 217.1988,-137.8353"/>
</g>
<!-- doSend&#45;&gt;partition -->
<g id="edge5" class="edge">
<title>doSend&#45;&gt;partition</title>
<path fill="none" stroke="#000000" d="M164.3173,-231.4777C175.3309,-225.5883 188.0726,-219.1455 200,-214 205.0727,-211.8116 210.3314,-209.6601 215.6647,-207.5663"/>
<polygon fill="#000000" stroke="#000000" points="217.2366,-210.7122 225.3211,-203.8644 214.7309,-204.176 217.2366,-210.7122"/>
</g>
<!-- doSend&#45;&gt;sender_wakeup -->
<g id="edge6" class="edge">
<title>doSend&#45;&gt;sender_wakeup</title>
<path fill="none" stroke="#000000" d="M164.3508,-248C185.1789,-248 213.8993,-248 239.6625,-248"/>
<polygon fill="#000000" stroke="#000000" points="239.7405,-251.5001 249.7405,-248 239.7405,-244.5001 239.7405,-251.5001"/>
</g>
<!-- doSend&#45;&gt;waitOnMetadata -->
<g id="edge7" class="edge">
<title>doSend&#45;&gt;waitOnMetadata</title>
<path fill="none" stroke="#000000" d="M164.3173,-264.5223C175.3309,-270.4117 188.0726,-276.8545 200,-282 211.73,-287.0603 224.4543,-291.9236 236.7963,-296.3315"/>
<polygon fill="#000000" stroke="#000000" points="235.9911,-299.758 246.586,-299.764 238.3073,-293.1523 235.9911,-299.758"/>
</g>
<!-- estimateSizeInBytesUpperBound -->
<g id="node9" class="node">
<title>estimateSizeInBytesUpperBound</title>
<polygon fill="none" stroke="#000000" points="402.4422,-396 200.1857,-396 200.1857,-360 402.4422,-360 402.4422,-396"/>
<text text-anchor="middle" x="301.314" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">estimateSizeInBytesUpperBound</text>
</g>
<!-- doSend&#45;&gt;estimateSizeInBytesUpperBound -->
<g id="edge8" class="edge">
<title>doSend&#45;&gt;estimateSizeInBytesUpperBound</title>
<path fill="none" stroke="#000000" d="M141.6118,-266.2237C150.9841,-289.4516 170.361,-329.201 200,-351 201.8468,-352.3583 203.757,-353.6482 205.72,-354.8733"/>
<polygon fill="#000000" stroke="#000000" points="204.1929,-358.029 214.6318,-359.84 207.6006,-351.9145 204.1929,-358.029"/>
</g>
<!-- RecordAccumulator_append -->
<g id="node10" class="node">
<title>RecordAccumulator_append</title>
<polygon fill="none" stroke="#000000" points="210.8691,-451.2 210.8691,-500.8 391.7588,-500.8 391.7588,-451.2 210.8691,-451.2"/>
<text text-anchor="middle" x="301.314" y="-485.6" font-family="Times,serif" font-size="14.00" fill="#000000">append</text>
<polyline fill="none" stroke="#000000" points="210.8691,-478.8 391.7588,-478.8 "/>
<text text-anchor="middle" x="301.314" y="-463.6" font-family="Times,serif" font-size="14.00" fill="#000000">将消息放到tp对应的队列中</text>
</g>
<!-- doSend&#45;&gt;RecordAccumulator_append -->
<g id="edge9" class="edge">
<title>doSend&#45;&gt;RecordAccumulator_append</title>
<path fill="none" stroke="#000000" d="M138.6521,-266.1122C147.8803,-310.1821 173.3068,-421.2747 200,-447 200.8233,-447.7935 201.6669,-448.5655 202.5291,-449.3167"/>
<polygon fill="#000000" stroke="#000000" points="200.6653,-452.295 210.7546,-455.5287 204.8839,-446.709 200.6653,-452.295"/>
</g>
<!-- getOrCreateDeque -->
<g id="node26" class="node">
<title>getOrCreateDeque</title>
<polygon fill="none" stroke="#000000" points="438.6279,-417.2 438.6279,-466.8 619.5176,-466.8 619.5176,-417.2 438.6279,-417.2"/>
<text text-anchor="middle" x="529.0728" y="-451.6" font-family="Times,serif" font-size="14.00" fill="#000000">getOrCreateDeque</text>
<polyline fill="none" stroke="#000000" points="438.6279,-444.8 619.5176,-444.8 "/>
<text text-anchor="middle" x="529.0728" y="-429.6" font-family="Times,serif" font-size="14.00" fill="#000000">获取活着创建tp对应的队列</text>
</g>
<!-- RecordAccumulator_append&#45;&gt;getOrCreateDeque -->
<g id="edge25" class="edge">
<title>RecordAccumulator_append&#45;&gt;getOrCreateDeque</title>
<path fill="none" stroke="#000000" d="M391.9847,-462.4646C403.9053,-460.6851 416.1803,-458.8527 428.2566,-457.0499"/>
<polygon fill="#000000" stroke="#000000" points="428.9683,-460.4825 438.3419,-455.5444 427.9347,-453.5593 428.9683,-460.4825"/>
</g>
<!-- tryAppend -->
<g id="node28" class="node">
<title>tryAppend</title>
<polygon fill="none" stroke="#000000" points="446.8071,-486.2 446.8071,-535.8 611.3384,-535.8 611.3384,-486.2 446.8071,-486.2"/>
<text text-anchor="middle" x="529.0728" y="-520.6" font-family="Times,serif" font-size="14.00" fill="#000000">tryAppend</text>
<polyline fill="none" stroke="#000000" points="446.8071,-513.8 611.3384,-513.8 "/>
<text text-anchor="start" x="454.8071" y="-498.6" font-family="Times,serif" font-size="14.00" fill="#000000">构造RecordAppendResult</text>
</g>
<!-- RecordAccumulator_append&#45;&gt;tryAppend -->
<g id="edge26" class="edge">
<title>RecordAccumulator_append&#45;&gt;tryAppend</title>
<path fill="none" stroke="#000000" d="M391.9847,-489.9335C406.5996,-492.1794 421.747,-494.5071 436.4082,-496.7601"/>
<polygon fill="#000000" stroke="#000000" points="436.0523,-500.2464 446.4679,-498.306 437.1156,-493.3276 436.0523,-500.2464"/>
</g>
<!-- addLast -->
<g id="node29" class="node">
<title>addLast</title>
<polygon fill="none" stroke="#000000" points="439.021,-555.2 439.021,-604.8 619.1245,-604.8 619.1245,-555.2 439.021,-555.2"/>
<text text-anchor="middle" x="529.0728" y="-589.6" font-family="Times,serif" font-size="14.00" fill="#000000">addLast</text>
<polyline fill="none" stroke="#000000" points="439.021,-582.8 619.1245,-582.8 "/>
<text text-anchor="middle" x="529.0728" y="-567.6" font-family="Times,serif" font-size="14.00" fill="#000000">将AppendResult放入队列中</text>
</g>
<!-- RecordAccumulator_append&#45;&gt;addLast -->
<g id="edge27" class="edge">
<title>RecordAccumulator_append&#45;&gt;addLast</title>
<path fill="none" stroke="#000000" d="M348.1207,-500.928C374.4215,-514.5775 408.02,-531.4253 438.6279,-545 443.3174,-547.0798 448.1718,-549.1603 453.0855,-551.2119"/>
<polygon fill="#000000" stroke="#000000" points="452.0001,-554.5499 462.58,-555.1139 454.661,-548.0753 452.0001,-554.5499"/>
</g>
<!-- resetProducerIdIfNeeded -->
<g id="node12" class="node">
<title>resetProducerIdIfNeeded</title>
<polygon fill="none" stroke="#000000" points="1060.1971,-144 903.7883,-144 903.7883,-108 1060.1971,-108 1060.1971,-144"/>
<text text-anchor="middle" x="981.9927" y="-121.8" font-family="Times,serif" font-size="14.00" fill="#000000">resetProducerIdIfNeeded</text>
</g>
<!-- runOnce&#45;&gt;resetProducerIdIfNeeded -->
<g id="edge11" class="edge">
<title>runOnce&#45;&gt;resetProducerIdIfNeeded</title>
<path fill="none" stroke="#000000" d="M758.9136,-218.7187C781.4458,-199.4707 819.6185,-169.6916 857.5938,-153 868.9283,-148.018 881.2596,-143.9235 893.6085,-140.5666"/>
<polygon fill="#000000" stroke="#000000" points="894.6806,-143.905 903.4972,-138.0297 892.9411,-137.1246 894.6806,-143.905"/>
</g>
<!-- maybeWaitForProducerId -->
<g id="node13" class="node">
<title>maybeWaitForProducerId</title>
<polygon fill="none" stroke="#000000" points="1062.5513,-198 901.4341,-198 901.4341,-162 1062.5513,-162 1062.5513,-198"/>
<text text-anchor="middle" x="981.9927" y="-175.8" font-family="Times,serif" font-size="14.00" fill="#000000">maybeWaitForProducerId</text>
</g>
<!-- runOnce&#45;&gt;maybeWaitForProducerId -->
<g id="edge12" class="edge">
<title>runOnce&#45;&gt;maybeWaitForProducerId</title>
<path fill="none" stroke="#000000" d="M770.8199,-228.561C794.7263,-222.3832 828.129,-213.9084 857.5938,-207 868.494,-204.4443 879.9517,-201.8427 891.3193,-199.3136"/>
<polygon fill="#000000" stroke="#000000" points="892.2616,-202.6898 901.2696,-197.1126 890.7497,-195.855 892.2616,-202.6898"/>
</g>
<!-- maybeSendAndPollTransactionalRequest -->
<g id="node14" class="node">
<title>maybeSendAndPollTransactionalRequest</title>
<polygon fill="none" stroke="#000000" points="1106.2906,-252 857.6947,-252 857.6947,-216 1106.2906,-216 1106.2906,-252"/>
<text text-anchor="middle" x="981.9927" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#000000">maybeSendAndPollTransactionalRequest</text>
</g>
<!-- runOnce&#45;&gt;maybeSendAndPollTransactionalRequest -->
<g id="edge13" class="edge">
<title>runOnce&#45;&gt;maybeSendAndPollTransactionalRequest</title>
<path fill="none" stroke="#000000" d="M770.8822,-236.6016C791.1287,-236.3521 818.7296,-236.012 847.2949,-235.6599"/>
<polygon fill="#000000" stroke="#000000" points="847.4725,-239.1581 857.4286,-235.5351 847.3862,-232.1587 847.4725,-239.1581"/>
</g>
<!-- client_poll -->
<g id="node15" class="node">
<title>client_poll</title>
<polygon fill="none" stroke="#000000" points="1019.8688,-306 944.1166,-306 944.1166,-270 1019.8688,-270 1019.8688,-306"/>
<text text-anchor="middle" x="981.9927" y="-283.8" font-family="Times,serif" font-size="14.00" fill="#000000">client_poll</text>
</g>
<!-- runOnce&#45;&gt;client_poll -->
<g id="edge14" class="edge">
<title>runOnce&#45;&gt;client_poll</title>
<path fill="none" stroke="#000000" d="M770.8822,-243.7724C812.6605,-252.525 885.7532,-267.8379 934.018,-277.9493"/>
<polygon fill="#000000" stroke="#000000" points="933.4149,-281.3989 943.9201,-280.0238 934.8503,-274.5476 933.4149,-281.3989"/>
</g>
<!-- sendProducerData -->
<g id="node16" class="node">
<title>sendProducerData</title>
<polygon fill="none" stroke="#000000" points="1041.1212,-360 922.8642,-360 922.8642,-324 1041.1212,-324 1041.1212,-360"/>
<text text-anchor="middle" x="981.9927" y="-337.8" font-family="Times,serif" font-size="14.00" fill="#000000">sendProducerData</text>
</g>
<!-- runOnce&#45;&gt;sendProducerData -->
<g id="edge15" class="edge">
<title>runOnce&#45;&gt;sendProducerData</title>
<path fill="none" stroke="#000000" d="M760.8387,-255.2328C783.7499,-273.0701 821.1343,-299.7185 857.5938,-315 874.877,-322.2441 894.3594,-327.6515 912.6878,-331.6442"/>
<polygon fill="#000000" stroke="#000000" points="912.2287,-335.1233 922.7302,-333.7196 913.6454,-328.2681 912.2287,-335.1233"/>
</g>
<!-- sendProduceRequests -->
<g id="node17" class="node">
<title>sendProduceRequests</title>
<polygon fill="none" stroke="#000000" points="1280.9263,-358 1142.7466,-358 1142.7466,-322 1280.9263,-322 1280.9263,-358"/>
<text text-anchor="middle" x="1211.8364" y="-335.8" font-family="Times,serif" font-size="14.00" fill="#000000">sendProduceRequests</text>
</g>
<!-- sendProducerData&#45;&gt;sendProduceRequests -->
<g id="edge16" class="edge">
<title>sendProducerData&#45;&gt;sendProduceRequests</title>
<path fill="none" stroke="#000000" d="M1041.1832,-341.485C1069.0269,-341.2427 1102.6297,-340.9503 1132.6278,-340.6892"/>
<polygon fill="#000000" stroke="#000000" points="1132.6802,-344.189 1142.6493,-340.602 1132.6192,-337.1893 1132.6802,-344.189"/>
</g>
<!-- accumulator_drain -->
<g id="node20" class="node">
<title>accumulator_drain</title>
<polygon fill="none" stroke="#000000" points="1142.3916,-446.2 1142.3916,-495.8 1281.2813,-495.8 1281.2813,-446.2 1142.3916,-446.2"/>
<text text-anchor="middle" x="1211.8364" y="-480.6" font-family="Times,serif" font-size="14.00" fill="#000000">drain</text>
<polyline fill="none" stroke="#000000" points="1142.3916,-473.8 1281.2813,-473.8 "/>
<text text-anchor="middle" x="1211.8364" y="-458.6" font-family="Times,serif" font-size="14.00" fill="#000000">从tp队列中获取消息</text>
</g>
<!-- sendProducerData&#45;&gt;accumulator_drain -->
<g id="edge19" class="edge">
<title>sendProducerData&#45;&gt;accumulator_drain</title>
<path fill="none" stroke="#000000" d="M1025.1398,-360.1233C1049.4668,-370.8318 1080.1494,-385.1678 1106.3916,-400 1127.718,-412.0538 1150.3745,-427.003 1169.1981,-440.0705"/>
<polygon fill="#000000" stroke="#000000" points="1167.3595,-443.0558 1177.5585,-445.9249 1171.3748,-437.3219 1167.3595,-443.0558"/>
</g>
<!-- sendProduceRequest -->
<g id="node18" class="node">
<title>sendProduceRequest</title>
<polygon fill="none" stroke="#000000" points="1464.5132,-356 1332.229,-356 1332.229,-320 1464.5132,-320 1464.5132,-356"/>
<text text-anchor="middle" x="1398.3711" y="-333.8" font-family="Times,serif" font-size="14.00" fill="#000000">sendProduceRequest</text>
</g>
<!-- sendProduceRequests&#45;&gt;sendProduceRequest -->
<g id="edge17" class="edge">
<title>sendProduceRequests&#45;&gt;sendProduceRequest</title>
<path fill="none" stroke="#000000" d="M1281.03,-339.2581C1294.3322,-339.1155 1308.3358,-338.9653 1321.854,-338.8204"/>
<polygon fill="#000000" stroke="#000000" points="1322.1153,-342.3179 1332.0771,-338.7108 1322.0401,-335.3183 1322.1153,-342.3179"/>
</g>
<!-- client_send -->
<g id="node19" class="node">
<title>client_send</title>
<polygon fill="none" stroke="#000000" points="1537.2061,-310.2 1537.2061,-359.8 1665.2061,-359.8 1665.2061,-310.2 1537.2061,-310.2"/>
<text text-anchor="middle" x="1601.2061" y="-344.6" font-family="Times,serif" font-size="14.00" fill="#000000">client_send</text>
<polyline fill="none" stroke="#000000" points="1537.2061,-337.8 1665.2061,-337.8 "/>
<text text-anchor="start" x="1545.2061" y="-322.6" font-family="Times,serif" font-size="14.00" fill="#000000">通过网络发送数据</text>
</g>
<!-- sendProduceRequest&#45;&gt;client_send -->
<g id="edge18" class="edge">
<title>sendProduceRequest&#45;&gt;client_send</title>
<path fill="none" stroke="#000000" d="M1464.7868,-337.0177C1484.6534,-336.7239 1506.5625,-336.3998 1526.9014,-336.099"/>
<polygon fill="#000000" stroke="#000000" points="1527.1112,-339.5964 1537.0583,-335.9488 1527.0076,-332.5971 1527.1112,-339.5964"/>
</g>
<!-- drainBatchesForOneNode -->
<g id="node23" class="node">
<title>drainBatchesForOneNode</title>
<polygon fill="none" stroke="#000000" points="1479.5509,-506 1317.1913,-506 1317.1913,-470 1479.5509,-470 1479.5509,-506"/>
<text text-anchor="middle" x="1398.3711" y="-483.8" font-family="Times,serif" font-size="14.00" fill="#000000">drainBatchesForOneNode</text>
</g>
<!-- accumulator_drain&#45;&gt;drainBatchesForOneNode -->
<g id="edge20" class="edge">
<title>accumulator_drain&#45;&gt;drainBatchesForOneNode</title>
<path fill="none" stroke="#000000" d="M1281.2951,-477.3302C1289.7079,-478.0969 1298.3978,-478.8888 1307.065,-479.6787"/>
<polygon fill="#000000" stroke="#000000" points="1306.9349,-483.1813 1317.2113,-480.6034 1307.5703,-476.2102 1306.9349,-483.1813"/>
</g>
<!-- peekFirst -->
<g id="node21" class="node">
<title>peekFirst</title>
<polygon fill="none" stroke="#000000" points="1524.7612,-412.2 1524.7612,-461.8 1677.6509,-461.8 1677.6509,-412.2 1524.7612,-412.2"/>
<text text-anchor="middle" x="1601.2061" y="-446.6" font-family="Times,serif" font-size="14.00" fill="#000000">peekFirst</text>
<polyline fill="none" stroke="#000000" points="1524.7612,-439.8 1677.6509,-439.8 "/>
<text text-anchor="start" x="1532.7612" y="-424.6" font-family="Times,serif" font-size="14.00" fill="#000000">从tp队列头部获取消息</text>
</g>
<!-- incrementSequenceNumber -->
<g id="node22" class="node">
<title>incrementSequenceNumber</title>
<polygon fill="none" stroke="#000000" points="1515.4609,-481.2 1515.4609,-530.8 1686.9512,-530.8 1686.9512,-481.2 1515.4609,-481.2"/>
<text text-anchor="middle" x="1601.2061" y="-515.6" font-family="Times,serif" font-size="14.00" fill="#000000">incrementSequenceNumber</text>
<polyline fill="none" stroke="#000000" points="1515.4609,-508.8 1686.9512,-508.8 "/>
<text text-anchor="start" x="1523.4609" y="-493.6" font-family="Times,serif" font-size="14.00" fill="#000000">每个消息分配一个序列号</text>
</g>
<!-- drainBatchesForOneNode&#45;&gt;peekFirst -->
<g id="edge21" class="edge">
<title>drainBatchesForOneNode&#45;&gt;peekFirst</title>
<path fill="none" stroke="#000000" d="M1470.1686,-469.9475C1484.6588,-466.3042 1500.0334,-462.4384 1514.9594,-458.6855"/>
<polygon fill="#000000" stroke="#000000" points="1515.8448,-462.0719 1524.6894,-456.239 1514.1378,-455.2832 1515.8448,-462.0719"/>
</g>
<!-- drainBatchesForOneNode&#45;&gt;incrementSequenceNumber -->
<g id="edge22" class="edge">
<title>drainBatchesForOneNode&#45;&gt;incrementSequenceNumber</title>
<path fill="none" stroke="#000000" d="M1479.7031,-495.2176C1488.1001,-495.9627 1496.6885,-496.7249 1505.2254,-497.4825"/>
<polygon fill="#000000" stroke="#000000" points="1504.9385,-500.9707 1515.2087,-498.3684 1505.5573,-493.9981 1504.9385,-500.9707"/>
</g>
<!-- getDeque -->
<g id="node24" class="node">
<title>getDeque</title>
<polygon fill="none" stroke="#000000" points="1635.8486,-585 1566.5635,-585 1566.5635,-549 1635.8486,-549 1635.8486,-585"/>
<text text-anchor="middle" x="1601.2061" y="-562.8" font-family="Times,serif" font-size="14.00" fill="#000000">getDeque</text>
</g>
<!-- drainBatchesForOneNode&#45;&gt;getDeque -->
<g id="edge23" class="edge">
<title>drainBatchesForOneNode&#45;&gt;getDeque</title>
<path fill="none" stroke="#000000" d="M1436.1509,-506.0805C1458.8716,-516.6256 1488.5185,-529.8127 1515.4609,-540 1528.6061,-544.9704 1543.1126,-549.7847 1556.3963,-553.9378"/>
<polygon fill="#000000" stroke="#000000" points="1555.6862,-557.3812 1566.2733,-556.9765 1557.7446,-550.6907 1555.6862,-557.3812"/>
</g>
<!-- batches -->
<g id="node25" class="node">
<title>batches</title>
<polygon fill="#95e1d3" stroke="#000000" points="1722.9512,-548.2 1722.9512,-597.8 1861.8408,-597.8 1861.8408,-548.2 1722.9512,-548.2"/>
<text text-anchor="middle" x="1792.396" y="-582.6" font-family="Times,serif" font-size="14.00" fill="#000000">batches</text>
<polyline fill="none" stroke="#000000" points="1722.9512,-575.8 1861.8408,-575.8 "/>
<text text-anchor="middle" x="1792.396" y="-560.6" font-family="Times,serif" font-size="14.00" fill="#000000">每个tp对应一个队列</text>
</g>
<!-- getDeque&#45;&gt;batches -->
<g id="edge24" class="edge">
<title>getDeque&#45;&gt;batches</title>
<path fill="none" stroke="#000000" d="M1636.2732,-568.1005C1657.6855,-568.7725 1685.9805,-569.6604 1712.5955,-570.4957"/>
<polygon fill="#000000" stroke="#000000" points="1712.591,-573.9972 1722.6959,-570.8126 1712.8106,-567.0006 1712.591,-573.9972"/>
</g>
<!-- getOrCreateDeque&#45;&gt;batches -->
<g id="edge29" class="edge">
<title>getOrCreateDeque&#45;&gt;batches</title>
<path fill="none" stroke="#000000" d="M619.7134,-426.7155C631.7227,-425.1795 643.8957,-423.8683 655.5176,-423 729.1241,-417.5007 748.3592,-413.7882 821.5938,-423 967.6042,-441.3658 999.5266,-469.7023 1142.3916,-505 1307.877,-545.8865 1346.1666,-574.0859 1515.4609,-594 1591.1569,-602.9041 1611.1012,-601.4796 1686.9512,-594 1695.454,-593.1615 1704.2872,-591.9515 1713.0609,-590.5297"/>
<polygon fill="#000000" stroke="#000000" points="1713.6541,-593.9791 1722.9206,-588.8428 1712.4736,-587.0794 1713.6541,-593.9791"/>
</g>
<!-- putIfAbsent -->
<g id="node27" class="node">
<title>putIfAbsent</title>
<polygon fill="none" stroke="#000000" points="683.1108,-432.2 683.1108,-481.8 794.0005,-481.8 794.0005,-432.2 683.1108,-432.2"/>
<text text-anchor="middle" x="738.5557" y="-466.6" font-family="Times,serif" font-size="14.00" fill="#000000">putIfAbsent</text>
<polyline fill="none" stroke="#000000" points="683.1108,-459.8 794.0005,-459.8 "/>
<text text-anchor="start" x="691.1108" y="-444.6" font-family="Times,serif" font-size="14.00" fill="#000000">插入新的tp队列</text>
</g>
<!-- getOrCreateDeque&#45;&gt;putIfAbsent -->
<g id="edge30" class="edge">
<title>getOrCreateDeque&#45;&gt;putIfAbsent</title>
<path fill="none" stroke="#000000" d="M619.7366,-448.492C637.593,-449.7706 656.0054,-451.089 672.8466,-452.2949"/>
<polygon fill="#000000" stroke="#000000" points="672.8862,-455.8066 683.1107,-453.0299 673.3862,-448.8245 672.8862,-455.8066"/>
</g>
<!-- newArrayDeque -->
<g id="node31" class="node">
<title>newArrayDeque</title>
<polygon fill="none" stroke="#000000" points="655.5176,-501.2 655.5176,-550.8 821.5938,-550.8 821.5938,-501.2 655.5176,-501.2"/>
<text text-anchor="middle" x="738.5557" y="-535.6" font-family="Times,serif" font-size="14.00" fill="#000000">newArrayDeque</text>
<polyline fill="none" stroke="#000000" points="655.5176,-528.8 821.5938,-528.8 "/>
<text text-anchor="start" x="663.5176" y="-513.6" font-family="Times,serif" font-size="14.00" fill="#000000">新建一个tp的ArrayDeque</text>
</g>
<!-- getOrCreateDeque&#45;&gt;newArrayDeque -->
<g id="edge31" class="edge">
<title>getOrCreateDeque&#45;&gt;newArrayDeque</title>
<path fill="none" stroke="#000000" d="M593.8594,-466.879C602.4975,-470.2523 611.2301,-473.6912 619.5176,-477 635.6534,-483.4423 652.9669,-490.4906 669.2547,-497.1829"/>
<polygon fill="#000000" stroke="#000000" points="668.13,-500.5048 678.7095,-501.0747 670.7945,-494.0317 668.13,-500.5048"/>
</g>
<!-- FutureRecordMetadata -->
<g id="node30" class="node">
<title>FutureRecordMetadata</title>
<polygon fill="none" stroke="#000000" points="811.1182,-605 665.9932,-605 665.9932,-569 811.1182,-569 811.1182,-605"/>
<text text-anchor="middle" x="738.5557" y="-582.8" font-family="Times,serif" font-size="14.00" fill="#000000">FutureRecordMetadata</text>
</g>
<!-- tryAppend&#45;&gt;FutureRecordMetadata -->
<g id="edge28" class="edge">
<title>tryAppend&#45;&gt;FutureRecordMetadata</title>
<path fill="none" stroke="#000000" d="M593.3096,-535.843C602.1163,-539.2533 611.0411,-542.7117 619.5176,-546 635.5227,-552.2089 639.3481,-554.2324 655.5176,-560 660.9143,-561.925 666.5275,-563.8701 672.1757,-565.7875"/>
<polygon fill="#000000" stroke="#000000" points="671.0882,-569.1143 681.6822,-568.9796 673.3164,-562.4784 671.0882,-569.1143"/>
</g>
</g>
</svg>
