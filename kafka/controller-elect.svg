<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: controller_elect Pages: 1 -->
<svg width="3092pt" height="775pt"
 viewBox="0.00 0.00 3092.34 775.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 771)">
<title>controller_elect</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-771 3088.3408,-771 3088.3408,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_zkClient</title>
<path fill="none" stroke="#000000" d="M546.0977,-8C546.0977,-8 3064.3408,-8 3064.3408,-8 3070.3408,-8 3076.3408,-14 3076.3408,-20 3076.3408,-20 3076.3408,-335 3076.3408,-335 3076.3408,-341 3070.3408,-347 3064.3408,-347 3064.3408,-347 546.0977,-347 546.0977,-347 540.0977,-347 534.0977,-341 534.0977,-335 534.0977,-335 534.0977,-20 534.0977,-20 534.0977,-14 540.0977,-8 546.0977,-8"/>
<text text-anchor="middle" x="1805.2192" y="-327" font-family="Times,serif" font-size="20.00" fill="#000000">zkClient</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_Controller</title>
<path fill="none" stroke="#000000" d="M246.166,-355C246.166,-355 2901.9268,-355 2901.9268,-355 2907.9268,-355 2913.9268,-361 2913.9268,-367 2913.9268,-367 2913.9268,-747 2913.9268,-747 2913.9268,-753 2907.9268,-759 2901.9268,-759 2901.9268,-759 246.166,-759 246.166,-759 240.166,-759 234.166,-753 234.166,-747 234.166,-747 234.166,-367 234.166,-367 234.166,-361 240.166,-355 246.166,-355"/>
<text text-anchor="middle" x="1574.0464" y="-739" font-family="Times,serif" font-size="20.00" fill="#000000">Controller</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_kafkaSServer</title>
<path fill="none" stroke="#000000" d="M20,-345C20,-345 202.166,-345 202.166,-345 208.166,-345 214.166,-351 214.166,-357 214.166,-357 214.166,-487 214.166,-487 214.166,-493 208.166,-499 202.166,-499 202.166,-499 20,-499 20,-499 14,-499 8,-493 8,-487 8,-487 8,-357 8,-357 8,-351 14,-345 20,-345"/>
<text text-anchor="middle" x="111.083" y="-479" font-family="Times,serif" font-size="20.00" fill="#000000">kafkaServer</text>
</g>
<!-- registerZNodeChangeHandlerAndCheckExistence -->
<g id="node1" class="node">
<title>registerZNodeChangeHandlerAndCheckExistence</title>
<polygon fill="none" stroke="#000000" points="841.1094,-311 542.0937,-311 542.0937,-275 841.1094,-275 841.1094,-311"/>
<text text-anchor="middle" x="691.6016" y="-288.8" font-family="Times,serif" font-size="14.00" fill="#000000">registerZNodeChangeHandlerAndCheckExistence</text>
</g>
<!-- registerZNodeChangeHandler -->
<g id="node2" class="node">
<title>registerZNodeChangeHandler</title>
<polygon fill="none" stroke="#000000" points="888.3608,-247.2 888.3608,-310.8 1084.7817,-310.8 1084.7817,-247.2 888.3608,-247.2"/>
<text text-anchor="middle" x="986.5713" y="-295.6" font-family="Times,serif" font-size="14.00" fill="#000000">registerZNodeChangeHandler</text>
<polyline fill="none" stroke="#000000" points="888.3608,-288.8 1084.7817,-288.8 "/>
<text text-anchor="start" x="896.3608" y="-273.6" font-family="Times,serif" font-size="14.00" fill="#000000">在ControllerZNode路径上注册</text>
<text text-anchor="middle" x="986.5713" y="-254" font-family="Times,serif" font-size="14.00" fill="#000000"> ControllerChangeHandler</text>
</g>
<!-- registerZNodeChangeHandlerAndCheckExistence&#45;&gt;registerZNodeChangeHandler -->
<g id="edge1" class="edge">
<title>registerZNodeChangeHandlerAndCheckExistence&#45;&gt;registerZNodeChangeHandler</title>
<path fill="none" stroke="#000000" d="M841.2468,-285.8975C853.725,-285.3052 866.1826,-284.7139 878.2621,-284.1406"/>
<polygon fill="#000000" stroke="#000000" points="878.4894,-287.6339 888.3122,-283.6636 878.1575,-280.6417 878.4894,-287.6339"/>
</g>
<!-- ControllerChangeHandler -->
<g id="node15" class="node">
<title>ControllerChangeHandler</title>
<polygon fill="#f38181" stroke="#000000" points="1132.2183,-388.8002 1132.2183,-497.1998 1299.4702,-497.1998 1299.4702,-388.8002 1132.2183,-388.8002"/>
<text text-anchor="middle" x="1215.8442" y="-481.9998" font-family="Times,serif" font-size="14.00" fill="#000000">controllerChangeHandler</text>
<polyline fill="none" stroke="#000000" points="1132.2183,-475.1998 1299.4702,-475.1998 "/>
<text text-anchor="start" x="1140.2183" y="-459.9998" font-family="Times,serif" font-size="14.00" fill="#000000">ControllerZNode发生</text>
<text text-anchor="start" x="1140.2183" y="-440.3999" font-family="Times,serif" font-size="14.00" fill="#000000"> 变化回调函数</text>
<text text-anchor="start" x="1140.2183" y="-420.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 每个broker都在zk上注册</text>
<text text-anchor="start" x="1140.2183" y="-401.2001" font-family="Times,serif" font-size="14.00" fill="#000000"> 了该回调函数</text>
</g>
<!-- registerZNodeChangeHandler&#45;&gt;ControllerChangeHandler -->
<g id="edge21" class="edge">
<title>registerZNodeChangeHandler&#45;&gt;ControllerChangeHandler</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1065.3159,-310.9373C1076.2126,-317.0809 1086.8146,-324.1038 1096.0371,-332 1115.1372,-348.3533 1113.0307,-361.0922 1129.862,-381.107"/>
<polygon fill="#000000" stroke="#000000" points="1127.3245,-383.5183 1136.6709,-388.5078 1132.4759,-378.7788 1127.3245,-383.5183"/>
</g>
<!-- deleteController -->
<g id="node3" class="node">
<title>deleteController</title>
<polygon fill="none" stroke="#000000" points="2412.1914,-261.2 2412.1914,-310.8 2549.502,-310.8 2549.502,-261.2 2412.1914,-261.2"/>
<text text-anchor="middle" x="2480.8467" y="-295.6" font-family="Times,serif" font-size="14.00" fill="#000000">deleteController</text>
<polyline fill="none" stroke="#000000" points="2412.1914,-288.8 2549.502,-288.8 "/>
<text text-anchor="start" x="2420.1914" y="-273.6" font-family="Times,serif" font-size="14.00" fill="#000000">删掉ControllerZnode</text>
</g>
<!-- unregisterZNodeChangeHandler -->
<g id="node4" class="node">
<title>unregisterZNodeChangeHandler</title>
<polygon fill="none" stroke="#000000" points="2676.4678,-261.2 2676.4678,-310.8 2886.8682,-310.8 2886.8682,-261.2 2676.4678,-261.2"/>
<text text-anchor="middle" x="2781.668" y="-295.6" font-family="Times,serif" font-size="14.00" fill="#000000">unregisterZNodeChangeHandler</text>
<polyline fill="none" stroke="#000000" points="2676.4678,-288.8 2886.8682,-288.8 "/>
<text text-anchor="middle" x="2781.668" y="-273.6" font-family="Times,serif" font-size="14.00" fill="#000000">取消controller注册的各种handler</text>
</g>
<!-- registerControllerAndIncrementControllerEpoch -->
<g id="node5" class="node">
<title>registerControllerAndIncrementControllerEpoch</title>
<polygon fill="none" stroke="#000000" points="2301.7917,-260 2012.4105,-260 2012.4105,-224 2301.7917,-224 2301.7917,-260"/>
<text text-anchor="middle" x="2157.1011" y="-237.8" font-family="Times,serif" font-size="14.00" fill="#000000">registerControllerAndIncrementControllerEpoch</text>
</g>
<!-- tryCreateControllerZNodeAndIncrementEpoch -->
<g id="node6" class="node">
<title>tryCreateControllerZNodeAndIncrementEpoch</title>
<polygon fill="none" stroke="#000000" points="2340.2842,-139.2 2340.2842,-188.8 2621.4092,-188.8 2621.4092,-139.2 2340.2842,-139.2"/>
<text text-anchor="middle" x="2480.8467" y="-173.6" font-family="Times,serif" font-size="14.00" fill="#000000">tryCreateControllerZNodeAndIncrementEpoch</text>
<polyline fill="none" stroke="#000000" points="2340.2842,-166.8 2621.4092,-166.8 "/>
<text text-anchor="start" x="2348.2842" y="-151.6" font-family="Times,serif" font-size="14.00" fill="#000000">尝试成为controller并增加Epoch</text>
</g>
<!-- registerControllerAndIncrementControllerEpoch&#45;&gt;tryCreateControllerZNodeAndIncrementEpoch -->
<g id="edge2" class="edge">
<title>registerControllerAndIncrementControllerEpoch&#45;&gt;tryCreateControllerZNodeAndIncrementEpoch</title>
<path fill="none" stroke="#000000" d="M2232.1886,-223.9092C2272.475,-214.203 2322.9436,-202.0436 2367.8675,-191.2201"/>
<polygon fill="#000000" stroke="#000000" points="2368.7586,-194.6056 2377.6606,-188.8606 2367.119,-187.8003 2368.7586,-194.6056"/>
</g>
<!-- getControllerEpoch -->
<g id="node7" class="node">
<title>getControllerEpoch</title>
<polygon fill="none" stroke="#000000" points="3068.5485,-164 2941.719,-164 2941.719,-128 3068.5485,-128 3068.5485,-164"/>
<text text-anchor="middle" x="3005.1338" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#000000">getControllerEpoch</text>
</g>
<!-- registerControllerAndIncrementControllerEpoch&#45;&gt;getControllerEpoch -->
<g id="edge3" class="edge">
<title>registerControllerAndIncrementControllerEpoch&#45;&gt;getControllerEpoch</title>
<path fill="none" stroke="#000000" d="M2301.838,-245.7182C2505.7515,-250.1001 2859.0005,-254.2329 2913.9268,-232 2943.8916,-219.8709 2969.7892,-192.8649 2986.2516,-172.3289"/>
<polygon fill="#000000" stroke="#000000" points="2989.1426,-174.3122 2992.5047,-164.2649 2983.6109,-170.0226 2989.1426,-174.3122"/>
</g>
<!-- checkControllerAndEpoch -->
<g id="node8" class="node">
<title>checkControllerAndEpoch</title>
<polygon fill="none" stroke="#000000" points="2662.3789,-16.4001 2662.3789,-85.5999 2900.957,-85.5999 2900.957,-16.4001 2662.3789,-16.4001"/>
<text text-anchor="middle" x="2781.668" y="-70.3999" font-family="Times,serif" font-size="14.00" fill="#000000">checkControllerAndEpoch</text>
<polyline fill="none" stroke="#000000" points="2662.3789,-63.5999 2900.957,-63.5999 "/>
<text text-anchor="start" x="2670.3789" y="-48.3999" font-family="Times,serif" font-size="14.00" fill="#000000">如果返回节点已存在或者Bad Version</text>
<text text-anchor="start" x="2670.3789" y="-28.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 那么就检查Controller和Epoch</text>
</g>
<!-- tryCreateControllerZNodeAndIncrementEpoch&#45;&gt;checkControllerAndEpoch -->
<g id="edge4" class="edge">
<title>tryCreateControllerZNodeAndIncrementEpoch&#45;&gt;checkControllerAndEpoch</title>
<path fill="none" stroke="#000000" d="M2543.1699,-139.0793C2576.8884,-125.7394 2619.319,-109.1824 2657.4092,-95 2662.5698,-93.0785 2667.8581,-91.1295 2673.2045,-89.1751"/>
<polygon fill="#000000" stroke="#000000" points="2674.6752,-92.3645 2682.8757,-85.6562 2672.2817,-85.7864 2674.6752,-92.3645"/>
</g>
<!-- CreateOp -->
<g id="node9" class="node">
<title>CreateOp</title>
<polygon fill="none" stroke="#000000" points="2699.0127,-104.2 2699.0127,-153.8 2864.3232,-153.8 2864.3232,-104.2 2699.0127,-104.2"/>
<text text-anchor="middle" x="2781.668" y="-138.6" font-family="Times,serif" font-size="14.00" fill="#000000">CreateOp</text>
<polyline fill="none" stroke="#000000" points="2699.0127,-131.8 2864.3232,-131.8 "/>
<text text-anchor="start" x="2707.0127" y="-116.6" font-family="Times,serif" font-size="14.00" fill="#000000">创建ControllerZnode路径</text>
</g>
<!-- tryCreateControllerZNodeAndIncrementEpoch&#45;&gt;CreateOp -->
<g id="edge5" class="edge">
<title>tryCreateControllerZNodeAndIncrementEpoch&#45;&gt;CreateOp</title>
<path fill="none" stroke="#000000" d="M2621.5689,-147.6272C2644.4062,-144.9702 2667.5426,-142.2783 2688.8606,-139.798"/>
<polygon fill="#000000" stroke="#000000" points="2689.3153,-143.2688 2698.8437,-138.6364 2688.5062,-136.3157 2689.3153,-143.2688"/>
</g>
<!-- SetDataOp -->
<g id="node10" class="node">
<title>SetDataOp</title>
<polygon fill="none" stroke="#000000" points="2727.7852,-173.2 2727.7852,-222.8 2835.5508,-222.8 2835.5508,-173.2 2727.7852,-173.2"/>
<text text-anchor="middle" x="2781.668" y="-207.6" font-family="Times,serif" font-size="14.00" fill="#000000">SetDataOp</text>
<polyline fill="none" stroke="#000000" points="2727.7852,-200.8 2835.5508,-200.8 "/>
<text text-anchor="middle" x="2781.668" y="-185.6" font-family="Times,serif" font-size="14.00" fill="#000000">设置新的Epoch</text>
</g>
<!-- tryCreateControllerZNodeAndIncrementEpoch&#45;&gt;SetDataOp -->
<g id="edge6" class="edge">
<title>tryCreateControllerZNodeAndIncrementEpoch&#45;&gt;SetDataOp</title>
<path fill="none" stroke="#000000" d="M2621.5689,-179.905C2655.2076,-183.7069 2689.4952,-187.5823 2717.6642,-190.766"/>
<polygon fill="#000000" stroke="#000000" points="2717.423,-194.261 2727.7529,-191.9063 2718.2093,-187.3053 2717.423,-194.261"/>
</g>
<!-- checkControllerAndEpoch&#45;&gt;getControllerEpoch -->
<g id="edge7" class="edge">
<title>checkControllerAndEpoch&#45;&gt;getControllerEpoch</title>
<path fill="none" stroke="#000000" d="M2891.2684,-85.6572C2899.0004,-88.653 2906.6206,-91.7766 2913.9268,-95 2931.8256,-102.8969 2950.8289,-113.1903 2966.8302,-122.4599"/>
<polygon fill="#000000" stroke="#000000" points="2965.4786,-125.7252 2975.8735,-127.7736 2969.0248,-119.69 2965.4786,-125.7252"/>
</g>
<!-- elect -->
<g id="node11" class="node">
<title>elect</title>
<polygon fill="none" stroke="#000000" points="1717.2109,-363.0002 1717.2109,-490.9998 1973.918,-490.9998 1973.918,-363.0002 1717.2109,-363.0002"/>
<text text-anchor="middle" x="1845.5645" y="-475.7998" font-family="Times,serif" font-size="14.00" fill="#000000">elect</text>
<polyline fill="none" stroke="#000000" points="1717.2109,-468.9998 1973.918,-468.9998 "/>
<text text-anchor="start" x="1725.2109" y="-453.7998" font-family="Times,serif" font-size="14.00" fill="#000000">controller选举</text>
<text text-anchor="start" x="1725.2109" y="-434.1999" font-family="Times,serif" font-size="14.00" fill="#000000"> 如果zk注册成功则</text>
<text text-anchor="start" x="1725.2109" y="-414.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 该broker成为controller</text>
<text text-anchor="start" x="1725.2109" y="-395" font-family="Times,serif" font-size="14.00" fill="#000000"> 如果该过程中出现ControllerMoved异常</text>
<text text-anchor="start" x="1725.2109" y="-375.4001" font-family="Times,serif" font-size="14.00" fill="#000000"> 则触发退位</text>
</g>
<!-- elect&#45;&gt;registerControllerAndIncrementControllerEpoch -->
<g id="edge17" class="edge">
<title>elect&#45;&gt;registerControllerAndIncrementControllerEpoch</title>
<path fill="none" stroke="#000000" d="M1967.3105,-362.8214C1969.5351,-361.5446 1971.7394,-360.27 1973.918,-359 2026.4334,-328.3858 2085.3895,-289.9735 2121.8876,-265.6984"/>
<polygon fill="#000000" stroke="#000000" points="2123.8394,-268.6037 2130.2177,-260.1439 2119.9559,-262.7797 2123.8394,-268.6037"/>
</g>
<!-- maybeResign -->
<g id="node13" class="node">
<title>maybeResign</title>
<polygon fill="none" stroke="#000000" points="2110.9976,-603.2 2110.9976,-652.8 2203.2046,-652.8 2203.2046,-603.2 2110.9976,-603.2"/>
<text text-anchor="middle" x="2157.1011" y="-637.6" font-family="Times,serif" font-size="14.00" fill="#000000">maybeResign</text>
<polyline fill="none" stroke="#000000" points="2110.9976,-630.8 2203.2046,-630.8 "/>
<text text-anchor="start" x="2118.9976" y="-615.6" font-family="Times,serif" font-size="14.00" fill="#000000">可能退位</text>
</g>
<!-- elect&#45;&gt;maybeResign -->
<g id="edge18" class="edge">
<title>elect&#45;&gt;maybeResign</title>
<path fill="none" stroke="#000000" d="M1893.3151,-491.0145C1923.071,-526.4955 1964.3029,-568.4726 2009.918,-594 2037.6381,-609.5129 2072.0763,-617.9576 2100.6696,-622.5498"/>
<polygon fill="#000000" stroke="#000000" points="2100.5103,-626.0645 2110.9163,-624.0733 2101.5398,-619.1406 2100.5103,-626.0645"/>
</g>
<!-- onControllerFailover -->
<g id="node26" class="node">
<title>onControllerFailover</title>
<polygon fill="#f38181" stroke="#000000" points="2009.918,-417.4003 2009.918,-584.5997 2304.2842,-584.5997 2304.2842,-417.4003 2009.918,-417.4003"/>
<text text-anchor="middle" x="2157.1011" y="-569.3997" font-family="Times,serif" font-size="14.00" fill="#000000">onControllerFailover</text>
<polyline fill="none" stroke="#000000" points="2009.918,-562.5997 2304.2842,-562.5997 "/>
<text text-anchor="start" x="2017.918" y="-547.3997" font-family="Times,serif" font-size="14.00" fill="#000000">broker被选举为controller</text>
<text text-anchor="start" x="2017.918" y="-527.7998" font-family="Times,serif" font-size="14.00" fill="#000000"> 1.更新ControllerContext中的cache.</text>
<text text-anchor="start" x="2017.918" y="-508.1999" font-family="Times,serif" font-size="14.00" fill="#000000"> 2.启动channelManager</text>
<text text-anchor="start" x="2017.918" y="-488.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 3.启动replicaStateMachine</text>
<text text-anchor="start" x="2017.918" y="-469" font-family="Times,serif" font-size="14.00" fill="#000000"> 4.启动ParitionStteMachine</text>
<text text-anchor="start" x="2017.918" y="-449.4001" font-family="Times,serif" font-size="14.00" fill="#000000"> 5.在zk上注册各种handler</text>
<text text-anchor="start" x="2017.918" y="-429.8002" font-family="Times,serif" font-size="14.00" fill="#000000"> 6.向所有的broker发送updatedateMetaData请求</text>
</g>
<!-- elect&#45;&gt;onControllerFailover -->
<g id="edge19" class="edge">
<title>elect&#45;&gt;onControllerFailover</title>
<path fill="none" stroke="#000000" d="M1974.077,-457.5259C1982.6624,-459.5652 1991.3618,-461.6316 2000.0665,-463.6992"/>
<polygon fill="#000000" stroke="#000000" points="1999.3527,-467.127 2009.8909,-466.0328 2000.9705,-460.3165 1999.3527,-467.127"/>
</g>
<!-- triggerControllerMove -->
<g id="node27" class="node">
<title>triggerControllerMove</title>
<polygon fill="none" stroke="#000000" points="2228.6263,-399 2085.5759,-399 2085.5759,-363 2228.6263,-363 2228.6263,-399"/>
<text text-anchor="middle" x="2157.1011" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#000000">triggerControllerMove</text>
</g>
<!-- elect&#45;&gt;triggerControllerMove -->
<g id="edge20" class="edge">
<title>elect&#45;&gt;triggerControllerMove</title>
<path fill="none" stroke="#000000" d="M1974.077,-408.0245C2008.2602,-402.9771 2044.2509,-397.6629 2075.1854,-393.0953"/>
<polygon fill="#000000" stroke="#000000" points="2076.091,-396.4996 2085.4725,-391.5763 2075.0685,-389.5747 2076.091,-396.4996"/>
</g>
<!-- isActive -->
<g id="node12" class="node">
<title>isActive</title>
<polygon fill="#95e1d3" stroke="#000000" points="2512.0029,-604 2453.6905,-604 2449.6905,-600 2449.6905,-568 2508.0029,-568 2512.0029,-572 2512.0029,-604"/>
<polyline fill="none" stroke="#000000" points="2508.0029,-600 2449.6905,-600 "/>
<polyline fill="none" stroke="#000000" points="2508.0029,-600 2508.0029,-568 "/>
<polyline fill="none" stroke="#000000" points="2508.0029,-600 2512.0029,-604 "/>
<text text-anchor="middle" x="2480.8467" y="-581.8" font-family="Times,serif" font-size="14.00" fill="#000000">isActive</text>
</g>
<!-- maybeResign&#45;&gt;registerZNodeChangeHandlerAndCheckExistence -->
<g id="edge29" class="edge">
<title>maybeResign&#45;&gt;registerZNodeChangeHandlerAndCheckExistence</title>
<path fill="none" stroke="#000000" d="M2110.7932,-644.9C1951.7423,-699.6691 1421.6668,-854.589 1132.0371,-602 1069.8936,-547.804 1151.0802,-481.3944 1096.0371,-420 1055.8808,-375.2102 902.0879,-335.8355 796.1657,-313.2245"/>
<polygon fill="#000000" stroke="#000000" points="796.5779,-309.7343 786.07,-311.0891 795.1292,-316.5828 796.5779,-309.7343"/>
</g>
<!-- maybeResign&#45;&gt;isActive -->
<g id="edge30" class="edge">
<title>maybeResign&#45;&gt;isActive</title>
<path fill="none" stroke="#000000" d="M2203.4859,-621.9824C2266.7879,-613.7702 2379.2561,-599.1795 2439.702,-591.3378"/>
<polygon fill="#000000" stroke="#000000" points="2440.1842,-594.8046 2449.6508,-590.0471 2439.2835,-587.8628 2440.1842,-594.8046"/>
</g>
<!-- getControllerId -->
<g id="node30" class="node">
<title>getControllerId</title>
<polygon fill="none" stroke="#000000" points="2532.1577,-658 2429.5357,-658 2429.5357,-622 2532.1577,-622 2532.1577,-658"/>
<text text-anchor="middle" x="2480.8467" y="-635.8" font-family="Times,serif" font-size="14.00" fill="#000000">getControllerId</text>
</g>
<!-- maybeResign&#45;&gt;getControllerId -->
<g id="edge31" class="edge">
<title>maybeResign&#45;&gt;getControllerId</title>
<path fill="none" stroke="#000000" d="M2203.4859,-629.7193C2260.211,-631.8219 2356.4167,-635.3879 2419.2905,-637.7183"/>
<polygon fill="#000000" stroke="#000000" points="2419.3458,-641.2227 2429.4686,-638.0956 2419.6051,-634.2275 2419.3458,-641.2227"/>
</g>
<!-- onControllerResignation -->
<g id="node31" class="node">
<title>onControllerResignation</title>
<polygon fill="#f38181" stroke="#000000" points="2389.25,-402.2003 2389.25,-549.7997 2572.4434,-549.7997 2572.4434,-402.2003 2389.25,-402.2003"/>
<text text-anchor="middle" x="2480.8467" y="-534.5997" font-family="Times,serif" font-size="14.00" fill="#000000">onControllerResignation</text>
<polyline fill="none" stroke="#000000" points="2389.25,-527.7997 2572.4434,-527.7997 "/>
<text text-anchor="start" x="2397.25" y="-512.5997" font-family="Times,serif" font-size="14.00" fill="#000000">controller退位</text>
<text text-anchor="start" x="2397.25" y="-492.9998" font-family="Times,serif" font-size="14.00" fill="#000000"> 1.取消在zk上的各种注册</text>
<text text-anchor="start" x="2397.25" y="-473.3999" font-family="Times,serif" font-size="14.00" fill="#000000"> 2.关闭replicaStateMachine</text>
<text text-anchor="start" x="2397.25" y="-453.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 3.关闭ParititonStateMachine</text>
<text text-anchor="start" x="2397.25" y="-434.2001" font-family="Times,serif" font-size="14.00" fill="#000000"> 4.关闭channelManager</text>
<text text-anchor="start" x="2397.25" y="-414.6002" font-family="Times,serif" font-size="14.00" fill="#000000"> 5.关闭KafkaScheduler</text>
</g>
<!-- maybeResign&#45;&gt;onControllerResignation -->
<g id="edge32" class="edge">
<title>maybeResign&#45;&gt;onControllerResignation</title>
<path fill="none" stroke="#000000" d="M2203.4941,-623.7992C2233.6786,-619.5393 2273.0846,-611.0107 2304.2842,-594 2323.8766,-583.3177 2322.5511,-572.5467 2340.2842,-559 2352.8728,-549.3832 2366.6657,-540.0088 2380.5367,-531.2295"/>
<polygon fill="#000000" stroke="#000000" points="2382.5404,-534.1049 2389.1734,-525.8432 2378.8361,-528.1653 2382.5404,-534.1049"/>
</g>
<!-- controller_startup -->
<g id="node14" class="node">
<title>controller_startup</title>
<polygon fill="none" stroke="#000000" points="242.166,-390 242.166,-426 296.2695,-426 296.2695,-390 242.166,-390"/>
<text text-anchor="middle" x="269.2178" y="-403.8" font-family="Times,serif" font-size="14.00" fill="#000000">startup</text>
</g>
<!-- processStartup -->
<g id="node17" class="node">
<title>processStartup</title>
<polygon fill="none" stroke="#000000" points="468.6123,-399 369.7549,-399 369.7549,-363 468.6123,-363 468.6123,-399"/>
<text text-anchor="middle" x="419.1836" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#000000">processStartup</text>
</g>
<!-- controller_startup&#45;&gt;processStartup -->
<g id="edge8" class="edge">
<title>controller_startup&#45;&gt;processStartup</title>
<path fill="none" stroke="#000000" d="M296.3755,-403.1105C314.0889,-399.9214 337.9137,-395.6319 359.864,-391.68"/>
<polygon fill="#000000" stroke="#000000" points="360.5671,-395.1097 369.7887,-389.8931 359.3267,-388.2205 360.5671,-395.1097"/>
</g>
<!-- registerStateChangeHandler -->
<g id="node18" class="node">
<title>registerStateChangeHandler</title>
<polygon fill="none" stroke="#000000" points="506.0118,-467 332.3554,-467 332.3554,-431 506.0118,-431 506.0118,-467"/>
<text text-anchor="middle" x="419.1836" y="-444.8" font-family="Times,serif" font-size="14.00" fill="#000000">registerStateChangeHandler</text>
</g>
<!-- controller_startup&#45;&gt;registerStateChangeHandler -->
<g id="edge9" class="edge">
<title>controller_startup&#45;&gt;registerStateChangeHandler</title>
<path fill="none" stroke="#000000" d="M296.3755,-415.4248C309.711,-419.0707 326.5103,-423.6635 343.3658,-428.2718"/>
<polygon fill="#000000" stroke="#000000" points="342.7018,-431.7186 353.2709,-430.9797 344.5479,-424.9664 342.7018,-431.7186"/>
</g>
<!-- ControllerChange -->
<g id="node16" class="node">
<title>ControllerChange</title>
<polygon fill="none" stroke="#000000" points="1381.7017,-388.4001 1381.7017,-457.5999 1499.2017,-457.5999 1499.2017,-388.4001 1381.7017,-388.4001"/>
<text text-anchor="middle" x="1440.4517" y="-442.3999" font-family="Times,serif" font-size="14.00" fill="#000000">ControllerChange</text>
<polyline fill="none" stroke="#000000" points="1381.7017,-435.5999 1499.2017,-435.5999 "/>
<text text-anchor="start" x="1389.7017" y="-420.3999" font-family="Times,serif" font-size="14.00" fill="#000000">controller节点</text>
<text text-anchor="start" x="1389.7017" y="-400.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 内容发生了变化</text>
</g>
<!-- ControllerChangeHandler&#45;&gt;ControllerChange -->
<g id="edge22" class="edge">
<title>ControllerChangeHandler&#45;&gt;ControllerChange</title>
<path fill="none" stroke="#000000" d="M1299.4798,-435.5527C1323.1667,-433.4435 1348.6773,-431.172 1371.3995,-429.1487"/>
<polygon fill="#000000" stroke="#000000" points="1371.9766,-432.6113 1381.6267,-428.238 1371.3557,-425.6388 1371.9766,-432.6113"/>
</g>
<!-- Reelect -->
<g id="node28" class="node">
<title>Reelect</title>
<polygon fill="none" stroke="#000000" points="1363.2412,-476.4001 1363.2412,-545.5999 1517.6621,-545.5999 1517.6621,-476.4001 1363.2412,-476.4001"/>
<text text-anchor="middle" x="1440.4517" y="-530.3999" font-family="Times,serif" font-size="14.00" fill="#000000">Reelect</text>
<polyline fill="none" stroke="#000000" points="1363.2412,-523.5999 1517.6621,-523.5999 "/>
<text text-anchor="start" x="1371.2412" y="-508.3999" font-family="Times,serif" font-size="14.00" fill="#000000">controller节点被删除了</text>
<text text-anchor="start" x="1371.2412" y="-488.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 触发重新选举</text>
</g>
<!-- ControllerChangeHandler&#45;&gt;Reelect -->
<g id="edge23" class="edge">
<title>ControllerChangeHandler&#45;&gt;Reelect</title>
<path fill="none" stroke="#000000" d="M1299.4798,-468.3207C1317.0542,-473.6414 1335.6326,-479.266 1353.3311,-484.6242"/>
<polygon fill="#000000" stroke="#000000" points="1352.476,-488.0222 1363.0612,-487.57 1354.5044,-481.3225 1352.476,-488.0222"/>
</g>
<!-- processControllerChange -->
<g id="node29" class="node">
<title>processControllerChange</title>
<polygon fill="none" stroke="#000000" points="1747.354,-510.4001 1747.354,-579.5999 1943.7749,-579.5999 1943.7749,-510.4001 1747.354,-510.4001"/>
<text text-anchor="middle" x="1845.5645" y="-564.3999" font-family="Times,serif" font-size="14.00" fill="#000000">processControllerChange</text>
<polyline fill="none" stroke="#000000" points="1747.354,-557.5999 1943.7749,-557.5999 "/>
<text text-anchor="start" x="1755.354" y="-542.3999" font-family="Times,serif" font-size="14.00" fill="#000000">controller节点数据发生了变化</text>
<text text-anchor="start" x="1755.354" y="-522.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 可能要退位</text>
</g>
<!-- ControllerChange&#45;&gt;processControllerChange -->
<g id="edge24" class="edge">
<title>ControllerChange&#45;&gt;processControllerChange</title>
<path fill="none" stroke="#000000" d="M1499.3585,-440.7398C1561.5455,-459.4675 1660.9498,-489.4032 1737.3235,-512.4032"/>
<polygon fill="#000000" stroke="#000000" points="1736.4074,-515.7825 1746.9919,-515.3148 1738.4259,-509.0798 1736.4074,-515.7825"/>
</g>
<!-- processStartup&#45;&gt;registerZNodeChangeHandlerAndCheckExistence -->
<g id="edge45" class="edge">
<title>processStartup&#45;&gt;registerZNodeChangeHandlerAndCheckExistence</title>
<path fill="none" stroke="#000000" d="M468.5164,-365.0639C512.5539,-350.8383 577.3848,-329.8958 625.8229,-314.2487"/>
<polygon fill="#000000" stroke="#000000" points="627.1486,-317.4986 635.5885,-311.0941 624.9968,-310.8375 627.1486,-317.4986"/>
</g>
<!-- processStartup&#45;&gt;elect -->
<g id="edge46" class="edge">
<title>processStartup&#45;&gt;elect</title>
<path fill="none" stroke="#000000" d="M468.6971,-382.5968C665.6329,-388.9479 1397.6311,-412.5544 1706.5756,-422.5177"/>
<polygon fill="#000000" stroke="#000000" points="1706.8298,-426.0276 1716.9374,-422.8518 1707.0555,-419.0312 1706.8298,-426.0276"/>
</g>
<!-- StateChangeHandler -->
<g id="node19" class="node">
<title>StateChangeHandler</title>
<polygon fill="none" stroke="#000000" points="757.4503,-482 625.7528,-482 625.7528,-446 757.4503,-446 757.4503,-482"/>
<text text-anchor="middle" x="691.6016" y="-459.8" font-family="Times,serif" font-size="14.00" fill="#000000">StateChangeHandler</text>
</g>
<!-- registerStateChangeHandler&#45;&gt;StateChangeHandler -->
<g id="edge10" class="edge">
<title>registerStateChangeHandler&#45;&gt;StateChangeHandler</title>
<path fill="none" stroke="#000000" d="M506.1273,-453.7873C541.1238,-455.7143 581.1349,-457.9174 615.0146,-459.7829"/>
<polygon fill="#000000" stroke="#000000" points="615.1425,-463.2952 625.3199,-460.3504 615.5274,-456.3058 615.1425,-463.2952"/>
</g>
<!-- afterInitializingSession -->
<g id="node20" class="node">
<title>afterInitializingSession</title>
<polygon fill="none" stroke="#000000" points="1059.4268,-560 913.7157,-560 913.7157,-524 1059.4268,-524 1059.4268,-560"/>
<text text-anchor="middle" x="986.5713" y="-537.8" font-family="Times,serif" font-size="14.00" fill="#000000">afterInitializingSession</text>
</g>
<!-- StateChangeHandler&#45;&gt;afterInitializingSession -->
<g id="edge11" class="edge">
<title>StateChangeHandler&#45;&gt;afterInitializingSession</title>
<path fill="none" stroke="#000000" d="M757.7985,-481.5047C802.4381,-493.3089 861.5262,-508.9338 908.4689,-521.3471"/>
<polygon fill="#000000" stroke="#000000" points="907.7295,-524.7718 918.292,-523.9446 909.5191,-518.0044 907.7295,-524.7718"/>
</g>
<!-- beforeInitializingSession -->
<g id="node21" class="node">
<title>beforeInitializingSession</title>
<polygon fill="none" stroke="#000000" points="877.1055,-429.4001 877.1055,-498.5999 1096.0371,-498.5999 1096.0371,-429.4001 877.1055,-429.4001"/>
<text text-anchor="middle" x="986.5713" y="-483.3999" font-family="Times,serif" font-size="14.00" fill="#000000">beforeInitializingSession</text>
<polyline fill="none" stroke="#000000" points="877.1055,-476.5999 1096.0371,-476.5999 "/>
<text text-anchor="start" x="885.1055" y="-461.3999" font-family="Times,serif" font-size="14.00" fill="#000000">清空controller的eventmanager队列</text>
<text text-anchor="middle" x="986.5713" y="-441.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 等待处理消息</text>
</g>
<!-- StateChangeHandler&#45;&gt;beforeInitializingSession -->
<g id="edge12" class="edge">
<title>StateChangeHandler&#45;&gt;beforeInitializingSession</title>
<path fill="none" stroke="#000000" d="M757.7985,-464C789.8597,-464 829.3741,-464 866.4889,-464"/>
<polygon fill="#000000" stroke="#000000" points="866.8853,-467.5001 876.8853,-464 866.8853,-460.5001 866.8853,-467.5001"/>
</g>
<!-- RegisterBrokerAndReelect -->
<g id="node22" class="node">
<title>RegisterBrokerAndReelect</title>
<polygon fill="none" stroke="#000000" points="1299.4589,-576 1132.2295,-576 1132.2295,-540 1299.4589,-540 1299.4589,-576"/>
<text text-anchor="middle" x="1215.8442" y="-553.8" font-family="Times,serif" font-size="14.00" fill="#000000">RegisterBrokerAndReelect</text>
</g>
<!-- afterInitializingSession&#45;&gt;RegisterBrokerAndReelect -->
<g id="edge13" class="edge">
<title>afterInitializingSession&#45;&gt;RegisterBrokerAndReelect</title>
<path fill="none" stroke="#000000" d="M1059.4297,-547.0845C1079.2619,-548.4685 1101.0267,-549.9874 1121.8515,-551.4406"/>
<polygon fill="#000000" stroke="#000000" points="1121.7671,-554.9432 1131.9866,-552.1479 1122.2545,-547.9602 1121.7671,-554.9432"/>
</g>
<!-- processRegisterBrokerAndReelect -->
<g id="node23" class="node">
<title>processRegisterBrokerAndReelect</title>
<polygon fill="none" stroke="#000000" points="1545.0526,-600 1335.8507,-600 1335.8507,-564 1545.0526,-564 1545.0526,-600"/>
<text text-anchor="middle" x="1440.4517" y="-577.8" font-family="Times,serif" font-size="14.00" fill="#000000">processRegisterBrokerAndReelect</text>
</g>
<!-- RegisterBrokerAndReelect&#45;&gt;processRegisterBrokerAndReelect -->
<g id="edge14" class="edge">
<title>RegisterBrokerAndReelect&#45;&gt;processRegisterBrokerAndReelect</title>
<path fill="none" stroke="#000000" d="M1299.4798,-566.9367C1308.0887,-567.8566 1316.9385,-568.8022 1325.8078,-569.7499"/>
<polygon fill="#000000" stroke="#000000" points="1325.5026,-573.2372 1335.8179,-570.8196 1326.2464,-566.2768 1325.5026,-573.2372"/>
</g>
<!-- processReelect -->
<g id="node24" class="node">
<title>processReelect</title>
<polygon fill="none" stroke="#000000" points="1681.1904,-537 1581.2725,-537 1581.2725,-501 1681.1904,-501 1681.1904,-537"/>
<text text-anchor="middle" x="1631.2314" y="-514.8" font-family="Times,serif" font-size="14.00" fill="#000000">processReelect</text>
</g>
<!-- processRegisterBrokerAndReelect&#45;&gt;processReelect -->
<g id="edge15" class="edge">
<title>processRegisterBrokerAndReelect&#45;&gt;processReelect</title>
<path fill="none" stroke="#000000" d="M1532.5231,-563.9838C1536.851,-562.7264 1541.1131,-561.3989 1545.252,-560 1559.8904,-555.0523 1575.2971,-548.2543 1588.9611,-541.616"/>
<polygon fill="#000000" stroke="#000000" points="1590.7128,-544.6539 1598.1115,-537.0703 1587.5985,-538.3848 1590.7128,-544.6539"/>
</g>
<!-- registerBroker -->
<g id="node25" class="node">
<title>registerBroker</title>
<polygon fill="none" stroke="#000000" points="1679.587,-600 1582.8759,-600 1582.8759,-564 1679.587,-564 1679.587,-600"/>
<text text-anchor="middle" x="1631.2314" y="-577.8" font-family="Times,serif" font-size="14.00" fill="#000000">registerBroker</text>
</g>
<!-- processRegisterBrokerAndReelect&#45;&gt;registerBroker -->
<g id="edge16" class="edge">
<title>processRegisterBrokerAndReelect&#45;&gt;registerBroker</title>
<path fill="none" stroke="#000000" d="M1545.3293,-582C1554.6642,-582 1563.8767,-582 1572.6045,-582"/>
<polygon fill="#000000" stroke="#000000" points="1572.6057,-585.5001 1582.6057,-582 1572.6056,-578.5001 1572.6057,-585.5001"/>
</g>
<!-- processReelect&#45;&gt;elect -->
<g id="edge27" class="edge">
<title>processReelect&#45;&gt;elect</title>
<path fill="none" stroke="#000000" d="M1673.321,-500.9335C1683.6189,-496.5133 1695.2069,-491.5392 1707.3793,-486.3144"/>
<polygon fill="#000000" stroke="#000000" points="1708.981,-489.4358 1716.7897,-482.2751 1706.2199,-483.0033 1708.981,-489.4358"/>
</g>
<!-- processReelect&#45;&gt;maybeResign -->
<g id="edge28" class="edge">
<title>processReelect&#45;&gt;maybeResign</title>
<path fill="none" stroke="#000000" d="M1645.8153,-537.2225C1661.3779,-555.1793 1687.8031,-581.6628 1717.2109,-594 1846.003,-648.0307 2014.4898,-642.3424 2100.788,-634.5954"/>
<polygon fill="#000000" stroke="#000000" points="2101.2684,-638.0658 2110.8966,-633.6443 2100.6126,-631.0965 2101.2684,-638.0658"/>
</g>
<!-- triggerControllerMove&#45;&gt;deleteController -->
<g id="edge33" class="edge">
<title>triggerControllerMove&#45;&gt;deleteController</title>
<path fill="none" stroke="#000000" d="M2228.7456,-368.6604C2252.9281,-363.8974 2279.9521,-357.9154 2304.2842,-351 2339.8772,-340.8841 2378.5429,-326.9932 2410.5924,-314.649"/>
<polygon fill="#000000" stroke="#000000" points="2412.2606,-317.7559 2420.3156,-310.8735 2409.7268,-311.2305 2412.2606,-317.7559"/>
</g>
<!-- triggerControllerMove&#45;&gt;isActive -->
<g id="edge34" class="edge">
<title>triggerControllerMove&#45;&gt;isActive</title>
<path fill="none" stroke="#000000" d="M2228.9023,-378.425C2255.6387,-381.1601 2284.3066,-389.0468 2304.2842,-408 2354.3353,-455.4846 2290.4317,-511.3069 2340.2842,-559 2366.4182,-584.002 2408.2711,-589.3021 2439.5216,-589.2213"/>
<polygon fill="#000000" stroke="#000000" points="2439.7508,-592.7174 2449.6751,-589.0084 2439.6039,-585.7189 2439.7508,-592.7174"/>
</g>
<!-- triggerControllerMove&#45;&gt;getControllerId -->
<g id="edge35" class="edge">
<title>triggerControllerMove&#45;&gt;getControllerId</title>
<path fill="none" stroke="#000000" d="M2228.7407,-377.7409C2255.778,-380.3159 2284.7031,-388.2697 2304.2842,-408 2369.4466,-473.6589 2275.3963,-547.0697 2340.2842,-613 2360.6207,-633.6633 2391.6165,-641.1001 2419.3314,-643.0745"/>
<polygon fill="#000000" stroke="#000000" points="2419.2078,-646.5725 2429.368,-643.5691 2419.5524,-639.581 2419.2078,-646.5725"/>
</g>
<!-- triggerControllerMove&#45;&gt;onControllerResignation -->
<g id="edge36" class="edge">
<title>triggerControllerMove&#45;&gt;onControllerResignation</title>
<path fill="none" stroke="#000000" d="M2228.8335,-391.4026C2253.0226,-395.6377 2280.0282,-401.1686 2304.2842,-408 2328.9869,-414.9572 2355.0569,-424.0015 2379.3587,-433.2109"/>
<polygon fill="#000000" stroke="#000000" points="2378.3453,-436.5708 2388.9356,-436.8826 2380.8512,-430.0347 2378.3453,-436.5708"/>
</g>
<!-- Reelect&#45;&gt;processReelect -->
<g id="edge26" class="edge">
<title>Reelect&#45;&gt;processReelect</title>
<path fill="none" stroke="#000000" d="M1517.7741,-514.2424C1535.48,-514.9848 1554.0479,-515.7634 1570.9158,-516.4708"/>
<polygon fill="#000000" stroke="#000000" points="1571.038,-519.9789 1581.1759,-516.901 1571.3314,-512.985 1571.038,-519.9789"/>
</g>
<!-- processControllerChange&#45;&gt;maybeResign -->
<g id="edge25" class="edge">
<title>processControllerChange&#45;&gt;maybeResign</title>
<path fill="none" stroke="#000000" d="M1943.9222,-575.4187C1965.5894,-581.8132 1988.4722,-588.332 2009.918,-594 2039.8388,-601.9079 2073.4497,-609.7499 2100.9907,-615.9064"/>
<polygon fill="#000000" stroke="#000000" points="2100.3237,-619.3435 2110.8447,-618.0954 2101.8417,-612.5101 2100.3237,-619.3435"/>
</g>
<!-- onControllerResignation&#45;&gt;unregisterZNodeChangeHandler -->
<g id="edge37" class="edge">
<title>onControllerResignation&#45;&gt;unregisterZNodeChangeHandler</title>
<path fill="none" stroke="#000000" d="M2572.7367,-407.4399C2599.5416,-388.4073 2629.2155,-368.2471 2657.4092,-351 2677.7616,-338.5497 2700.7409,-326.1064 2721.3534,-315.4892"/>
<polygon fill="#000000" stroke="#000000" points="2723.0199,-318.5681 2730.3325,-310.9016 2719.835,-312.3346 2723.0199,-318.5681"/>
</g>
<!-- unregisterZNodeChildChangeHandler -->
<g id="node32" class="node">
<title>unregisterZNodeChildChangeHandler</title>
<polygon fill="none" stroke="#000000" points="2896.4962,-615 2666.8398,-615 2666.8398,-579 2896.4962,-579 2896.4962,-615"/>
<text text-anchor="middle" x="2781.668" y="-592.8" font-family="Times,serif" font-size="14.00" fill="#000000">unregisterZNodeChildChangeHandler</text>
</g>
<!-- onControllerResignation&#45;&gt;unregisterZNodeChildChangeHandler -->
<g id="edge38" class="edge">
<title>onControllerResignation&#45;&gt;unregisterZNodeChildChangeHandler</title>
<path fill="none" stroke="#000000" d="M2572.5524,-530.9614C2599.2291,-545.2427 2628.8822,-559.5353 2657.4092,-570 2663.3257,-572.1704 2669.4678,-574.1925 2675.7117,-576.0723"/>
<polygon fill="#000000" stroke="#000000" points="2675.0117,-579.5127 2685.5894,-578.9102 2676.9446,-572.7849 2675.0117,-579.5127"/>
</g>
<!-- unregisterPartitionModificationsHandlers -->
<g id="node33" class="node">
<title>unregisterPartitionModificationsHandlers</title>
<polygon fill="none" stroke="#000000" points="2905.686,-669 2657.6499,-669 2657.6499,-633 2905.686,-633 2905.686,-669"/>
<text text-anchor="middle" x="2781.668" y="-646.8" font-family="Times,serif" font-size="14.00" fill="#000000">unregisterPartitionModificationsHandlers</text>
</g>
<!-- onControllerResignation&#45;&gt;unregisterPartitionModificationsHandlers -->
<g id="edge39" class="edge">
<title>onControllerResignation&#45;&gt;unregisterPartitionModificationsHandlers</title>
<path fill="none" stroke="#000000" d="M2572.6231,-520.5602C2590.0786,-531.5896 2607.2801,-544.4754 2621.4092,-559 2644.436,-582.6714 2630.9108,-604.292 2657.4092,-624 2659.2442,-625.3648 2661.1342,-626.6634 2663.0718,-627.8988"/>
<polygon fill="#000000" stroke="#000000" points="2661.4305,-630.9921 2671.8482,-632.921 2664.9072,-624.9165 2661.4305,-630.9921"/>
</g>
<!-- KafkaScheduler_shutDown -->
<g id="node34" class="node">
<title>KafkaScheduler_shutDown</title>
<polygon fill="none" stroke="#000000" points="2866.9065,-723 2696.4295,-723 2696.4295,-687 2866.9065,-687 2866.9065,-723"/>
<text text-anchor="middle" x="2781.668" y="-700.8" font-family="Times,serif" font-size="14.00" fill="#000000">KafkaScheduler_shutDown</text>
</g>
<!-- onControllerResignation&#45;&gt;KafkaScheduler_shutDown -->
<g id="edge40" class="edge">
<title>onControllerResignation&#45;&gt;KafkaScheduler_shutDown</title>
<path fill="none" stroke="#000000" d="M2572.6007,-516.7303C2590.7845,-528.2354 2608.2838,-542.2818 2621.4092,-559 2655.5309,-602.462 2616.8097,-640.5178 2657.4092,-678 2665.8147,-685.7601 2675.9088,-691.4849 2686.6634,-695.6804"/>
<polygon fill="#000000" stroke="#000000" points="2685.6639,-699.0379 2696.2586,-698.9863 2687.9442,-692.4197 2685.6639,-699.0379"/>
</g>
<!-- tokenCleanScheduler_shutDown -->
<g id="node35" class="node">
<title>tokenCleanScheduler_shutDown</title>
<polygon fill="none" stroke="#000000" points="2881.9651,-399 2681.3709,-399 2681.3709,-363 2881.9651,-363 2881.9651,-399"/>
<text text-anchor="middle" x="2781.668" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#000000">tokenCleanScheduler_shutDown</text>
</g>
<!-- onControllerResignation&#45;&gt;tokenCleanScheduler_shutDown -->
<g id="edge41" class="edge">
<title>onControllerResignation&#45;&gt;tokenCleanScheduler_shutDown</title>
<path fill="none" stroke="#000000" d="M2572.4709,-437.6427C2599.5281,-427.1546 2629.4018,-416.382 2657.4092,-408 2665.0774,-405.7051 2673.0662,-403.5186 2681.1307,-401.4559"/>
<polygon fill="#000000" stroke="#000000" points="2682.1303,-404.814 2690.9889,-399.0023 2680.4396,-398.0212 2682.1303,-404.814"/>
</g>
<!-- partitionStateMachine_shutDown -->
<g id="node36" class="node">
<title>partitionStateMachine_shutDown</title>
<polygon fill="none" stroke="#000000" points="2884.1338,-453 2679.2021,-453 2679.2021,-417 2884.1338,-417 2884.1338,-453"/>
<text text-anchor="middle" x="2781.668" y="-430.8" font-family="Times,serif" font-size="14.00" fill="#000000">partitionStateMachine_shutDown</text>
</g>
<!-- onControllerResignation&#45;&gt;partitionStateMachine_shutDown -->
<g id="edge42" class="edge">
<title>onControllerResignation&#45;&gt;partitionStateMachine_shutDown</title>
<path fill="none" stroke="#000000" d="M2572.7376,-463.4759C2603.0624,-459.3428 2637.147,-454.6973 2668.8507,-450.3763"/>
<polygon fill="#000000" stroke="#000000" points="2669.617,-453.8043 2679.0527,-448.9858 2668.6716,-446.8684 2669.617,-453.8043"/>
</g>
<!-- channelManager_shutdown -->
<g id="node37" class="node">
<title>channelManager_shutdown</title>
<polygon fill="none" stroke="#000000" points="2866.8996,-507 2696.4363,-507 2696.4363,-471 2866.8996,-471 2866.8996,-507"/>
<text text-anchor="middle" x="2781.668" y="-484.8" font-family="Times,serif" font-size="14.00" fill="#000000">channelManager_shutdown</text>
</g>
<!-- onControllerResignation&#45;&gt;channelManager_shutdown -->
<g id="edge43" class="edge">
<title>onControllerResignation&#45;&gt;channelManager_shutdown</title>
<path fill="none" stroke="#000000" d="M2572.7376,-479.9711C2608.6681,-481.5238 2649.8771,-483.3047 2686.1497,-484.8722"/>
<polygon fill="#000000" stroke="#000000" points="2686.0992,-488.3732 2696.2411,-485.3083 2686.4015,-481.3797 2686.0992,-488.3732"/>
</g>
<!-- controllerContext_reset -->
<g id="node38" class="node">
<title>controllerContext_reset</title>
<polygon fill="none" stroke="#000000" points="2855.8478,-561 2707.4882,-561 2707.4882,-525 2855.8478,-525 2855.8478,-561"/>
<text text-anchor="middle" x="2781.668" y="-538.8" font-family="Times,serif" font-size="14.00" fill="#000000">controllerContext_reset</text>
</g>
<!-- onControllerResignation&#45;&gt;controllerContext_reset -->
<g id="edge44" class="edge">
<title>onControllerResignation&#45;&gt;controllerContext_reset</title>
<path fill="none" stroke="#000000" d="M2572.4515,-496.9144C2599.7733,-503.1086 2629.794,-509.8718 2657.4092,-516 2670.2898,-518.8584 2683.9287,-521.8537 2697.2698,-524.7663"/>
<polygon fill="#000000" stroke="#000000" points="2696.8803,-528.2635 2707.3963,-526.9737 2698.3712,-521.4241 2696.8803,-528.2635"/>
</g>
<!-- startup -->
<g id="node39" class="node">
<title>startup</title>
<polygon fill="none" stroke="#000000" points="16,-353.8002 16,-462.1998 206.166,-462.1998 206.166,-353.8002 16,-353.8002"/>
<text text-anchor="middle" x="111.083" y="-446.9998" font-family="Times,serif" font-size="14.00" fill="#000000">startup</text>
<polyline fill="none" stroke="#000000" points="16,-440.1998 206.166,-440.1998 "/>
<text text-anchor="start" x="24" y="-424.9998" font-family="Times,serif" font-size="14.00" fill="#000000">每个broker启动时候</text>
<text text-anchor="start" x="24" y="-405.3999" font-family="Times,serif" font-size="14.00" fill="#000000"> 会调用controller startup</text>
<text text-anchor="start" x="24" y="-385.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 注册controllerChange handler</text>
<text text-anchor="start" x="24" y="-366.2001" font-family="Times,serif" font-size="14.00" fill="#000000"> 触发选举</text>
</g>
<!-- startup&#45;&gt;controller_startup -->
<g id="edge47" class="edge">
<title>startup&#45;&gt;controller_startup</title>
<path fill="none" stroke="#000000" d="M206.2644,-408C215.2585,-408 223.962,-408 231.8825,-408"/>
<polygon fill="#000000" stroke="#000000" points="232.1514,-411.5001 242.1514,-408 232.1514,-404.5001 232.1514,-411.5001"/>
</g>
</g>
</svg>
