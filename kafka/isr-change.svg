<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: isrchange Pages: 1 -->
<svg width="1232pt" height="534pt"
 viewBox="0.00 0.00 1232.09 534.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 530.0999)">
<title>isrchange</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-530.0999 1228.0879,-530.0999 1228.0879,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_controllerContext</title>
<path fill="none" stroke="#000000" d="M525.4058,-80.0999C525.4058,-80.0999 910.9194,-80.0999 910.9194,-80.0999 916.9194,-80.0999 922.9194,-86.0999 922.9194,-92.0999 922.9194,-92.0999 922.9194,-250.0999 922.9194,-250.0999 922.9194,-256.0999 916.9194,-262.0999 910.9194,-262.0999 910.9194,-262.0999 525.4058,-262.0999 525.4058,-262.0999 519.4058,-262.0999 513.4058,-256.0999 513.4058,-250.0999 513.4058,-250.0999 513.4058,-92.0999 513.4058,-92.0999 513.4058,-86.0999 519.4058,-80.0999 525.4058,-80.0999"/>
<text text-anchor="middle" x="718.1626" y="-242.0999" font-family="Times,serif" font-size="20.00" fill="#000000">controllerContext</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_zkClient</title>
<path fill="none" stroke="#000000" d="M222.4072,-316.0999C222.4072,-316.0999 1204.0879,-316.0999 1204.0879,-316.0999 1210.0879,-316.0999 1216.0879,-322.0999 1216.0879,-328.0999 1216.0879,-328.0999 1216.0879,-506.0999 1216.0879,-506.0999 1216.0879,-512.0999 1210.0879,-518.0999 1204.0879,-518.0999 1204.0879,-518.0999 222.4072,-518.0999 222.4072,-518.0999 216.4072,-518.0999 210.4072,-512.0999 210.4072,-506.0999 210.4072,-506.0999 210.4072,-328.0999 210.4072,-328.0999 210.4072,-322.0999 216.4072,-316.0999 222.4072,-316.0999"/>
<text text-anchor="middle" x="713.2476" y="-498.0999" font-family="Times,serif" font-size="20.00" fill="#000000">zkClient</text>
</g>
<!-- liveBrokerEpochs -->
<g id="node1" class="node">
<title>liveBrokerEpochs</title>
<polygon fill="#95e1d3" stroke="#000000" points="797.8364,-105.0999 797.8364,-141.0999 914.9194,-141.0999 914.9194,-105.0999 797.8364,-105.0999"/>
<text text-anchor="middle" x="856.3779" y="-118.8999" font-family="Times,serif" font-size="14.00" fill="#000000">liveBrokerEpochs</text>
</g>
<!-- partitionLeadershipInfo -->
<g id="node2" class="node">
<title>partitionLeadershipInfo</title>
<polygon fill="#95e1d3" stroke="#000000" points="543.3799,-176.3 543.3799,-225.8999 692.332,-225.8999 692.332,-176.3 543.3799,-176.3"/>
<text text-anchor="middle" x="617.856" y="-210.6999" font-family="Times,serif" font-size="14.00" fill="#000000">partitionLeadershipInfo</text>
<polyline fill="none" stroke="#000000" points="543.3799,-203.8999 692.332,-203.8999 "/>
<text text-anchor="start" x="551.3799" y="-188.6999" font-family="Times,serif" font-size="14.00" fill="#000000">更新此处cache</text>
</g>
<!-- liveOrShuttingDownBrokerIds -->
<g id="node3" class="node">
<title>liveOrShuttingDownBrokerIds</title>
<polygon fill="none" stroke="#000000" points="521.4058,-88.5 521.4058,-157.6998 714.3062,-157.6998 714.3062,-88.5 521.4058,-88.5"/>
<text text-anchor="middle" x="617.856" y="-142.4998" font-family="Times,serif" font-size="14.00" fill="#000000">liveOrShuttingDownBrokerIds</text>
<polyline fill="none" stroke="#000000" points="521.4058,-135.6998 714.3062,-135.6998 "/>
<text text-anchor="start" x="529.4058" y="-120.4998" font-family="Times,serif" font-size="14.00" fill="#000000">获取要发送udpateMetadata 的</text>
<text text-anchor="start" x="529.4058" y="-100.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> broker列表</text>
</g>
<!-- liveOrShuttingDownBrokerIds&#45;&gt;liveBrokerEpochs -->
<g id="edge1" class="edge">
<title>liveOrShuttingDownBrokerIds&#45;&gt;liveBrokerEpochs</title>
<path fill="none" stroke="#000000" d="M714.5281,-123.0999C738.9409,-123.0999 764.6644,-123.0999 787.4025,-123.0999"/>
<polygon fill="#000000" stroke="#000000" points="787.6243,-126.6 797.6243,-123.0999 787.6242,-119.6 787.6243,-126.6"/>
</g>
<!-- getAllIsrChangeNotifications -->
<g id="node4" class="node">
<title>getAllIsrChangeNotifications</title>
<polygon fill="none" stroke="#000000" points="432.2593,-482.0999 251.5346,-482.0999 251.5346,-446.0999 432.2593,-446.0999 432.2593,-482.0999"/>
<text text-anchor="middle" x="341.897" y="-459.8999" font-family="Times,serif" font-size="14.00" fill="#000000">getAllIsrChangeNotifications</text>
</g>
<!-- IsrChangeNotificationZNode -->
<g id="node11" class="node">
<title>IsrChangeNotificationZNode</title>
<polygon fill="none" stroke="#000000" points="707.6531,-482.0999 528.0588,-482.0999 528.0588,-446.0999 707.6531,-446.0999 707.6531,-482.0999"/>
<text text-anchor="middle" x="617.856" y="-459.8999" font-family="Times,serif" font-size="14.00" fill="#000000">IsrChangeNotificationZNode</text>
</g>
<!-- getAllIsrChangeNotifications&#45;&gt;IsrChangeNotificationZNode -->
<g id="edge7" class="edge">
<title>getAllIsrChangeNotifications&#45;&gt;IsrChangeNotificationZNode</title>
<path fill="none" stroke="#000000" d="M432.6385,-464.0999C459.9211,-464.0999 490.0058,-464.0999 517.8527,-464.0999"/>
<polygon fill="#000000" stroke="#000000" points="518.0015,-467.6 528.0015,-464.0999 518.0015,-460.6 518.0015,-467.6"/>
</g>
<!-- getPartitionsFromIsrChangeNotifications -->
<g id="node5" class="node">
<title>getPartitionsFromIsrChangeNotifications</title>
<polygon fill="none" stroke="#000000" points="465.3765,-360.0999 218.4175,-360.0999 218.4175,-324.0999 465.3765,-324.0999 465.3765,-360.0999"/>
<text text-anchor="middle" x="341.897" y="-337.8999" font-family="Times,serif" font-size="14.00" fill="#000000">getPartitionsFromIsrChangeNotifications</text>
</g>
<!-- IsrChangeNotificationSequenceZNode -->
<g id="node10" class="node">
<title>IsrChangeNotificationSequenceZNode</title>
<polygon fill="none" stroke="#000000" points="734.2944,-428.0999 501.4175,-428.0999 501.4175,-392.0999 734.2944,-392.0999 734.2944,-428.0999"/>
<text text-anchor="middle" x="617.856" y="-405.8999" font-family="Times,serif" font-size="14.00" fill="#000000">IsrChangeNotificationSequenceZNode</text>
</g>
<!-- getPartitionsFromIsrChangeNotifications&#45;&gt;IsrChangeNotificationSequenceZNode -->
<g id="edge6" class="edge">
<title>getPartitionsFromIsrChangeNotifications&#45;&gt;IsrChangeNotificationSequenceZNode</title>
<path fill="none" stroke="#000000" d="M432.3556,-360.1731C443.5472,-362.909 454.7767,-365.8982 465.3867,-369.0999 481.822,-374.0595 484.9829,-378.0374 501.3867,-383.0999 508.6384,-385.3379 516.1944,-387.4874 523.8199,-389.5279"/>
<polygon fill="#000000" stroke="#000000" points="522.9387,-392.9151 533.4984,-392.0529 524.7058,-386.1418 522.9387,-392.9151"/>
</g>
<!-- getTopicPartitionStates -->
<g id="node6" class="node">
<title>getTopicPartitionStates</title>
<polygon fill="none" stroke="#000000" points="537.5317,-324.3 537.5317,-373.8999 698.1802,-373.8999 698.1802,-324.3 537.5317,-324.3"/>
<text text-anchor="middle" x="617.856" y="-358.6999" font-family="Times,serif" font-size="14.00" fill="#000000">getTopicPartitionStates</text>
<polyline fill="none" stroke="#000000" points="537.5317,-351.8999 698.1802,-351.8999 "/>
<text text-anchor="start" x="545.5317" y="-336.6999" font-family="Times,serif" font-size="14.00" fill="#000000">从zk中获取partition状态</text>
</g>
<!-- getTopicPartitionStatesRaw -->
<g id="node7" class="node">
<title>getTopicPartitionStatesRaw</title>
<polygon fill="none" stroke="#000000" points="942.4834,-367.0999 770.2724,-367.0999 770.2724,-331.0999 942.4834,-331.0999 942.4834,-367.0999"/>
<text text-anchor="middle" x="856.3779" y="-344.8999" font-family="Times,serif" font-size="14.00" fill="#000000">getTopicPartitionStatesRaw</text>
</g>
<!-- getTopicPartitionStates&#45;&gt;getTopicPartitionStatesRaw -->
<g id="edge2" class="edge">
<title>getTopicPartitionStates&#45;&gt;getTopicPartitionStatesRaw</title>
<path fill="none" stroke="#000000" d="M698.2761,-349.0999C718.0604,-349.0999 739.4457,-349.0999 759.9019,-349.0999"/>
<polygon fill="#000000" stroke="#000000" points="760.1785,-352.6 770.1784,-349.0999 760.1784,-345.6 760.1785,-352.6"/>
</g>
<!-- GetDataRequest -->
<g id="node8" class="node">
<title>GetDataRequest</title>
<polygon fill="none" stroke="#000000" points="978.4307,-324.3 978.4307,-373.8999 1208.0879,-373.8999 1208.0879,-324.3 978.4307,-324.3"/>
<text text-anchor="middle" x="1093.2593" y="-358.6999" font-family="Times,serif" font-size="14.00" fill="#000000">GetDataRequest</text>
<polyline fill="none" stroke="#000000" points="978.4307,-351.8999 1208.0879,-351.8999 "/>
<text text-anchor="middle" x="1093.2593" y="-336.6999" font-family="Times,serif" font-size="14.00" fill="#000000">获取TopicPartitionStateZnode下数据</text>
</g>
<!-- getTopicPartitionStatesRaw&#45;&gt;GetDataRequest -->
<g id="edge3" class="edge">
<title>getTopicPartitionStatesRaw&#45;&gt;GetDataRequest</title>
<path fill="none" stroke="#000000" d="M942.5676,-349.0999C950.9347,-349.0999 959.5342,-349.0999 968.181,-349.0999"/>
<polygon fill="#000000" stroke="#000000" points="968.3423,-352.6 978.3423,-349.0999 968.3423,-345.6 968.3423,-352.6"/>
</g>
<!-- deleteIsrChangeNotifications -->
<g id="node9" class="node">
<title>deleteIsrChangeNotifications</title>
<polygon fill="none" stroke="#000000" points="252.252,-378.3 252.252,-427.8999 431.542,-427.8999 431.542,-378.3 252.252,-378.3"/>
<text text-anchor="middle" x="341.897" y="-412.6999" font-family="Times,serif" font-size="14.00" fill="#000000">deleteIsrChangeNotifications</text>
<polyline fill="none" stroke="#000000" points="252.252,-405.8999 431.542,-405.8999 "/>
<text text-anchor="middle" x="341.897" y="-390.6999" font-family="Times,serif" font-size="14.00" fill="#000000">清理掉所有的通知</text>
</g>
<!-- deleteIsrChangeNotifications&#45;&gt;IsrChangeNotificationSequenceZNode -->
<g id="edge4" class="edge">
<title>deleteIsrChangeNotifications&#45;&gt;IsrChangeNotificationSequenceZNode</title>
<path fill="none" stroke="#000000" d="M431.8744,-405.3823C450.8464,-405.8635 471.2015,-406.3799 491.2351,-406.888"/>
<polygon fill="#000000" stroke="#000000" points="491.2678,-410.3899 501.3534,-407.1447 491.4454,-403.3921 491.2678,-410.3899"/>
</g>
<!-- deleteIsrChangeNotifications&#45;&gt;IsrChangeNotificationZNode -->
<g id="edge5" class="edge">
<title>deleteIsrChangeNotifications&#45;&gt;IsrChangeNotificationZNode</title>
<path fill="none" stroke="#000000" d="M431.8744,-422.9892C462.115,-429.6738 495.8699,-437.1352 526.2353,-443.8474"/>
<polygon fill="#000000" stroke="#000000" points="525.8734,-447.3518 536.3932,-446.0928 527.3843,-440.5168 525.8734,-447.3518"/>
</g>
<!-- processIsrChangeNotification -->
<g id="node12" class="node">
<title>processIsrChangeNotification</title>
<polygon fill="none" stroke="#000000" points="182.6113,-360.0999 -.2041,-360.0999 -.2041,-324.0999 182.6113,-324.0999 182.6113,-360.0999"/>
<text text-anchor="middle" x="91.2036" y="-337.8999" font-family="Times,serif" font-size="14.00" fill="#000000">processIsrChangeNotification</text>
</g>
<!-- processIsrChangeNotification&#45;&gt;getAllIsrChangeNotifications -->
<g id="edge8" class="edge">
<title>processIsrChangeNotification&#45;&gt;getAllIsrChangeNotifications</title>
<path fill="none" stroke="#000000" d="M108.346,-360.2211C130.0033,-381.9755 169.421,-417.9193 210.4072,-437.0999 220.1842,-441.6753 230.728,-445.479 241.4409,-448.6403"/>
<polygon fill="#000000" stroke="#000000" points="240.7388,-452.0774 251.3098,-451.3667 242.6029,-445.3301 240.7388,-452.0774"/>
</g>
<!-- processIsrChangeNotification&#45;&gt;getPartitionsFromIsrChangeNotifications -->
<g id="edge9" class="edge">
<title>processIsrChangeNotification&#45;&gt;getPartitionsFromIsrChangeNotifications</title>
<path fill="none" stroke="#000000" d="M182.4188,-342.0999C190.7706,-342.0999 199.3413,-342.0999 207.9664,-342.0999"/>
<polygon fill="#000000" stroke="#000000" points="208.1067,-345.6 218.1067,-342.0999 208.1066,-338.6 208.1067,-345.6"/>
</g>
<!-- processIsrChangeNotification&#45;&gt;deleteIsrChangeNotifications -->
<g id="edge10" class="edge">
<title>processIsrChangeNotification&#45;&gt;deleteIsrChangeNotifications</title>
<path fill="none" stroke="#000000" d="M165.4024,-360.1543C189.4712,-366.0109 216.5771,-372.6064 242.1907,-378.8389"/>
<polygon fill="#000000" stroke="#000000" points="241.3808,-382.2439 251.9249,-381.2074 243.0359,-375.4423 241.3808,-382.2439"/>
</g>
<!-- updateLeaderAndIsrCache -->
<g id="node13" class="node">
<title>updateLeaderAndIsrCache</title>
<polygon fill="none" stroke="#000000" points="224.8433,-236.5 224.8433,-305.6998 458.9507,-305.6998 458.9507,-236.5 224.8433,-236.5"/>
<text text-anchor="middle" x="341.897" y="-290.4998" font-family="Times,serif" font-size="14.00" fill="#000000">updateLeaderAndIsrCache</text>
<polyline fill="none" stroke="#000000" points="224.8433,-283.6998 458.9507,-283.6998 "/>
<text text-anchor="start" x="232.8433" y="-268.4998" font-family="Times,serif" font-size="14.00" fill="#000000">从zk中获取最新的partionState</text>
<text text-anchor="start" x="232.8433" y="-248.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 然后更新controllerContext中的cache</text>
</g>
<!-- processIsrChangeNotification&#45;&gt;updateLeaderAndIsrCache -->
<g id="edge11" class="edge">
<title>processIsrChangeNotification&#45;&gt;updateLeaderAndIsrCache</title>
<path fill="none" stroke="#000000" d="M154.7882,-324.0918C173.1966,-318.8783 193.9743,-312.9938 214.816,-307.0911"/>
<polygon fill="#000000" stroke="#000000" points="216.046,-310.3805 224.7138,-304.2879 214.1385,-303.6454 216.046,-310.3805"/>
</g>
<!-- processUpdateNotifications -->
<g id="node14" class="node">
<title>processUpdateNotifications</title>
<polygon fill="none" stroke="#000000" points="256.5244,-88.5 256.5244,-157.6998 427.2695,-157.6998 427.2695,-88.5 256.5244,-88.5"/>
<text text-anchor="middle" x="341.897" y="-142.4998" font-family="Times,serif" font-size="14.00" fill="#000000">processUpdateNotifications</text>
<polyline fill="none" stroke="#000000" points="256.5244,-135.6998 427.2695,-135.6998 "/>
<text text-anchor="start" x="264.5244" y="-120.4998" font-family="Times,serif" font-size="14.00" fill="#000000">获取要发送的broker列表</text>
<text text-anchor="start" x="264.5244" y="-100.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 发送updateMetaData请求</text>
</g>
<!-- processIsrChangeNotification&#45;&gt;processUpdateNotifications -->
<g id="edge12" class="edge">
<title>processIsrChangeNotification&#45;&gt;processUpdateNotifications</title>
<path fill="none" stroke="#000000" d="M108.8579,-323.9976C131.6817,-300.848 172.9517,-259.8399 210.4072,-227.0999 235.1159,-205.502 263.5669,-182.7544 287.6703,-164.0596"/>
<polygon fill="#000000" stroke="#000000" points="289.8923,-166.7658 295.6662,-157.8825 285.6128,-161.2263 289.8923,-166.7658"/>
</g>
<!-- updateLeaderAndIsrCache&#45;&gt;partitionLeadershipInfo -->
<g id="edge13" class="edge">
<title>updateLeaderAndIsrCache&#45;&gt;partitionLeadershipInfo</title>
<path fill="none" stroke="#000000" d="M459.3286,-241.3121C484.2305,-234.9955 510.0457,-228.4472 533.4314,-222.5151"/>
<polygon fill="#000000" stroke="#000000" points="534.463,-225.8644 543.2954,-220.013 532.7418,-219.0793 534.463,-225.8644"/>
</g>
<!-- updateLeaderAndIsrCache&#45;&gt;getTopicPartitionStates -->
<g id="edge14" class="edge">
<title>updateLeaderAndIsrCache&#45;&gt;getTopicPartitionStates</title>
<path fill="none" stroke="#000000" d="M459.3286,-304.292C482.0999,-310.7284 505.635,-317.3806 527.3777,-323.5262"/>
<polygon fill="#000000" stroke="#000000" points="526.6572,-326.9596 537.2322,-326.3116 528.5613,-320.2235 526.6572,-326.9596"/>
</g>
<!-- leaderIsrAndControllerEpochs -->
<g id="node16" class="node">
<title>leaderIsrAndControllerEpochs</title>
<polygon fill="none" stroke="#000000" points="711.691,-306.0999 524.0209,-306.0999 524.0209,-270.0999 711.691,-270.0999 711.691,-306.0999"/>
<text text-anchor="middle" x="617.856" y="-283.8999" font-family="Times,serif" font-size="14.00" fill="#000000">leaderIsrAndControllerEpochs</text>
</g>
<!-- updateLeaderAndIsrCache&#45;&gt;leaderIsrAndControllerEpochs -->
<g id="edge15" class="edge">
<title>updateLeaderAndIsrCache&#45;&gt;leaderIsrAndControllerEpochs</title>
<path fill="none" stroke="#000000" d="M459.3286,-278.3341C477.3552,-279.4446 495.8604,-280.5846 513.5761,-281.6759"/>
<polygon fill="#000000" stroke="#000000" points="513.7097,-285.1907 523.9061,-282.3123 514.1402,-278.2039 513.7097,-285.1907"/>
</g>
<!-- processUpdateNotifications&#45;&gt;liveOrShuttingDownBrokerIds -->
<g id="edge16" class="edge">
<title>processUpdateNotifications&#45;&gt;liveOrShuttingDownBrokerIds</title>
<path fill="none" stroke="#000000" d="M427.3223,-123.0999C453.8265,-123.0999 483.3725,-123.0999 511.1362,-123.0999"/>
<polygon fill="#000000" stroke="#000000" points="511.2753,-126.6 521.2753,-123.0999 511.2753,-119.6 511.2753,-126.6"/>
</g>
<!-- sendUpdateMetadataRequest -->
<g id="node15" class="node">
<title>sendUpdateMetadataRequest</title>
<polygon fill="none" stroke="#000000" points="528.2178,-.5 528.2178,-69.6998 707.4941,-69.6998 707.4941,-.5 528.2178,-.5"/>
<text text-anchor="middle" x="617.856" y="-54.4998" font-family="Times,serif" font-size="14.00" fill="#000000">sendUpdateMetadataRequest</text>
<polyline fill="none" stroke="#000000" points="528.2178,-47.6998 707.4941,-47.6998 "/>
<text text-anchor="start" x="536.2178" y="-32.4998" font-family="Times,serif" font-size="14.00" fill="#000000">向所有的broker发送</text>
<text text-anchor="start" x="536.2178" y="-12.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 更新metadata请求 </text>
</g>
<!-- processUpdateNotifications&#45;&gt;sendUpdateMetadataRequest -->
<g id="edge17" class="edge">
<title>processUpdateNotifications&#45;&gt;sendUpdateMetadataRequest</title>
<path fill="none" stroke="#000000" d="M427.3223,-95.8588C456.175,-86.658 488.6323,-76.3078 518.4709,-66.7926"/>
<polygon fill="#000000" stroke="#000000" points="519.5949,-70.1079 528.0589,-63.7351 517.4682,-63.4388 519.5949,-70.1079"/>
</g>
</g>
</svg>
