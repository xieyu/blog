<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: logStruct Pages: 1 -->
<svg width="1211pt" height="545pt"
 viewBox="0.00 0.00 1211.00 544.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 540.5)">
<title>logStruct</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-540.5 1207,-540.5 1207,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ReplicaLeader</title>
<polygon fill="none" stroke="#000000" points="247,-348 247,-524 710,-524 710,-348 247,-348"/>
<text text-anchor="middle" x="478.5" y="-504" font-family="Times,serif" font-size="20.00" fill="#000000">broker1/Replica&#45;Leader</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Replica2</title>
<polygon fill="none" stroke="#000000" points="325,-178 325,-340 657.5,-340 657.5,-178 325,-178"/>
<text text-anchor="middle" x="491.25" y="-320" font-family="Times,serif" font-size="20.00" fill="#000000">broker2/Replica&#45;follower</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_Replica3</title>
<polygon fill="none" stroke="#000000" points="325,-8 325,-170 657.5,-170 657.5,-8 325,-8"/>
<text text-anchor="middle" x="491.25" y="-150" font-family="Times,serif" font-size="20.00" fill="#000000">broker3/Replica&#45;follower</text>
</g>
<!-- Topic -->
<g id="node1" class="node">
<title>Topic</title>
<polygon fill="none" stroke="#000000" points="0,-163.5 0,-278.5 219,-278.5 219,-163.5 0,-163.5"/>
<text text-anchor="middle" x="109.5" y="-263.3" font-family="Times,serif" font-size="14.00" fill="#000000">Topic:每个topic有多个partition</text>
<polyline fill="none" stroke="#000000" points="0,-255.5 219,-255.5 "/>
<text text-anchor="middle" x="109.5" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#000000">Partition1: 每个parition有多个副本</text>
<polyline fill="none" stroke="#000000" points="0,-232.5 219,-232.5 "/>
<text text-anchor="start" x="8" y="-217.3" font-family="Times,serif" font-size="14.00" fill="#000000">Partition2 </text>
<polyline fill="none" stroke="#000000" points="0,-209.5 219,-209.5 "/>
<text text-anchor="start" x="8" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#000000">Partition3</text>
<polyline fill="none" stroke="#000000" points="0,-186.5 219,-186.5 "/>
<text text-anchor="start" x="8" y="-171.3" font-family="Times,serif" font-size="14.00" fill="#000000">...</text>
</g>
<!-- Partition -->
<g id="node2" class="node">
<title>Partition</title>
<polygon fill="none" stroke="#000000" points="255,-356 255,-486 484,-486 484,-356 255,-356"/>
<text text-anchor="start" x="263" y="-470.8" font-family="Times,serif" font-size="14.00" fill="#000000">Partition:</text>
<text text-anchor="middle" x="369.5" y="-455.8" font-family="Times,serif" font-size="14.00" fill="#000000">每个partion有多个segment日志文件</text>
<polyline fill="none" stroke="#000000" points="255,-448 484,-448 "/>
<text text-anchor="start" x="263" y="-432.8" font-family="Times,serif" font-size="14.00" fill="#000000">segment1 </text>
<polyline fill="none" stroke="#000000" points="255,-425 484,-425 "/>
<text text-anchor="start" x="263" y="-409.8" font-family="Times,serif" font-size="14.00" fill="#000000">segment2 </text>
<polyline fill="none" stroke="#000000" points="255,-402 484,-402 "/>
<text text-anchor="start" x="263" y="-386.8" font-family="Times,serif" font-size="14.00" fill="#000000">segment3 </text>
<polyline fill="none" stroke="#000000" points="255,-379 484,-379 "/>
<text text-anchor="start" x="263" y="-363.8" font-family="Times,serif" font-size="14.00" fill="#000000">... </text>
</g>
<!-- Topic&#45;&gt;Partition -->
<g id="edge7" class="edge">
<title>Topic:p&#45;&gt;Partition</title>
<path fill="none" stroke="#000000" d="M219,-244C265.1538,-244 219.3883,-307.0167 247,-344 248.059,-345.4184 249.1525,-346.8171 250.2779,-348.1961"/>
<polygon fill="#000000" stroke="#000000" points="247.8129,-350.6927 257.0521,-355.8781 253.0632,-346.0629 247.8129,-350.6927"/>
</g>
<!-- Partition2 -->
<g id="node7" class="node">
<title>Partition2</title>
<polygon fill="none" stroke="#000000" points="333,-186.5 333,-301.5 406,-301.5 406,-186.5 333,-186.5"/>
<text text-anchor="middle" x="369.5" y="-286.3" font-family="Times,serif" font-size="14.00" fill="#000000">Partition</text>
<polyline fill="none" stroke="#000000" points="333,-278.5 406,-278.5 "/>
<text text-anchor="start" x="341" y="-263.3" font-family="Times,serif" font-size="14.00" fill="#000000">segment1 </text>
<polyline fill="none" stroke="#000000" points="333,-255.5 406,-255.5 "/>
<text text-anchor="start" x="341" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#000000">segment2 </text>
<polyline fill="none" stroke="#000000" points="333,-232.5 406,-232.5 "/>
<text text-anchor="start" x="341" y="-217.3" font-family="Times,serif" font-size="14.00" fill="#000000">segment3 </text>
<polyline fill="none" stroke="#000000" points="333,-209.5 406,-209.5 "/>
<text text-anchor="start" x="341" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#000000">... </text>
</g>
<!-- Topic&#45;&gt;Partition2 -->
<g id="edge8" class="edge">
<title>Topic:p&#45;&gt;Partition2</title>
<path fill="none" stroke="#000000" d="M219,-244C253.7085,-244 292.9196,-244 322.615,-244"/>
<polygon fill="#000000" stroke="#000000" points="322.6988,-247.5001 332.6988,-244 322.6988,-240.5001 322.6988,-247.5001"/>
</g>
<!-- Partition3 -->
<g id="node9" class="node">
<title>Partition3</title>
<polygon fill="none" stroke="#000000" points="333,-16.5 333,-131.5 406,-131.5 406,-16.5 333,-16.5"/>
<text text-anchor="middle" x="369.5" y="-116.3" font-family="Times,serif" font-size="14.00" fill="#000000">Partition</text>
<polyline fill="none" stroke="#000000" points="333,-108.5 406,-108.5 "/>
<text text-anchor="start" x="341" y="-93.3" font-family="Times,serif" font-size="14.00" fill="#000000">segment1 </text>
<polyline fill="none" stroke="#000000" points="333,-85.5 406,-85.5 "/>
<text text-anchor="start" x="341" y="-70.3" font-family="Times,serif" font-size="14.00" fill="#000000">segment2 </text>
<polyline fill="none" stroke="#000000" points="333,-62.5 406,-62.5 "/>
<text text-anchor="start" x="341" y="-47.3" font-family="Times,serif" font-size="14.00" fill="#000000">segment3 </text>
<polyline fill="none" stroke="#000000" points="333,-39.5 406,-39.5 "/>
<text text-anchor="start" x="341" y="-24.3" font-family="Times,serif" font-size="14.00" fill="#000000">... </text>
</g>
<!-- Topic&#45;&gt;Partition3 -->
<g id="edge9" class="edge">
<title>Topic:p&#45;&gt;Partition3</title>
<path fill="none" stroke="#000000" d="M219,-244C252.5077,-244 227.1687,-201.009 247,-174 267.9482,-145.4698 298.8663,-120.3132 324.3992,-102.3683"/>
<polygon fill="#000000" stroke="#000000" points="326.5774,-105.118 332.8296,-96.5646 322.608,-99.3522 326.5774,-105.118"/>
</g>
<!-- Segement -->
<g id="node3" class="node">
<title>Segement</title>
<polygon fill="none" stroke="#000000" points="520,-359.5 520,-466.5 702,-466.5 702,-359.5 520,-359.5"/>
<text text-anchor="middle" x="611" y="-451.3" font-family="Times,serif" font-size="14.00" fill="#000000">Segement</text>
<polyline fill="none" stroke="#000000" points="520,-443.5 702,-443.5 "/>
<text text-anchor="start" x="528" y="-428.3" font-family="Times,serif" font-size="14.00" fill="#000000">以Segment中第一个消息在</text>
<text text-anchor="start" x="528" y="-413.3" font-family="Times,serif" font-size="14.00" fill="#000000"> partition中的offset为文件名</text>
<polyline fill="none" stroke="#000000" points="520,-405.5 702,-405.5 "/>
<text text-anchor="start" x="528" y="-390.3" font-family="Times,serif" font-size="14.00" fill="#000000">xxxx.log</text>
<polyline fill="none" stroke="#000000" points="520,-382.5 702,-382.5 "/>
<text text-anchor="start" x="528" y="-367.3" font-family="Times,serif" font-size="14.00" fill="#000000">xxxx.index</text>
</g>
<!-- Partition&#45;&gt;Segement -->
<g id="edge10" class="edge">
<title>Partition:s&#45;&gt;Segement</title>
<path fill="none" stroke="#000000" d="M484,-413C492.3199,-413 500.9464,-413 509.6083,-413"/>
<polygon fill="#000000" stroke="#000000" points="509.7768,-416.5001 519.7767,-413 509.7767,-409.5001 509.7768,-416.5001"/>
</g>
<!-- Messages -->
<g id="node4" class="node">
<title>Messages</title>
<polygon fill="none" stroke="#000000" points="973,-294.5 973,-455.5 1043,-455.5 1043,-294.5 973,-294.5"/>
<text text-anchor="middle" x="1008" y="-440.3" font-family="Times,serif" font-size="14.00" fill="#000000">Messages</text>
<polyline fill="none" stroke="#000000" points="973,-432.5 1043,-432.5 "/>
<text text-anchor="start" x="981" y="-417.3" font-family="Times,serif" font-size="14.00" fill="#000000">msg1</text>
<polyline fill="none" stroke="#000000" points="973,-409.5 1043,-409.5 "/>
<text text-anchor="start" x="981" y="-394.3" font-family="Times,serif" font-size="14.00" fill="#000000">msg2</text>
<polyline fill="none" stroke="#000000" points="973,-386.5 1043,-386.5 "/>
<text text-anchor="start" x="981" y="-371.3" font-family="Times,serif" font-size="14.00" fill="#000000">msg3</text>
<polyline fill="none" stroke="#000000" points="973,-363.5 1043,-363.5 "/>
<text text-anchor="start" x="981" y="-348.3" font-family="Times,serif" font-size="14.00" fill="#000000">...</text>
<polyline fill="none" stroke="#000000" points="973,-340.5 1043,-340.5 "/>
<text text-anchor="start" x="981" y="-325.3" font-family="Times,serif" font-size="14.00" fill="#000000">msgN</text>
<polyline fill="none" stroke="#000000" points="973,-317.5 1043,-317.5 "/>
<text text-anchor="start" x="981" y="-302.3" font-family="Times,serif" font-size="14.00" fill="#000000">...</text>
</g>
<!-- Segement&#45;&gt;Messages -->
<g id="edge1" class="edge">
<title>Segement:msg&#45;&gt;Messages</title>
<path fill="none" stroke="#000000" d="M702,-394C720.3033,-394 720.2818,-409.4088 738,-414 823.6167,-436.1855 851.3303,-435.9801 937,-414 946.1036,-411.6643 955.2926,-407.8904 963.902,-403.5883"/>
<polygon fill="#000000" stroke="#000000" points="965.8008,-406.5427 972.9852,-398.7558 962.513,-400.3628 965.8008,-406.5427"/>
</g>
<!-- Index -->
<g id="node5" class="node">
<title>Index</title>
<polygon fill="none" stroke="#000000" points="738,-259.5 738,-404.5 937,-404.5 937,-259.5 738,-259.5"/>
<text text-anchor="middle" x="837.5" y="-389.3" font-family="Times,serif" font-size="14.00" fill="#000000">Index</text>
<polyline fill="none" stroke="#000000" points="738,-381.5 937,-381.5 "/>
<text text-anchor="start" x="746" y="-366.3" font-family="Times,serif" font-size="14.00" fill="#000000">用于快速定位消息</text>
<text text-anchor="start" x="746" y="-351.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 在Segment日志文件中的offset</text>
<text text-anchor="start" x="746" y="-336.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 为稀疏索引</text>
<polyline fill="none" stroke="#000000" points="738,-328.5 937,-328.5 "/>
<text text-anchor="start" x="746" y="-313.3" font-family="Times,serif" font-size="14.00" fill="#000000">1, 0</text>
<polyline fill="none" stroke="#000000" points="738,-305.5 937,-305.5 "/>
<text text-anchor="start" x="746" y="-290.3" font-family="Times,serif" font-size="14.00" fill="#000000">...</text>
<polyline fill="none" stroke="#000000" points="738,-282.5 937,-282.5 "/>
<text text-anchor="start" x="746" y="-267.3" font-family="Times,serif" font-size="14.00" fill="#000000">msgN, filePosition</text>
</g>
<!-- Segement&#45;&gt;Index -->
<g id="edge2" class="edge">
<title>Segement:index&#45;&gt;Index</title>
<path fill="none" stroke="#000000" d="M702,-371C710.4454,-371 719.0754,-370.2917 727.6868,-369.066"/>
<polygon fill="#000000" stroke="#000000" points="728.4788,-372.4827 737.7753,-367.4009 727.3388,-365.5762 728.4788,-372.4827"/>
</g>
<!-- Message -->
<g id="node6" class="node">
<title>Message</title>
<polygon fill="none" stroke="#000000" points="1079,-306 1079,-536 1203,-536 1203,-306 1079,-306"/>
<text text-anchor="middle" x="1141" y="-520.8" font-family="Times,serif" font-size="14.00" fill="#000000">Msg</text>
<polyline fill="none" stroke="#000000" points="1079,-513 1203,-513 "/>
<text text-anchor="start" x="1087" y="-497.8" font-family="Times,serif" font-size="14.00" fill="#000000">8byte offset</text>
<polyline fill="none" stroke="#000000" points="1079,-490 1203,-490 "/>
<text text-anchor="start" x="1087" y="-474.8" font-family="Times,serif" font-size="14.00" fill="#000000">4byte messageSize </text>
<polyline fill="none" stroke="#000000" points="1079,-467 1203,-467 "/>
<text text-anchor="start" x="1087" y="-451.8" font-family="Times,serif" font-size="14.00" fill="#000000">4byte crc32</text>
<polyline fill="none" stroke="#000000" points="1079,-444 1203,-444 "/>
<text text-anchor="start" x="1087" y="-428.8" font-family="Times,serif" font-size="14.00" fill="#000000">1byte magic</text>
<polyline fill="none" stroke="#000000" points="1079,-421 1203,-421 "/>
<text text-anchor="start" x="1087" y="-405.8" font-family="Times,serif" font-size="14.00" fill="#000000">1byte attributes</text>
<polyline fill="none" stroke="#000000" points="1079,-398 1203,-398 "/>
<text text-anchor="start" x="1087" y="-382.8" font-family="Times,serif" font-size="14.00" fill="#000000">4byte keylen</text>
<polyline fill="none" stroke="#000000" points="1079,-375 1203,-375 "/>
<text text-anchor="start" x="1087" y="-359.8" font-family="Times,serif" font-size="14.00" fill="#000000">key paload</text>
<polyline fill="none" stroke="#000000" points="1079,-352 1203,-352 "/>
<text text-anchor="start" x="1087" y="-336.8" font-family="Times,serif" font-size="14.00" fill="#000000">4byte payloadLen</text>
<polyline fill="none" stroke="#000000" points="1079,-329 1203,-329 "/>
<text text-anchor="start" x="1087" y="-313.8" font-family="Times,serif" font-size="14.00" fill="#000000">value payload</text>
</g>
<!-- Messages&#45;&gt;Message -->
<g id="edge3" class="edge">
<title>Messages:msg&#45;&gt;Message</title>
<path fill="none" stroke="#000000" d="M1043,-421C1051.3155,-421 1060.028,-421 1068.6827,-421"/>
<polygon fill="#000000" stroke="#000000" points="1068.7888,-424.5001 1078.7887,-421 1068.7887,-417.5001 1068.7888,-424.5001"/>
</g>
<!-- Index&#45;&gt;Messages -->
<g id="edge4" class="edge">
<title>Index:msgN&#45;&gt;Messages:msgN</title>
<path fill="none" stroke="#000000" d="M937,-271C963.0731,-271 948.5134,-313.8345 963.1585,-325.8817"/>
<polygon fill="#000000" stroke="#000000" points="962.4099,-329.3159 973,-329 964.5243,-322.6429 962.4099,-329.3159"/>
</g>
<!-- Segement2 -->
<g id="node8" class="node">
<title>Segement2</title>
<polygon fill="none" stroke="#000000" points="572.5,-209.5 572.5,-278.5 649.5,-278.5 649.5,-209.5 572.5,-209.5"/>
<text text-anchor="middle" x="611" y="-263.3" font-family="Times,serif" font-size="14.00" fill="#000000">Segement</text>
<polyline fill="none" stroke="#000000" points="572.5,-255.5 649.5,-255.5 "/>
<text text-anchor="start" x="580.5" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#000000">xxxx.log</text>
<polyline fill="none" stroke="#000000" points="572.5,-232.5 649.5,-232.5 "/>
<text text-anchor="start" x="580.5" y="-217.3" font-family="Times,serif" font-size="14.00" fill="#000000">xxxx.index</text>
</g>
<!-- Partition2&#45;&gt;Segement2 -->
<g id="edge5" class="edge">
<title>Partition2:s&#45;&gt;Segement2</title>
<path fill="none" stroke="#000000" d="M406.5,-244C459.6859,-244 520.6525,-244 562.0813,-244"/>
<polygon fill="#000000" stroke="#000000" points="562.1765,-247.5001 572.1764,-244 562.1764,-240.5001 562.1765,-247.5001"/>
</g>
<!-- Segement3 -->
<g id="node10" class="node">
<title>Segement3</title>
<polygon fill="none" stroke="#000000" points="572.5,-39.5 572.5,-108.5 649.5,-108.5 649.5,-39.5 572.5,-39.5"/>
<text text-anchor="middle" x="611" y="-93.3" font-family="Times,serif" font-size="14.00" fill="#000000">Segement</text>
<polyline fill="none" stroke="#000000" points="572.5,-85.5 649.5,-85.5 "/>
<text text-anchor="start" x="580.5" y="-70.3" font-family="Times,serif" font-size="14.00" fill="#000000">xxxx.log</text>
<polyline fill="none" stroke="#000000" points="572.5,-62.5 649.5,-62.5 "/>
<text text-anchor="start" x="580.5" y="-47.3" font-family="Times,serif" font-size="14.00" fill="#000000">xxxx.index</text>
</g>
<!-- Partition3&#45;&gt;Segement3 -->
<g id="edge6" class="edge">
<title>Partition3:s&#45;&gt;Segement3</title>
<path fill="none" stroke="#000000" d="M406.5,-74C459.6859,-74 520.6525,-74 562.0813,-74"/>
<polygon fill="#000000" stroke="#000000" points="562.1765,-77.5001 572.1764,-74 562.1764,-70.5001 562.1765,-77.5001"/>
</g>
</g>
</svg>
