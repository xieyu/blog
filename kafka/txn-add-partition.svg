<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: txnAddPartition Pages: 1 -->
<svg width="2093pt" height="635pt"
 viewBox="0.00 0.00 2092.60 635.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 631)">
<title>txnAddPartition</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-631 2088.5967,-631 2088.5967,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ReplicaManager</title>
<path fill="none" stroke="#000000" d="M845.3989,-8C845.3989,-8 968.7026,-8 968.7026,-8 974.7026,-8 980.7026,-14 980.7026,-20 980.7026,-20 980.7026,-76 980.7026,-76 980.7026,-82 974.7026,-88 968.7026,-88 968.7026,-88 845.3989,-88 845.3989,-88 839.3989,-88 833.3989,-82 833.3989,-76 833.3989,-76 833.3989,-20 833.3989,-20 833.3989,-14 839.3989,-8 845.3989,-8"/>
<text text-anchor="middle" x="907.0508" y="-68" font-family="Times,serif" font-size="20.00" fill="#000000">ReplicaManager</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_TransactionMetadata</title>
<path fill="none" stroke="#000000" d="M584.062,-397C584.062,-397 2064.5967,-397 2064.5967,-397 2070.5967,-397 2076.5967,-403 2076.5967,-409 2076.5967,-409 2076.5967,-607 2076.5967,-607 2076.5967,-613 2070.5967,-619 2064.5967,-619 2064.5967,-619 584.062,-619 584.062,-619 578.062,-619 572.062,-613 572.062,-607 572.062,-607 572.062,-409 572.062,-409 572.062,-403 578.062,-397 584.062,-397"/>
<text text-anchor="middle" x="1324.3293" y="-599" font-family="Times,serif" font-size="20.00" fill="#000000">TransactionMetadata</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_TransactionStateManager</title>
<path fill="none" stroke="#000000" d="M574.7275,-96C574.7275,-96 1767.8359,-96 1767.8359,-96 1773.8359,-96 1779.8359,-102 1779.8359,-108 1779.8359,-108 1779.8359,-377 1779.8359,-377 1779.8359,-383 1773.8359,-389 1767.8359,-389 1767.8359,-389 574.7275,-389 574.7275,-389 568.7275,-389 562.7275,-383 562.7275,-377 562.7275,-377 562.7275,-108 562.7275,-108 562.7275,-102 568.7275,-96 574.7275,-96"/>
<text text-anchor="middle" x="1171.2817" y="-369" font-family="Times,serif" font-size="20.00" fill="#000000">TransactionStateManager</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_TransactionCoordinator</title>
<path fill="none" stroke="#000000" d="M312.772,-294C312.772,-294 516.0405,-294 516.0405,-294 522.0405,-294 528.0405,-300 528.0405,-306 528.0405,-306 528.0405,-362 528.0405,-362 528.0405,-368 522.0405,-374 516.0405,-374 516.0405,-374 312.772,-374 312.772,-374 306.772,-374 300.772,-368 300.772,-362 300.772,-362 300.772,-306 300.772,-306 300.772,-300 306.772,-294 312.772,-294"/>
<text text-anchor="middle" x="414.4063" y="-354" font-family="Times,serif" font-size="20.00" fill="#000000">TransactionCoordinator</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_GroupCoordinator</title>
<path fill="none" stroke="#000000" d="M319.0303,-192C319.0303,-192 509.7822,-192 509.7822,-192 515.7822,-192 521.7822,-198 521.7822,-204 521.7822,-204 521.7822,-274 521.7822,-274 521.7822,-280 515.7822,-286 509.7822,-286 509.7822,-286 319.0303,-286 319.0303,-286 313.0303,-286 307.0303,-280 307.0303,-274 307.0303,-274 307.0303,-204 307.0303,-204 307.0303,-198 313.0303,-192 319.0303,-192"/>
<text text-anchor="middle" x="414.4063" y="-266" font-family="Times,serif" font-size="20.00" fill="#000000">GroupCoordinator</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_KafkaApi</title>
<path fill="none" stroke="#000000" d="M20,-382C20,-382 530.7275,-382 530.7275,-382 536.7275,-382 542.7275,-388 542.7275,-394 542.7275,-394 542.7275,-580 542.7275,-580 542.7275,-586 536.7275,-592 530.7275,-592 530.7275,-592 20,-592 20,-592 14,-592 8,-586 8,-580 8,-580 8,-394 8,-394 8,-388 14,-382 20,-382"/>
<text text-anchor="middle" x="275.3638" y="-572" font-family="Times,serif" font-size="20.00" fill="#000000">KafkaApi</text>
</g>
<!-- appendRecords -->
<g id="node1" class="node">
<title>appendRecords</title>
<polygon fill="none" stroke="#000000" points="957.8549,-52 855.2466,-52 855.2466,-16 957.8549,-16 957.8549,-52"/>
<text text-anchor="middle" x="906.5508" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">appendRecords</text>
</g>
<!-- updateCacheCallback -->
<g id="node13" class="node">
<title>updateCacheCallback</title>
<polygon fill="none" stroke="#000000" points="1133.8701,-104.4001 1133.8701,-173.5999 1271.9258,-173.5999 1271.9258,-104.4001 1133.8701,-104.4001"/>
<text text-anchor="middle" x="1202.8979" y="-158.3999" font-family="Times,serif" font-size="14.00" fill="#000000">updateCacheCallback</text>
<polyline fill="none" stroke="#000000" points="1133.8701,-151.5999 1271.9258,-151.5999 "/>
<text text-anchor="start" x="1141.8701" y="-136.3999" font-family="Times,serif" font-size="14.00" fill="#000000">日志写入</text>
<text text-anchor="start" x="1141.8701" y="-116.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 成功回调</text>
</g>
<!-- appendRecords&#45;&gt;updateCacheCallback -->
<g id="edge13" class="edge">
<title>appendRecords&#45;&gt;updateCacheCallback</title>
<path fill="none" stroke="#000000" d="M957.4947,-52.0501C1003.2975,-68.2787 1071.2923,-92.3703 1124.1019,-111.0814"/>
<polygon fill="#000000" stroke="#000000" points="1123.1824,-114.4688 1133.7771,-114.5095 1125.5202,-107.8707 1123.1824,-114.4688"/>
</g>
<!-- TransactionMetadata -->
<g id="node2" class="node">
<title>TransactionMetadata</title>
<polygon fill="#95e1d3" stroke="#000000" points="1807.8359,-406 1807.8359,-582 2068.5967,-582 2068.5967,-406 1807.8359,-406"/>
<text text-anchor="middle" x="1938.2163" y="-566.8" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionMetadata</text>
<polyline fill="none" stroke="#000000" points="1807.8359,-560 2068.5967,-560 "/>
<text text-anchor="start" x="1815.8359" y="-544.8" font-family="Times,serif" font-size="14.00" fill="#000000">transactionalId: String </text>
<polyline fill="none" stroke="#000000" points="1807.8359,-538 2068.5967,-538 "/>
<text text-anchor="start" x="1815.8359" y="-522.8" font-family="Times,serif" font-size="14.00" fill="#000000">producerId: long </text>
<polyline fill="none" stroke="#000000" points="1807.8359,-516 2068.5967,-516 "/>
<text text-anchor="start" x="1815.8359" y="-500.8" font-family="Times,serif" font-size="14.00" fill="#000000">lastProducerId: Long </text>
<polyline fill="none" stroke="#000000" points="1807.8359,-494 2068.5967,-494 "/>
<text text-anchor="start" x="1815.8359" y="-478.8" font-family="Times,serif" font-size="14.00" fill="#000000">producerEpoch: short </text>
<polyline fill="none" stroke="#000000" points="1807.8359,-472 2068.5967,-472 "/>
<text text-anchor="start" x="1815.8359" y="-456.8" font-family="Times,serif" font-size="14.00" fill="#000000">txnTimeoutMs: Int </text>
<polyline fill="none" stroke="#000000" points="1807.8359,-450 2068.5967,-450 "/>
<text text-anchor="start" x="1815.8359" y="-434.8" font-family="Times,serif" font-size="14.00" fill="#000000">state: TransactionState </text>
<polyline fill="none" stroke="#000000" points="1807.8359,-428 2068.5967,-428 "/>
<text text-anchor="start" x="1815.8359" y="-412.8" font-family="Times,serif" font-size="14.00" fill="#000000">topicPartitions: mutable.Set[TopicPartition]</text>
</g>
<!-- prepareAddPartitions -->
<g id="node3" class="node">
<title>prepareAddPartitions</title>
<polygon fill="none" stroke="#000000" points="580.062,-405.2 580.062,-454.8 732.1724,-454.8 732.1724,-405.2 580.062,-405.2"/>
<text text-anchor="middle" x="656.1172" y="-439.6" font-family="Times,serif" font-size="14.00" fill="#000000">prepareAddPartitions</text>
<polyline fill="none" stroke="#000000" points="580.062,-432.8 732.1724,-432.8 "/>
<text text-anchor="middle" x="656.1172" y="-417.6" font-family="Times,serif" font-size="14.00" fill="#000000">将状态设置为OnGoing</text>
</g>
<!-- prepareTransitionTo -->
<g id="node4" class="node">
<title>prepareTransitionTo</title>
<polygon fill="none" stroke="#000000" points="807.9473,-405.2 807.9473,-454.8 1005.1543,-454.8 1005.1543,-405.2 807.9473,-405.2"/>
<text text-anchor="middle" x="906.5508" y="-439.6" font-family="Times,serif" font-size="14.00" fill="#000000">prepareTransitionTo</text>
<polyline fill="none" stroke="#000000" points="807.9473,-432.8 1005.1543,-432.8 "/>
<text text-anchor="middle" x="906.5508" y="-417.6" font-family="Times,serif" font-size="14.00" fill="#000000">将pendingState设置为OnGoing</text>
</g>
<!-- prepareAddPartitions&#45;&gt;prepareTransitionTo -->
<g id="edge1" class="edge">
<title>prepareAddPartitions&#45;&gt;prepareTransitionTo</title>
<path fill="none" stroke="#000000" d="M732.2755,-430C752.8662,-430 775.5591,-430 797.5711,-430"/>
<polygon fill="#000000" stroke="#000000" points="797.6269,-433.5001 807.6269,-430 797.6268,-426.5001 797.6269,-433.5001"/>
</g>
<!-- pendingState -->
<g id="node6" class="node">
<title>pendingState</title>
<polygon fill="#95e1d3" stroke="#000000" points="1247.4947,-448 1162.3012,-448 1158.3012,-444 1158.3012,-412 1243.4947,-412 1247.4947,-416 1247.4947,-448"/>
<polyline fill="none" stroke="#000000" points="1243.4947,-444 1158.3012,-444 "/>
<polyline fill="none" stroke="#000000" points="1243.4947,-444 1243.4947,-412 "/>
<polyline fill="none" stroke="#000000" points="1243.4947,-444 1247.4947,-448 "/>
<text text-anchor="middle" x="1202.8979" y="-425.8" font-family="Times,serif" font-size="14.00" fill="#000000">pendingState</text>
</g>
<!-- prepareTransitionTo&#45;&gt;pendingState -->
<g id="edge2" class="edge">
<title>prepareTransitionTo&#45;&gt;pendingState</title>
<path fill="none" stroke="#000000" d="M1005.2301,-430C1052.7817,-430 1108.0165,-430 1147.9907,-430"/>
<polygon fill="#000000" stroke="#000000" points="1148.0678,-433.5001 1158.0678,-430 1148.0677,-426.5001 1148.0678,-433.5001"/>
</g>
<!-- completeTransitionTo -->
<g id="node5" class="node">
<title>completeTransitionTo</title>
<polygon fill="none" stroke="#000000" points="1370.2012,-405.4001 1370.2012,-474.5999 1522.6738,-474.5999 1522.6738,-405.4001 1370.2012,-405.4001"/>
<text text-anchor="middle" x="1446.4375" y="-459.3999" font-family="Times,serif" font-size="14.00" fill="#000000">completeTransitionTo</text>
<polyline fill="none" stroke="#000000" points="1370.2012,-452.5999 1522.6738,-452.5999 "/>
<text text-anchor="start" x="1378.2012" y="-437.3999" font-family="Times,serif" font-size="14.00" fill="#000000">在OnGoing状态下，</text>
<text text-anchor="start" x="1378.2012" y="-417.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 将tp添加到Metadata中</text>
</g>
<!-- addPartitions -->
<g id="node7" class="node">
<title>addPartitions</title>
<polygon fill="none" stroke="#000000" points="1710.1378,-449 1620.372,-449 1620.372,-413 1710.1378,-413 1710.1378,-449"/>
<text text-anchor="middle" x="1665.2549" y="-426.8" font-family="Times,serif" font-size="14.00" fill="#000000">addPartitions</text>
</g>
<!-- completeTransitionTo&#45;&gt;addPartitions -->
<g id="edge3" class="edge">
<title>completeTransitionTo&#45;&gt;addPartitions</title>
<path fill="none" stroke="#000000" d="M1522.9692,-436.8522C1551.6926,-435.6708 1583.7488,-434.3524 1610.152,-433.2664"/>
<polygon fill="#000000" stroke="#000000" points="1610.499,-436.7552 1620.3467,-432.8471 1610.2112,-429.7611 1610.499,-436.7552"/>
</g>
<!-- addPartitions&#45;&gt;TransactionMetadata -->
<g id="edge4" class="edge">
<title>addPartitions&#45;&gt;TransactionMetadata:tp</title>
<path fill="none" stroke="#000000" d="M1710.2159,-424.328C1735.4632,-421.0884 1767.8776,-417.7549 1798.0743,-417.1112"/>
<polygon fill="#000000" stroke="#000000" points="1798.2553,-420.6095 1808.2163,-417 1798.1785,-413.6099 1798.2553,-420.6095"/>
</g>
<!-- appendTransactionToLog -->
<g id="node8" class="node">
<title>appendTransactionToLog</title>
<polygon fill="none" stroke="#000000" points="576.5415,-207.4001 576.5415,-276.5999 735.6929,-276.5999 735.6929,-207.4001 576.5415,-207.4001"/>
<text text-anchor="middle" x="656.1172" y="-261.3999" font-family="Times,serif" font-size="14.00" fill="#000000">appendTransactionToLog</text>
<polyline fill="none" stroke="#000000" points="576.5415,-254.5999 735.6929,-254.5999 "/>
<text text-anchor="start" x="584.5415" y="-239.3999" font-family="Times,serif" font-size="14.00" fill="#000000">将事务日志对应的</text>
<text text-anchor="start" x="584.5415" y="-219.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 写入topic_partition</text>
</g>
<!-- appendTransactionToLog&#45;&gt;appendRecords -->
<g id="edge11" class="edge">
<title>appendTransactionToLog&#45;&gt;appendRecords</title>
<path fill="none" stroke="#000000" d="M677.4302,-207.086C699.1634,-173.8701 735.5755,-124.3031 777.5068,-92 797.7674,-76.3917 822.8949,-63.8851 845.5785,-54.5392"/>
<polygon fill="#000000" stroke="#000000" points="847.1388,-57.685 855.1291,-50.7275 844.5441,-51.1836 847.1388,-57.685"/>
</g>
<!-- TRANSACTION_STATE_TOPIC_NAME -->
<g id="node16" class="node">
<title>TRANSACTION_STATE_TOPIC_NAME</title>
<polygon fill="none" stroke="#000000" points="1035.6387,-266 777.4629,-266 777.4629,-230 1035.6387,-230 1035.6387,-266"/>
<text text-anchor="middle" x="906.5508" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#000000">TRANSACTION_STATE_TOPIC_NAME</text>
</g>
<!-- appendTransactionToLog&#45;&gt;TRANSACTION_STATE_TOPIC_NAME -->
<g id="edge12" class="edge">
<title>appendTransactionToLog&#45;&gt;TRANSACTION_STATE_TOPIC_NAME</title>
<path fill="none" stroke="#000000" d="M735.7,-243.9067C745.794,-244.1485 756.3462,-244.4013 767.0394,-244.6575"/>
<polygon fill="#000000" stroke="#000000" points="767.2434,-248.1633 777.3244,-244.9039 767.4111,-241.1653 767.2434,-248.1633"/>
</g>
<!-- getTransactionState -->
<g id="node9" class="node">
<title>getTransactionState</title>
<polygon fill="none" stroke="#000000" points="570.7275,-295.2 570.7275,-344.8 741.5068,-344.8 741.5068,-295.2 570.7275,-295.2"/>
<text text-anchor="middle" x="656.1172" y="-329.6" font-family="Times,serif" font-size="14.00" fill="#000000">getTransactionState</text>
<polyline fill="none" stroke="#000000" points="570.7275,-322.8 741.5068,-322.8 "/>
<text text-anchor="middle" x="656.1172" y="-307.6" font-family="Times,serif" font-size="14.00" fill="#000000">根据tid获取事务对应状态</text>
</g>
<!-- getAndMaybeAddTransactionState -->
<g id="node14" class="node">
<title>getAndMaybeAddTransactionState</title>
<polygon fill="none" stroke="#000000" points="1013.3419,-332 799.7597,-332 799.7597,-296 1013.3419,-296 1013.3419,-332"/>
<text text-anchor="middle" x="906.5508" y="-309.8" font-family="Times,serif" font-size="14.00" fill="#000000">getAndMaybeAddTransactionState</text>
</g>
<!-- getTransactionState&#45;&gt;getAndMaybeAddTransactionState -->
<g id="edge7" class="edge">
<title>getTransactionState&#45;&gt;getAndMaybeAddTransactionState</title>
<path fill="none" stroke="#000000" d="M741.6018,-317.9519C757.091,-317.5808 773.4851,-317.188 789.6917,-316.7998"/>
<polygon fill="#000000" stroke="#000000" points="789.8353,-320.2974 799.7485,-316.5588 789.6676,-313.2994 789.8353,-320.2974"/>
</g>
<!-- transactionMetadataCache -->
<g id="node10" class="node">
<title>transactionMetadataCache</title>
<polygon fill="#95e1d3" stroke="#000000" points="1071.5947,-192.2 1071.5947,-255.8 1334.2012,-255.8 1334.2012,-192.2 1071.5947,-192.2"/>
<text text-anchor="middle" x="1202.8979" y="-240.6" font-family="Times,serif" font-size="14.00" fill="#000000">transactionMetadataCache</text>
<polyline fill="none" stroke="#000000" points="1071.5947,-233.8 1334.2012,-233.8 "/>
<text text-anchor="start" x="1079.5947" y="-218.6" font-family="Times,serif" font-size="14.00" fill="#000000">mutable.Map[Int, TxnMetadataCacheEntry]</text>
<text text-anchor="middle" x="1202.8979" y="-204.6" font-family="Times,serif" font-size="14.00" fill="#000000"> parition 到cacheEntry的映射</text>
</g>
<!-- TxnMetadataCacheEntry -->
<g id="node11" class="node">
<title>TxnMetadataCacheEntry</title>
<polygon fill="#95e1d3" stroke="#000000" points="1558.6738,-230.2 1558.6738,-329.8 1771.8359,-329.8 1771.8359,-230.2 1558.6738,-230.2"/>
<text text-anchor="middle" x="1665.2549" y="-314.6" font-family="Times,serif" font-size="14.00" fill="#000000">TxnMetadataCacheEntry</text>
<polyline fill="none" stroke="#000000" points="1558.6738,-307.8 1771.8359,-307.8 "/>
<text text-anchor="start" x="1566.6738" y="-292.6" font-family="Times,serif" font-size="14.00" fill="#000000">coordinatorEpoch Int </text>
<polyline fill="none" stroke="#000000" points="1558.6738,-285.8 1771.8359,-285.8 "/>
<text text-anchor="start" x="1566.6738" y="-270.6" font-family="Times,serif" font-size="14.00" fill="#000000">metadataPerTransactionalId </text>
<text text-anchor="start" x="1566.6738" y="-256.6" font-family="Times,serif" font-size="14.00" fill="#000000"> Pool[String, TransactionMetadata]</text>
<text text-anchor="middle" x="1665.2549" y="-242.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 事务ID到事务metadata映射</text>
</g>
<!-- transactionMetadataCache&#45;&gt;TxnMetadataCacheEntry -->
<g id="edge5" class="edge">
<title>transactionMetadataCache:entry&#45;&gt;TxnMetadataCacheEntry</title>
<path fill="none" stroke="#000000" d="M1333.8979,-213C1406.183,-213 1485.61,-228.5075 1548.5762,-244.6013"/>
<polygon fill="#000000" stroke="#000000" points="1547.9783,-248.062 1558.537,-247.187 1549.7372,-241.2866 1547.9783,-248.062"/>
</g>
<!-- TxnMetadataCacheEntry&#45;&gt;TransactionMetadata -->
<g id="edge6" class="edge">
<title>TxnMetadataCacheEntry:meta&#45;&gt;TransactionMetadata</title>
<path fill="none" stroke="#000000" d="M1772.2549,-258C1843.747,-258 1887.109,-331.361 1911.4848,-396.2796"/>
<polygon fill="#000000" stroke="#000000" points="1908.2358,-397.5865 1914.9445,-405.7867 1914.8137,-395.1927 1908.2358,-397.5865"/>
</g>
<!-- partitionFor -->
<g id="node12" class="node">
<title>partitionFor</title>
<polygon fill="none" stroke="#000000" points="1088.7598,-275.2 1088.7598,-352.8 1317.0361,-352.8 1317.0361,-275.2 1088.7598,-275.2"/>
<text text-anchor="middle" x="1202.8979" y="-337.6" font-family="Times,serif" font-size="14.00" fill="#000000">partitionFor</text>
<polyline fill="none" stroke="#000000" points="1088.7598,-330.8 1317.0361,-330.8 "/>
<text text-anchor="start" x="1096.7598" y="-315.6" font-family="Times,serif" font-size="14.00" fill="#000000">Utils.abs(transactionalId.hashCode)%</text>
<text text-anchor="start" x="1096.7598" y="-301.6" font-family="Times,serif" font-size="14.00" fill="#000000"> transactionTopicPartitionCount </text>
<text text-anchor="start" x="1096.7598" y="-287.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 根据事务id获取对应的partition</text>
</g>
<!-- updateCacheCallback&#45;&gt;completeTransitionTo -->
<g id="edge14" class="edge">
<title>updateCacheCallback&#45;&gt;completeTransitionTo</title>
<path fill="none" stroke="#000000" d="M1272.0252,-150.6145C1293.9812,-157.1245 1316.9986,-167.2549 1334.2012,-183 1396.711,-240.2139 1426.1023,-338.4259 1438.5139,-395.4418"/>
<polygon fill="#000000" stroke="#000000" points="1435.0923,-396.1792 1440.5694,-405.2484 1441.9434,-394.7431 1435.0923,-396.1792"/>
</g>
<!-- getAndMaybeAddTransactionState&#45;&gt;transactionMetadataCache -->
<g id="edge8" class="edge">
<title>getAndMaybeAddTransactionState&#45;&gt;transactionMetadataCache</title>
<path fill="none" stroke="#000000" d="M966.3089,-295.9722C988.1178,-289.3844 1012.9754,-281.8656 1035.5947,-275 1052.7561,-269.791 1070.904,-264.271 1088.6699,-258.8606"/>
<polygon fill="#000000" stroke="#000000" points="1089.9456,-262.1309 1098.4918,-255.8688 1087.9058,-255.4346 1089.9456,-262.1309"/>
</g>
<!-- getAndMaybeAddTransactionState&#45;&gt;partitionFor -->
<g id="edge9" class="edge">
<title>getAndMaybeAddTransactionState&#45;&gt;partitionFor</title>
<path fill="none" stroke="#000000" d="M1013.5389,-314C1034.5782,-314 1056.8209,-314 1078.3779,-314"/>
<polygon fill="#000000" stroke="#000000" points="1078.5609,-317.5001 1088.5609,-314 1078.5608,-310.5001 1078.5609,-317.5001"/>
</g>
<!-- addLoadedTransactionsToCache -->
<g id="node15" class="node">
<title>addLoadedTransactionsToCache</title>
<polygon fill="none" stroke="#000000" points="1005.8439,-212 807.2577,-212 807.2577,-176 1005.8439,-176 1005.8439,-212"/>
<text text-anchor="middle" x="906.5508" y="-189.8" font-family="Times,serif" font-size="14.00" fill="#000000">addLoadedTransactionsToCache</text>
</g>
<!-- addLoadedTransactionsToCache&#45;&gt;transactionMetadataCache -->
<g id="edge10" class="edge">
<title>addLoadedTransactionsToCache&#45;&gt;transactionMetadataCache</title>
<path fill="none" stroke="#000000" d="M1006.0545,-204.073C1023.871,-205.8766 1042.7436,-207.7872 1061.4722,-209.6831"/>
<polygon fill="#000000" stroke="#000000" points="1061.2474,-213.1781 1071.5491,-210.7032 1061.9525,-206.2137 1061.2474,-213.1781"/>
</g>
<!-- handleAddPartitionsToTransaction -->
<g id="node17" class="node">
<title>handleAddPartitionsToTransaction</title>
<polygon fill="none" stroke="#000000" points="520.175,-338 308.6375,-338 308.6375,-302 520.175,-302 520.175,-338"/>
<text text-anchor="middle" x="414.4063" y="-315.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleAddPartitionsToTransaction</text>
</g>
<!-- handleAddPartitionsToTransaction&#45;&gt;prepareAddPartitions -->
<g id="edge15" class="edge">
<title>handleAddPartitionsToTransaction&#45;&gt;prepareAddPartitions</title>
<path fill="none" stroke="#000000" d="M460.76,-338.0518C485.7106,-348.4798 516.6327,-362.5699 542.7275,-378 552.2917,-383.6554 553.0323,-387.5723 562.7275,-393 567.578,-395.7155 572.6685,-398.3283 577.8639,-400.822"/>
<polygon fill="#000000" stroke="#000000" points="576.7538,-404.1645 587.3,-405.1785 579.688,-397.8091 576.7538,-404.1645"/>
</g>
<!-- handleAddPartitionsToTransaction&#45;&gt;appendTransactionToLog -->
<g id="edge16" class="edge">
<title>handleAddPartitionsToTransaction&#45;&gt;appendTransactionToLog</title>
<path fill="none" stroke="#000000" d="M500.558,-301.9992C514.7602,-298.4215 529.2409,-294.3954 542.7275,-290 551.5521,-287.124 560.645,-283.8428 569.6613,-280.3767"/>
<polygon fill="#000000" stroke="#000000" points="570.9843,-283.6174 579.0151,-276.7068 568.4276,-277.101 570.9843,-283.6174"/>
</g>
<!-- handleAddPartitionsToTransaction&#45;&gt;getTransactionState -->
<g id="edge17" class="edge">
<title>handleAddPartitionsToTransaction&#45;&gt;getTransactionState</title>
<path fill="none" stroke="#000000" d="M520.0726,-320C533.536,-320 547.255,-320 560.5469,-320"/>
<polygon fill="#000000" stroke="#000000" points="560.6167,-323.5001 570.6166,-320 560.6166,-316.5001 560.6167,-323.5001"/>
</g>
<!-- gp_partitionFor -->
<g id="node18" class="node">
<title>gp_partitionFor</title>
<polygon fill="none" stroke="#000000" points="315.0303,-200.2 315.0303,-249.8 513.7822,-249.8 513.7822,-200.2 315.0303,-200.2"/>
<text text-anchor="middle" x="414.4063" y="-234.6" font-family="Times,serif" font-size="14.00" fill="#000000">partitionFor</text>
<polyline fill="none" stroke="#000000" points="315.0303,-227.8 513.7822,-227.8 "/>
<text text-anchor="middle" x="414.4063" y="-212.6" font-family="Times,serif" font-size="14.00" fill="#000000">获取consumerGroupId对应的tp</text>
</g>
<!-- handleAddPartitionToTxnRequest -->
<g id="node19" class="node">
<title>handleAddPartitionToTxnRequest</title>
<polygon fill="none" stroke="#000000" points="16,-445 16,-555 258.085,-555 258.085,-445 16,-445"/>
<text text-anchor="middle" x="137.0425" y="-539.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleAddPartitionToTxnRequest</text>
<polyline fill="none" stroke="#000000" points="16,-533 258.085,-533 "/>
<text text-anchor="start" x="24" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">transactionalId: String</text>
<polyline fill="none" stroke="#000000" points="16,-511 258.085,-511 "/>
<text text-anchor="start" x="24" y="-495.8" font-family="Times,serif" font-size="14.00" fill="#000000">producerId: Long</text>
<polyline fill="none" stroke="#000000" points="16,-489 258.085,-489 "/>
<text text-anchor="start" x="24" y="-473.8" font-family="Times,serif" font-size="14.00" fill="#000000">producerIdAndEpoch: Short</text>
<polyline fill="none" stroke="#000000" points="16,-467 258.085,-467 "/>
<text text-anchor="start" x="24" y="-451.8" font-family="Times,serif" font-size="14.00" fill="#000000">partitions: collection.Set[TopicPartition]</text>
</g>
<!-- handleAddPartitionToTxnRequest&#45;&gt;handleAddPartitionsToTransaction -->
<g id="edge21" class="edge">
<title>handleAddPartitionToTxnRequest&#45;&gt;handleAddPartitionsToTransaction</title>
<path fill="none" stroke="#000000" d="M246.511,-444.8733C250.5425,-441.7069 254.4204,-438.4149 258.085,-435 280.0056,-414.5729 271.724,-397.944 294.085,-378 310.743,-363.1425 331.8847,-351.258 351.7833,-342.2114"/>
<polygon fill="#000000" stroke="#000000" points="353.3623,-345.3409 361.1211,-338.1262 350.5566,-338.9278 353.3623,-345.3409"/>
</g>
<!-- handleAddOffsetsToTxnRequest -->
<g id="node20" class="node">
<title>handleAddOffsetsToTxnRequest</title>
<polygon fill="none" stroke="#000000" points="236.8882,-426 37.1967,-426 37.1967,-390 236.8882,-390 236.8882,-426"/>
<text text-anchor="middle" x="137.0425" y="-403.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleAddOffsetsToTxnRequest</text>
</g>
<!-- handleAddOffsetsToTxnRequest&#45;&gt;handleAddPartitionsToTransaction -->
<g id="edge18" class="edge">
<title>handleAddOffsetsToTxnRequest&#45;&gt;handleAddPartitionsToTransaction</title>
<path fill="none" stroke="#000000" d="M193.8405,-389.9795C238.3778,-375.8491 300.4691,-356.1492 347.429,-341.2501"/>
<polygon fill="#000000" stroke="#000000" points="348.735,-344.5077 357.2083,-338.1474 346.618,-337.8355 348.735,-344.5077"/>
</g>
<!-- handleAddOffsetsToTxnRequest&#45;&gt;gp_partitionFor -->
<g id="edge19" class="edge">
<title>handleAddOffsetsToTxnRequest&#45;&gt;gp_partitionFor</title>
<path fill="none" stroke="#000000" d="M158.9131,-389.9128C188.5862,-365.7642 243.6914,-322.2898 294.085,-290 313.5009,-277.5592 335.5033,-265.2022 355.3349,-254.6562"/>
<polygon fill="#000000" stroke="#000000" points="357.0615,-257.7026 364.2768,-249.9444 353.7983,-251.5097 357.0615,-257.7026"/>
</g>
<!-- GROUP_METADATA_TOPIC_NAME -->
<g id="node21" class="node">
<title>GROUP_METADATA_TOPIC_NAME</title>
<polygon fill="none" stroke="#000000" points="534.5491,-426 294.2634,-426 294.2634,-390 534.5491,-390 534.5491,-426"/>
<text text-anchor="middle" x="414.4063" y="-403.8" font-family="Times,serif" font-size="14.00" fill="#000000">GROUP_METADATA_TOPIC_NAME</text>
</g>
<!-- handleAddOffsetsToTxnRequest&#45;&gt;GROUP_METADATA_TOPIC_NAME -->
<g id="edge20" class="edge">
<title>handleAddOffsetsToTxnRequest&#45;&gt;GROUP_METADATA_TOPIC_NAME</title>
<path fill="none" stroke="#000000" d="M237.1772,-408C252.3245,-408 268.1383,-408 283.8138,-408"/>
<polygon fill="#000000" stroke="#000000" points="284.0866,-411.5001 294.0865,-408 284.0865,-404.5001 284.0866,-411.5001"/>
</g>
</g>
</svg>
