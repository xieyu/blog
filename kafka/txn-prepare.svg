<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: txn_prepare Pages: 1 -->
<svg width="1724pt" height="777pt"
 viewBox="0.00 0.00 1724.26 777.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 773)">
<title>txn_prepare</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-773 1720.2568,-773 1720.2568,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ReplicaManager</title>
<path fill="none" stroke="#000000" d="M665.5317,-8C665.5317,-8 788.8354,-8 788.8354,-8 794.8354,-8 800.8354,-14 800.8354,-20 800.8354,-20 800.8354,-76 800.8354,-76 800.8354,-82 794.8354,-88 788.8354,-88 788.8354,-88 665.5317,-88 665.5317,-88 659.5317,-88 653.5317,-82 653.5317,-76 653.5317,-76 653.5317,-20 653.5317,-20 653.5317,-14 659.5317,-8 665.5317,-8"/>
<text text-anchor="middle" x="727.1836" y="-68" font-family="Times,serif" font-size="20.00" fill="#000000">ReplicaManager</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_TransactionMetadata</title>
<path fill="none" stroke="#000000" d="M376.9912,-397C376.9912,-397 1696.2568,-397 1696.2568,-397 1702.2568,-397 1708.2568,-403 1708.2568,-409 1708.2568,-409 1708.2568,-661 1708.2568,-661 1708.2568,-667 1702.2568,-673 1696.2568,-673 1696.2568,-673 376.9912,-673 376.9912,-673 370.9912,-673 364.9912,-667 364.9912,-661 364.9912,-661 364.9912,-409 364.9912,-409 364.9912,-403 370.9912,-397 376.9912,-397"/>
<text text-anchor="middle" x="1036.624" y="-653" font-family="Times,serif" font-size="20.00" fill="#000000">TransactionMetadata</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_TransactionStateManager</title>
<path fill="none" stroke="#000000" d="M385.9258,-96C385.9258,-96 1399.4961,-96 1399.4961,-96 1405.4961,-96 1411.4961,-102 1411.4961,-108 1411.4961,-108 1411.4961,-377 1411.4961,-377 1411.4961,-383 1405.4961,-389 1399.4961,-389 1399.4961,-389 385.9258,-389 385.9258,-389 379.9258,-389 373.9258,-383 373.9258,-377 373.9258,-377 373.9258,-108 373.9258,-108 373.9258,-102 379.9258,-96 385.9258,-96"/>
<text text-anchor="middle" x="892.7109" y="-369" font-family="Times,serif" font-size="20.00" fill="#000000">TransactionStateManager</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_TransactionCoordinator</title>
<path fill="none" stroke="#000000" d="M199.5244,-681C199.5244,-681 537.3096,-681 537.3096,-681 543.3096,-681 549.3096,-687 549.3096,-693 549.3096,-693 549.3096,-749 549.3096,-749 549.3096,-755 543.3096,-761 537.3096,-761 537.3096,-761 199.5244,-761 199.5244,-761 193.5244,-761 187.5244,-755 187.5244,-749 187.5244,-749 187.5244,-693 187.5244,-693 187.5244,-687 193.5244,-681 199.5244,-681"/>
<text text-anchor="middle" x="368.417" y="-741" font-family="Times,serif" font-size="20.00" fill="#000000">TransactionCoordinator</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_KafkaApi</title>
<path fill="none" stroke="#000000" d="M20,-681C20,-681 155.5244,-681 155.5244,-681 161.5244,-681 167.5244,-687 167.5244,-693 167.5244,-693 167.5244,-749 167.5244,-749 167.5244,-755 161.5244,-761 155.5244,-761 155.5244,-761 20,-761 20,-761 14,-761 8,-755 8,-749 8,-749 8,-693 8,-693 8,-687 14,-681 20,-681"/>
<text text-anchor="middle" x="87.7622" y="-741" font-family="Times,serif" font-size="20.00" fill="#000000">KafkaApi</text>
</g>
<!-- appendRecords -->
<g id="node1" class="node">
<title>appendRecords</title>
<polygon fill="none" stroke="#000000" points="777.9878,-52 675.3794,-52 675.3794,-16 777.9878,-16 777.9878,-52"/>
<text text-anchor="middle" x="726.6836" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">appendRecords</text>
</g>
<!-- updateCacheCallback -->
<g id="node13" class="node">
<title>updateCacheCallback</title>
<polygon fill="none" stroke="#000000" points="954.0029,-104.4001 954.0029,-173.5999 1092.0586,-173.5999 1092.0586,-104.4001 954.0029,-104.4001"/>
<text text-anchor="middle" x="1023.0308" y="-158.3999" font-family="Times,serif" font-size="14.00" fill="#000000">updateCacheCallback</text>
<polyline fill="none" stroke="#000000" points="954.0029,-151.5999 1092.0586,-151.5999 "/>
<text text-anchor="start" x="962.0029" y="-136.3999" font-family="Times,serif" font-size="14.00" fill="#000000">日志写入</text>
<text text-anchor="start" x="962.0029" y="-116.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 成功回调</text>
</g>
<!-- appendRecords&#45;&gt;updateCacheCallback -->
<g id="edge11" class="edge">
<title>appendRecords&#45;&gt;updateCacheCallback</title>
<path fill="none" stroke="#000000" d="M777.6275,-52.0501C823.4303,-68.2787 891.4251,-92.3703 944.2347,-111.0814"/>
<polygon fill="#000000" stroke="#000000" points="943.3152,-114.4688 953.9099,-114.5095 945.653,-107.8707 943.3152,-114.4688"/>
</g>
<!-- TransactionMetadata -->
<g id="node2" class="node">
<title>TransactionMetadata</title>
<polygon fill="#95e1d3" stroke="#000000" points="1439.4961,-406 1439.4961,-582 1700.2568,-582 1700.2568,-406 1439.4961,-406"/>
<text text-anchor="middle" x="1569.8765" y="-566.8" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionMetadata</text>
<polyline fill="none" stroke="#000000" points="1439.4961,-560 1700.2568,-560 "/>
<text text-anchor="start" x="1447.4961" y="-544.8" font-family="Times,serif" font-size="14.00" fill="#000000">transactionalId: String </text>
<polyline fill="none" stroke="#000000" points="1439.4961,-538 1700.2568,-538 "/>
<text text-anchor="start" x="1447.4961" y="-522.8" font-family="Times,serif" font-size="14.00" fill="#000000">producerId: long </text>
<polyline fill="none" stroke="#000000" points="1439.4961,-516 1700.2568,-516 "/>
<text text-anchor="start" x="1447.4961" y="-500.8" font-family="Times,serif" font-size="14.00" fill="#000000">lastProducerId: Long </text>
<polyline fill="none" stroke="#000000" points="1439.4961,-494 1700.2568,-494 "/>
<text text-anchor="start" x="1447.4961" y="-478.8" font-family="Times,serif" font-size="14.00" fill="#000000">producerEpoch: short </text>
<polyline fill="none" stroke="#000000" points="1439.4961,-472 1700.2568,-472 "/>
<text text-anchor="start" x="1447.4961" y="-456.8" font-family="Times,serif" font-size="14.00" fill="#000000">txnTimeoutMs: Int </text>
<polyline fill="none" stroke="#000000" points="1439.4961,-450 1700.2568,-450 "/>
<text text-anchor="start" x="1447.4961" y="-434.8" font-family="Times,serif" font-size="14.00" fill="#000000">state: TransactionState </text>
<polyline fill="none" stroke="#000000" points="1439.4961,-428 1700.2568,-428 "/>
<text text-anchor="start" x="1447.4961" y="-412.8" font-family="Times,serif" font-size="14.00" fill="#000000">topicPartitions: mutable.Set[TopicPartition]</text>
</g>
<!-- prepareTransitionTo -->
<g id="node3" class="node">
<title>prepareTransitionTo</title>
<polygon fill="none" stroke="#000000" points="661.8838,-584 661.8838,-620 791.4834,-620 791.4834,-584 661.8838,-584"/>
<text text-anchor="middle" x="726.6836" y="-597.8" font-family="Times,serif" font-size="14.00" fill="#000000">prepareTransitionTo</text>
</g>
<!-- pendingState -->
<g id="node5" class="node">
<title>pendingState</title>
<polygon fill="#95e1d3" stroke="#000000" points="1067.6275,-620 982.434,-620 978.434,-616 978.434,-584 1063.6275,-584 1067.6275,-588 1067.6275,-620"/>
<polyline fill="none" stroke="#000000" points="1063.6275,-616 978.434,-616 "/>
<polyline fill="none" stroke="#000000" points="1063.6275,-616 1063.6275,-584 "/>
<polyline fill="none" stroke="#000000" points="1063.6275,-616 1067.6275,-620 "/>
<text text-anchor="middle" x="1023.0308" y="-597.8" font-family="Times,serif" font-size="14.00" fill="#000000">pendingState</text>
</g>
<!-- prepareTransitionTo&#45;&gt;pendingState -->
<g id="edge2" class="edge">
<title>prepareTransitionTo&#45;&gt;pendingState</title>
<path fill="none" stroke="#000000" d="M791.7182,-602C844.5281,-602 918.17,-602 968.0676,-602"/>
<polygon fill="#000000" stroke="#000000" points="968.3387,-605.5001 978.3387,-602 968.3387,-598.5001 968.3387,-605.5001"/>
</g>
<!-- completeTransitionTo -->
<g id="node4" class="node">
<title>completeTransitionTo</title>
<polygon fill="none" stroke="#000000" points="1210.165,-472.6001 1210.165,-569.3999 1383.665,-569.3999 1383.665,-472.6001 1210.165,-472.6001"/>
<text text-anchor="middle" x="1296.915" y="-554.1999" font-family="Times,serif" font-size="14.00" fill="#000000">completeTransitionTo</text>
<polyline fill="none" stroke="#000000" points="1210.165,-547.3999 1383.665,-547.3999 "/>
<text text-anchor="middle" x="1296.915" y="-532.1999" font-family="Times,serif" font-size="14.00" fill="#000000">在PrepareCommit</text>
<polyline fill="none" stroke="#000000" points="1210.165,-519.8 1383.665,-519.8 "/>
<text text-anchor="start" x="1218.165" y="-504.6" font-family="Times,serif" font-size="14.00" fill="#000000">PrepareAbort状态下，</text>
<text text-anchor="start" x="1218.165" y="-485" font-family="Times,serif" font-size="14.00" fill="#000000"> 如果状态不对，抛出异常</text>
</g>
<!-- throwStateTransitionFailure -->
<g id="node7" class="node">
<title>throwStateTransitionFailure</title>
<polygon fill="none" stroke="#000000" points="1656.747,-637 1483.006,-637 1483.006,-601 1656.747,-601 1656.747,-637"/>
<text text-anchor="middle" x="1569.8765" y="-614.8" font-family="Times,serif" font-size="14.00" fill="#000000">throwStateTransitionFailure</text>
</g>
<!-- completeTransitionTo&#45;&gt;throwStateTransitionFailure -->
<g id="edge3" class="edge">
<title>completeTransitionTo&#45;&gt;throwStateTransitionFailure</title>
<path fill="none" stroke="#000000" d="M1383.9913,-568.7707C1401.9828,-577.3772 1421.0724,-585.6254 1439.4961,-592 1450.2249,-595.7122 1461.6359,-598.9938 1473.0724,-601.8734"/>
<polygon fill="#000000" stroke="#000000" points="1472.5702,-605.3527 1483.1127,-604.3011 1474.2155,-598.5488 1472.5702,-605.3527"/>
</g>
<!-- prepareAbortOrCommit -->
<g id="node6" class="node">
<title>prepareAbortOrCommit</title>
<polygon fill="none" stroke="#000000" points="372.9912,-567.4001 372.9912,-636.5999 561.6396,-636.5999 561.6396,-567.4001 372.9912,-567.4001"/>
<text text-anchor="middle" x="467.3154" y="-621.3999" font-family="Times,serif" font-size="14.00" fill="#000000">prepareAbortOrCommit</text>
<polyline fill="none" stroke="#000000" points="372.9912,-614.5999 561.6396,-614.5999 "/>
<text text-anchor="start" x="380.9912" y="-599.3999" font-family="Times,serif" font-size="14.00" fill="#000000">将状态切换为PrepareCommit</text>
<text text-anchor="start" x="380.9912" y="-579.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 或者PrepareAbort</text>
</g>
<!-- prepareAbortOrCommit&#45;&gt;prepareTransitionTo -->
<g id="edge1" class="edge">
<title>prepareAbortOrCommit&#45;&gt;prepareTransitionTo</title>
<path fill="none" stroke="#000000" d="M561.687,-602C591.2282,-602 623.4158,-602 651.4538,-602"/>
<polygon fill="#000000" stroke="#000000" points="651.5832,-605.5001 661.5832,-602 651.5832,-598.5001 651.5832,-605.5001"/>
</g>
<!-- appendTransactionToLog -->
<g id="node8" class="node">
<title>appendTransactionToLog</title>
<polygon fill="none" stroke="#000000" points="387.7397,-153.4001 387.7397,-222.5999 546.8911,-222.5999 546.8911,-153.4001 387.7397,-153.4001"/>
<text text-anchor="middle" x="467.3154" y="-207.3999" font-family="Times,serif" font-size="14.00" fill="#000000">appendTransactionToLog</text>
<polyline fill="none" stroke="#000000" points="387.7397,-200.5999 546.8911,-200.5999 "/>
<text text-anchor="start" x="395.7397" y="-185.3999" font-family="Times,serif" font-size="14.00" fill="#000000">将事务日志对应的</text>
<text text-anchor="start" x="395.7397" y="-165.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 写入topic_partition</text>
</g>
<!-- appendTransactionToLog&#45;&gt;appendRecords -->
<g id="edge9" class="edge">
<title>appendTransactionToLog&#45;&gt;appendRecords</title>
<path fill="none" stroke="#000000" d="M509.4738,-153.3782C534.2533,-133.9546 566.7011,-110.0711 597.6396,-92 620.7546,-78.4986 647.5761,-65.9811 670.7591,-56.0567"/>
<polygon fill="#000000" stroke="#000000" points="672.2638,-59.2206 680.1149,-52.1064 669.541,-52.7718 672.2638,-59.2206"/>
</g>
<!-- TRANSACTION_STATE_TOPIC_NAME -->
<g id="node15" class="node">
<title>TRANSACTION_STATE_TOPIC_NAME</title>
<polygon fill="none" stroke="#000000" points="855.7715,-206 597.5957,-206 597.5957,-170 855.7715,-170 855.7715,-206"/>
<text text-anchor="middle" x="726.6836" y="-183.8" font-family="Times,serif" font-size="14.00" fill="#000000">TRANSACTION_STATE_TOPIC_NAME</text>
</g>
<!-- appendTransactionToLog&#45;&gt;TRANSACTION_STATE_TOPIC_NAME -->
<g id="edge10" class="edge">
<title>appendTransactionToLog&#45;&gt;TRANSACTION_STATE_TOPIC_NAME</title>
<path fill="none" stroke="#000000" d="M546.8971,-188C559.8384,-188 573.5663,-188 587.4409,-188"/>
<polygon fill="#000000" stroke="#000000" points="587.5605,-191.5001 597.5605,-188 587.5605,-184.5001 587.5605,-191.5001"/>
</g>
<!-- getTransactionState -->
<g id="node9" class="node">
<title>getTransactionState</title>
<polygon fill="none" stroke="#000000" points="381.9258,-296.2 381.9258,-345.8 552.7051,-345.8 552.7051,-296.2 381.9258,-296.2"/>
<text text-anchor="middle" x="467.3154" y="-330.6" font-family="Times,serif" font-size="14.00" fill="#000000">getTransactionState</text>
<polyline fill="none" stroke="#000000" points="381.9258,-323.8 552.7051,-323.8 "/>
<text text-anchor="middle" x="467.3154" y="-308.6" font-family="Times,serif" font-size="14.00" fill="#000000">根据tid获取事务对应状态</text>
</g>
<!-- getAndMaybeAddTransactionState -->
<g id="node14" class="node">
<title>getAndMaybeAddTransactionState</title>
<polygon fill="none" stroke="#000000" points="833.4747,-332 619.8925,-332 619.8925,-296 833.4747,-296 833.4747,-332"/>
<text text-anchor="middle" x="726.6836" y="-309.8" font-family="Times,serif" font-size="14.00" fill="#000000">getAndMaybeAddTransactionState</text>
</g>
<!-- getTransactionState&#45;&gt;getAndMaybeAddTransactionState -->
<g id="edge6" class="edge">
<title>getTransactionState&#45;&gt;getAndMaybeAddTransactionState</title>
<path fill="none" stroke="#000000" d="M552.9611,-318.6885C571.0971,-318.1991 590.537,-317.6744 609.6097,-317.1597"/>
<polygon fill="#000000" stroke="#000000" points="609.9459,-320.652 619.8478,-316.8834 609.757,-313.6545 609.9459,-320.652"/>
</g>
<!-- transactionMetadataCache -->
<g id="node10" class="node">
<title>transactionMetadataCache</title>
<polygon fill="#95e1d3" stroke="#000000" points="891.7275,-192.2 891.7275,-255.8 1154.334,-255.8 1154.334,-192.2 891.7275,-192.2"/>
<text text-anchor="middle" x="1023.0308" y="-240.6" font-family="Times,serif" font-size="14.00" fill="#000000">transactionMetadataCache</text>
<polyline fill="none" stroke="#000000" points="891.7275,-233.8 1154.334,-233.8 "/>
<text text-anchor="start" x="899.7275" y="-218.6" font-family="Times,serif" font-size="14.00" fill="#000000">mutable.Map[Int, TxnMetadataCacheEntry]</text>
<text text-anchor="middle" x="1023.0308" y="-204.6" font-family="Times,serif" font-size="14.00" fill="#000000"> parition 到cacheEntry的映射</text>
</g>
<!-- TxnMetadataCacheEntry -->
<g id="node11" class="node">
<title>TxnMetadataCacheEntry</title>
<polygon fill="#95e1d3" stroke="#000000" points="1190.334,-242.2 1190.334,-341.8 1403.4961,-341.8 1403.4961,-242.2 1190.334,-242.2"/>
<text text-anchor="middle" x="1296.915" y="-326.6" font-family="Times,serif" font-size="14.00" fill="#000000">TxnMetadataCacheEntry</text>
<polyline fill="none" stroke="#000000" points="1190.334,-319.8 1403.4961,-319.8 "/>
<text text-anchor="start" x="1198.334" y="-304.6" font-family="Times,serif" font-size="14.00" fill="#000000">coordinatorEpoch Int </text>
<polyline fill="none" stroke="#000000" points="1190.334,-297.8 1403.4961,-297.8 "/>
<text text-anchor="start" x="1198.334" y="-282.6" font-family="Times,serif" font-size="14.00" fill="#000000">metadataPerTransactionalId </text>
<text text-anchor="start" x="1198.334" y="-268.6" font-family="Times,serif" font-size="14.00" fill="#000000"> Pool[String, TransactionMetadata]</text>
<text text-anchor="middle" x="1296.915" y="-254.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 事务ID到事务metadata映射</text>
</g>
<!-- transactionMetadataCache&#45;&gt;TxnMetadataCacheEntry -->
<g id="edge4" class="edge">
<title>transactionMetadataCache:entry&#45;&gt;TxnMetadataCacheEntry</title>
<path fill="none" stroke="#000000" d="M1154.0308,-213C1167.3476,-213 1190.1375,-223.6425 1213.6527,-237.1151"/>
<polygon fill="#000000" stroke="#000000" points="1211.9338,-240.1644 1222.3328,-242.1922 1215.4681,-234.1221 1211.9338,-240.1644"/>
</g>
<!-- TxnMetadataCacheEntry&#45;&gt;TransactionMetadata -->
<g id="edge5" class="edge">
<title>TxnMetadataCacheEntry:meta&#45;&gt;TransactionMetadata</title>
<path fill="none" stroke="#000000" d="M1403.915,-270C1471.1049,-270 1514.2271,-335.8707 1539.6262,-396.1716"/>
<polygon fill="#000000" stroke="#000000" points="1536.5326,-397.8544 1543.5514,-405.7908 1543.0138,-395.2096 1536.5326,-397.8544"/>
</g>
<!-- partitionFor -->
<g id="node12" class="node">
<title>partitionFor</title>
<polygon fill="none" stroke="#000000" points="908.8926,-275.2 908.8926,-352.8 1137.1689,-352.8 1137.1689,-275.2 908.8926,-275.2"/>
<text text-anchor="middle" x="1023.0308" y="-337.6" font-family="Times,serif" font-size="14.00" fill="#000000">partitionFor</text>
<polyline fill="none" stroke="#000000" points="908.8926,-330.8 1137.1689,-330.8 "/>
<text text-anchor="start" x="916.8926" y="-315.6" font-family="Times,serif" font-size="14.00" fill="#000000">Utils.abs(transactionalId.hashCode)%</text>
<text text-anchor="start" x="916.8926" y="-301.6" font-family="Times,serif" font-size="14.00" fill="#000000"> transactionTopicPartitionCount </text>
<text text-anchor="start" x="916.8926" y="-287.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 根据事务id获取对应的partition</text>
</g>
<!-- updateCacheCallback&#45;&gt;completeTransitionTo -->
<g id="edge12" class="edge">
<title>updateCacheCallback&#45;&gt;completeTransitionTo</title>
<path fill="none" stroke="#000000" d="M1092.1094,-147.6748C1114.9955,-153.9324 1138.6099,-164.6549 1154.334,-183 1215.9599,-254.8983 1150.6812,-307.0072 1190.334,-393 1202.3048,-418.9604 1220.9242,-443.9589 1239.272,-464.8669"/>
<polygon fill="#000000" stroke="#000000" points="1236.7253,-467.2694 1246.0066,-472.379 1241.9374,-462.5967 1236.7253,-467.2694"/>
</g>
<!-- sendTxnMarkersCallback -->
<g id="node16" class="node">
<title>sendTxnMarkersCallback</title>
<polygon fill="#f38181" stroke="#000000" points="1203.3804,-104.8002 1203.3804,-213.1998 1390.4497,-213.1998 1390.4497,-104.8002 1203.3804,-104.8002"/>
<text text-anchor="middle" x="1296.915" y="-197.9998" font-family="Times,serif" font-size="14.00" fill="#000000">sendTxnMarkersCallback</text>
<polyline fill="none" stroke="#000000" points="1203.3804,-191.1998 1390.4497,-191.1998 "/>
<text text-anchor="start" x="1211.3804" y="-175.9998" font-family="Times,serif" font-size="14.00" fill="#000000">coordinator开始向各个broker</text>
<text text-anchor="start" x="1211.3804" y="-156.3999" font-family="Times,serif" font-size="14.00" fill="#000000"> 发送txnMark请求</text>
<text text-anchor="start" x="1211.3804" y="-136.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 不断尝试直到成功</text>
<text text-anchor="start" x="1211.3804" y="-117.2001" font-family="Times,serif" font-size="14.00" fill="#000000"> 并将状态设置为Complete</text>
</g>
<!-- updateCacheCallback&#45;&gt;sendTxnMarkersCallback -->
<g id="edge13" class="edge">
<title>updateCacheCallback&#45;&gt;sendTxnMarkersCallback</title>
<path fill="none" stroke="#000000" d="M1092.1433,-144.0468C1122.6609,-146.2753 1159.1911,-148.9429 1192.8934,-151.404"/>
<polygon fill="#000000" stroke="#000000" points="1193.0238,-154.9227 1203.2522,-152.1604 1193.5337,-147.9413 1193.0238,-154.9227"/>
</g>
<!-- getAndMaybeAddTransactionState&#45;&gt;transactionMetadataCache -->
<g id="edge7" class="edge">
<title>getAndMaybeAddTransactionState&#45;&gt;transactionMetadataCache</title>
<path fill="none" stroke="#000000" d="M786.2974,-295.8954C821.3434,-285.252 866.8297,-271.4379 908.5522,-258.7669"/>
<polygon fill="#000000" stroke="#000000" points="909.6755,-262.0837 918.2269,-255.8287 907.6413,-255.3857 909.6755,-262.0837"/>
</g>
<!-- getAndMaybeAddTransactionState&#45;&gt;partitionFor -->
<g id="edge8" class="edge">
<title>getAndMaybeAddTransactionState&#45;&gt;partitionFor</title>
<path fill="none" stroke="#000000" d="M833.6717,-314C854.711,-314 876.9537,-314 898.5107,-314"/>
<polygon fill="#000000" stroke="#000000" points="898.6937,-317.5001 908.6937,-314 898.6936,-310.5001 898.6937,-317.5001"/>
</g>
<!-- handleEndTransaction -->
<g id="node17" class="node">
<title>handleEndTransaction</title>
<polygon fill="none" stroke="#000000" points="337.2254,-725 195.2902,-725 195.2902,-689 337.2254,-689 337.2254,-725"/>
<text text-anchor="middle" x="266.2578" y="-702.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleEndTransaction</text>
</g>
<!-- handleEndTransaction&#45;&gt;prepareAbortOrCommit -->
<g id="edge14" class="edge">
<title>handleEndTransaction&#45;&gt;prepareAbortOrCommit</title>
<path fill="none" stroke="#000000" d="M300.8208,-688.9499C325.7549,-675.9283 360.3825,-657.8445 391.6035,-641.5397"/>
<polygon fill="#000000" stroke="#000000" points="393.4932,-644.5014 400.737,-636.7698 390.2527,-638.2966 393.4932,-644.5014"/>
</g>
<!-- handleEndTransaction&#45;&gt;appendTransactionToLog -->
<g id="edge15" class="edge">
<title>handleEndTransaction&#45;&gt;appendTransactionToLog</title>
<path fill="none" stroke="#000000" d="M266.9254,-688.9081C269.8809,-628.0998 285.4754,-427.0447 364.9912,-287 377.2188,-265.4646 395.5477,-245.6224 413.3295,-229.4465"/>
<polygon fill="#000000" stroke="#000000" points="415.7317,-231.9943 420.8974,-222.7441 411.0907,-226.7539 415.7317,-231.9943"/>
</g>
<!-- handleEndTransaction&#45;&gt;getTransactionState -->
<g id="edge16" class="edge">
<title>handleEndTransaction&#45;&gt;getTransactionState</title>
<path fill="none" stroke="#000000" d="M267.8935,-688.8851C273.3065,-637.6933 294.5177,-489.4255 364.9912,-393 376.9427,-376.6473 393.7634,-362.6549 410.3204,-351.4728"/>
<polygon fill="#000000" stroke="#000000" points="412.4466,-354.2654 418.9275,-345.8839 408.6344,-348.3945 412.4466,-354.2654"/>
</g>
<!-- addTxnMarkersToSend -->
<g id="node18" class="node">
<title>addTxnMarkersToSend</title>
<polygon fill="none" stroke="#000000" points="541.3037,-725 393.3271,-725 393.3271,-689 541.3037,-689 541.3037,-725"/>
<text text-anchor="middle" x="467.3154" y="-702.8" font-family="Times,serif" font-size="14.00" fill="#000000">addTxnMarkersToSend</text>
</g>
<!-- handleEndTransaction&#45;&gt;addTxnMarkersToSend -->
<g id="edge17" class="edge">
<title>handleEndTransaction&#45;&gt;addTxnMarkersToSend</title>
<path fill="none" stroke="#000000" d="M337.1432,-707C352.0748,-707 367.9646,-707 383.3248,-707"/>
<polygon fill="#000000" stroke="#000000" points="383.3267,-710.5001 393.3267,-707 383.3267,-703.5001 383.3267,-710.5001"/>
</g>
<!-- handleEndTxnRequest -->
<g id="node19" class="node">
<title>handleEndTxnRequest</title>
<polygon fill="none" stroke="#000000" points="159.2874,-725 16.237,-725 16.237,-689 159.2874,-689 159.2874,-725"/>
<text text-anchor="middle" x="87.7622" y="-702.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleEndTxnRequest</text>
</g>
<!-- handleEndTxnRequest&#45;&gt;handleEndTransaction -->
<g id="edge18" class="edge">
<title>handleEndTxnRequest&#45;&gt;handleEndTransaction</title>
<path fill="none" stroke="#000000" d="M159.3347,-707C167.8395,-707 176.5674,-707 185.1925,-707"/>
<polygon fill="#000000" stroke="#000000" points="185.2509,-710.5001 195.2509,-707 185.2508,-703.5001 185.2509,-710.5001"/>
</g>
</g>
</svg>
