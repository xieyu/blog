<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: txn_write_marks Pages: 1 -->
<svg width="1796pt" height="460pt"
 viewBox="0.00 0.00 1795.64 460.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 456)">
<title>txn_write_marks</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-456 1791.6445,-456 1791.6445,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ReplicaManager</title>
<path fill="none" stroke="#000000" d="M274.9043,-216C274.9043,-216 398.208,-216 398.208,-216 404.208,-216 410.208,-222 410.208,-228 410.208,-228 410.208,-284 410.208,-284 410.208,-290 404.208,-296 398.208,-296 398.208,-296 274.9043,-296 274.9043,-296 268.9043,-296 262.9043,-290 262.9043,-284 262.9043,-284 262.9043,-228 262.9043,-228 262.9043,-222 268.9043,-216 274.9043,-216"/>
<text text-anchor="middle" x="336.5562" y="-276" font-family="Times,serif" font-size="20.00" fill="#000000">ReplicaManager</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_groupCoordinator</title>
<path fill="none" stroke="#000000" d="M681.9141,-291C681.9141,-291 1767.6445,-291 1767.6445,-291 1773.6445,-291 1779.6445,-297 1779.6445,-303 1779.6445,-303 1779.6445,-432 1779.6445,-432 1779.6445,-438 1773.6445,-444 1767.6445,-444 1767.6445,-444 681.9141,-444 681.9141,-444 675.9141,-444 669.9141,-438 669.9141,-432 669.9141,-432 669.9141,-303 669.9141,-303 669.9141,-297 675.9141,-291 681.9141,-291"/>
<text text-anchor="middle" x="1224.7793" y="-424" font-family="Times,serif" font-size="20.00" fill="#000000">groupCoordinator</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_MemoryRecord</title>
<path fill="none" stroke="#000000" d="M254.9365,-8C254.9365,-8 1256.3662,-8 1256.3662,-8 1262.3662,-8 1268.3662,-14 1268.3662,-20 1268.3662,-20 1268.3662,-196 1268.3662,-196 1268.3662,-202 1262.3662,-208 1256.3662,-208 1256.3662,-208 254.9365,-208 254.9365,-208 248.9365,-208 242.9365,-202 242.9365,-196 242.9365,-196 242.9365,-20 242.9365,-20 242.9365,-14 248.9365,-8 254.9365,-8"/>
<text text-anchor="middle" x="755.6514" y="-188" font-family="Times,serif" font-size="20.00" fill="#000000">MemoryRecord</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_KafkaApi</title>
<path fill="none" stroke="#000000" d="M20,-304C20,-304 637.9141,-304 637.9141,-304 643.9141,-304 649.9141,-310 649.9141,-316 649.9141,-316 649.9141,-372 649.9141,-372 649.9141,-378 643.9141,-384 637.9141,-384 637.9141,-384 20,-384 20,-384 14,-384 8,-378 8,-372 8,-372 8,-316 8,-316 8,-310 14,-304 20,-304"/>
<text text-anchor="middle" x="328.957" y="-364" font-family="Times,serif" font-size="20.00" fill="#000000">KafkaApi</text>
</g>
<!-- appendRecords -->
<g id="node1" class="node">
<title>appendRecords</title>
<polygon fill="none" stroke="#000000" points="387.3603,-260 284.752,-260 284.752,-224 387.3603,-224 387.3603,-260"/>
<text text-anchor="middle" x="336.0562" y="-237.8" font-family="Times,serif" font-size="14.00" fill="#000000">appendRecords</text>
</g>
<!-- maybeSendResponseCallback -->
<g id="node13" class="node">
<title>maybeSendResponseCallback</title>
<polygon fill="none" stroke="#000000" points="641.7834,-348 457.3065,-348 457.3065,-312 641.7834,-312 641.7834,-348"/>
<text text-anchor="middle" x="549.5449" y="-325.8" font-family="Times,serif" font-size="14.00" fill="#000000">maybeSendResponseCallback</text>
</g>
<!-- appendRecords&#45;&gt;maybeSendResponseCallback -->
<g id="edge12" class="edge">
<title>appendRecords&#45;&gt;maybeSendResponseCallback</title>
<path fill="none" stroke="#000000" d="M379.774,-260.0205C413.4809,-273.9144 460.2507,-293.193 496.1676,-307.9979"/>
<polygon fill="#000000" stroke="#000000" points="494.94,-311.2775 505.5193,-311.8526 497.6077,-304.8058 494.94,-311.2775"/>
</g>
<!-- scheduleHandleTxnCompletion -->
<g id="node2" class="node">
<title>scheduleHandleTxnCompletion</title>
<polygon fill="none" stroke="#000000" points="677.9141,-305.2 677.9141,-354.8 871.9834,-354.8 871.9834,-305.2 677.9141,-305.2"/>
<text text-anchor="middle" x="774.9487" y="-339.6" font-family="Times,serif" font-size="14.00" fill="#000000">scheduleHandleTxnCompletion</text>
<polyline fill="none" stroke="#000000" points="677.9141,-332.8 871.9834,-332.8 "/>
<text text-anchor="start" x="685.9141" y="-317.6" font-family="Times,serif" font-size="14.00" fill="#000000">将提交的事务对group可见</text>
</g>
<!-- handleTxnCompletion -->
<g id="node3" class="node">
<title>handleTxnCompletion</title>
<polygon fill="none" stroke="#000000" points="1155.1543,-348 1013.1953,-348 1013.1953,-312 1155.1543,-312 1155.1543,-348"/>
<text text-anchor="middle" x="1084.1748" y="-325.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleTxnCompletion</text>
</g>
<!-- scheduleHandleTxnCompletion&#45;&gt;handleTxnCompletion -->
<g id="edge1" class="edge">
<title>scheduleHandleTxnCompletion&#45;&gt;handleTxnCompletion</title>
<path fill="none" stroke="#000000" d="M872.3654,-330C914.2192,-330 962.5824,-330 1002.5194,-330"/>
<polygon fill="#000000" stroke="#000000" points="1002.7474,-333.5001 1012.7474,-330 1002.7474,-326.5001 1002.7474,-333.5001"/>
</g>
<!-- completePendingTxnOffsetCommit -->
<g id="node4" class="node">
<title>completePendingTxnOffsetCommit</title>
<polygon fill="none" stroke="#000000" points="1512.9496,-344 1296.1715,-344 1296.1715,-308 1512.9496,-308 1512.9496,-344"/>
<text text-anchor="middle" x="1404.5605" y="-321.8" font-family="Times,serif" font-size="14.00" fill="#000000">completePendingTxnOffsetCommit</text>
</g>
<!-- handleTxnCompletion&#45;&gt;completePendingTxnOffsetCommit -->
<g id="edge2" class="edge">
<title>handleTxnCompletion&#45;&gt;completePendingTxnOffsetCommit</title>
<path fill="none" stroke="#000000" d="M1155.2788,-329.1123C1193.675,-328.6329 1242.0834,-328.0285 1286.0047,-327.4802"/>
<polygon fill="#000000" stroke="#000000" points="1286.2243,-330.9778 1296.1798,-327.3531 1286.1369,-323.9783 1286.2243,-330.9778"/>
</g>
<!-- removeProducerGroup -->
<g id="node5" class="node">
<title>removeProducerGroup</title>
<polygon fill="none" stroke="#000000" points="1476.8509,-398 1332.2702,-398 1332.2702,-362 1476.8509,-362 1476.8509,-398"/>
<text text-anchor="middle" x="1404.5605" y="-375.8" font-family="Times,serif" font-size="14.00" fill="#000000">removeProducerGroup</text>
</g>
<!-- handleTxnCompletion&#45;&gt;removeProducerGroup -->
<g id="edge3" class="edge">
<title>handleTxnCompletion&#45;&gt;removeProducerGroup</title>
<path fill="none" stroke="#000000" d="M1155.2788,-341.0966C1204.6218,-348.7972 1270.4999,-359.0782 1322.1405,-367.1374"/>
<polygon fill="#000000" stroke="#000000" points="1321.8495,-370.6342 1332.2696,-368.7181 1322.9289,-363.718 1321.8495,-370.6342"/>
</g>
<!-- pendingTransactionalOffsetCommits -->
<g id="node6" class="node">
<title>pendingTransactionalOffsetCommits</title>
<polygon fill="#95e1d3" stroke="#000000" points="1548.7549,-300 1548.7549,-344 1771.6445,-344 1771.6445,-300 1548.7549,-300"/>
<text text-anchor="middle" x="1660.1997" y="-328.8" font-family="Times,serif" font-size="14.00" fill="#000000">pendingTransactionalOffsetCommits</text>
<polyline fill="none" stroke="#000000" points="1548.7549,-322 1771.6445,-322 "/>
<text text-anchor="start" x="1556.7549" y="-306.8" font-family="Times,serif" font-size="14.00" fill="#000000">field </text>
</g>
<!-- completePendingTxnOffsetCommit&#45;&gt;pendingTransactionalOffsetCommits -->
<g id="edge4" class="edge">
<title>completePendingTxnOffsetCommit&#45;&gt;pendingTransactionalOffsetCommits</title>
<path fill="none" stroke="#000000" d="M1512.9746,-324.3036C1521.2948,-324.1735 1529.7273,-324.0415 1538.1266,-323.9101"/>
<polygon fill="#000000" stroke="#000000" points="1538.4018,-327.4063 1548.3458,-323.7502 1538.2922,-320.4072 1538.4018,-327.4063"/>
</g>
<!-- offsets -->
<g id="node7" class="node">
<title>offsets</title>
<polygon fill="#95e1d3" stroke="#000000" points="1633.1997,-363 1633.1997,-407 1687.1997,-407 1687.1997,-363 1633.1997,-363"/>
<text text-anchor="middle" x="1659.7388" y="-391.8" font-family="Times,serif" font-size="14.00" fill="#000000">offsets</text>
<polyline fill="none" stroke="#000000" points="1633.1997,-385 1686.2778,-385 "/>
<text text-anchor="start" x="1641.1997" y="-369.8" font-family="Times,serif" font-size="14.00" fill="#000000">field </text>
</g>
<!-- completePendingTxnOffsetCommit&#45;&gt;offsets -->
<g id="edge5" class="edge">
<title>completePendingTxnOffsetCommit&#45;&gt;offsets</title>
<path fill="none" stroke="#000000" d="M1482.6498,-344.0225C1529.3566,-354.8022 1586.5593,-368.0042 1623.188,-376.4579"/>
<polygon fill="#000000" stroke="#000000" points="1622.4169,-379.8719 1632.9478,-378.7104 1623.9911,-373.0512 1622.4169,-379.8719"/>
</g>
<!-- withEndTransactionMarker -->
<g id="node8" class="node">
<title>withEndTransactionMarker</title>
<polygon fill="none" stroke="#000000" points="421.2956,-168 250.8167,-168 250.8167,-132 421.2956,-132 421.2956,-168"/>
<text text-anchor="middle" x="336.0562" y="-145.8" font-family="Times,serif" font-size="14.00" fill="#000000">withEndTransactionMarker</text>
</g>
<!-- writeEndTransactionalMarker -->
<g id="node9" class="node">
<title>writeEndTransactionalMarker</title>
<polygon fill="none" stroke="#000000" points="457.4355,-122.2 457.4355,-171.8 641.6543,-171.8 641.6543,-122.2 457.4355,-122.2"/>
<text text-anchor="middle" x="549.5449" y="-156.6" font-family="Times,serif" font-size="14.00" fill="#000000">writeEndTransactionalMarker</text>
<polyline fill="none" stroke="#000000" points="457.4355,-149.8 641.6543,-149.8 "/>
<text text-anchor="middle" x="549.5449" y="-134.6" font-family="Times,serif" font-size="14.00" fill="#000000">向记录中写入特殊的marker</text>
</g>
<!-- withEndTransactionMarker&#45;&gt;writeEndTransactionalMarker -->
<g id="edge6" class="edge">
<title>withEndTransactionMarker&#45;&gt;writeEndTransactionalMarker</title>
<path fill="none" stroke="#000000" d="M421.353,-148.8014C429.8677,-148.6817 438.5723,-148.5594 447.2378,-148.4376"/>
<polygon fill="#000000" stroke="#000000" points="447.4289,-151.9354 457.3787,-148.2951 447.3305,-144.9361 447.4289,-151.9354"/>
</g>
<!-- appendEndTxnMarker -->
<g id="node10" class="node">
<title>appendEndTxnMarker</title>
<polygon fill="none" stroke="#000000" points="846.1804,-161 703.717,-161 703.717,-125 846.1804,-125 846.1804,-161"/>
<text text-anchor="middle" x="774.9487" y="-138.8" font-family="Times,serif" font-size="14.00" fill="#000000">appendEndTxnMarker</text>
</g>
<!-- writeEndTransactionalMarker&#45;&gt;appendEndTxnMarker -->
<g id="edge7" class="edge">
<title>writeEndTransactionalMarker&#45;&gt;appendEndTxnMarker</title>
<path fill="none" stroke="#000000" d="M641.8756,-145.3615C658.891,-145.0596 676.5471,-144.7462 693.2224,-144.4503"/>
<polygon fill="#000000" stroke="#000000" points="693.5276,-147.9455 703.4639,-144.2686 693.4033,-140.9466 693.5276,-147.9455"/>
</g>
<!-- EndTransactionMarker -->
<g id="node11" class="node">
<title>EndTransactionMarker</title>
<polygon fill="#95e1d3" stroke="#000000" points="907.9834,-17 907.9834,-171 1260.3662,-171 1260.3662,-17 907.9834,-17"/>
<text text-anchor="middle" x="1084.1748" y="-155.8" font-family="Times,serif" font-size="14.00" fill="#000000">EndTransactionMarker</text>
<polyline fill="none" stroke="#000000" points="907.9834,-149 1260.3662,-149 "/>
<text text-anchor="middle" x="1084.1748" y="-133.8" font-family="Times,serif" font-size="14.00" fill="#000000">short CURRENT_END_TXN_MARKER_VERSION</text>
<polyline fill="none" stroke="#000000" points="907.9834,-127 1260.3662,-127 "/>
<text text-anchor="middle" x="1084.1748" y="-111.8" font-family="Times,serif" font-size="14.00" fill="#000000">Schema END_TXN_MARKER_SCHEMA_VERSION_V0</text>
<polyline fill="none" stroke="#000000" points="907.9834,-105 1260.3662,-105 "/>
<text text-anchor="middle" x="1084.1748" y="-89.8" font-family="Times,serif" font-size="14.00" fill="#000000">CURRENT_END_TXN_MARKER_VALUE_SIZE</text>
<polyline fill="none" stroke="#000000" points="907.9834,-83 1260.3662,-83 "/>
<text text-anchor="middle" x="1084.1748" y="-67.8" font-family="Times,serif" font-size="14.00" fill="#000000">CURRENT_END_TXN_SCHEMA_RECORD_SIZE</text>
<polyline fill="none" stroke="#000000" points="907.9834,-61 1260.3662,-61 "/>
<text text-anchor="middle" x="1084.1748" y="-45.8" font-family="Times,serif" font-size="14.00" fill="#000000">ControlRecordType type</text>
<polyline fill="none" stroke="#000000" points="907.9834,-39 1260.3662,-39 "/>
<text text-anchor="middle" x="1084.1748" y="-23.8" font-family="Times,serif" font-size="14.00" fill="#000000">coordinatorEpoch</text>
</g>
<!-- appendEndTxnMarker&#45;&gt;EndTransactionMarker -->
<g id="edge8" class="edge">
<title>appendEndTxnMarker&#45;&gt;EndTransactionMarker</title>
<path fill="none" stroke="#000000" d="M846.2797,-131.6969C862.0816,-129.1929 879.5377,-126.4268 897.6025,-123.5643"/>
<polygon fill="#000000" stroke="#000000" points="898.3655,-126.9871 907.6945,-121.9651 897.2699,-120.0734 898.3655,-126.9871"/>
</g>
<!-- handleWriteTxnMarkersRequest -->
<g id="node12" class="node">
<title>handleWriteTxnMarkersRequest</title>
<polygon fill="none" stroke="#000000" points="214.9048,-348 16.0317,-348 16.0317,-312 214.9048,-312 214.9048,-348"/>
<text text-anchor="middle" x="115.4683" y="-325.8" font-family="Times,serif" font-size="14.00" fill="#000000">handleWriteTxnMarkersRequest</text>
</g>
<!-- handleWriteTxnMarkersRequest&#45;&gt;appendRecords -->
<g id="edge9" class="edge">
<title>handleWriteTxnMarkersRequest&#45;&gt;appendRecords</title>
<path fill="none" stroke="#000000" d="M160.6398,-311.9795C195.4676,-298.0856 243.7927,-278.807 280.9038,-264.0021"/>
<polygon fill="#000000" stroke="#000000" points="282.5752,-267.1037 290.5665,-260.1474 279.9814,-260.6019 282.5752,-267.1037"/>
</g>
<!-- handleWriteTxnMarkersRequest&#45;&gt;withEndTransactionMarker -->
<g id="edge10" class="edge">
<title>handleWriteTxnMarkersRequest&#45;&gt;withEndTransactionMarker</title>
<path fill="none" stroke="#000000" d="M133.2246,-311.8426C157.1346,-287.8046 201.4773,-244.6529 242.9365,-212 260.2175,-198.3897 280.4341,-184.6869 297.6064,-173.6374"/>
<polygon fill="#000000" stroke="#000000" points="299.7223,-176.4394 306.2772,-168.1157 295.9623,-170.535 299.7223,-176.4394"/>
</g>
<!-- handleWriteTxnMarkersRequest&#45;&gt;EndTransactionMarker -->
<g id="edge11" class="edge">
<title>handleWriteTxnMarkersRequest&#45;&gt;EndTransactionMarker</title>
<path fill="none" stroke="#000000" d="M120.3794,-311.7222C132.7733,-269.6358 169.6796,-166.1931 242.9365,-123 442.4102,-5.3881 717.254,-22.2646 897.7361,-52.1993"/>
<polygon fill="#000000" stroke="#000000" points="897.1581,-55.6512 907.6011,-53.8641 898.323,-48.7487 897.1581,-55.6512"/>
</g>
<!-- maybeSendResponseCallback&#45;&gt;scheduleHandleTxnCompletion -->
<g id="edge13" class="edge">
<title>maybeSendResponseCallback&#45;&gt;scheduleHandleTxnCompletion</title>
<path fill="none" stroke="#000000" d="M641.8756,-330C650.352,-330 658.9873,-330 667.5812,-330"/>
<polygon fill="#000000" stroke="#000000" points="667.6387,-333.5001 677.6386,-330 667.6386,-326.5001 667.6387,-333.5001"/>
</g>
</g>
</svg>
