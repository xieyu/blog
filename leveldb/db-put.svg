<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: db_put Pages: 1 -->
<svg width="2902pt" height="1523pt"
 viewBox="0.00 0.00 2901.63 1523.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1519)">
<title>db_put</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1519 2897.6328,-1519 2897.6328,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_SkipList</title>
<path fill="none" stroke="#000000" d="M1578.5264,-8C1578.5264,-8 1724.9814,-8 1724.9814,-8 1730.9814,-8 1736.9814,-14 1736.9814,-20 1736.9814,-20 1736.9814,-90 1736.9814,-90 1736.9814,-96 1730.9814,-102 1724.9814,-102 1724.9814,-102 1578.5264,-102 1578.5264,-102 1572.5264,-102 1566.5264,-96 1566.5264,-90 1566.5264,-90 1566.5264,-20 1566.5264,-20 1566.5264,-14 1572.5264,-8 1578.5264,-8"/>
<text text-anchor="middle" x="1651.7539" y="-82" font-family="Times,serif" font-size="20.00" fill="#000000">SkipList</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_MemTable</title>
<path fill="none" stroke="#000000" d="M1444.5264,-110C1444.5264,-110 1720.3125,-110 1720.3125,-110 1726.3125,-110 1732.3125,-116 1732.3125,-122 1732.3125,-122 1732.3125,-474 1732.3125,-474 1732.3125,-480 1726.3125,-486 1720.3125,-486 1720.3125,-486 1444.5264,-486 1444.5264,-486 1438.5264,-486 1432.5264,-480 1432.5264,-474 1432.5264,-474 1432.5264,-122 1432.5264,-122 1432.5264,-116 1438.5264,-110 1444.5264,-110"/>
<text text-anchor="middle" x="1582.4194" y="-466" font-family="Times,serif" font-size="20.00" fill="#000000">MemTable</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_VersionSet</title>
<path fill="none" stroke="#000000" d="M2319.751,-136C2319.751,-136 2873.6328,-136 2873.6328,-136 2879.6328,-136 2885.6328,-142 2885.6328,-148 2885.6328,-148 2885.6328,-474 2885.6328,-474 2885.6328,-480 2879.6328,-486 2873.6328,-486 2873.6328,-486 2319.751,-486 2319.751,-486 2313.751,-486 2307.751,-480 2307.751,-474 2307.751,-474 2307.751,-148 2307.751,-148 2307.751,-142 2313.751,-136 2319.751,-136"/>
<text text-anchor="middle" x="2596.6919" y="-466" font-family="Times,serif" font-size="20.00" fill="#000000">VersionSet</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_WritableFile</title>
<polygon fill="none" stroke="#000000" points="953.4072,-388 953.4072,-470 1169.7861,-470 1169.7861,-388 953.4072,-388"/>
<text text-anchor="middle" x="1061.5967" y="-450" font-family="Times,serif" font-size="20.00" fill="#000000">WritableFile</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_LogWriter</title>
<path fill="none" stroke="#000000" d="M668.2568,-372C668.2568,-372 833.7568,-372 833.7568,-372 839.7568,-372 845.7568,-378 845.7568,-384 845.7568,-384 845.7568,-474 845.7568,-474 845.7568,-480 839.7568,-486 833.7568,-486 833.7568,-486 668.2568,-486 668.2568,-486 662.2568,-486 656.2568,-480 656.2568,-474 656.2568,-474 656.2568,-384 656.2568,-384 656.2568,-378 662.2568,-372 668.2568,-372"/>
<text text-anchor="middle" x="751.0068" y="-466" font-family="Times,serif" font-size="20.00" fill="#000000">LogWriter</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_MemTableInserter</title>
<path fill="none" stroke="#000000" d="M1210.3047,-310C1210.3047,-310 1349.3047,-310 1349.3047,-310 1355.3047,-310 1361.3047,-316 1361.3047,-322 1361.3047,-322 1361.3047,-435 1361.3047,-435 1361.3047,-441 1355.3047,-447 1349.3047,-447 1349.3047,-447 1210.3047,-447 1210.3047,-447 1204.3047,-447 1198.3047,-441 1198.3047,-435 1198.3047,-435 1198.3047,-322 1198.3047,-322 1198.3047,-316 1204.3047,-310 1210.3047,-310"/>
<text text-anchor="middle" x="1279.8047" y="-427" font-family="Times,serif" font-size="20.00" fill="#000000">MemTableInserter</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_DBImpl</title>
<path fill="none" stroke="#000000" d="M20,-494C20,-494 2845.0845,-494 2845.0845,-494 2851.0845,-494 2857.0845,-500 2857.0845,-506 2857.0845,-506 2857.0845,-1495 2857.0845,-1495 2857.0845,-1501 2851.0845,-1507 2845.0845,-1507 2845.0845,-1507 20,-1507 20,-1507 14,-1507 8,-1501 8,-1495 8,-1495 8,-506 8,-506 8,-500 14,-494 20,-494"/>
<text text-anchor="middle" x="1432.5422" y="-1487" font-family="Times,serif" font-size="20.00" fill="#000000">DBImpl</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_MemTable</title>
<path fill="none" stroke="#000000" d="M1210.083,-943C1210.083,-943 2634.3281,-943 2634.3281,-943 2640.3281,-943 2646.3281,-949 2646.3281,-955 2646.3281,-955 2646.3281,-1025 2646.3281,-1025 2646.3281,-1031 2640.3281,-1037 2634.3281,-1037 2634.3281,-1037 1210.083,-1037 1210.083,-1037 1204.083,-1037 1198.083,-1031 1198.083,-1025 1198.083,-1025 1198.083,-955 1198.083,-955 1198.083,-949 1204.083,-943 1210.083,-943"/>
<text text-anchor="middle" x="1922.2056" y="-1017" font-family="Times,serif" font-size="20.00" fill="#000000">MemTable</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_background_work_finished</title>
<path fill="none" stroke="#000000" d="M1400.5264,-1357C1400.5264,-1357 2238.0029,-1357 2238.0029,-1357 2244.0029,-1357 2250.0029,-1363 2250.0029,-1369 2250.0029,-1369 2250.0029,-1459 2250.0029,-1459 2250.0029,-1465 2244.0029,-1471 2238.0029,-1471 2238.0029,-1471 1400.5264,-1471 1400.5264,-1471 1394.5264,-1471 1388.5264,-1465 1388.5264,-1459 1388.5264,-1459 1388.5264,-1369 1388.5264,-1369 1388.5264,-1363 1394.5264,-1357 1400.5264,-1357"/>
<text text-anchor="middle" x="1819.2646" y="-1451" font-family="Times,serif" font-size="20.00" fill="#000000">background_work_finished</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_writers</title>
<path fill="none" stroke="#000000" d="M663.5688,-514C663.5688,-514 1167.083,-514 1167.083,-514 1173.083,-514 1179.083,-520 1179.083,-526 1179.083,-526 1179.083,-993 1179.083,-993 1179.083,-999 1173.083,-1005 1167.083,-1005 1167.083,-1005 663.5688,-1005 663.5688,-1005 657.5688,-1005 651.5688,-999 651.5688,-993 651.5688,-993 651.5688,-526 651.5688,-526 651.5688,-520 657.5688,-514 663.5688,-514"/>
<text text-anchor="middle" x="915.3259" y="-985" font-family="Times,serif" font-size="20.00" fill="#000000">writers队列</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_cv</title>
<path fill="none" stroke="#000000" d="M671.5688,-739C671.5688,-739 830.4448,-739 830.4448,-739 836.4448,-739 842.4448,-745 842.4448,-751 842.4448,-751 842.4448,-949 842.4448,-949 842.4448,-955 836.4448,-961 830.4448,-961 830.4448,-961 671.5688,-961 671.5688,-961 665.5688,-961 659.5688,-955 659.5688,-949 659.5688,-949 659.5688,-751 659.5688,-751 659.5688,-745 665.5688,-739 671.5688,-739"/>
<text text-anchor="middle" x="751.0068" y="-941" font-family="Times,serif" font-size="20.00" fill="#000000">ConditionVar</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_Sequnce</title>
<path fill="none" stroke="#000000" d="M674.3032,-1073C674.3032,-1073 827.7104,-1073 827.7104,-1073 833.7104,-1073 839.7104,-1079 839.7104,-1085 839.7104,-1085 839.7104,-1303 839.7104,-1303 839.7104,-1309 833.7104,-1315 827.7104,-1315 827.7104,-1315 674.3032,-1315 674.3032,-1315 668.3032,-1315 662.3032,-1309 662.3032,-1303 662.3032,-1303 662.3032,-1085 662.3032,-1085 662.3032,-1079 668.3032,-1073 674.3032,-1073"/>
<text text-anchor="middle" x="751.0068" y="-1295" font-family="Times,serif" font-size="20.00" fill="#000000">Sequnce</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_BgThread</title>
<path fill="none" stroke="#000000" d="M1234.8701,-1045C1234.8701,-1045 2837.0845,-1045 2837.0845,-1045 2843.0845,-1045 2849.0845,-1051 2849.0845,-1057 2849.0845,-1057 2849.0845,-1337 2849.0845,-1337 2849.0845,-1343 2843.0845,-1349 2837.0845,-1349 2837.0845,-1349 1234.8701,-1349 1234.8701,-1349 1228.8701,-1349 1222.8701,-1343 1222.8701,-1337 1222.8701,-1337 1222.8701,-1057 1222.8701,-1057 1222.8701,-1051 1228.8701,-1045 1234.8701,-1045"/>
<text text-anchor="middle" x="2035.9773" y="-1329" font-family="Times,serif" font-size="20.00" fill="#000000">后台压缩线程</text>
</g>
<!-- SkipList_Insert -->
<g id="node1" class="node">
<title>SkipList_Insert</title>
<polygon fill="#f38181" stroke="#000000" points="1574.5264,-16.2 1574.5264,-65.8 1728.9814,-65.8 1728.9814,-16.2 1574.5264,-16.2"/>
<text text-anchor="middle" x="1651.7539" y="-50.6" font-family="Times,serif" font-size="14.00" fill="#000000">Insert</text>
<polyline fill="none" stroke="#000000" points="1574.5264,-43.8 1728.9814,-43.8 "/>
<text text-anchor="middle" x="1651.7539" y="-28.6" font-family="Times,serif" font-size="14.00" fill="#000000">将记录插入到skiplist中</text>
</g>
<!-- MemTable_Add -->
<g id="node2" class="node">
<title>MemTable_Add</title>
<polygon fill="none" stroke="#000000" points="1440.5264,-253 1440.5264,-289 1494.5264,-289 1494.5264,-253 1440.5264,-253"/>
<text text-anchor="middle" x="1467.0815" y="-266.8" font-family="Times,serif" font-size="14.00" fill="#000000">Add</text>
</g>
<!-- MemTable_Add&#45;&gt;SkipList_Insert -->
<g id="edge1" class="edge">
<title>MemTable_Add&#45;&gt;SkipList_Insert</title>
<path fill="none" stroke="#000000" d="M1475.5523,-252.9337C1490.3511,-220.9231 1524.318,-153.1807 1566.5264,-106 1577.623,-93.5961 1591.3686,-81.9256 1604.5579,-71.9899"/>
<polygon fill="#000000" stroke="#000000" points="1606.6785,-74.7751 1612.6695,-66.0367 1602.5368,-69.1318 1606.6785,-74.7751"/>
</g>
<!-- Arena_Allocate -->
<g id="node3" class="node">
<title>Arena_Allocate</title>
<polygon fill="none" stroke="#000000" points="1703.8757,-154 1599.6321,-154 1599.6321,-118 1703.8757,-118 1703.8757,-154"/>
<text text-anchor="middle" x="1651.7539" y="-131.8" font-family="Times,serif" font-size="14.00" fill="#000000">Arena_Allocate</text>
</g>
<!-- MemTable_Add&#45;&gt;Arena_Allocate -->
<g id="edge2" class="edge">
<title>MemTable_Add&#45;&gt;Arena_Allocate</title>
<path fill="none" stroke="#000000" d="M1479.7171,-252.5952C1496.5159,-228.6171 1528.9991,-186.9387 1566.5264,-163 1573.6743,-158.4403 1581.6523,-154.5972 1589.7806,-151.3724"/>
<polygon fill="#000000" stroke="#000000" points="1591.166,-154.5924 1599.3509,-147.865 1588.7572,-148.0199 1591.166,-154.5924"/>
</g>
<!-- EncodeFixed64 -->
<g id="node4" class="node">
<title>EncodeFixed64</title>
<polygon fill="none" stroke="#000000" points="1703.6231,-208 1599.8847,-208 1599.8847,-172 1703.6231,-172 1703.6231,-208"/>
<text text-anchor="middle" x="1651.7539" y="-185.8" font-family="Times,serif" font-size="14.00" fill="#000000">EncodeFixed64</text>
</g>
<!-- MemTable_Add&#45;&gt;EncodeFixed64 -->
<g id="edge3" class="edge">
<title>MemTable_Add&#45;&gt;EncodeFixed64</title>
<path fill="none" stroke="#000000" d="M1494.5556,-254.4081C1514.0692,-242.8932 1541.3136,-227.7512 1566.5264,-217 1574.0376,-213.7971 1582.061,-210.7703 1590.0688,-207.9826"/>
<polygon fill="#000000" stroke="#000000" points="1591.4351,-211.2156 1599.7934,-204.7049 1589.1993,-204.5822 1591.4351,-211.2156"/>
</g>
<!-- EncodeVarint32 -->
<g id="node5" class="node">
<title>EncodeVarint32</title>
<polygon fill="none" stroke="#000000" points="1704.9474,-262 1598.5604,-262 1598.5604,-226 1704.9474,-226 1704.9474,-262"/>
<text text-anchor="middle" x="1651.7539" y="-239.8" font-family="Times,serif" font-size="14.00" fill="#000000">EncodeVarint32</text>
</g>
<!-- MemTable_Add&#45;&gt;EncodeVarint32 -->
<g id="edge4" class="edge">
<title>MemTable_Add&#45;&gt;EncodeVarint32</title>
<path fill="none" stroke="#000000" d="M1494.7098,-267.0161C1519.2756,-263.4157 1556.3772,-257.9782 1588.351,-253.2922"/>
<polygon fill="#000000" stroke="#000000" points="1589.1427,-256.7136 1598.5295,-251.8005 1588.1276,-249.7876 1589.1427,-256.7136"/>
</g>
<!-- memcpy -->
<g id="node6" class="node">
<title>memcpy</title>
<polygon fill="none" stroke="#000000" points="1683.9613,-316 1619.5465,-316 1619.5465,-280 1683.9613,-280 1683.9613,-316"/>
<text text-anchor="middle" x="1651.7539" y="-293.8" font-family="Times,serif" font-size="14.00" fill="#000000">memcpy</text>
</g>
<!-- MemTable_Add&#45;&gt;memcpy -->
<g id="edge5" class="edge">
<title>MemTable_Add&#45;&gt;memcpy</title>
<path fill="none" stroke="#000000" d="M1494.7098,-274.9839C1524.9541,-279.4165 1574.1996,-286.6338 1609.4836,-291.805"/>
<polygon fill="#000000" stroke="#000000" points="1609.0908,-295.2847 1619.4927,-293.2719 1610.1059,-288.3587 1609.0908,-295.2847"/>
</g>
<!-- KeyValue -->
<g id="node7" class="node">
<title>KeyValue</title>
<polygon fill="none" stroke="#000000" points="1579.1953,-334.2 1579.1953,-449.8 1724.3125,-449.8 1724.3125,-334.2 1579.1953,-334.2"/>
<text text-anchor="middle" x="1651.7539" y="-434.6" font-family="Times,serif" font-size="14.00" fill="#000000">插入skiplist的buf编码</text>
<polyline fill="none" stroke="#000000" points="1579.1953,-422.2 1724.3125,-422.2 "/>
<text text-anchor="start" x="1587.1953" y="-407" font-family="Times,serif" font-size="14.00" fill="#000000">keySize: varint32</text>
<polyline fill="none" stroke="#000000" points="1579.1953,-400.2 1724.3125,-400.2 "/>
<text text-anchor="start" x="1587.1953" y="-385" font-family="Times,serif" font-size="14.00" fill="#000000">keyBytes</text>
<polyline fill="none" stroke="#000000" points="1579.1953,-378.2 1724.3125,-378.2 "/>
<text text-anchor="start" x="1587.1953" y="-363" font-family="Times,serif" font-size="14.00" fill="#000000">valueSize: varint32</text>
<polyline fill="none" stroke="#000000" points="1579.1953,-356.2 1724.3125,-356.2 "/>
<text text-anchor="start" x="1587.1953" y="-341" font-family="Times,serif" font-size="14.00" fill="#000000">value bytes</text>
</g>
<!-- MemTable_Add&#45;&gt;KeyValue -->
<g id="edge6" class="edge">
<title>MemTable_Add&#45;&gt;KeyValue</title>
<path fill="none" stroke="#000000" d="M1494.7098,-288.854C1514.8466,-302.0798 1543.4066,-320.8378 1570.6608,-338.7383"/>
<polygon fill="#000000" stroke="#000000" points="1568.7865,-341.6947 1579.0663,-344.259 1572.6293,-335.8438 1568.7865,-341.6947"/>
</g>
<!-- PickLevelForMemTableOutput -->
<g id="node8" class="node">
<title>PickLevelForMemTableOutput</title>
<polygon fill="none" stroke="#000000" points="2877.4034,-450 2686.3222,-450 2686.3222,-414 2877.4034,-414 2877.4034,-450"/>
<text text-anchor="middle" x="2781.8628" y="-427.8" font-family="Times,serif" font-size="14.00" fill="#000000">PickLevelForMemTableOutput</text>
</g>
<!-- OverlapInLevel -->
<g id="node9" class="node">
<title>OverlapInLevel</title>
<polygon fill="none" stroke="#000000" points="2420.1833,-369 2315.9397,-369 2315.9397,-333 2420.1833,-333 2420.1833,-369"/>
<text text-anchor="middle" x="2368.0615" y="-346.8" font-family="Times,serif" font-size="14.00" fill="#000000">OverlapInLevel</text>
</g>
<!-- SomeFileOverlapsRange -->
<g id="node10" class="node">
<title>SomeFileOverlapsRange</title>
<polygon fill="none" stroke="#000000" points="2650.0791,-288 2494.1338,-288 2494.1338,-252 2650.0791,-252 2650.0791,-288"/>
<text text-anchor="middle" x="2572.1064" y="-265.8" font-family="Times,serif" font-size="14.00" fill="#000000">SomeFileOverlapsRange</text>
</g>
<!-- OverlapInLevel&#45;&gt;SomeFileOverlapsRange -->
<g id="edge7" class="edge">
<title>OverlapInLevel&#45;&gt;SomeFileOverlapsRange</title>
<path fill="none" stroke="#000000" d="M2413.5992,-332.9228C2444.2801,-320.7434 2484.9128,-304.6134 2517.3569,-291.734"/>
<polygon fill="#000000" stroke="#000000" points="2518.7049,-294.9647 2526.7079,-288.0219 2516.1221,-288.4585 2518.7049,-294.9647"/>
</g>
<!-- AfterFile -->
<g id="node11" class="node">
<title>AfterFile</title>
<polygon fill="none" stroke="#000000" points="2815.6809,-342 2748.0447,-342 2748.0447,-306 2815.6809,-306 2815.6809,-342"/>
<text text-anchor="middle" x="2781.8628" y="-319.8" font-family="Times,serif" font-size="14.00" fill="#000000">AfterFile</text>
</g>
<!-- SomeFileOverlapsRange&#45;&gt;AfterFile -->
<g id="edge8" class="edge">
<title>SomeFileOverlapsRange&#45;&gt;AfterFile</title>
<path fill="none" stroke="#000000" d="M2642.2439,-288.0563C2673.9591,-296.2211 2710.4525,-305.616 2738.1743,-312.7528"/>
<polygon fill="#000000" stroke="#000000" points="2737.4088,-316.1697 2747.9656,-315.2735 2739.154,-309.3908 2737.4088,-316.1697"/>
</g>
<!-- files_ -->
<g id="node12" class="node">
<title>files_</title>
<polygon fill="none" stroke="#000000" points="2808.8628,-180 2754.8628,-180 2754.8628,-144 2808.8628,-144 2808.8628,-180"/>
<text text-anchor="middle" x="2781.8628" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#000000">files_</text>
</g>
<!-- SomeFileOverlapsRange&#45;&gt;files_ -->
<g id="edge9" class="edge">
<title>SomeFileOverlapsRange&#45;&gt;files_</title>
<path fill="none" stroke="#000000" d="M2592.9817,-251.785C2614.841,-233.5586 2650.8354,-205.8708 2686.0928,-189 2704.5456,-180.1703 2726.419,-173.7321 2744.6001,-169.3622"/>
<polygon fill="#000000" stroke="#000000" points="2745.5819,-172.7281 2754.5492,-167.0856 2744.0204,-165.9044 2745.5819,-172.7281"/>
</g>
<!-- BeforeFile -->
<g id="node13" class="node">
<title>BeforeFile</title>
<polygon fill="none" stroke="#000000" points="2819.732,-234 2743.9935,-234 2743.9935,-198 2819.732,-198 2819.732,-234"/>
<text text-anchor="middle" x="2781.8628" y="-211.8" font-family="Times,serif" font-size="14.00" fill="#000000">BeforeFile</text>
</g>
<!-- SomeFileOverlapsRange&#45;&gt;BeforeFile -->
<g id="edge10" class="edge">
<title>SomeFileOverlapsRange&#45;&gt;BeforeFile</title>
<path fill="none" stroke="#000000" d="M2642.2439,-251.9437C2672.3415,-244.1953 2706.7423,-235.3391 2733.8659,-228.3564"/>
<polygon fill="#000000" stroke="#000000" points="2735.0692,-231.6608 2743.8808,-225.7781 2733.324,-224.8819 2735.0692,-231.6608"/>
</g>
<!-- FindFile -->
<g id="node14" class="node">
<title>FindFile</title>
<polygon fill="none" stroke="#000000" points="2813.8195,-288 2749.9061,-288 2749.9061,-252 2813.8195,-252 2813.8195,-288"/>
<text text-anchor="middle" x="2781.8628" y="-265.8" font-family="Times,serif" font-size="14.00" fill="#000000">FindFile</text>
</g>
<!-- SomeFileOverlapsRange&#45;&gt;FindFile -->
<g id="edge11" class="edge">
<title>SomeFileOverlapsRange&#45;&gt;FindFile</title>
<path fill="none" stroke="#000000" d="M2650.212,-270C2680.6168,-270 2714.2389,-270 2739.8946,-270"/>
<polygon fill="#000000" stroke="#000000" points="2740.016,-273.5001 2750.016,-270 2740.016,-266.5001 2740.016,-273.5001"/>
</g>
<!-- NewFileNumber -->
<g id="node15" class="node">
<title>NewFileNumber</title>
<polygon fill="none" stroke="#000000" points="2836.9527,-396 2726.7729,-396 2726.7729,-360 2836.9527,-360 2836.9527,-396"/>
<text text-anchor="middle" x="2781.8628" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">NewFileNumber</text>
</g>
<!-- WritableFile_Append -->
<g id="node16" class="node">
<title>WritableFile_Append</title>
<polygon fill="none" stroke="#000000" points="961.4072,-397 961.4072,-433 1161.7861,-433 1161.7861,-397 961.4072,-397"/>
<text text-anchor="start" x="969.4072" y="-413.8" font-family="Times,serif" font-size="14.00" fill="#000000">Append| 将record追加到文件中</text>
</g>
<!-- AddRecord -->
<g id="node17" class="node">
<title>AddRecord</title>
<polygon fill="#f38181" stroke="#000000" points="664.2568,-380.4001 664.2568,-449.5999 837.7568,-449.5999 837.7568,-380.4001 664.2568,-380.4001"/>
<text text-anchor="middle" x="751.0068" y="-434.3999" font-family="Times,serif" font-size="14.00" fill="#000000">AddRecord</text>
<polyline fill="none" stroke="#000000" points="664.2568,-427.5999 837.7568,-427.5999 "/>
<text text-anchor="start" x="672.2568" y="-412.3999" font-family="Times,serif" font-size="14.00" fill="#000000">先将内容写入日志中</text>
<text text-anchor="start" x="672.2568" y="-392.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 挂掉后，能从日志中恢复</text>
</g>
<!-- AddRecord&#45;&gt;WritableFile_Append -->
<g id="edge12" class="edge">
<title>AddRecord&#45;&gt;WritableFile_Append</title>
<path fill="none" stroke="#000000" d="M837.9364,-415C872.9584,-415 913.7762,-415 950.8835,-415"/>
<polygon fill="#000000" stroke="#000000" points="951.2434,-418.5001 961.2433,-415 951.2433,-411.5001 951.2434,-418.5001"/>
</g>
<!-- MemTableInserter_Put -->
<g id="node18" class="node">
<title>MemTableInserter_Put</title>
<polygon fill="none" stroke="#000000" points="1252.3047,-374 1252.3047,-410 1306.3047,-410 1306.3047,-374 1252.3047,-374"/>
<text text-anchor="middle" x="1279.1426" y="-387.8" font-family="Times,serif" font-size="14.00" fill="#000000">Put</text>
</g>
<!-- MemTableInserter_Put&#45;&gt;MemTable_Add -->
<g id="edge13" class="edge">
<title>MemTableInserter_Put&#45;&gt;MemTable_Add</title>
<path fill="none" stroke="#000000" d="M1306.3076,-386.067C1322.8829,-381.7226 1344.148,-374.852 1361.3047,-365 1393.4471,-346.5427 1424.5126,-317.2948 1444.6563,-296.3255"/>
<polygon fill="#000000" stroke="#000000" points="1447.2438,-298.6832 1451.5653,-289.0098 1442.1546,-293.8769 1447.2438,-298.6832"/>
</g>
<!-- MemTableInserter_Delete -->
<g id="node19" class="node">
<title>MemTableInserter_Delete</title>
<polygon fill="none" stroke="#000000" points="1252.3047,-319 1252.3047,-355 1306.3047,-355 1306.3047,-319 1252.3047,-319"/>
<text text-anchor="middle" x="1279.0703" y="-332.8" font-family="Times,serif" font-size="14.00" fill="#000000">Delete</text>
</g>
<!-- MemTableInserter_Delete&#45;&gt;MemTable_Add -->
<g id="edge14" class="edge">
<title>MemTableInserter_Delete&#45;&gt;MemTable_Add</title>
<path fill="none" stroke="#000000" d="M1306.6737,-327.403C1339.3857,-315.9326 1394.2627,-296.6899 1430.681,-283.9198"/>
<polygon fill="#000000" stroke="#000000" points="1432.1511,-287.1133 1440.4297,-280.5015 1429.8348,-280.5077 1432.1511,-287.1133"/>
</g>
<!-- background_work_finished_signal_ -->
<g id="node20" class="node">
<title>background_work_finished_signal_</title>
<polygon fill="#95e1d3" stroke="#000000" points="2025.3613,-1385 2025.3613,-1421 2242.0029,-1421 2242.0029,-1385 2025.3613,-1385"/>
<text text-anchor="middle" x="2133.6821" y="-1398.8" font-family="Times,serif" font-size="14.00" fill="#000000">background_work_finished_signal_</text>
</g>
<!-- background_work_finished_signal__Wait -->
<g id="node21" class="node">
<title>background_work_finished_signal__Wait</title>
<polygon fill="none" stroke="#000000" points="1396.5264,-1385.2 1396.5264,-1434.8 1538.5264,-1434.8 1538.5264,-1385.2 1396.5264,-1385.2"/>
<text text-anchor="middle" x="1467.5264" y="-1419.6" font-family="Times,serif" font-size="14.00" fill="#000000">Wait</text>
<polyline fill="none" stroke="#000000" points="1396.5264,-1412.8 1538.5264,-1412.8 "/>
<text text-anchor="middle" x="1467.5264" y="-1397.6" font-family="Times,serif" font-size="14.00" fill="#000000">等待后台线程处理完</text>
</g>
<!-- background_work_finished_signal__Wait&#45;&gt;background_work_finished_signal_ -->
<g id="edge15" class="edge">
<title>background_work_finished_signal__Wait&#45;&gt;background_work_finished_signal_</title>
<path fill="none" stroke="#000000" d="M1538.6726,-1425.3255C1548.0027,-1426.843 1557.4666,-1428.1385 1566.5264,-1429 1753.6091,-1446.79 1802.1805,-1445.7261 1989.3613,-1429 2005.111,-1427.5926 2021.7135,-1425.3378 2037.8279,-1422.7294"/>
<polygon fill="#000000" stroke="#000000" points="2038.5006,-1426.1656 2047.7864,-1421.0641 2037.346,-1419.2615 2038.5006,-1426.1656"/>
</g>
<!-- background_work_finished_signal__SignalAll -->
<g id="node22" class="node">
<title>background_work_finished_signal__SignalAll</title>
<polygon fill="none" stroke="#000000" points="1813.1714,-1365.2 1813.1714,-1414.8 1941.1714,-1414.8 1941.1714,-1365.2 1813.1714,-1365.2"/>
<text text-anchor="middle" x="1877.1714" y="-1399.6" font-family="Times,serif" font-size="14.00" fill="#000000">SignalAll</text>
<polyline fill="none" stroke="#000000" points="1813.1714,-1392.8 1941.1714,-1392.8 "/>
<text text-anchor="middle" x="1877.1714" y="-1377.6" font-family="Times,serif" font-size="14.00" fill="#000000">通知已压缩处理完</text>
</g>
<!-- background_work_finished_signal__SignalAll&#45;&gt;background_work_finished_signal_ -->
<g id="edge16" class="edge">
<title>background_work_finished_signal__SignalAll&#45;&gt;background_work_finished_signal_</title>
<path fill="none" stroke="#000000" d="M1941.2382,-1393.2469C1963.7051,-1394.3855 1989.7126,-1395.7036 2015.2022,-1396.9954"/>
<polygon fill="#000000" stroke="#000000" points="2015.1516,-1400.4973 2025.316,-1397.508 2015.506,-1393.5062 2015.1516,-1400.4973"/>
</g>
<!-- cv_wait -->
<g id="node23" class="node">
<title>cv_wait</title>
<polygon fill="none" stroke="#000000" points="667.5688,-855.4001 667.5688,-924.5999 834.4448,-924.5999 834.4448,-855.4001 667.5688,-855.4001"/>
<text text-anchor="middle" x="751.0068" y="-909.3999" font-family="Times,serif" font-size="14.00" fill="#000000">Wait</text>
<polyline fill="none" stroke="#000000" points="667.5688,-902.5999 834.4448,-902.5999 "/>
<text text-anchor="start" x="675.5688" y="-887.3999" font-family="Times,serif" font-size="14.00" fill="#000000">如果自己不再writers队列</text>
<text text-anchor="start" x="675.5688" y="-867.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 最开头的话就等待</text>
</g>
<!-- cv_Signal -->
<g id="node24" class="node">
<title>cv_Signal</title>
<polygon fill="none" stroke="#000000" points="669.3188,-747.6001 669.3188,-836.3999 832.6948,-836.3999 832.6948,-747.6001 669.3188,-747.6001"/>
<text text-anchor="middle" x="751.0068" y="-821.1999" font-family="Times,serif" font-size="14.00" fill="#000000">Signal</text>
<polyline fill="none" stroke="#000000" points="669.3188,-814.3999 832.6948,-814.3999 "/>
<text text-anchor="start" x="677.3188" y="-799.1999" font-family="Times,serif" font-size="14.00" fill="#000000">自己写完了，</text>
<text text-anchor="start" x="677.3188" y="-779.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 通知writers_队列中其他</text>
<text text-anchor="start" x="677.3188" y="-760" font-family="Times,serif" font-size="14.00" fill="#000000"> writer开始写</text>
</g>
<!-- Writer -->
<g id="node25" class="node">
<title>Writer</title>
<polygon fill="none" stroke="#000000" points="678.2568,-659.4001 678.2568,-728.5999 823.7568,-728.5999 823.7568,-659.4001 678.2568,-659.4001"/>
<text text-anchor="middle" x="751.0068" y="-713.3999" font-family="Times,serif" font-size="14.00" fill="#000000">Writer</text>
<polyline fill="none" stroke="#000000" points="678.2568,-706.5999 823.7568,-706.5999 "/>
<text text-anchor="start" x="686.2568" y="-691.3999" font-family="Times,serif" font-size="14.00" fill="#000000">先创建一个Writer，</text>
<text text-anchor="start" x="686.2568" y="-671.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 并将自己放入队列中</text>
</g>
<!-- writers_ -->
<g id="node26" class="node">
<title>writers_</title>
<polygon fill="#95e1d3" stroke="#000000" points="952.1104,-522.2 952.1104,-599.8 1171.083,-599.8 1171.083,-522.2 952.1104,-522.2"/>
<text text-anchor="middle" x="1061.5967" y="-584.6" font-family="Times,serif" font-size="14.00" fill="#000000">writers_</text>
<polyline fill="none" stroke="#000000" points="952.1104,-577.8 1171.083,-577.8 "/>
<text text-anchor="start" x="960.1104" y="-562.6" font-family="Times,serif" font-size="14.00" fill="#000000">writers队列</text>
<text text-anchor="start" x="960.1104" y="-543" font-family="Times,serif" font-size="14.00" fill="#000000"> std::deque&lt;Writer*&gt; </text>
<text text-anchor="start" x="960.1104" y="-529" font-family="Times,serif" font-size="14.00" fill="#000000"> writers_ GUARDED_BY(mutex_);</text>
</g>
<!-- writers_push_back -->
<g id="node27" class="node">
<title>writers_push_back</title>
<polygon fill="none" stroke="#000000" points="665.6309,-591.2 665.6309,-640.8 836.3828,-640.8 836.3828,-591.2 665.6309,-591.2"/>
<text text-anchor="middle" x="751.0068" y="-625.6" font-family="Times,serif" font-size="14.00" fill="#000000">push_back</text>
<polyline fill="none" stroke="#000000" points="665.6309,-618.8 836.3828,-618.8 "/>
<text text-anchor="start" x="673.6309" y="-603.6" font-family="Times,serif" font-size="14.00" fill="#000000">将writers放入writers_队列</text>
</g>
<!-- writers_push_back&#45;&gt;writers_ -->
<g id="edge17" class="edge">
<title>writers_push_back&#45;&gt;writers_</title>
<path fill="none" stroke="#000000" d="M836.6991,-600.8254C869.1387,-595.0809 906.6875,-588.4317 941.7005,-582.2315"/>
<polygon fill="#000000" stroke="#000000" points="942.7512,-585.6 951.9876,-580.4098 941.5305,-578.7072 942.7512,-585.6"/>
</g>
<!-- writers_pop_front -->
<g id="node28" class="node">
<title>writers_pop_front</title>
<polygon fill="none" stroke="#000000" points="681.5688,-522.2 681.5688,-571.8 820.4448,-571.8 820.4448,-522.2 681.5688,-522.2"/>
<text text-anchor="middle" x="751.0068" y="-556.6" font-family="Times,serif" font-size="14.00" fill="#000000">pop_front</text>
<polyline fill="none" stroke="#000000" points="681.5688,-549.8 820.4448,-549.8 "/>
<text text-anchor="start" x="689.5688" y="-534.6" font-family="Times,serif" font-size="14.00" fill="#000000">从writers队列中取出</text>
</g>
<!-- writers_pop_front&#45;&gt;writers_ -->
<g id="edge18" class="edge">
<title>writers_pop_front&#45;&gt;writers_</title>
<path fill="none" stroke="#000000" d="M820.7093,-550.1419C856.3986,-551.7506 900.859,-553.7547 941.8324,-555.6016"/>
<polygon fill="#000000" stroke="#000000" points="941.742,-559.1009 951.8895,-556.0549 942.0573,-552.108 941.742,-559.1009"/>
</g>
<!-- imm_ -->
<g id="node29" class="node">
<title>imm_</title>
<polygon fill="#95e1d3" stroke="#000000" points="2505.8848,-951.2 2505.8848,-1000.8 2638.3281,-1000.8 2638.3281,-951.2 2505.8848,-951.2"/>
<text text-anchor="middle" x="2572.1064" y="-985.6" font-family="Times,serif" font-size="14.00" fill="#000000">imm_</text>
<polyline fill="none" stroke="#000000" points="2505.8848,-978.8 2638.3281,-978.8 "/>
<text text-anchor="start" x="2513.8848" y="-963.6" font-family="Times,serif" font-size="14.00" fill="#000000">不可变的MemTable</text>
</g>
<!-- mem_ -->
<g id="node30" class="node">
<title>mem_</title>
<polygon fill="#95e1d3" stroke="#000000" points="1206.083,-951.2 1206.083,-1000.8 1352.5264,-1000.8 1352.5264,-951.2 1206.083,-951.2"/>
<text text-anchor="middle" x="1279.3047" y="-985.6" font-family="Times,serif" font-size="14.00" fill="#000000">mem_</text>
<polyline fill="none" stroke="#000000" points="1206.083,-978.8 1352.5264,-978.8 "/>
<text text-anchor="middle" x="1279.3047" y="-963.6" font-family="Times,serif" font-size="14.00" fill="#000000">当前可变的MemTable</text>
</g>
<!-- DBImpl_Write -->
<g id="node31" class="node">
<title>DBImpl_Write</title>
<polygon fill="none" stroke="#000000" points="157.4209,-835.8002 157.4209,-944.1998 549.9033,-944.1998 549.9033,-835.8002 157.4209,-835.8002"/>
<text text-anchor="middle" x="353.6621" y="-928.9998" font-family="Times,serif" font-size="14.00" fill="#000000">Write</text>
<polyline fill="none" stroke="#000000" points="157.4209,-922.1998 549.9033,-922.1998 "/>
<text text-anchor="start" x="165.4209" y="-906.9998" font-family="Times,serif" font-size="14.00" fill="#000000">1. 先将自己加入到writers队列</text>
<text text-anchor="start" x="165.4209" y="-887.3999" font-family="Times,serif" font-size="14.00" fill="#000000"> 2. 通过MakeRoomForWrite保证mem_有足够空间写入key,value</text>
<text text-anchor="start" x="165.4209" y="-867.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 3. 先写入WAL日志</text>
<text text-anchor="start" x="165.4209" y="-848.2001" font-family="Times,serif" font-size="14.00" fill="#000000"> 4. 写入memTable中</text>
</g>
<!-- DBImpl_Write&#45;&gt;AddRecord -->
<g id="edge23" class="edge">
<title>DBImpl_Write&#45;&gt;AddRecord</title>
<path fill="none" stroke="#000000" d="M541.2705,-835.5132C544.3104,-832.5088 547.1955,-829.3407 549.9033,-826 644.4735,-709.3256 497.9593,-611.7468 585.9033,-490 602.7238,-466.7143 628.5275,-450.5 654.7741,-439.2744"/>
<polygon fill="#000000" stroke="#000000" points="656.1103,-442.5094 664.0624,-435.5084 653.48,-436.0224 656.1103,-442.5094"/>
</g>
<!-- DBImpl_Write&#45;&gt;cv_wait -->
<g id="edge24" class="edge">
<title>DBImpl_Write&#45;&gt;cv_wait</title>
<path fill="none" stroke="#000000" d="M550.0063,-890C587.4087,-890 624.921,-890 657.2399,-890"/>
<polygon fill="#000000" stroke="#000000" points="657.5439,-893.5001 667.5439,-890 657.5439,-886.5001 657.5439,-893.5001"/>
</g>
<!-- DBImpl_Write&#45;&gt;cv_Signal -->
<g id="edge25" class="edge">
<title>DBImpl_Write&#45;&gt;cv_Signal</title>
<path fill="none" stroke="#000000" d="M550.0063,-841.5742C588.1021,-832.1784 626.3121,-822.7544 659.0322,-814.6844"/>
<polygon fill="#000000" stroke="#000000" points="660.1334,-818.0177 669.0043,-812.2249 658.4571,-811.2214 660.1334,-818.0177"/>
</g>
<!-- DBImpl_Write&#45;&gt;Writer -->
<g id="edge26" class="edge">
<title>DBImpl_Write&#45;&gt;Writer</title>
<path fill="none" stroke="#000000" d="M538.4086,-835.767C542.4064,-832.6893 546.2484,-829.4369 549.9033,-826 581.5888,-796.2043 553.1681,-763.6384 585.9033,-735 608.4718,-715.256 639.1083,-704.7239 667.8634,-699.2025"/>
<polygon fill="#000000" stroke="#000000" points="668.6865,-702.612 677.9396,-697.4516 667.488,-695.7154 668.6865,-702.612"/>
</g>
<!-- DBImpl_Write&#45;&gt;writers_ -->
<g id="edge27" class="edge">
<title>DBImpl_Write&#45;&gt;writers_</title>
<path fill="none" stroke="#000000" d="M541.2351,-835.4845C544.2857,-832.4887 547.1826,-829.3301 549.9033,-826 594.2009,-771.781 533.6439,-559.5933 585.9033,-513 613.2889,-488.5836 879.8855,-507.1785 916.1104,-513 926.2595,-514.631 936.6602,-516.8636 947.0051,-519.4789"/>
<polygon fill="#000000" stroke="#000000" points="946.3337,-522.9216 956.8963,-522.0965 948.1245,-516.1546 946.3337,-522.9216"/>
</g>
<!-- DBImpl_Write&#45;&gt;writers_push_back -->
<g id="edge28" class="edge">
<title>DBImpl_Write&#45;&gt;writers_push_back</title>
<path fill="none" stroke="#000000" d="M540.4497,-835.5137C543.7613,-832.5102 546.9206,-829.342 549.9033,-826 603.0672,-766.4322 529.4842,-706.4942 585.9033,-650 604.2511,-631.6278 629.7122,-621.9064 655.1523,-617.0462"/>
<polygon fill="#000000" stroke="#000000" points="655.9779,-620.457 665.2655,-615.3589 654.8258,-613.5524 655.9779,-620.457"/>
</g>
<!-- DBImpl_Write&#45;&gt;writers_pop_front -->
<g id="edge29" class="edge">
<title>DBImpl_Write&#45;&gt;writers_pop_front</title>
<path fill="none" stroke="#000000" d="M540.7035,-835.7339C543.9392,-832.6646 547.0141,-829.4232 549.9033,-826 620.6064,-742.2308 510.8476,-661.8926 585.9033,-582 607.6231,-558.8806 640.4998,-549.0559 671.2127,-545.4162"/>
<polygon fill="#000000" stroke="#000000" points="671.9138,-548.8644 681.5261,-544.4087 671.2332,-541.8976 671.9138,-548.8644"/>
</g>
<!-- MakeRoomForWrite -->
<g id="node36" class="node">
<title>MakeRoomForWrite</title>
<polygon fill="#f38181" stroke="#000000" points="585.9033,-1323.2003 585.9033,-1470.7997 916.1104,-1470.7997 916.1104,-1323.2003 585.9033,-1323.2003"/>
<text text-anchor="middle" x="751.0068" y="-1455.5997" font-family="Times,serif" font-size="14.00" fill="#000000">MakeRoomForWrite</text>
<polyline fill="none" stroke="#000000" points="585.9033,-1448.7997 916.1104,-1448.7997 "/>
<text text-anchor="start" x="593.9033" y="-1433.5997" font-family="Times,serif" font-size="14.00" fill="#000000">1. 如果level0文件各处超过配置则等待后台压缩线程</text>
<text text-anchor="start" x="593.9033" y="-1413.9998" font-family="Times,serif" font-size="14.00" fill="#000000"> 2. 如果imm_不为null, 也等待后台压缩线程</text>
<text text-anchor="start" x="593.9033" y="-1394.3999" font-family="Times,serif" font-size="14.00" fill="#000000"> 3. 如果mem_内存超过阈值则新建一个mem_</text>
<text text-anchor="start" x="593.9033" y="-1374.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 4. 并将之间的imm设置为之前的mem_, </text>
<text text-anchor="start" x="593.9033" y="-1355.2001" font-family="Times,serif" font-size="14.00" fill="#000000">在后面的CompatMemTable中会将它落盘</text>
<text text-anchor="start" x="593.9033" y="-1335.6002" font-family="Times,serif" font-size="14.00" fill="#000000"> 5. 触发压缩操作</text>
</g>
<!-- DBImpl_Write&#45;&gt;MakeRoomForWrite -->
<g id="edge30" class="edge">
<title>DBImpl_Write&#45;&gt;MakeRoomForWrite</title>
<path fill="none" stroke="#000000" d="M541.3089,-944.4558C544.3373,-947.4695 547.2096,-950.6479 549.9033,-954 649.9185,-1078.4601 498.4556,-1181.4497 583.092,-1314.432"/>
<polygon fill="#000000" stroke="#000000" points="580.245,-1316.4708 588.7231,-1322.8248 586.0578,-1312.5706 580.245,-1316.4708"/>
</g>
<!-- BuildBatchGroup -->
<g id="node37" class="node">
<title>BuildBatchGroup</title>
<polygon fill="none" stroke="#000000" points="808.5527,-1279 693.461,-1279 693.461,-1243 808.5527,-1243 808.5527,-1279"/>
<text text-anchor="middle" x="751.0068" y="-1256.8" font-family="Times,serif" font-size="14.00" fill="#000000">BuildBatchGroup</text>
</g>
<!-- DBImpl_Write&#45;&gt;BuildBatchGroup -->
<g id="edge31" class="edge">
<title>DBImpl_Write&#45;&gt;BuildBatchGroup</title>
<path fill="none" stroke="#000000" d="M541.1747,-944.5652C544.2434,-947.5461 547.1604,-950.6881 549.9033,-954 629.9339,-1050.6309 498.7148,-1143.7748 585.9033,-1234 610.5047,-1259.4582 649.1086,-1266.7943 682.8037,-1267.494"/>
<polygon fill="#000000" stroke="#000000" points="683.0765,-1270.9943 693.0822,-1267.5108 683.088,-1263.9944 683.0765,-1270.9943"/>
</g>
<!-- SetSequence -->
<g id="node38" class="node">
<title>SetSequence</title>
<polygon fill="none" stroke="#000000" points="794.5393,-1225 707.4743,-1225 707.4743,-1189 794.5393,-1189 794.5393,-1225"/>
<text text-anchor="middle" x="751.0068" y="-1202.8" font-family="Times,serif" font-size="14.00" fill="#000000">SetSequence</text>
</g>
<!-- DBImpl_Write&#45;&gt;SetSequence -->
<g id="edge32" class="edge">
<title>DBImpl_Write&#45;&gt;SetSequence</title>
<path fill="none" stroke="#000000" d="M540.6503,-944.3112C543.9019,-947.3671 546.9945,-950.5935 549.9033,-954 615.9511,-1031.3484 514.1317,-1107.9311 585.9033,-1180 614.3503,-1208.5648 660.4846,-1214.0919 696.7643,-1213.1656"/>
<polygon fill="#000000" stroke="#000000" points="697.3526,-1216.6437 707.1935,-1212.7186 697.0528,-1209.6501 697.3526,-1216.6437"/>
</g>
<!-- Versions_LastSequence -->
<g id="node39" class="node">
<title>Versions_LastSequence</title>
<polygon fill="none" stroke="#000000" points="825.4727,-1171 676.541,-1171 676.541,-1135 825.4727,-1135 825.4727,-1171"/>
<text text-anchor="middle" x="751.0068" y="-1148.8" font-family="Times,serif" font-size="14.00" fill="#000000">Versions_LastSequence</text>
</g>
<!-- DBImpl_Write&#45;&gt;Versions_LastSequence -->
<g id="edge33" class="edge">
<title>DBImpl_Write&#45;&gt;Versions_LastSequence</title>
<path fill="none" stroke="#000000" d="M540.4291,-944.5048C543.7468,-947.5027 546.913,-950.6648 549.9033,-954 602.0408,-1012.1502 529.4701,-1072.0089 585.9033,-1126 607.1171,-1146.2957 637.3192,-1154.7734 666.1042,-1157.6014"/>
<polygon fill="#000000" stroke="#000000" points="665.9712,-1161.1014 676.2096,-1158.3763 666.5064,-1154.1219 665.9712,-1161.1014"/>
</g>
<!-- Version_SetLastSequence -->
<g id="node40" class="node">
<title>Version_SetLastSequence</title>
<polygon fill="none" stroke="#000000" points="831.9146,-1117 670.0991,-1117 670.0991,-1081 831.9146,-1081 831.9146,-1117"/>
<text text-anchor="middle" x="751.0068" y="-1094.8" font-family="Times,serif" font-size="14.00" fill="#000000">Version_SetLastSequence</text>
</g>
<!-- DBImpl_Write&#45;&gt;Version_SetLastSequence -->
<g id="edge34" class="edge">
<title>DBImpl_Write&#45;&gt;Version_SetLastSequence</title>
<path fill="none" stroke="#000000" d="M539.6692,-944.4825C543.2397,-947.4865 546.6598,-950.656 549.9033,-954 589.5608,-994.8868 542.6798,-1039.9032 585.9033,-1077 606.2366,-1094.4512 633.4814,-1102.1514 659.9702,-1104.8732"/>
<polygon fill="#000000" stroke="#000000" points="659.8217,-1108.3724 670.0694,-1105.6826 660.381,-1101.3948 659.8217,-1108.3724"/>
</g>
<!-- WriteBatchInternal_InsertInto -->
<g id="node41" class="node">
<title>WriteBatchInternal_InsertInto</title>
<polygon fill="none" stroke="#000000" points="658.1523,-1013.2 658.1523,-1062.8 843.8613,-1062.8 843.8613,-1013.2 658.1523,-1013.2"/>
<text text-anchor="middle" x="751.0068" y="-1047.6" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatchInternal::InsertInto</text>
<polyline fill="none" stroke="#000000" points="658.1523,-1040.8 843.8613,-1040.8 "/>
<text text-anchor="middle" x="751.0068" y="-1025.6" font-family="Times,serif" font-size="14.00" fill="#000000">将内容插入memtable</text>
</g>
<!-- DBImpl_Write&#45;&gt;WriteBatchInternal_InsertInto -->
<g id="edge35" class="edge">
<title>DBImpl_Write&#45;&gt;WriteBatchInternal_InsertInto</title>
<path fill="none" stroke="#000000" d="M522.8275,-944.2088C532.0109,-947.4509 541.0845,-950.7262 549.9033,-954 595.5206,-970.9344 646.0558,-992.0527 685.056,-1008.8778"/>
<polygon fill="#000000" stroke="#000000" points="684.1453,-1012.2974 694.7128,-1013.0577 686.926,-1005.8733 684.1453,-1012.2974"/>
</g>
<!-- DBImpl_Put -->
<g id="node32" class="node">
<title>DBImpl_Put</title>
<polygon fill="none" stroke="#000000" points="112.277,-944 25.1439,-944 25.1439,-908 112.277,-908 112.277,-944"/>
<text text-anchor="middle" x="68.7104" y="-921.8" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl_Put</text>
</g>
<!-- DBImpl_Put&#45;&gt;DBImpl_Write -->
<g id="edge19" class="edge">
<title>DBImpl_Put&#45;&gt;DBImpl_Write</title>
<path fill="none" stroke="#000000" d="M112.2987,-920.4932C122.7967,-919.1669 134.7081,-917.662 147.4796,-916.0485"/>
<polygon fill="#000000" stroke="#000000" points="147.9221,-919.5205 157.4045,-914.7946 147.0446,-912.5757 147.9221,-919.5205"/>
</g>
<!-- WriteBatch_Put -->
<g id="node33" class="node">
<title>WriteBatch_Put</title>
<polygon fill="none" stroke="#000000" points="406.3092,-999 301.015,-999 301.015,-963 406.3092,-963 406.3092,-999"/>
<text text-anchor="middle" x="353.6621" y="-976.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch_Put</text>
</g>
<!-- DBImpl_Put&#45;&gt;WriteBatch_Put -->
<g id="edge20" class="edge">
<title>DBImpl_Put&#45;&gt;WriteBatch_Put</title>
<path fill="none" stroke="#000000" d="M112.5295,-941.445C126.7151,-946.0088 142.6098,-950.6688 157.4209,-954 201.465,-963.9061 251.9386,-970.7523 290.6673,-975.072"/>
<polygon fill="#000000" stroke="#000000" points="290.4355,-978.5674 300.7555,-976.1699 291.1929,-971.6085 290.4355,-978.5674"/>
</g>
<!-- DBImpl_Delete -->
<g id="node34" class="node">
<title>DBImpl_Delete</title>
<polygon fill="none" stroke="#000000" points="121.6322,-872 15.7887,-872 15.7887,-836 121.6322,-836 121.6322,-872"/>
<text text-anchor="middle" x="68.7104" y="-849.8" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl_Delete</text>
</g>
<!-- DBImpl_Delete&#45;&gt;DBImpl_Write -->
<g id="edge21" class="edge">
<title>DBImpl_Delete&#45;&gt;DBImpl_Write</title>
<path fill="none" stroke="#000000" d="M121.6399,-860.687C129.6182,-861.6949 138.2264,-862.7825 147.268,-863.9247"/>
<polygon fill="#000000" stroke="#000000" points="146.8798,-867.4034 157.2397,-865.1845 147.7573,-860.4586 146.8798,-867.4034"/>
</g>
<!-- WriteBatch_Delete -->
<g id="node35" class="node">
<title>WriteBatch_Delete</title>
<polygon fill="none" stroke="#000000" points="415.1651,-817 292.1592,-817 292.1592,-781 415.1651,-781 415.1651,-817"/>
<text text-anchor="middle" x="353.6621" y="-794.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch_Delete</text>
</g>
<!-- DBImpl_Delete&#45;&gt;WriteBatch_Delete -->
<g id="edge22" class="edge">
<title>DBImpl_Delete&#45;&gt;WriteBatch_Delete</title>
<path fill="none" stroke="#000000" d="M120.8471,-835.9327C132.7627,-832.2553 145.446,-828.6933 157.4209,-826 198.0574,-816.8603 244.1669,-810.3254 281.4755,-805.9762"/>
<polygon fill="#000000" stroke="#000000" points="282.2129,-809.415 291.7532,-804.8072 281.4217,-802.4599 282.2129,-809.415"/>
</g>
<!-- MakeRoomForWrite&#45;&gt;background_work_finished_signal__Wait -->
<g id="edge36" class="edge">
<title>MakeRoomForWrite&#45;&gt;background_work_finished_signal__Wait</title>
<path fill="none" stroke="#000000" d="M916.2906,-1399.9988C1063.5251,-1402.6701 1272.7406,-1406.466 1386.4036,-1408.5282"/>
<polygon fill="#000000" stroke="#000000" points="1386.3677,-1412.028 1396.4296,-1408.7101 1386.4947,-1405.0291 1386.3677,-1412.028"/>
</g>
<!-- MakeRoomForWrite&#45;&gt;imm_ -->
<g id="edge37" class="edge">
<title>MakeRoomForWrite&#45;&gt;imm_</title>
<path fill="none" stroke="#000000" d="M912.6554,-1322.9345C913.8338,-1321.6441 914.986,-1320.3327 916.1104,-1319 954.493,-1273.504 907.1654,-1229.0264 952.1104,-1190 1028.9421,-1123.2858 1108.7497,-1233.5331 1179.083,-1160 1212.6952,-1124.8586 1162.8516,-975.5178 1198.083,-942 1284.9043,-859.4015 1347.6913,-932 1467.5264,-932 1467.5264,-932 1467.5264,-932 2133.6821,-932 2261.1668,-932 2408.4657,-950.6463 2495.756,-963.662"/>
<polygon fill="#000000" stroke="#000000" points="2495.4277,-967.1519 2505.8374,-965.18 2496.47,-960.23 2495.4277,-967.1519"/>
</g>
<!-- MakeRoomForWrite&#45;&gt;mem_ -->
<g id="edge38" class="edge">
<title>MakeRoomForWrite&#45;&gt;mem_</title>
<path fill="none" stroke="#000000" d="M916.2102,-1340.3728C928.2791,-1337.2329 940.3338,-1334.3903 952.1104,-1332 1001.7323,-1321.928 1143.7494,-1348.2673 1179.083,-1312 1226.7814,-1263.0412 1156.9985,-1059.6275 1198.083,-1005 1198.2939,-1004.7195 1198.5078,-1004.4418 1198.7246,-1004.1667"/>
<polygon fill="#000000" stroke="#000000" points="1201.3048,-1006.5335 1205.7513,-996.9169 1196.2783,-1001.6617 1201.3048,-1006.5335"/>
</g>
<!-- SleepForMicroseconds -->
<g id="node42" class="node">
<title>SleepForMicroseconds</title>
<polygon fill="none" stroke="#000000" points="989.0518,-1081.4001 989.0518,-1150.5999 1134.1416,-1150.5999 1134.1416,-1081.4001 989.0518,-1081.4001"/>
<text text-anchor="middle" x="1061.5967" y="-1135.3999" font-family="Times,serif" font-size="14.00" fill="#000000">SleepForMicroseconds</text>
<polyline fill="none" stroke="#000000" points="989.0518,-1128.5999 1134.1416,-1128.5999 "/>
<text text-anchor="start" x="997.0518" y="-1113.3999" font-family="Times,serif" font-size="14.00" fill="#000000">Sleep等待后台</text>
<text text-anchor="start" x="997.0518" y="-1093.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 线程压缩完毕</text>
</g>
<!-- MakeRoomForWrite&#45;&gt;SleepForMicroseconds -->
<g id="edge39" class="edge">
<title>MakeRoomForWrite&#45;&gt;SleepForMicroseconds</title>
<path fill="none" stroke="#000000" d="M912.7375,-1323.0023C913.8898,-1321.6903 915.0146,-1320.3563 916.1104,-1319 960.2831,-1264.3245 907.3784,-1219.219 952.1104,-1165 959.7204,-1155.776 969.425,-1148.2247 979.9016,-1142.0597"/>
<polygon fill="#000000" stroke="#000000" points="981.735,-1145.047 988.8546,-1137.2009 978.396,-1138.8947 981.735,-1145.047"/>
</g>
<!-- MaybeScheduleCompaction -->
<g id="node44" class="node">
<title>MaybeScheduleCompaction</title>
<polygon fill="none" stroke="#000000" points="974.2827,-1341.2 974.2827,-1390.8 1148.9106,-1390.8 1148.9106,-1341.2 974.2827,-1341.2"/>
<text text-anchor="middle" x="1061.5967" y="-1375.6" font-family="Times,serif" font-size="14.00" fill="#000000">MaybeScheduleCompaction</text>
<polyline fill="none" stroke="#000000" points="974.2827,-1368.8 1148.9106,-1368.8 "/>
<text text-anchor="start" x="982.2827" y="-1353.6" font-family="Times,serif" font-size="14.00" fill="#000000">可能触发压缩操作</text>
</g>
<!-- MakeRoomForWrite&#45;&gt;MaybeScheduleCompaction -->
<g id="edge40" class="edge">
<title>MakeRoomForWrite&#45;&gt;MaybeScheduleCompaction</title>
<path fill="none" stroke="#000000" d="M916.3048,-1380.5016C932.7047,-1378.8647 948.9551,-1377.2428 964.3205,-1375.7091"/>
<polygon fill="#000000" stroke="#000000" points="964.6797,-1379.1908 974.2827,-1374.7148 963.9845,-1372.2254 964.6797,-1379.1908"/>
</g>
<!-- ApproximateMemoryUsage -->
<g id="node45" class="node">
<title>ApproximateMemoryUsage</title>
<polygon fill="none" stroke="#000000" points="975.062,-1199.2 975.062,-1248.8 1148.1313,-1248.8 1148.1313,-1199.2 975.062,-1199.2"/>
<text text-anchor="middle" x="1061.5967" y="-1233.6" font-family="Times,serif" font-size="14.00" fill="#000000">ApproximateMemoryUsage</text>
<polyline fill="none" stroke="#000000" points="975.062,-1226.8 1148.1313,-1226.8 "/>
<text text-anchor="start" x="983.062" y="-1211.6" font-family="Times,serif" font-size="14.00" fill="#000000">评估当前mem_使用内存</text>
</g>
<!-- MakeRoomForWrite&#45;&gt;ApproximateMemoryUsage -->
<g id="edge41" class="edge">
<title>MakeRoomForWrite&#45;&gt;ApproximateMemoryUsage</title>
<path fill="none" stroke="#000000" d="M911.4582,-1323.1054C913.0364,-1321.7571 914.588,-1320.3887 916.1104,-1319 939.3683,-1297.7849 927.4231,-1277.5333 952.1104,-1258 956.4027,-1254.6038 961.0363,-1251.5448 965.8883,-1248.79"/>
<polygon fill="#000000" stroke="#000000" points="967.5651,-1251.8631 974.8311,-1244.1524 964.3425,-1245.649 967.5651,-1251.8631"/>
</g>
<!-- has_imm_ -->
<g id="node46" class="node">
<title>has_imm_</title>
<polygon fill="none" stroke="#000000" points="1098.9285,-1303 1024.2649,-1303 1024.2649,-1267 1098.9285,-1267 1098.9285,-1303"/>
<text text-anchor="middle" x="1061.5967" y="-1280.8" font-family="Times,serif" font-size="14.00" fill="#000000">has_imm_</text>
</g>
<!-- MakeRoomForWrite&#45;&gt;has_imm_ -->
<g id="edge42" class="edge">
<title>MakeRoomForWrite&#45;&gt;has_imm_</title>
<path fill="none" stroke="#000000" d="M916.2565,-1329.8316C928.342,-1325.3598 940.3857,-1321.0354 952.1104,-1317 972.3614,-1310.0299 995.0419,-1303.238 1014.4851,-1297.7176"/>
<polygon fill="#000000" stroke="#000000" points="1015.6469,-1301.0267 1024.3275,-1294.9524 1013.7536,-1294.2876 1015.6469,-1301.0267"/>
</g>
<!-- WriteBatch_Iterate -->
<g id="node47" class="node">
<title>WriteBatch_Iterate</title>
<polygon fill="none" stroke="#000000" points="972.4404,-1013.2 972.4404,-1062.8 1150.7529,-1062.8 1150.7529,-1013.2 972.4404,-1013.2"/>
<text text-anchor="middle" x="1061.5967" y="-1047.6" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch_Iterate</text>
<polyline fill="none" stroke="#000000" points="972.4404,-1040.8 1150.7529,-1040.8 "/>
<text text-anchor="middle" x="1061.5967" y="-1025.6" font-family="Times,serif" font-size="14.00" fill="#000000">根据KeyTypeput或者delete;</text>
</g>
<!-- WriteBatchInternal_InsertInto&#45;&gt;WriteBatch_Iterate -->
<g id="edge43" class="edge">
<title>WriteBatchInternal_InsertInto&#45;&gt;WriteBatch_Iterate</title>
<path fill="none" stroke="#000000" d="M844.194,-1038C881.428,-1038 924.365,-1038 962.1955,-1038"/>
<polygon fill="#000000" stroke="#000000" points="962.2072,-1041.5001 972.2072,-1038 962.2072,-1034.5001 962.2072,-1041.5001"/>
</g>
<!-- shutting_down_ -->
<g id="node43" class="node">
<title>shutting_down_</title>
<polygon fill="#95e1d3" stroke="#000000" points="2518.9927,-1195 2518.9927,-1231 2625.2202,-1231 2625.2202,-1195 2518.9927,-1195"/>
<text text-anchor="middle" x="2572.1064" y="-1208.8" font-family="Times,serif" font-size="14.00" fill="#000000">shutting_down_</text>
</g>
<!-- background_compaction_scheduled_ -->
<g id="node48" class="node">
<title>background_compaction_scheduled_</title>
<polygon fill="none" stroke="#000000" points="1989.5516,-1185 1764.7912,-1185 1764.7912,-1149 1989.5516,-1149 1989.5516,-1185"/>
<text text-anchor="middle" x="1877.1714" y="-1162.8" font-family="Times,serif" font-size="14.00" fill="#000000">background_compaction_scheduled_</text>
</g>
<!-- MaybeScheduleCompaction&#45;&gt;background_compaction_scheduled_ -->
<g id="edge47" class="edge">
<title>MaybeScheduleCompaction&#45;&gt;background_compaction_scheduled_</title>
<path fill="none" stroke="#000000" d="M1149.147,-1347.8454C1160.2768,-1342.5743 1170.6886,-1335.7737 1179.083,-1327 1200.4806,-1304.6355 1174.3898,-1279.9163 1198.083,-1260 1290.2471,-1182.5277 1618.5438,-1225.6492 1736.9814,-1204 1760.0611,-1199.7813 1784.9184,-1193.7298 1807.1994,-1187.7393"/>
<polygon fill="#000000" stroke="#000000" points="1808.1818,-1191.0993 1816.9076,-1185.09 1806.3389,-1184.3462 1808.1818,-1191.0993"/>
</g>
<!-- Env_Schedule -->
<g id="node49" class="node">
<title>Env_Schedule</title>
<polygon fill="none" stroke="#000000" points="1327.6739,-1305 1230.9355,-1305 1230.9355,-1269 1327.6739,-1269 1327.6739,-1305"/>
<text text-anchor="middle" x="1279.3047" y="-1282.8" font-family="Times,serif" font-size="14.00" fill="#000000">Env_Schedule</text>
</g>
<!-- MaybeScheduleCompaction&#45;&gt;Env_Schedule -->
<g id="edge48" class="edge">
<title>MaybeScheduleCompaction&#45;&gt;Env_Schedule</title>
<path fill="none" stroke="#000000" d="M1149.1699,-1341.7311C1159.5611,-1337.4678 1169.7711,-1332.5748 1179.083,-1327 1189.0634,-1321.025 1187.9393,-1314.6933 1198.083,-1309 1205.1476,-1305.0349 1212.9626,-1301.7554 1220.8715,-1299.0504"/>
<polygon fill="#000000" stroke="#000000" points="1222.0241,-1302.3571 1230.5211,-1296.0284 1219.9321,-1295.6771 1222.0241,-1302.3571"/>
</g>
<!-- WriteBatch_Iterate&#45;&gt;MemTableInserter_Put -->
<g id="edge45" class="edge">
<title>WriteBatch_Iterate&#45;&gt;MemTableInserter_Put</title>
<path fill="none" stroke="#000000" d="M1150.7971,-1029.3936C1161.6884,-1024.7669 1171.5943,-1018.2098 1179.083,-1009 1215.4885,-964.2279 1177.5217,-543.9178 1198.083,-490 1208.8996,-461.6357 1231.4962,-435.4929 1250.1151,-417.3552"/>
<polygon fill="#000000" stroke="#000000" points="1252.9405,-419.5008 1257.8052,-410.0888 1248.1329,-414.4128 1252.9405,-419.5008"/>
</g>
<!-- WriteBatch_Iterate&#45;&gt;MemTableInserter_Delete -->
<g id="edge46" class="edge">
<title>WriteBatch_Iterate&#45;&gt;MemTableInserter_Delete</title>
<path fill="none" stroke="#000000" d="M1150.8567,-1029.4419C1161.7394,-1024.8082 1171.627,-1018.2363 1179.083,-1009 1224.0486,-953.2977 1155.668,-422.6682 1198.083,-365 1208.2321,-351.2011 1225.6211,-344.1478 1241.7117,-340.5649"/>
<polygon fill="#000000" stroke="#000000" points="1242.8048,-343.9228 1252.0089,-338.6755 1241.5414,-337.0378 1242.8048,-343.9228"/>
</g>
<!-- WriteBatch_Iterate&#45;&gt;mem_ -->
<g id="edge44" class="edge">
<title>WriteBatch_Iterate&#45;&gt;mem_</title>
<path fill="none" stroke="#000000" d="M1150.9517,-1016.6987C1160.4754,-1014.2036 1169.9972,-1011.6131 1179.083,-1009 1184.6657,-1007.3944 1190.4031,-1005.6802 1196.1713,-1003.909"/>
<polygon fill="#000000" stroke="#000000" points="1197.3789,-1007.1988 1205.8858,-1000.8834 1195.2974,-1000.5154 1197.3789,-1007.1988"/>
</g>
<!-- BGWork -->
<g id="node50" class="node">
<title>BGWork</title>
<polygon fill="none" stroke="#000000" points="1500.7367,-1305 1434.3161,-1305 1434.3161,-1269 1500.7367,-1269 1500.7367,-1305"/>
<text text-anchor="middle" x="1467.5264" y="-1282.8" font-family="Times,serif" font-size="14.00" fill="#000000">BGWork</text>
</g>
<!-- Env_Schedule&#45;&gt;BGWork -->
<g id="edge49" class="edge">
<title>Env_Schedule&#45;&gt;BGWork</title>
<path fill="none" stroke="#000000" d="M1327.7764,-1287C1357.5585,-1287 1395.3863,-1287 1424.1731,-1287"/>
<polygon fill="#000000" stroke="#000000" points="1424.3381,-1290.5001 1434.3381,-1287 1424.338,-1283.5001 1424.3381,-1290.5001"/>
</g>
<!-- BackgroundCall -->
<g id="node51" class="node">
<title>BackgroundCall</title>
<polygon fill="none" stroke="#000000" points="1705.513,-1305 1597.9948,-1305 1597.9948,-1269 1705.513,-1269 1705.513,-1305"/>
<text text-anchor="middle" x="1651.7539" y="-1282.8" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundCall</text>
</g>
<!-- BGWork&#45;&gt;BackgroundCall -->
<g id="edge50" class="edge">
<title>BGWork&#45;&gt;BackgroundCall</title>
<path fill="none" stroke="#000000" d="M1500.8886,-1287C1525.0046,-1287 1558.3416,-1287 1587.546,-1287"/>
<polygon fill="#000000" stroke="#000000" points="1587.6817,-1290.5001 1597.6817,-1287 1587.6817,-1283.5001 1587.6817,-1290.5001"/>
</g>
<!-- BackgroundCall&#45;&gt;background_work_finished_signal__SignalAll -->
<g id="edge51" class="edge">
<title>BackgroundCall&#45;&gt;background_work_finished_signal__SignalAll</title>
<path fill="none" stroke="#000000" d="M1674.7475,-1305.2777C1696.7553,-1321.9577 1731.4704,-1346.199 1764.9814,-1361 1777.0064,-1366.3111 1790.202,-1370.8003 1803.1872,-1374.5412"/>
<polygon fill="#000000" stroke="#000000" points="1802.4829,-1377.9774 1813.0533,-1377.2572 1804.3409,-1371.2285 1802.4829,-1377.9774"/>
</g>
<!-- BackgroundCall&#45;&gt;shutting_down_ -->
<g id="edge52" class="edge">
<title>BackgroundCall&#45;&gt;shutting_down_</title>
<path fill="none" stroke="#000000" d="M1705.9851,-1299.8301C1838.6253,-1328.68 2188.2826,-1389.3746 2458.1201,-1299 2493.7104,-1287.08 2527.0736,-1259.1778 2548.395,-1238.3675"/>
<polygon fill="#000000" stroke="#000000" points="2551.0982,-1240.6137 2555.6872,-1231.0642 2546.1447,-1235.6677 2551.0982,-1240.6137"/>
</g>
<!-- BackgroundCall&#45;&gt;background_compaction_scheduled_ -->
<g id="edge53" class="edge">
<title>BackgroundCall&#45;&gt;background_compaction_scheduled_</title>
<path fill="none" stroke="#000000" d="M1705.9605,-1276.118C1716.4889,-1273.1439 1727.2643,-1269.4724 1736.9814,-1265 1778.7852,-1245.7594 1821.3493,-1213.9017 1848.4344,-1191.7529"/>
<polygon fill="#000000" stroke="#000000" points="1850.8575,-1194.2906 1856.3252,-1185.2156 1846.3917,-1188.9002 1850.8575,-1194.2906"/>
</g>
<!-- BackgroundCompaction -->
<g id="node52" class="node">
<title>BackgroundCompaction</title>
<polygon fill="none" stroke="#000000" points="1953.5338,-1239 1800.809,-1239 1800.809,-1203 1953.5338,-1203 1953.5338,-1239"/>
<text text-anchor="middle" x="1877.1714" y="-1216.8" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundCompaction</text>
</g>
<!-- BackgroundCall&#45;&gt;BackgroundCompaction -->
<g id="edge54" class="edge">
<title>BackgroundCall&#45;&gt;BackgroundCompaction</title>
<path fill="none" stroke="#000000" d="M1705.5155,-1273.5712C1715.9785,-1270.8312 1726.8431,-1267.8974 1736.9814,-1265 1761.7721,-1257.9151 1788.8403,-1249.5658 1812.5232,-1242.055"/>
<polygon fill="#000000" stroke="#000000" points="1813.6381,-1245.3732 1822.1045,-1239.0038 1811.514,-1238.7033 1813.6381,-1245.3732"/>
</g>
<!-- CompactMemTable -->
<g id="node53" class="node">
<title>CompactMemTable</title>
<polygon fill="none" stroke="#000000" points="2286.3667,-1053.4001 2286.3667,-1122.5999 2449.7563,-1122.5999 2449.7563,-1053.4001 2286.3667,-1053.4001"/>
<text text-anchor="middle" x="2368.0615" y="-1107.3999" font-family="Times,serif" font-size="14.00" fill="#000000">CompactMemTable</text>
<polyline fill="none" stroke="#000000" points="2286.3667,-1100.5999 2449.7563,-1100.5999 "/>
<text text-anchor="start" x="2294.3667" y="-1085.3999" font-family="Times,serif" font-size="14.00" fill="#000000">将imm_写入level0文件</text>
<text text-anchor="start" x="2294.3667" y="-1065.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 然后将imm_置为nullptr;</text>
</g>
<!-- BackgroundCompaction&#45;&gt;CompactMemTable -->
<g id="edge55" class="edge">
<title>BackgroundCompaction&#45;&gt;CompactMemTable</title>
<path fill="none" stroke="#000000" d="M1953.8122,-1207.3327C1965.7696,-1204.8089 1977.9415,-1202.0097 1989.3613,-1199 2005.6699,-1194.7018 2009.2566,-1192.0081 2025.3613,-1187 2109.9075,-1160.7089 2206.9054,-1132.9063 2276.0779,-1113.4804"/>
<polygon fill="#000000" stroke="#000000" points="2277.3936,-1116.7465 2286.077,-1110.6762 2275.5034,-1110.0065 2277.3936,-1116.7465"/>
</g>
<!-- CompactRange -->
<g id="node54" class="node">
<title>CompactRange</title>
<polygon fill="none" stroke="#000000" points="2184.9931,-1089 2082.3711,-1089 2082.3711,-1053 2184.9931,-1053 2184.9931,-1089"/>
<text text-anchor="middle" x="2133.6821" y="-1066.8" font-family="Times,serif" font-size="14.00" fill="#000000">CompactRange</text>
</g>
<!-- BackgroundCompaction&#45;&gt;CompactRange -->
<g id="edge56" class="edge">
<title>BackgroundCompaction&#45;&gt;CompactRange</title>
<path fill="none" stroke="#000000" d="M1953.6183,-1216.2088C1966.5121,-1212.6667 1979.041,-1207.2286 1989.3613,-1199 2020.1642,-1174.4402 1997.3817,-1145.7333 2025.3613,-1118 2038.5671,-1104.9104 2056.0131,-1095.1962 2073.0368,-1088.1088"/>
<polygon fill="#000000" stroke="#000000" points="2074.3842,-1091.34 2082.4214,-1084.4368 2071.8335,-1084.8213 2074.3842,-1091.34"/>
</g>
<!-- DoCompactionWork -->
<g id="node55" class="node">
<title>DoCompactionWork</title>
<polygon fill="none" stroke="#000000" points="2067.5288,-1196.2 2067.5288,-1245.8 2199.8354,-1245.8 2199.8354,-1196.2 2067.5288,-1196.2"/>
<text text-anchor="middle" x="2133.6821" y="-1230.6" font-family="Times,serif" font-size="14.00" fill="#000000">DoCompactionWork</text>
<polyline fill="none" stroke="#000000" points="2067.5288,-1223.8 2199.8354,-1223.8 "/>
<text text-anchor="middle" x="2133.6821" y="-1208.6" font-family="Times,serif" font-size="14.00" fill="#000000">做归并排序</text>
</g>
<!-- BackgroundCompaction&#45;&gt;DoCompactionWork -->
<g id="edge57" class="edge">
<title>BackgroundCompaction&#45;&gt;DoCompactionWork</title>
<path fill="none" stroke="#000000" d="M1953.7856,-1221C1986.4222,-1221 2024.4144,-1221 2057.0526,-1221"/>
<polygon fill="#000000" stroke="#000000" points="2057.4478,-1224.5001 2067.4477,-1221 2057.4477,-1217.5001 2057.4478,-1224.5001"/>
</g>
<!-- PickCompaction -->
<g id="node56" class="node">
<title>PickCompaction</title>
<polygon fill="none" stroke="#000000" points="2055.3027,-1127.2 2055.3027,-1176.8 2212.0615,-1176.8 2212.0615,-1127.2 2055.3027,-1127.2"/>
<text text-anchor="middle" x="2133.6821" y="-1161.6" font-family="Times,serif" font-size="14.00" fill="#000000">PickCompaction</text>
<polyline fill="none" stroke="#000000" points="2055.3027,-1154.8 2212.0615,-1154.8 "/>
<text text-anchor="middle" x="2133.6821" y="-1139.6" font-family="Times,serif" font-size="14.00" fill="#000000">选择需要compact的files</text>
</g>
<!-- BackgroundCompaction&#45;&gt;PickCompaction -->
<g id="edge58" class="edge">
<title>BackgroundCompaction&#45;&gt;PickCompaction</title>
<path fill="none" stroke="#000000" d="M1953.7939,-1207.2628C1965.7537,-1204.7482 1977.9312,-1201.9702 1989.3613,-1199 2010.2775,-1193.5648 2032.6039,-1186.7884 2053.2903,-1180.088"/>
<polygon fill="#000000" stroke="#000000" points="2054.5678,-1183.3526 2062.9832,-1176.9159 2052.3906,-1176.6998 2054.5678,-1183.3526"/>
</g>
<!-- CompactMemTable&#45;&gt;imm_ -->
<g id="edge59" class="edge">
<title>CompactMemTable&#45;&gt;imm_</title>
<path fill="none" stroke="#000000" d="M2449.8272,-1053.2879C2452.6411,-1051.8722 2455.4129,-1050.441 2458.1201,-1049 2481.898,-1036.3433 2507.235,-1020.3855 2527.9678,-1006.6202"/>
<polygon fill="#000000" stroke="#000000" points="2530.1917,-1009.3433 2536.5534,-1000.871 2526.2969,-1003.5269 2530.1917,-1009.3433"/>
</g>
<!-- CompactMemTable&#45;&gt;shutting_down_ -->
<g id="edge60" class="edge">
<title>CompactMemTable&#45;&gt;shutting_down_</title>
<path fill="none" stroke="#000000" d="M2424.6284,-1122.6535C2459.4083,-1143.96 2503.0472,-1170.6936 2533.8029,-1189.5348"/>
<polygon fill="#000000" stroke="#000000" points="2532.1578,-1192.6315 2542.5132,-1194.8709 2535.8144,-1186.6626 2532.1578,-1192.6315"/>
</g>
<!-- WriteLevel0Table -->
<g id="node57" class="node">
<title>WriteLevel0Table</title>
<polygon fill="#f38181" stroke="#000000" points="2512.8848,-1053.2 2512.8848,-1102.8 2631.3281,-1102.8 2631.3281,-1053.2 2512.8848,-1053.2"/>
<text text-anchor="middle" x="2572.1064" y="-1087.6" font-family="Times,serif" font-size="14.00" fill="#000000">WriteLevel0Table</text>
<polyline fill="none" stroke="#000000" points="2512.8848,-1080.8 2631.3281,-1080.8 "/>
<text text-anchor="start" x="2520.8848" y="-1065.6" font-family="Times,serif" font-size="14.00" fill="#000000">将MemTable落盘</text>
</g>
<!-- CompactMemTable&#45;&gt;WriteLevel0Table -->
<g id="edge61" class="edge">
<title>CompactMemTable&#45;&gt;WriteLevel0Table</title>
<path fill="none" stroke="#000000" d="M2449.8787,-1083.9902C2467.3238,-1083.1353 2485.59,-1082.2401 2502.5251,-1081.4101"/>
<polygon fill="#000000" stroke="#000000" points="2503.0617,-1084.8881 2512.8784,-1080.9027 2502.719,-1077.8965 2503.0617,-1084.8881"/>
</g>
<!-- CompactRange&#45;&gt;OverlapInLevel -->
<g id="edge70" class="edge">
<title>CompactRange&#45;&gt;OverlapInLevel</title>
<path fill="none" stroke="#000000" d="M2185.0192,-1073.7289C2207.8605,-1072.1334 2233.3089,-1066.0206 2250.0029,-1049 2345.5572,-951.5765 2364.1699,-497.9486 2367.4252,-379.4041"/>
<polygon fill="#000000" stroke="#000000" points="2370.9267,-379.3899 2367.6871,-369.3025 2363.929,-379.2085 2370.9267,-379.3899"/>
</g>
<!-- DoCompactionWork&#45;&gt;CompactMemTable -->
<g id="edge62" class="edge">
<title>DoCompactionWork&#45;&gt;CompactMemTable</title>
<path fill="none" stroke="#000000" d="M2199.989,-1210.2426C2216.8893,-1205.9678 2234.6143,-1200.0752 2250.0029,-1192 2279.991,-1176.2637 2308.6236,-1151.3758 2330.1797,-1129.8919"/>
<polygon fill="#000000" stroke="#000000" points="2332.6861,-1132.3349 2337.2105,-1122.7547 2327.6993,-1127.4225 2332.6861,-1132.3349"/>
</g>
<!-- OpenCompactionOutputFile -->
<g id="node59" class="node">
<title>OpenCompactionOutputFile</title>
<polygon fill="none" stroke="#000000" points="2455.9898,-1177 2280.1333,-1177 2280.1333,-1141 2455.9898,-1141 2455.9898,-1177"/>
<text text-anchor="middle" x="2368.0615" y="-1154.8" font-family="Times,serif" font-size="14.00" fill="#000000">OpenCompactionOutputFile</text>
</g>
<!-- DoCompactionWork&#45;&gt;OpenCompactionOutputFile -->
<g id="edge63" class="edge">
<title>DoCompactionWork&#45;&gt;OpenCompactionOutputFile</title>
<path fill="none" stroke="#000000" d="M2199.8932,-1204.8366C2216.2923,-1200.7386 2233.8051,-1196.2821 2250.0029,-1192 2264.6024,-1188.1405 2280.1787,-1183.8852 2295.0686,-1179.7501"/>
<polygon fill="#000000" stroke="#000000" points="2296.044,-1183.1117 2304.7372,-1177.0555 2294.1646,-1176.3687 2296.044,-1183.1117"/>
</g>
<!-- FinishCompactionOutputFile -->
<g id="node60" class="node">
<title>FinishCompactionOutputFile</title>
<polygon fill="none" stroke="#000000" points="2458.1787,-1231 2277.9443,-1231 2277.9443,-1195 2458.1787,-1195 2458.1787,-1231"/>
<text text-anchor="middle" x="2368.0615" y="-1208.8" font-family="Times,serif" font-size="14.00" fill="#000000">FinishCompactionOutputFile</text>
</g>
<!-- DoCompactionWork&#45;&gt;FinishCompactionOutputFile -->
<g id="edge64" class="edge">
<title>DoCompactionWork&#45;&gt;FinishCompactionOutputFile</title>
<path fill="none" stroke="#000000" d="M2199.9061,-1218.7396C2221.0135,-1218.0191 2244.8605,-1217.2052 2267.8207,-1216.4215"/>
<polygon fill="#000000" stroke="#000000" points="2268.0691,-1219.9151 2277.9439,-1216.076 2267.8303,-1212.9192 2268.0691,-1219.9151"/>
</g>
<!-- BlockBuilder_Add -->
<g id="node61" class="node">
<title>BlockBuilder_Add</title>
<polygon fill="none" stroke="#000000" points="2429.1073,-1285 2307.0158,-1285 2307.0158,-1249 2429.1073,-1249 2429.1073,-1285"/>
<text text-anchor="middle" x="2368.0615" y="-1262.8" font-family="Times,serif" font-size="14.00" fill="#000000">BlockBuilder_Add</text>
</g>
<!-- DoCompactionWork&#45;&gt;BlockBuilder_Add -->
<g id="edge65" class="edge">
<title>DoCompactionWork&#45;&gt;BlockBuilder_Add</title>
<path fill="none" stroke="#000000" d="M2199.9061,-1233.9973C2230.199,-1239.9427 2266.1346,-1246.9955 2296.9935,-1253.052"/>
<polygon fill="#000000" stroke="#000000" points="2296.3338,-1256.4892 2306.8207,-1254.9807 2297.682,-1249.6202 2296.3338,-1256.4892"/>
</g>
<!-- WriteLevel0Table&#45;&gt;PickLevelForMemTableOutput -->
<g id="edge66" class="edge">
<title>WriteLevel0Table&#45;&gt;PickLevelForMemTableOutput</title>
<path fill="none" stroke="#000000" d="M2631.3693,-1057.3334C2638.4513,-1052.8491 2644.9716,-1047.4581 2650.0928,-1041 2723.7657,-948.0934 2767.8893,-567.7215 2779.0469,-460.3451"/>
<polygon fill="#000000" stroke="#000000" points="2782.5415,-460.5756 2780.0796,-450.2708 2775.578,-459.8617 2782.5415,-460.5756"/>
</g>
<!-- WriteLevel0Table&#45;&gt;NewFileNumber -->
<g id="edge67" class="edge">
<title>WriteLevel0Table&#45;&gt;NewFileNumber</title>
<path fill="none" stroke="#000000" d="M2631.5727,-1058.5342C2638.8141,-1053.8531 2645.325,-1048.0875 2650.0928,-1041 2729.1065,-923.5438 2597.4919,-515.4038 2686.0928,-405 2693.9844,-395.1664 2705.161,-388.7453 2717.1079,-384.5903"/>
<polygon fill="#000000" stroke="#000000" points="2718.2095,-387.9144 2726.8062,-381.7219 2716.2242,-381.2019 2718.2095,-387.9144"/>
</g>
<!-- BuildTable -->
<g id="node58" class="node">
<title>BuildTable</title>
<polygon fill="none" stroke="#000000" points="2722.6411,-1053.2 2722.6411,-1102.8 2841.0845,-1102.8 2841.0845,-1053.2 2722.6411,-1053.2"/>
<text text-anchor="middle" x="2781.8628" y="-1087.6" font-family="Times,serif" font-size="14.00" fill="#000000">BuildTable</text>
<polyline fill="none" stroke="#000000" points="2722.6411,-1080.8 2841.0845,-1080.8 "/>
<text text-anchor="middle" x="2781.8628" y="-1065.6" font-family="Times,serif" font-size="14.00" fill="#000000">将MemTable落盘</text>
</g>
<!-- WriteLevel0Table&#45;&gt;BuildTable -->
<g id="edge68" class="edge">
<title>WriteLevel0Table&#45;&gt;BuildTable</title>
<path fill="none" stroke="#000000" d="M2631.3731,-1078C2656.5064,-1078 2685.9799,-1078 2712.1499,-1078"/>
<polygon fill="#000000" stroke="#000000" points="2712.3791,-1081.5001 2722.379,-1078 2712.379,-1074.5001 2712.3791,-1081.5001"/>
</g>
<!-- AddFile -->
<g id="node62" class="node">
<title>AddFile</title>
<polygon fill="none" stroke="#000000" points="2812.7525,-1157 2750.973,-1157 2750.973,-1121 2812.7525,-1121 2812.7525,-1157"/>
<text text-anchor="middle" x="2781.8628" y="-1134.8" font-family="Times,serif" font-size="14.00" fill="#000000">AddFile</text>
</g>
<!-- WriteLevel0Table&#45;&gt;AddFile -->
<g id="edge69" class="edge">
<title>WriteLevel0Table&#45;&gt;AddFile</title>
<path fill="none" stroke="#000000" d="M2631.5117,-1095.9041C2649.0707,-1101.1463 2668.342,-1106.8508 2686.0928,-1112 2704.1224,-1117.2301 2724.1027,-1122.8853 2741.1285,-1127.6622"/>
<polygon fill="#000000" stroke="#000000" points="2740.2012,-1131.0371 2750.7746,-1130.3633 2742.0888,-1124.2964 2740.2012,-1131.0371"/>
</g>
</g>
</svg>
