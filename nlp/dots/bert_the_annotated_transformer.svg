<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.49.3 (20211023.0002)
 -->
<!-- Title: bert Pages: 1 -->
<svg width="1248pt" height="396pt"
 viewBox="0.00 0.00 1248.00 396.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 392)">
<title>bert</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-392 1244,-392 1244,4 -4,4"/>
<!-- EncoderDecoder -->
<g id="node1" class="node">
<title>EncoderDecoder</title>
<polygon fill="none" stroke="black" points="111,-296 0,-296 0,-260 111,-260 111,-296"/>
<text text-anchor="middle" x="55.5" y="-274.3" font-family="Times,serif" font-size="14.00">EncoderDecoder</text>
</g>
<!-- Encoder -->
<g id="node2" class="node">
<title>Encoder</title>
<polygon fill="none" stroke="black" points="369.5,-250 306.5,-250 306.5,-214 369.5,-214 369.5,-250"/>
<text text-anchor="middle" x="338" y="-228.3" font-family="Times,serif" font-size="14.00">Encoder</text>
</g>
<!-- EncoderDecoder&#45;&gt;Encoder -->
<g id="edge1" class="edge">
<title>EncoderDecoder&#45;&gt;Encoder</title>
<path fill="none" stroke="#666666" d="M111.14,-274.68C147.58,-271.88 196.43,-267.02 239,-259 258.14,-255.39 278.98,-249.88 296.51,-244.77"/>
<polygon fill="#666666" stroke="#666666" points="297.82,-248.03 306.41,-241.83 295.83,-241.32 297.82,-248.03"/>
</g>
<!-- Decoder -->
<g id="node3" class="node">
<title>Decoder</title>
<polygon fill="none" stroke="black" points="520,-332 456,-332 456,-296 520,-296 520,-332"/>
<text text-anchor="middle" x="488" y="-310.3" font-family="Times,serif" font-size="14.00">Decoder</text>
</g>
<!-- EncoderDecoder&#45;&gt;Decoder -->
<g id="edge2" class="edge">
<title>EncoderDecoder&#45;&gt;Decoder</title>
<path fill="none" stroke="#666666" d="M111.02,-282.56C198.22,-289.85 367.15,-303.98 445.38,-310.52"/>
<polygon fill="#666666" stroke="#666666" points="445.55,-314.05 455.8,-311.39 446.13,-307.07 445.55,-314.05"/>
</g>
<!-- src_embed -->
<g id="node4" class="node">
<title>src_embed</title>
<polygon fill="none" stroke="black" points="231.5,-196 154.5,-196 154.5,-160 231.5,-160 231.5,-196"/>
<text text-anchor="middle" x="193" y="-174.3" font-family="Times,serif" font-size="14.00">src_embed</text>
</g>
<!-- EncoderDecoder&#45;&gt;src_embed -->
<g id="edge3" class="edge">
<title>EncoderDecoder&#45;&gt;src_embed</title>
<path fill="none" stroke="#666666" d="M77.43,-259.73C95.37,-244.42 122.17,-222.34 147,-205 148.62,-203.87 150.3,-202.73 152,-201.6"/>
<polygon fill="#666666" stroke="#666666" points="154.13,-204.39 160.66,-196.04 150.35,-198.5 154.13,-204.39"/>
</g>
<!-- target_embed -->
<g id="node5" class="node">
<title>target_embed</title>
<polygon fill="none" stroke="black" points="239,-250 147,-250 147,-214 239,-214 239,-250"/>
<text text-anchor="middle" x="193" y="-228.3" font-family="Times,serif" font-size="14.00">target_embed</text>
</g>
<!-- EncoderDecoder&#45;&gt;target_embed -->
<g id="edge4" class="edge">
<title>EncoderDecoder&#45;&gt;target_embed</title>
<path fill="none" stroke="#666666" d="M109.66,-259.95C118.7,-256.88 128.1,-253.69 137.18,-250.61"/>
<polygon fill="#666666" stroke="#666666" points="138.53,-253.85 146.88,-247.32 136.28,-247.22 138.53,-253.85"/>
</g>
<!-- Generator -->
<g id="node6" class="node">
<title>Generator</title>
<polygon fill="none" stroke="black" points="659.5,-388 587.5,-388 587.5,-352 659.5,-352 659.5,-388"/>
<text text-anchor="middle" x="623.5" y="-366.3" font-family="Times,serif" font-size="14.00">Generator</text>
</g>
<!-- EncoderDecoder&#45;&gt;Generator -->
<g id="edge5" class="edge">
<title>EncoderDecoder&#45;&gt;Generator</title>
<path fill="none" stroke="#666666" d="M111.26,-294.35C122.98,-297.51 135.35,-300.58 147,-303 303.52,-335.5 492.34,-356.9 577.26,-365.6"/>
<polygon fill="#666666" stroke="#666666" points="577.03,-369.09 587.33,-366.62 577.74,-362.13 577.03,-369.09"/>
</g>
<!-- Encoder&#45;&gt;Decoder -->
<g id="edge29" class="edge">
<title>Encoder&#45;&gt;Decoder</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M369.75,-247.49C379.77,-252.63 390.91,-258.47 401,-264 416.43,-272.46 433.19,-282.1 447.79,-290.65"/>
<polygon fill="green" stroke="green" points="446.17,-293.76 456.56,-295.81 449.72,-287.72 446.17,-293.76"/>
</g>
<!-- EncodeLayer -->
<g id="node9" class="node">
<title>EncodeLayer</title>
<polygon fill="none" stroke="black" points="669,-226 578,-226 578,-190 669,-190 669,-226"/>
<text text-anchor="middle" x="623.5" y="-204.3" font-family="Times,serif" font-size="14.00">EncodeLayer</text>
</g>
<!-- Encoder&#45;&gt;EncodeLayer -->
<g id="edge10" class="edge">
<title>Encoder&#45;&gt;EncodeLayer</title>
<path fill="none" stroke="#666666" d="M369.61,-229.41C416.88,-225.41 508.35,-217.66 567.36,-212.67"/>
<polygon fill="#666666" stroke="#666666" points="567.95,-216.13 577.62,-211.8 567.36,-209.16 567.95,-216.13"/>
</g>
<!-- LayerNorm -->
<g id="node23" class="node">
<title>LayerNorm</title>
<polygon fill="none" stroke="black" points="664.5,-280 582.5,-280 582.5,-244 664.5,-244 664.5,-280"/>
<text text-anchor="middle" x="623.5" y="-258.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- Encoder&#45;&gt;LayerNorm -->
<g id="edge30" class="edge">
<title>Encoder&#45;&gt;LayerNorm</title>
<path fill="none" stroke="#666666" d="M369.61,-235.24C418.23,-240.38 513.62,-250.48 572.33,-256.69"/>
<polygon fill="#666666" stroke="#666666" points="572.18,-260.2 582.5,-257.77 572.92,-253.23 572.18,-260.2"/>
</g>
<!-- Decoder&#45;&gt;Generator -->
<g id="edge28" class="edge">
<title>Decoder&#45;&gt;Generator</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M520.3,-327.13C537.44,-334.32 558.98,-343.35 577.85,-351.27"/>
<polygon fill="green" stroke="green" points="576.58,-354.53 587.16,-355.18 579.29,-348.08 576.58,-354.53"/>
</g>
<!-- DecoderLayer -->
<g id="node10" class="node">
<title>DecoderLayer</title>
<polygon fill="none" stroke="black" points="672,-334 575,-334 575,-298 672,-298 672,-334"/>
<text text-anchor="middle" x="623.5" y="-312.3" font-family="Times,serif" font-size="14.00">DecoderLayer</text>
</g>
<!-- Decoder&#45;&gt;DecoderLayer -->
<g id="edge11" class="edge">
<title>Decoder&#45;&gt;DecoderLayer</title>
<path fill="none" stroke="#666666" d="M520.3,-314.47C533.51,-314.67 549.33,-314.9 564.54,-315.13"/>
<polygon fill="#666666" stroke="#666666" points="564.87,-318.64 574.93,-315.29 564.98,-311.64 564.87,-318.64"/>
</g>
<!-- Decoder&#45;&gt;LayerNorm -->
<g id="edge31" class="edge">
<title>Decoder&#45;&gt;LayerNorm</title>
<path fill="none" stroke="#666666" d="M520.3,-301.81C535.91,-295.73 555.15,-288.23 572.72,-281.39"/>
<polygon fill="#666666" stroke="#666666" points="574.23,-284.56 582.28,-277.67 571.69,-278.04 574.23,-284.56"/>
</g>
<!-- src_embed&#45;&gt;Encoder -->
<g id="edge26" class="edge">
<title>src_embed&#45;&gt;Encoder</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M231.57,-192.19C251.72,-199.8 276.54,-209.17 297.04,-216.91"/>
<polygon fill="green" stroke="green" points="295.82,-220.19 306.42,-220.45 298.3,-213.64 295.82,-220.19"/>
</g>
<!-- Embedding -->
<g id="node7" class="node">
<title>Embedding</title>
<polygon fill="none" stroke="black" points="378.5,-196 297.5,-196 297.5,-160 378.5,-160 378.5,-196"/>
<text text-anchor="middle" x="338" y="-174.3" font-family="Times,serif" font-size="14.00">Embedding</text>
</g>
<!-- src_embed&#45;&gt;Embedding -->
<g id="edge6" class="edge">
<title>src_embed&#45;&gt;Embedding</title>
<path fill="none" stroke="#666666" d="M231.57,-178C248.6,-178 268.97,-178 287.24,-178"/>
<polygon fill="#666666" stroke="#666666" points="287.43,-181.5 297.43,-178 287.43,-174.5 287.43,-181.5"/>
</g>
<!-- PositionalEncoding -->
<g id="node8" class="node">
<title>PositionalEncoding</title>
<polygon fill="none" stroke="black" points="401,-117 275,-117 275,-81 401,-81 401,-117"/>
<text text-anchor="middle" x="338" y="-95.3" font-family="Times,serif" font-size="14.00">PositionalEncoding</text>
</g>
<!-- src_embed&#45;&gt;PositionalEncoding -->
<g id="edge7" class="edge">
<title>src_embed&#45;&gt;PositionalEncoding</title>
<path fill="none" stroke="#666666" d="M226.81,-159.88C247.15,-148.64 273.48,-134.09 295.3,-122.04"/>
<polygon fill="#666666" stroke="#666666" points="297.28,-124.94 304.35,-117.04 293.9,-118.81 297.28,-124.94"/>
</g>
<!-- target_embed&#45;&gt;Decoder -->
<g id="edge27" class="edge">
<title>target_embed&#45;&gt;Decoder</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M239.24,-247.68C250.85,-251.54 263.34,-255.55 275,-259 334.07,-276.49 403.28,-293.87 446.14,-304.27"/>
<polygon fill="green" stroke="green" points="445.38,-307.69 455.92,-306.64 447.02,-300.89 445.38,-307.69"/>
</g>
<!-- target_embed&#45;&gt;Embedding -->
<g id="edge8" class="edge">
<title>target_embed&#45;&gt;Embedding</title>
<path fill="none" stroke="#666666" d="M239.25,-214.91C254.7,-209.08 272.04,-202.53 287.79,-196.58"/>
<polygon fill="#666666" stroke="#666666" points="289.24,-199.78 297.36,-192.97 286.76,-193.23 289.24,-199.78"/>
</g>
<!-- target_embed&#45;&gt;PositionalEncoding -->
<g id="edge9" class="edge">
<title>target_embed&#45;&gt;PositionalEncoding</title>
<path fill="none" stroke="#666666" d="M228.12,-213.79C231.98,-211.09 235.7,-208.14 239,-205 259.88,-185.09 255.75,-172.49 275,-151 283.8,-141.17 294.49,-131.56 304.49,-123.33"/>
<polygon fill="#666666" stroke="#666666" points="306.71,-126.03 312.32,-117.04 302.33,-120.57 306.71,-126.03"/>
</g>
<!-- nn_Embedding -->
<g id="node13" class="node">
<title>nn_Embedding</title>
<polygon fill="none" stroke="black" points="539,-198 437,-198 437,-162 539,-162 539,-198"/>
<text text-anchor="middle" x="488" y="-176.3" font-family="Times,serif" font-size="14.00">nn_Embedding</text>
</g>
<!-- Embedding&#45;&gt;nn_Embedding -->
<g id="edge16" class="edge">
<title>Embedding&#45;&gt;nn_Embedding</title>
<path fill="none" stroke="#666666" d="M378.66,-178.54C393.34,-178.73 410.34,-178.96 426.45,-179.18"/>
<polygon fill="#666666" stroke="#666666" points="426.84,-182.69 436.88,-179.32 426.93,-175.69 426.84,-182.69"/>
</g>
<!-- vocab -->
<g id="node14" class="node">
<title>vocab</title>
<polygon fill="none" stroke="black" points="515,-144 461,-144 461,-108 515,-108 515,-144"/>
<text text-anchor="middle" x="488" y="-122.3" font-family="Times,serif" font-size="14.00">vocab</text>
</g>
<!-- Embedding&#45;&gt;vocab -->
<g id="edge17" class="edge">
<title>Embedding&#45;&gt;vocab</title>
<path fill="none" stroke="#666666" d="M378.66,-164.06C401.23,-156.13 429.28,-146.28 451.19,-138.58"/>
<polygon fill="#666666" stroke="#666666" points="452.5,-141.83 460.77,-135.21 450.18,-135.23 452.5,-141.83"/>
</g>
<!-- torch__sin -->
<g id="node15" class="node">
<title>torch__sin</title>
<polygon fill="none" stroke="black" points="526,-90 450,-90 450,-54 526,-54 526,-90"/>
<text text-anchor="middle" x="488" y="-68.3" font-family="Times,serif" font-size="14.00">torch__sin</text>
</g>
<!-- PositionalEncoding&#45;&gt;torch__sin -->
<g id="edge18" class="edge">
<title>PositionalEncoding&#45;&gt;torch__sin</title>
<path fill="none" stroke="#666666" d="M401.34,-87.63C414.17,-85.29 427.49,-82.86 439.69,-80.63"/>
<polygon fill="#666666" stroke="#666666" points="440.43,-84.05 449.64,-78.82 439.18,-77.17 440.43,-84.05"/>
</g>
<!-- torch__cos -->
<g id="node16" class="node">
<title>torch__cos</title>
<polygon fill="none" stroke="black" points="527,-36 449,-36 449,0 527,0 527,-36"/>
<text text-anchor="middle" x="488" y="-14.3" font-family="Times,serif" font-size="14.00">torch__cos</text>
</g>
<!-- PositionalEncoding&#45;&gt;torch__cos -->
<g id="edge19" class="edge">
<title>PositionalEncoding&#45;&gt;torch__cos</title>
<path fill="none" stroke="#666666" d="M371.63,-80.93C390.67,-70.41 415.17,-56.91 437,-45 439.39,-43.69 441.85,-42.36 444.34,-41.01"/>
<polygon fill="#666666" stroke="#666666" points="446.24,-43.96 453.36,-36.12 442.9,-37.8 446.24,-43.96"/>
</g>
<!-- MultiHeadAttention -->
<g id="node11" class="node">
<title>MultiHeadAttention</title>
<polygon fill="none" stroke="black" points="873.5,-323 743.5,-323 743.5,-287 873.5,-287 873.5,-323"/>
<text text-anchor="middle" x="808.5" y="-301.3" font-family="Times,serif" font-size="14.00">MultiHeadAttention</text>
</g>
<!-- EncodeLayer&#45;&gt;MultiHeadAttention -->
<g id="edge12" class="edge">
<title>EncodeLayer&#45;&gt;MultiHeadAttention</title>
<path fill="none" stroke="#666666" d="M658.56,-226.12C663.18,-228.93 667.78,-231.93 672,-235 689.55,-247.78 689.48,-256.67 708,-268 717.33,-273.71 727.68,-278.76 738.07,-283.14"/>
<polygon fill="#666666" stroke="#666666" points="737.02,-286.5 747.61,-286.99 739.64,-280 737.02,-286.5"/>
</g>
<!-- PositionwiseFeedForward -->
<g id="node12" class="node">
<title>PositionwiseFeedForward</title>
<path fill="none" stroke="black" d="M720,-197.5C720,-197.5 897,-197.5 897,-197.5 903,-197.5 909,-203.5 909,-209.5 909,-209.5 909,-246.5 909,-246.5 909,-252.5 903,-258.5 897,-258.5 897,-258.5 720,-258.5 720,-258.5 714,-258.5 708,-252.5 708,-246.5 708,-246.5 708,-209.5 708,-209.5 708,-203.5 714,-197.5 720,-197.5"/>
<text text-anchor="start" x="716" y="-243.3" font-family="Times,serif" font-size="14.00">PositionwiseFeedForward</text>
<polyline fill="none" stroke="black" points="708,-235.5 909,-235.5 "/>
<text text-anchor="start" x="716" y="-220.3" font-family="Times,serif" font-size="14.00">FFN(x) = </text>
<text text-anchor="start" x="716" y="-205.3" font-family="Times,serif" font-size="14.00"> max(0, xW_1 + b_1)*W_2 + b2</text>
</g>
<!-- EncodeLayer&#45;&gt;PositionwiseFeedForward -->
<g id="edge13" class="edge">
<title>EncodeLayer&#45;&gt;PositionwiseFeedForward</title>
<path fill="none" stroke="#666666" d="M669.27,-212.89C678.16,-213.86 687.85,-214.92 697.84,-216.02"/>
<polygon fill="#666666" stroke="#666666" points="697.6,-219.51 707.92,-217.12 698.36,-212.55 697.6,-219.51"/>
</g>
<!-- DecoderLayer&#45;&gt;MultiHeadAttention -->
<g id="edge14" class="edge">
<title>DecoderLayer&#45;&gt;MultiHeadAttention</title>
<path fill="none" stroke="#666666" d="M672.1,-313.14C690.76,-312.02 712.61,-310.7 733.24,-309.46"/>
<polygon fill="#666666" stroke="#666666" points="733.48,-312.96 743.26,-308.86 733.06,-305.97 733.48,-312.96"/>
</g>
<!-- DecoderLayer&#45;&gt;PositionwiseFeedForward -->
<g id="edge15" class="edge">
<title>DecoderLayer&#45;&gt;PositionwiseFeedForward</title>
<path fill="none" stroke="#666666" d="M661.97,-297.98C682.93,-287.9 709.77,-274.99 734.69,-263.01"/>
<polygon fill="#666666" stroke="#666666" points="736.27,-266.14 743.76,-258.65 733.23,-259.83 736.27,-266.14"/>
</g>
<!-- nn__Linear -->
<g id="node17" class="node">
<title>nn__Linear</title>
<polygon fill="none" stroke="black" points="1084,-377 1003,-377 1003,-341 1084,-341 1084,-377"/>
<text text-anchor="middle" x="1043.5" y="-355.3" font-family="Times,serif" font-size="14.00">nn__Linear</text>
</g>
<!-- MultiHeadAttention&#45;&gt;nn__Linear -->
<g id="edge20" class="edge">
<title>MultiHeadAttention&#45;&gt;nn__Linear</title>
<path fill="none" stroke="#666666" d="M873.79,-319.9C911.42,-328.62 958.23,-339.47 992.99,-347.52"/>
<polygon fill="#666666" stroke="#666666" points="992.37,-350.98 1002.91,-349.82 993.95,-344.16 992.37,-350.98"/>
</g>
<!-- nn__Dropout -->
<g id="node18" class="node">
<title>nn__Dropout</title>
<polygon fill="none" stroke="black" points="1089,-323 998,-323 998,-287 1089,-287 1089,-323"/>
<text text-anchor="middle" x="1043.5" y="-301.3" font-family="Times,serif" font-size="14.00">nn__Dropout</text>
</g>
<!-- MultiHeadAttention&#45;&gt;nn__Dropout -->
<g id="edge21" class="edge">
<title>MultiHeadAttention&#45;&gt;nn__Dropout</title>
<path fill="none" stroke="#666666" d="M873.79,-305C909.55,-305 953.6,-305 987.72,-305"/>
<polygon fill="#666666" stroke="#666666" points="987.97,-308.5 997.97,-305 987.97,-301.5 987.97,-308.5"/>
</g>
<!-- attention -->
<g id="node19" class="node">
<title>attention</title>
<path fill="none" stroke="black" d="M957,-207.5C957,-207.5 1130,-207.5 1130,-207.5 1136,-207.5 1142,-213.5 1142,-219.5 1142,-219.5 1142,-256.5 1142,-256.5 1142,-262.5 1136,-268.5 1130,-268.5 1130,-268.5 957,-268.5 957,-268.5 951,-268.5 945,-262.5 945,-256.5 945,-256.5 945,-219.5 945,-219.5 945,-213.5 951,-207.5 957,-207.5"/>
<text text-anchor="start" x="953" y="-253.3" font-family="Times,serif" font-size="14.00">attention</text>
<polyline fill="none" stroke="black" points="945,-245.5 1142,-245.5 "/>
<text text-anchor="start" x="953" y="-230.3" font-family="Times,serif" font-size="14.00">attention(Q, K, V) </text>
<text text-anchor="start" x="953" y="-215.3" font-family="Times,serif" font-size="14.00"> = softmax(QK^T/sqrt(d_K))*V</text>
</g>
<!-- MultiHeadAttention&#45;&gt;attention -->
<g id="edge22" class="edge">
<title>MultiHeadAttention&#45;&gt;attention</title>
<path fill="none" stroke="#666666" d="M872.25,-286.96C891.65,-281.38 913.6,-275.07 935.13,-268.87"/>
<polygon fill="#666666" stroke="#666666" points="936.34,-272.17 944.99,-266.04 934.41,-265.44 936.34,-272.17"/>
</g>
<!-- softmax -->
<g id="node20" class="node">
<title>softmax</title>
<polygon fill="none" stroke="black" points="1240,-310 1178,-310 1178,-274 1240,-274 1240,-310"/>
<text text-anchor="middle" x="1209" y="-288.3" font-family="Times,serif" font-size="14.00">softmax</text>
</g>
<!-- attention&#45;&gt;softmax -->
<g id="edge23" class="edge">
<title>attention&#45;&gt;softmax</title>
<path fill="none" stroke="#666666" d="M1137.24,-268.63C1148.15,-272.23 1158.8,-275.75 1168.38,-278.91"/>
<polygon fill="#666666" stroke="#666666" points="1167.36,-282.26 1177.95,-282.07 1169.55,-275.62 1167.36,-282.26"/>
</g>
<!-- matmul -->
<g id="node21" class="node">
<title>matmul</title>
<polygon fill="none" stroke="black" points="1238.5,-256 1179.5,-256 1179.5,-220 1238.5,-220 1238.5,-256"/>
<text text-anchor="middle" x="1209" y="-234.3" font-family="Times,serif" font-size="14.00">matmul</text>
</g>
<!-- attention&#45;&gt;matmul -->
<g id="edge24" class="edge">
<title>attention&#45;&gt;matmul</title>
<path fill="none" stroke="#666666" d="M1142.44,-238C1151.91,-238 1161.08,-238 1169.4,-238"/>
<polygon fill="#666666" stroke="#666666" points="1169.47,-241.5 1179.46,-238 1169.46,-234.5 1169.47,-241.5"/>
</g>
<!-- dropout -->
<g id="node22" class="node">
<title>dropout</title>
<polygon fill="none" stroke="black" points="1239,-202 1179,-202 1179,-166 1239,-166 1239,-202"/>
<text text-anchor="middle" x="1209" y="-180.3" font-family="Times,serif" font-size="14.00">dropout</text>
</g>
<!-- attention&#45;&gt;dropout -->
<g id="edge25" class="edge">
<title>attention&#45;&gt;dropout</title>
<path fill="none" stroke="#666666" d="M1137.24,-207.37C1148.47,-203.66 1159.42,-200.04 1169.22,-196.81"/>
<polygon fill="#666666" stroke="#666666" points="1170.59,-200.04 1178.98,-193.58 1168.39,-193.4 1170.59,-200.04"/>
</g>
</g>
</svg>
