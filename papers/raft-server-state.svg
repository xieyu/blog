<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: raft_server_state Pages: 1 -->
<svg width="1414pt" height="212pt"
 viewBox="0.00 0.00 1413.58 211.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 207.94)">
<title>raft_server_state</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-207.94 1409.584,-207.94 1409.584,4 -4,4"/>
<!-- Follower -->
<g id="node1" class="node">
<title>Follower</title>
<polygon fill="#95e1d3" stroke="#000000" points="0,-71.5 0,-140.6998 246.7197,-140.6998 246.7197,-71.5 0,-71.5"/>
<text text-anchor="middle" x="123.3599" y="-125.4998" font-family="Times,serif" font-size="14.00" fill="#000000">Follower</text>
<polyline fill="none" stroke="#000000" points="0,-118.6998 246.7197,-118.6998 "/>
<text text-anchor="start" x="8" y="-103.4998" font-family="Times,serif" font-size="14.00" fill="#000000">1.处理leader的AppendEntries请求</text>
<text text-anchor="start" x="8" y="-83.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 2.处理Candidate的RequestForVote请求</text>
</g>
<!-- ElectionTimeout -->
<g id="node2" class="node">
<title>ElectionTimeout</title>
<polygon fill="none" stroke="#000000" points="392.1169,-124.0999 282.9202,-124.0999 282.9202,-88.0999 392.1169,-88.0999 392.1169,-124.0999"/>
<text text-anchor="middle" x="337.5186" y="-101.8999" font-family="Times,serif" font-size="14.00" fill="#000000">ElectionTimeout</text>
</g>
<!-- Follower&#45;&gt;ElectionTimeout -->
<g id="edge1" class="edge">
<title>Follower&#45;&gt;ElectionTimeout</title>
<path fill="none" stroke="#666666" d="M247.0064,-106.0999C255.7443,-106.0999 264.3314,-106.0999 272.5272,-106.0999"/>
<polygon fill="#666666" stroke="#666666" points="272.6813,-109.6 282.6813,-106.0999 272.6813,-102.6 272.6813,-109.6"/>
</g>
<!-- Candidate -->
<g id="node3" class="node">
<title>Candidate</title>
<polygon fill="#95e1d3" stroke="#000000" points="428.3174,-81.3 428.3174,-130.8999 562.7637,-130.8999 562.7637,-81.3 428.3174,-81.3"/>
<text text-anchor="middle" x="495.5405" y="-115.6999" font-family="Times,serif" font-size="14.00" fill="#000000">Candidate</text>
<polyline fill="none" stroke="#000000" points="428.3174,-108.8999 562.7637,-108.8999 "/>
<text text-anchor="middle" x="495.5405" y="-93.6999" font-family="Times,serif" font-size="14.00" fill="#000000">1.将自己的term +=1</text>
</g>
<!-- ElectionTimeout&#45;&gt;Candidate -->
<g id="edge2" class="edge">
<title>ElectionTimeout&#45;&gt;Candidate</title>
<path fill="none" stroke="#666666" d="M392.3435,-106.0999C400.6727,-106.0999 409.3987,-106.0999 418.0993,-106.0999"/>
<polygon fill="#666666" stroke="#666666" points="418.2762,-109.6 428.2762,-106.0999 418.2761,-102.6 418.2762,-109.6"/>
</g>
<!-- MajorityVote -->
<g id="node4" class="node">
<title>MajorityVote</title>
<polygon fill="none" stroke="#000000" points="649.3838,-88.5 649.3838,-157.6998 800.3115,-157.6998 800.3115,-88.5 649.3838,-88.5"/>
<text text-anchor="middle" x="724.8477" y="-142.4998" font-family="Times,serif" font-size="14.00" fill="#000000">MajorityVote</text>
<polyline fill="none" stroke="#000000" points="649.3838,-135.6998 800.3115,-135.6998 "/>
<text text-anchor="start" x="657.3838" y="-120.4998" font-family="Times,serif" font-size="14.00" fill="#000000">候选者收到了</text>
<text text-anchor="start" x="657.3838" y="-100.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 大多数follower的投票</text>
</g>
<!-- Candidate&#45;&gt;MajorityVote -->
<g id="edge3" class="edge">
<title>Candidate&#45;&gt;MajorityVote</title>
<path fill="none" stroke="#666666" d="M562.7908,-111.0856C586.6015,-112.8508 613.7227,-114.8615 638.8757,-116.7263"/>
<polygon fill="#666666" stroke="#666666" points="638.915,-120.2387 649.1464,-117.4877 639.4326,-113.2579 638.915,-120.2387"/>
</g>
<!-- DiscoverLeaderorNewTerm -->
<g id="node7" class="node">
<title>DiscoverLeaderorNewTerm</title>
<polygon fill="none" stroke="#000000" points="598.7637,-.5 598.7637,-69.6998 850.9316,-69.6998 850.9316,-.5 598.7637,-.5"/>
<text text-anchor="middle" x="724.8477" y="-54.4998" font-family="Times,serif" font-size="14.00" fill="#000000">DiscoverLeaderorNewTerm</text>
<polyline fill="none" stroke="#000000" points="598.7637,-47.6998 850.9316,-47.6998 "/>
<text text-anchor="start" x="606.7637" y="-32.4998" font-family="Times,serif" font-size="14.00" fill="#000000">1.如果收到了term比自己大的AE请求</text>
<text text-anchor="start" x="606.7637" y="-12.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 2.如果RequestVote返回的term比自己大</text>
</g>
<!-- Candidate&#45;&gt;DiscoverLeaderorNewTerm -->
<g id="edge7" class="edge">
<title>Candidate&#45;&gt;DiscoverLeaderorNewTerm</title>
<path fill="none" stroke="#666666" d="M562.7908,-85.2773C575.5683,-81.321 589.2991,-77.0696 603.1675,-72.7755"/>
<polygon fill="#666666" stroke="#666666" points="604.2634,-76.1002 612.7807,-69.799 602.1929,-69.4134 604.2634,-76.1002"/>
</g>
<!-- Leader -->
<g id="node5" class="node">
<title>Leader</title>
<polygon fill="#95e1d3" stroke="#000000" points="886.9316,-38.1001 886.9316,-174.0997 1180.9424,-174.0997 1180.9424,-38.1001 886.9316,-38.1001"/>
<text text-anchor="middle" x="1033.937" y="-158.8997" font-family="Times,serif" font-size="14.00" fill="#000000">Leader</text>
<polyline fill="none" stroke="#000000" points="886.9316,-152.0997 1180.9424,-152.0997 "/>
<text text-anchor="start" x="894.9316" y="-136.8997" font-family="Times,serif" font-size="14.00" fill="#000000">1.接受client读写请求</text>
<text text-anchor="start" x="894.9316" y="-117.2998" font-family="Times,serif" font-size="14.00" fill="#000000"> 2.通过发送空的AppendEntries心跳信息</text>
<text text-anchor="start" x="894.9316" y="-97.6999" font-family="Times,serif" font-size="14.00" fill="#000000"> 抑制follower的electiontimeout</text>
<polyline fill="none" stroke="#000000" points="886.9316,-85.3 1180.9424,-85.3 "/>
<text text-anchor="start" x="894.9316" y="-70.1" font-family="Times,serif" font-size="14.00" fill="#000000">3.通过AppendEntries将log entry push给follower</text>
<text text-anchor="start" x="894.9316" y="-50.5" font-family="Times,serif" font-size="14.00" fill="#000000"> 让follower的logentry保持和leader一致</text>
</g>
<!-- MajorityVote&#45;&gt;Leader -->
<g id="edge4" class="edge">
<title>MajorityVote&#45;&gt;Leader</title>
<path fill="none" stroke="#666666" d="M800.4594,-118.9412C823.6761,-117.6643 850.1415,-116.2087 876.7126,-114.7473"/>
<polygon fill="#666666" stroke="#666666" points="877.1022,-118.2313 886.8949,-114.1873 876.7177,-111.2418 877.1022,-118.2313"/>
</g>
<!-- DiscoverHigherTerm -->
<g id="node6" class="node">
<title>DiscoverHigherTerm</title>
<polygon fill="none" stroke="#000000" points="1216.9424,-119.5 1216.9424,-188.6998 1405.584,-188.6998 1405.584,-119.5 1216.9424,-119.5"/>
<text text-anchor="middle" x="1311.2632" y="-173.4998" font-family="Times,serif" font-size="14.00" fill="#000000">DiscoverHigherTerm</text>
<polyline fill="none" stroke="#000000" points="1216.9424,-166.6998 1405.584,-166.6998 "/>
<text text-anchor="start" x="1224.9424" y="-151.4998" font-family="Times,serif" font-size="14.00" fill="#000000">1.如果follower的AE Rpc请求</text>
<text text-anchor="start" x="1224.9424" y="-131.8999" font-family="Times,serif" font-size="14.00" fill="#000000"> 返回的term比自己大</text>
</g>
<!-- Leader&#45;&gt;DiscoverHigherTerm -->
<g id="edge5" class="edge">
<title>Leader&#45;&gt;DiscoverHigherTerm</title>
<path fill="none" stroke="#666666" d="M1181.1263,-131.5756C1189.6978,-133.0592 1198.2257,-134.5352 1206.5783,-135.9809"/>
<polygon fill="#666666" stroke="#666666" points="1206.2204,-139.4709 1216.6708,-137.7277 1207.4142,-132.5735 1206.2204,-139.4709"/>
</g>
<!-- DiscoverHigherTerm&#45;&gt;Follower -->
<g id="edge6" class="edge">
<title>DiscoverHigherTerm&#45;&gt;Follower</title>
<path fill="none" stroke="#666666" d="M1216.5914,-177.2196C1204.6466,-179.5298 1192.5483,-181.5791 1180.9424,-183.0999 979.7776,-209.4604 927.7322,-202.0999 724.8477,-202.0999 495.5405,-202.0999 495.5405,-202.0999 495.5405,-202.0999 398.4698,-202.0999 291.5428,-171.1021 217.3043,-144.3347"/>
<polygon fill="#666666" stroke="#666666" points="218.1003,-140.8995 207.5064,-140.7581 215.6999,-147.475 218.1003,-140.8995"/>
</g>
<!-- DiscoverLeaderorNewTerm&#45;&gt;Follower -->
<g id="edge8" class="edge">
<title>DiscoverLeaderorNewTerm&#45;&gt;Follower</title>
<path fill="none" stroke="#666666" d="M598.322,-45.369C509.7643,-53.124 388.7955,-64.8527 282.7197,-79.0999 274.233,-80.2398 265.5051,-81.4916 256.7143,-82.8123"/>
<polygon fill="#666666" stroke="#666666" points="256.1289,-79.3611 246.7718,-84.3306 257.1856,-86.2809 256.1289,-79.3611"/>
</g>
</g>
</svg>
