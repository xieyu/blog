<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: raft Pages: 1 -->
<svg width="942pt" height="1071pt"
 viewBox="0.00 0.00 941.86 1071.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1067.0034)">
<title>raft</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1067.0034 937.8599,-1067.0034 937.8599,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Leader</title>
<polygon fill="none" stroke="#000000" points="8,-395.5 8,-753.5 415.2227,-753.5 415.2227,-395.5 8,-395.5"/>
<text text-anchor="middle" x="211.6113" y="-733.5" font-family="Times,serif" font-size="20.00" fill="#000000">Leader</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Follower</title>
<polygon fill="none" stroke="#000000" points="8,-141.5 8,-387.5 925.8599,-387.5 925.8599,-141.5 8,-141.5"/>
<text text-anchor="middle" x="466.9299" y="-367.5" font-family="Times,serif" font-size="20.00" fill="#000000">Follower</text>
</g>
<!-- PersistentState -->
<g id="node1" class="node">
<title>PersistentState</title>
<polygon fill="#95e1d3" stroke="#000000" points="16,-601.7 16,-717.3 172,-717.3 172,-601.7 16,-601.7"/>
<text text-anchor="middle" x="94" y="-702.1" font-family="Times,serif" font-size="14.00" fill="#000000">PersistentState</text>
<polyline fill="none" stroke="#000000" points="16,-695.3 172,-695.3 "/>
<text text-anchor="start" x="24" y="-680.1" font-family="Times,serif" font-size="14.00" fill="#000000">需要持久化存储的状态</text>
<polyline fill="none" stroke="#000000" points="16,-667.7 172,-667.7 "/>
<text text-anchor="start" x="24" y="-652.5" font-family="Times,serif" font-size="14.00" fill="#000000">currentTerm</text>
<polyline fill="none" stroke="#000000" points="16,-645.7 172,-645.7 "/>
<text text-anchor="start" x="24" y="-630.5" font-family="Times,serif" font-size="14.00" fill="#000000">votedFor</text>
<polyline fill="none" stroke="#000000" points="16,-623.7 172,-623.7 "/>
<text text-anchor="start" x="24" y="-608.5" font-family="Times,serif" font-size="14.00" fill="#000000">log[]</text>
</g>
<!-- Log -->
<g id="node2" class="node">
<title>Log</title>
<polygon fill="none" stroke="#000000" points="208,-574.5 208,-662.5 274.5449,-662.5 274.5449,-574.5 208,-574.5"/>
<text text-anchor="middle" x="241.2725" y="-647.3" font-family="Times,serif" font-size="14.00" fill="#000000">Log</text>
<polyline fill="none" stroke="#000000" points="208,-640.5 274.5449,-640.5 "/>
<text text-anchor="start" x="216" y="-625.3" font-family="Times,serif" font-size="14.00" fill="#000000">logItem1</text>
<polyline fill="none" stroke="#000000" points="208,-618.5 274.5449,-618.5 "/>
<text text-anchor="start" x="216" y="-603.3" font-family="Times,serif" font-size="14.00" fill="#000000">logItem2</text>
<polyline fill="none" stroke="#000000" points="208,-596.5 274.5449,-596.5 "/>
<text text-anchor="middle" x="241.2725" y="-581.3" font-family="Times,serif" font-size="14.00" fill="#000000">...</text>
</g>
<!-- PersistentState&#45;&gt;Log -->
<g id="edge1" class="edge">
<title>PersistentState&#45;&gt;Log</title>
<path fill="none" stroke="#666666" d="M172.3794,-637.6795C181.2677,-635.2051 190.0634,-632.7564 198.2457,-630.4784"/>
<polygon fill="#666666" stroke="#666666" points="199.1922,-633.8481 207.8871,-627.7943 197.3148,-627.1046 199.1922,-633.8481"/>
</g>
<!-- LogItem -->
<g id="node5" class="node">
<title>LogItem</title>
<polygon fill="none" stroke="#000000" points="336.7949,-596.5 336.7949,-640.5 407.2227,-640.5 407.2227,-596.5 336.7949,-596.5"/>
<text text-anchor="start" x="344.7949" y="-625.3" font-family="Times,serif" font-size="14.00" fill="#000000">LogIndex</text>
<polyline fill="none" stroke="#000000" points="336.7949,-618.5 407.2227,-618.5 "/>
<text text-anchor="start" x="344.7949" y="-603.3" font-family="Times,serif" font-size="14.00" fill="#000000">Term</text>
</g>
<!-- Log&#45;&gt;LogItem -->
<g id="edge2" class="edge">
<title>Log&#45;&gt;LogItem</title>
<path fill="none" stroke="#666666" d="M274.601,-618.5C290.2634,-618.5 309.186,-618.5 326.1715,-618.5"/>
<polygon fill="#666666" stroke="#666666" points="326.4505,-622.0001 336.4505,-618.5 326.4504,-615.0001 326.4505,-622.0001"/>
</g>
<!-- VolatileState -->
<g id="node3" class="node">
<title>VolatileState</title>
<polygon fill="#95e1d3" stroke="#000000" points="50.3574,-516.5 50.3574,-582.5 137.6426,-582.5 137.6426,-516.5 50.3574,-516.5"/>
<text text-anchor="middle" x="94" y="-567.3" font-family="Times,serif" font-size="14.00" fill="#000000">VolatileState</text>
<polyline fill="none" stroke="#000000" points="50.3574,-560.5 137.6426,-560.5 "/>
<text text-anchor="start" x="58.3574" y="-545.3" font-family="Times,serif" font-size="14.00" fill="#000000">comitIndex</text>
<polyline fill="none" stroke="#000000" points="50.3574,-538.5 137.6426,-538.5 "/>
<text text-anchor="start" x="58.3574" y="-523.3" font-family="Times,serif" font-size="14.00" fill="#000000">lastApplied</text>
</g>
<!-- LeaderVolatileState -->
<g id="node4" class="node">
<title>LeaderVolatileState</title>
<polygon fill="#95e1d3" stroke="#000000" points="16,-403.7 16,-497.3 172,-497.3 172,-403.7 16,-403.7"/>
<text text-anchor="middle" x="94" y="-482.1" font-family="Times,serif" font-size="14.00" fill="#000000">LeaderVolatileState</text>
<polyline fill="none" stroke="#000000" points="16,-475.3 172,-475.3 "/>
<text text-anchor="start" x="24" y="-460.1" font-family="Times,serif" font-size="14.00" fill="#000000">每次选举后重新初始化</text>
<polyline fill="none" stroke="#000000" points="16,-447.7 172,-447.7 "/>
<text text-anchor="start" x="24" y="-432.5" font-family="Times,serif" font-size="14.00" fill="#000000">nextIndex[]</text>
<polyline fill="none" stroke="#000000" points="16,-425.7 172,-425.7 "/>
<text text-anchor="start" x="24" y="-410.5" font-family="Times,serif" font-size="14.00" fill="#000000">matchIndex[]</text>
</g>
<!-- Leader -->
<g id="node6" class="node">
<title>Leader</title>
<polygon fill="none" stroke="#000000" points="268.6281,-717.5 213.9168,-717.5 213.9168,-681.5 268.6281,-681.5 268.6281,-717.5"/>
<text text-anchor="middle" x="241.2725" y="-695.3" font-family="Times,serif" font-size="14.00" fill="#000000">Leader</text>
</g>
<!-- AppendEntries -->
<g id="node14" class="node">
<title>AppendEntries</title>
<polygon fill="none" stroke="#000000" points="310.5449,-762.3002 310.5449,-1018.6998 433.4727,-1018.6998 433.4727,-762.3002 310.5449,-762.3002"/>
<text text-anchor="middle" x="372.0088" y="-1003.4998" font-family="Times,serif" font-size="14.00" fill="#000000">AppendEntries</text>
<polyline fill="none" stroke="#000000" points="310.5449,-996.6998 433.4727,-996.6998 "/>
<text text-anchor="start" x="318.5449" y="-981.4998" font-family="Times,serif" font-size="14.00" fill="#000000">req:请求参数</text>
<polyline fill="none" stroke="#000000" points="310.5449,-969.0999 433.4727,-969.0999 "/>
<text text-anchor="start" x="318.5449" y="-953.8999" font-family="Times,serif" font-size="14.00" fill="#000000">term leader的任期</text>
<polyline fill="none" stroke="#000000" points="310.5449,-941.5 433.4727,-941.5 "/>
<text text-anchor="start" x="318.5449" y="-926.3" font-family="Times,serif" font-size="14.00" fill="#000000">leaderId l</text>
<polyline fill="none" stroke="#000000" points="310.5449,-919.5 433.4727,-919.5 "/>
<text text-anchor="start" x="318.5449" y="-904.3" font-family="Times,serif" font-size="14.00" fill="#000000">prevLogIndex </text>
<polyline fill="none" stroke="#000000" points="310.5449,-897.5 433.4727,-897.5 "/>
<text text-anchor="start" x="318.5449" y="-882.3" font-family="Times,serif" font-size="14.00" fill="#000000">entries[]</text>
<polyline fill="none" stroke="#000000" points="310.5449,-875.5 433.4727,-875.5 "/>
<text text-anchor="start" x="318.5449" y="-860.3" font-family="Times,serif" font-size="14.00" fill="#000000">leaderCommit</text>
<polyline fill="none" stroke="#000000" points="310.5449,-853.5 433.4727,-853.5 "/>
<text text-anchor="start" x="318.5449" y="-838.3" font-family="Times,serif" font-size="14.00" fill="#000000">resp:返回结果</text>
<polyline fill="none" stroke="#000000" points="310.5449,-825.9001 433.4727,-825.9001 "/>
<text text-anchor="start" x="318.5449" y="-810.7001" font-family="Times,serif" font-size="14.00" fill="#000000">term</text>
<text text-anchor="middle" x="372.0088" y="-796.7001" font-family="Times,serif" font-size="14.00" fill="#000000"> 如果follower返回</text>
<polyline fill="none" stroke="#000000" points="310.5449,-784.3002 433.4727,-784.3002 "/>
<text text-anchor="start" x="318.5449" y="-769.1002" font-family="Times,serif" font-size="14.00" fill="#000000">success</text>
</g>
<!-- Leader&#45;&gt;AppendEntries -->
<g id="edge10" class="edge">
<title>Leader&#45;&gt;AppendEntries</title>
<path fill="none" stroke="#b83b5e" d="M253.808,-717.8139C265.9071,-735.4901 285.2188,-763.7037 304.7552,-792.2455"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="302.0039,-794.4225 310.5405,-800.6976 307.7803,-790.4686 302.0039,-794.4225"/>
</g>
<!-- Follower -->
<g id="node7" class="node">
<title>Follower</title>
<polygon fill="none" stroke="#000000" points="535.8018,-351.5 469.6953,-351.5 469.6953,-315.5 535.8018,-315.5 535.8018,-351.5"/>
<text text-anchor="middle" x="502.7485" y="-329.3" font-family="Times,serif" font-size="14.00" fill="#000000">Follower</text>
</g>
<!-- electionTimeout -->
<g id="node9" class="node">
<title>electionTimeout</title>
<polygon fill="none" stroke="#000000" points="679.4144,-351.5 571.8942,-351.5 571.8942,-315.5 679.4144,-315.5 679.4144,-351.5"/>
<text text-anchor="middle" x="625.6543" y="-329.3" font-family="Times,serif" font-size="14.00" fill="#000000">electionTimeout</text>
</g>
<!-- Follower&#45;&gt;electionTimeout -->
<g id="edge3" class="edge">
<title>Follower&#45;&gt;electionTimeout</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M536.0086,-333.5C544.0664,-333.5 552.9499,-333.5 561.8986,-333.5"/>
<polygon fill="#666666" stroke="#666666" points="561.9891,-337.0001 571.9891,-333.5 561.989,-330.0001 561.9891,-337.0001"/>
</g>
<!-- Candidate -->
<g id="node8" class="node">
<title>Candidate</title>
<polygon fill="none" stroke="#000000" points="787.9228,-351.5 715.4044,-351.5 715.4044,-315.5 787.9228,-315.5 787.9228,-351.5"/>
<text text-anchor="middle" x="751.6636" y="-329.3" font-family="Times,serif" font-size="14.00" fill="#000000">Candidate</text>
</g>
<!-- majorityVote -->
<g id="node10" class="node">
<title>majorityVote</title>
<polygon fill="none" stroke="#000000" points="917.7819,-351.5 829.0941,-351.5 829.0941,-315.5 917.7819,-315.5 917.7819,-351.5"/>
<text text-anchor="middle" x="873.438" y="-329.3" font-family="Times,serif" font-size="14.00" fill="#000000">majorityVote</text>
</g>
<!-- Candidate&#45;&gt;majorityVote -->
<g id="edge5" class="edge">
<title>Candidate&#45;&gt;majorityVote</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M788.1999,-333.5C797.7628,-333.5 808.2851,-333.5 818.5756,-333.5"/>
<polygon fill="#666666" stroke="#666666" points="818.7447,-337.0001 828.7447,-333.5 818.7447,-330.0001 818.7447,-337.0001"/>
</g>
<!-- RequestVote -->
<g id="node13" class="node">
<title>RequestVote</title>
<polygon fill="none" stroke="#000000" points="824.043,-.5 824.043,-132.5 922.833,-132.5 922.833,-.5 824.043,-.5"/>
<text text-anchor="middle" x="873.438" y="-117.3" font-family="Times,serif" font-size="14.00" fill="#000000">RequestVote</text>
<polyline fill="none" stroke="#000000" points="824.043,-110.5 922.833,-110.5 "/>
<text text-anchor="start" x="832.043" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#000000">candidate term</text>
<polyline fill="none" stroke="#000000" points="824.043,-88.5 922.833,-88.5 "/>
<text text-anchor="start" x="832.043" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#000000">candidate id</text>
<polyline fill="none" stroke="#000000" points="824.043,-66.5 922.833,-66.5 "/>
<text text-anchor="start" x="832.043" y="-51.3" font-family="Times,serif" font-size="14.00" fill="#000000">lastLogIndex</text>
<polyline fill="none" stroke="#000000" points="824.043,-44.5 922.833,-44.5 "/>
<text text-anchor="start" x="832.043" y="-29.3" font-family="Times,serif" font-size="14.00" fill="#000000">lastLogTerm</text>
<polyline fill="none" stroke="#000000" points="824.043,-22.5 922.833,-22.5 "/>
<text text-anchor="middle" x="873.438" y="-7.3" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
</g>
<!-- Candidate&#45;&gt;RequestVote -->
<g id="edge7" class="edge">
<title>Candidate&#45;&gt;RequestVote</title>
<path fill="none" stroke="#17b978" d="M758.764,-315.3354C766.1901,-296.2508 778.1235,-265.3362 788.043,-238.5 803.468,-196.769 802.4687,-181.8618 822.0913,-141.6608"/>
<polygon fill="#17b978" stroke="#17b978" points="825.2416,-143.1865 826.6048,-132.6797 818.987,-140.0431 825.2416,-143.1865"/>
</g>
<!-- electionTimeout&#45;&gt;Candidate -->
<g id="edge4" class="edge">
<title>electionTimeout&#45;&gt;Candidate</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M679.4591,-333.5C687.9252,-333.5 696.6177,-333.5 704.9075,-333.5"/>
<polygon fill="#666666" stroke="#666666" points="705.1451,-337.0001 715.1451,-333.5 705.1451,-330.0001 705.1451,-337.0001"/>
</g>
<!-- majorityVote&#45;&gt;Leader -->
<g id="edge6" class="edge">
<title>majorityVote&#45;&gt;Leader</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M871.2819,-351.5066C857.5225,-462.3627 777.6946,-1047.5 625.6543,-1047.5 502.7485,-1047.5 502.7485,-1047.5 502.7485,-1047.5 417.0984,-1047.5 374.9653,-1089.9443 310.5449,-1033.5 264.6831,-993.3164 247.7802,-801.6582 242.9226,-728.2223"/>
<polygon fill="#666666" stroke="#666666" points="246.393,-727.6425 242.2674,-717.8839 239.407,-728.0853 246.393,-727.6425"/>
</g>
<!-- PersistentState2 -->
<g id="node11" class="node">
<title>PersistentState2</title>
<polygon fill="#95e1d3" stroke="#000000" points="16,-235.7 16,-351.3 172,-351.3 172,-235.7 16,-235.7"/>
<text text-anchor="middle" x="94" y="-336.1" font-family="Times,serif" font-size="14.00" fill="#000000">PersistentState</text>
<polyline fill="none" stroke="#000000" points="16,-329.3 172,-329.3 "/>
<text text-anchor="start" x="24" y="-314.1" font-family="Times,serif" font-size="14.00" fill="#000000">需要持久化存储的状态</text>
<polyline fill="none" stroke="#000000" points="16,-301.7 172,-301.7 "/>
<text text-anchor="start" x="24" y="-286.5" font-family="Times,serif" font-size="14.00" fill="#000000">currentTerm</text>
<polyline fill="none" stroke="#000000" points="16,-279.7 172,-279.7 "/>
<text text-anchor="start" x="24" y="-264.5" font-family="Times,serif" font-size="14.00" fill="#000000">votedFor</text>
<polyline fill="none" stroke="#000000" points="16,-257.7 172,-257.7 "/>
<text text-anchor="start" x="24" y="-242.5" font-family="Times,serif" font-size="14.00" fill="#000000">log[]</text>
</g>
<!-- VolatileState2 -->
<g id="node12" class="node">
<title>VolatileState2</title>
<polygon fill="#95e1d3" stroke="#000000" points="50.3574,-150.5 50.3574,-216.5 137.6426,-216.5 137.6426,-150.5 50.3574,-150.5"/>
<text text-anchor="middle" x="94" y="-201.3" font-family="Times,serif" font-size="14.00" fill="#000000">VolatileState</text>
<polyline fill="none" stroke="#000000" points="50.3574,-194.5 137.6426,-194.5 "/>
<text text-anchor="start" x="58.3574" y="-179.3" font-family="Times,serif" font-size="14.00" fill="#000000">comitIndex</text>
<polyline fill="none" stroke="#000000" points="50.3574,-172.5 137.6426,-172.5 "/>
<text text-anchor="start" x="58.3574" y="-157.3" font-family="Times,serif" font-size="14.00" fill="#000000">lastApplied</text>
</g>
<!-- RequestVote&#45;&gt;Leader -->
<g id="edge8" class="edge">
<title>RequestVote&#45;&gt;Leader</title>
<path fill="none" stroke="#17b978" d="M823.7992,-58.6254C738.1726,-48.1491 562.9212,-40.8976 469.4727,-137.5 429.8359,-178.4744 451.6219,-337.4576 433.4727,-391.5 388.2172,-526.2559 373.9747,-568.8814 275.5904,-675.5547"/>
<polygon fill="#17b978" stroke="#17b978" points="272.9086,-673.2994 268.674,-683.0112 278.0407,-678.0598 272.9086,-673.2994"/>
</g>
<!-- RequestVote&#45;&gt;Follower -->
<g id="edge9" class="edge">
<title>RequestVote&#45;&gt;Follower</title>
<path fill="none" stroke="#17b978" d="M823.9362,-108.9546C812.324,-118.549 799.8815,-128.5416 788.043,-137.5 701.3436,-203.1066 594.6907,-273.8793 539.5944,-309.7456"/>
<polygon fill="#17b978" stroke="#17b978" points="537.3634,-307.0213 530.8844,-315.4042 541.1769,-312.8913 537.3634,-307.0213"/>
</g>
<!-- AppendEntries&#45;&gt;Follower -->
<g id="edge11" class="edge">
<title>AppendEntries&#45;&gt;Follower</title>
<path fill="none" stroke="#b83b5e" d="M431.975,-762.2575C432.4885,-760.6671 432.9881,-759.0808 433.4727,-757.5 477.8747,-612.6413 495.4294,-430.7098 500.7864,-361.7454"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="504.2842,-361.9042 501.5436,-351.67 497.3039,-361.3795 504.2842,-361.9042"/>
</g>
<!-- AppendEntries&#45;&gt;Candidate -->
<g id="edge12" class="edge">
<title>AppendEntries&#45;&gt;Candidate</title>
<path fill="none" stroke="#b83b5e" d="M433.6402,-800.0792C522.0009,-670.4433 679.9253,-438.7488 733.3916,-360.3072"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="736.3578,-362.1697 739.0979,-351.9353 730.5736,-358.2272 736.3578,-362.1697"/>
</g>
<!-- client -->
<g id="node15" class="node">
<title>client</title>
<polygon fill="none" stroke="#000000" points="121,-797.5 67,-797.5 67,-761.5 121,-761.5 121,-797.5"/>
<text text-anchor="middle" x="94" y="-775.3" font-family="Times,serif" font-size="14.00" fill="#000000">client</text>
</g>
<!-- client&#45;&gt;Leader -->
<g id="edge13" class="edge">
<title>client&#45;&gt;Leader</title>
<path fill="none" stroke="#666666" d="M121.0567,-774.8089C136.5756,-771.4119 156.0756,-765.9119 172,-757.5 188.3093,-748.8847 204.252,-735.9462 216.7234,-724.4739"/>
<polygon fill="#666666" stroke="#666666" points="219.1576,-726.9892 224.0124,-717.5721 214.3446,-721.9063 219.1576,-726.9892"/>
</g>
</g>
</svg>
