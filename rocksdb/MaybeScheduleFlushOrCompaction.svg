<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: MaybeScheduleFlushOrCompaction Pages: 1 -->
<svg width="1605pt" height="255pt"
 viewBox="0.00 0.00 1605.13 255.30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 251.3)">
<title>MaybeScheduleFlushOrCompaction</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-251.3 1601.1309,-251.3 1601.1309,4 -4,4"/>
<!-- MaybeScheduleFlushOrCompaction -->
<g id="node1" class="node">
<title>MaybeScheduleFlushOrCompaction</title>
<polygon fill="none" stroke="#000000" points="0,-94.7 0,-163.8999 220.5244,-163.8999 220.5244,-94.7 0,-94.7"/>
<text text-anchor="middle" x="110.2622" y="-148.6999" font-family="Times,serif" font-size="14.00" fill="#000000">MaybeScheduleFlushOrCompaction</text>
<polyline fill="none" stroke="#000000" points="0,-141.8999 220.5244,-141.8999 "/>
<text text-anchor="start" x="8" y="-126.6999" font-family="Times,serif" font-size="14.00" fill="#000000">调度刷新和压缩线程</text>
<text text-anchor="start" x="8" y="-107.1" font-family="Times,serif" font-size="14.00" fill="#000000"> 最大线程数为GetBGJobLimits</text>
</g>
<!-- GetBGJobLimits -->
<g id="node2" class="node">
<title>GetBGJobLimits</title>
<polygon fill="none" stroke="#000000" points="387.0596,-247.3 275.7207,-247.3 275.7207,-211.3 387.0596,-211.3 387.0596,-247.3"/>
<text text-anchor="middle" x="331.3901" y="-225.1" font-family="Times,serif" font-size="14.00" fill="#000000">GetBGJobLimits</text>
</g>
<!-- MaybeScheduleFlushOrCompaction&#45;&gt;GetBGJobLimits -->
<g id="edge1" class="edge">
<title>MaybeScheduleFlushOrCompaction&#45;&gt;GetBGJobLimits</title>
<path fill="none" stroke="#666666" d="M175.7507,-164.0289C200.7271,-176.7307 229.6525,-190.795 256.5244,-202.3 260.6366,-204.0606 264.9061,-205.8077 269.2272,-207.5166"/>
<polygon fill="#666666" stroke="#666666" points="268.1393,-210.8483 278.7287,-211.1869 270.6617,-204.3185 268.1393,-210.8483"/>
</g>
<!-- GetBackgroundThreads -->
<g id="node3" class="node">
<title>GetBackgroundThreads</title>
<polygon fill="none" stroke="#000000" points="406.1218,-193.3 256.6585,-193.3 256.6585,-157.3 406.1218,-157.3 406.1218,-193.3"/>
<text text-anchor="middle" x="331.3901" y="-171.1" font-family="Times,serif" font-size="14.00" fill="#000000">GetBackgroundThreads</text>
</g>
<!-- MaybeScheduleFlushOrCompaction&#45;&gt;GetBackgroundThreads -->
<g id="edge2" class="edge">
<title>MaybeScheduleFlushOrCompaction&#45;&gt;GetBackgroundThreads</title>
<path fill="none" stroke="#666666" d="M220.8262,-152.3C229.518,-154.1081 238.2098,-155.9162 246.6867,-157.6796"/>
<polygon fill="#666666" stroke="#666666" points="246.023,-161.1164 256.5263,-159.7265 247.4488,-154.2631 246.023,-161.1164"/>
</g>
<!-- Schedule -->
<g id="node4" class="node">
<title>Schedule</title>
<polygon fill="none" stroke="#000000" points="274.3901,-51.5 274.3901,-101.0999 388.3901,-101.0999 388.3901,-51.5 274.3901,-51.5"/>
<text text-anchor="middle" x="331.3901" y="-85.8999" font-family="Times,serif" font-size="14.00" fill="#000000">Schedule</text>
<polyline fill="none" stroke="#000000" points="274.3901,-79.0999 388.3901,-79.0999 "/>
<text text-anchor="middle" x="331.3901" y="-63.8999" font-family="Times,serif" font-size="14.00" fill="#000000">后台线程池调度</text>
</g>
<!-- MaybeScheduleFlushOrCompaction&#45;&gt;Schedule -->
<g id="edge3" class="edge">
<title>MaybeScheduleFlushOrCompaction&#45;&gt;Schedule</title>
<path fill="none" stroke="#666666" d="M220.8262,-102.8C235.6834,-99.239 250.5406,-95.678 264.3247,-92.3742"/>
<polygon fill="#666666" stroke="#666666" points="265.2478,-95.7522 274.1566,-90.0177 263.6162,-88.945 265.2478,-95.7522"/>
</g>
<!-- BGThread -->
<g id="node5" class="node">
<title>BGThread</title>
<polygon fill="none" stroke="#000000" points="442.2559,-51.5 442.2559,-101.0999 542.2559,-101.0999 542.2559,-51.5 442.2559,-51.5"/>
<text text-anchor="middle" x="492.2559" y="-85.8999" font-family="Times,serif" font-size="14.00" fill="#000000">BGThread</text>
<polyline fill="none" stroke="#000000" points="442.2559,-79.0999 542.2559,-79.0999 "/>
<text text-anchor="middle" x="492.2559" y="-63.8999" font-family="Times,serif" font-size="14.00" fill="#000000">后台工作线程</text>
</g>
<!-- Schedule&#45;&gt;BGThread -->
<g id="edge4" class="edge">
<title>Schedule&#45;&gt;BGThread</title>
<path fill="none" stroke="#b3b3b3" stroke-dasharray="5,2" d="M388.5583,-76.3C402.6562,-76.3 417.7973,-76.3 432.035,-76.3"/>
<polygon fill="#b3b3b3" stroke="#b3b3b3" points="432.2147,-79.8001 442.2147,-76.3 432.2146,-72.8001 432.2147,-79.8001"/>
</g>
<!-- BGWorkFlush -->
<g id="node6" class="node">
<title>BGWorkFlush</title>
<polygon fill="none" stroke="#000000" points="694.4127,-100.3 596.7436,-100.3 596.7436,-64.3 694.4127,-64.3 694.4127,-100.3"/>
<text text-anchor="middle" x="645.5781" y="-78.1" font-family="Times,serif" font-size="14.00" fill="#000000">BGWorkFlush</text>
</g>
<!-- BGThread&#45;&gt;BGWorkFlush -->
<g id="edge5" class="edge">
<title>BGThread&#45;&gt;BGWorkFlush</title>
<path fill="none" stroke="#7f7f7f" stroke-dasharray="5,2" d="M542.4593,-78.2646C556.5147,-78.8146 571.9225,-79.4176 586.4439,-79.9858"/>
<polygon fill="#7f7f7f" stroke="#7f7f7f" points="586.6997,-83.4984 596.829,-80.3922 586.9735,-76.5038 586.6997,-83.4984"/>
</g>
<!-- BGWorkCompaction -->
<g id="node7" class="node">
<title>BGWorkCompaction</title>
<polygon fill="none" stroke="#000000" points="712.7231,-43.3 578.4331,-43.3 578.4331,-7.3 712.7231,-7.3 712.7231,-43.3"/>
<text text-anchor="middle" x="645.5781" y="-21.1" font-family="Times,serif" font-size="14.00" fill="#000000">BGWorkCompaction</text>
</g>
<!-- BGThread&#45;&gt;BGWorkCompaction -->
<g id="edge6" class="edge">
<title>BGThread&#45;&gt;BGWorkCompaction</title>
<path fill="none" stroke="#7f7f7f" stroke-dasharray="5,2" d="M542.4593,-59.6006C554.9167,-55.4569 568.4366,-50.9597 581.46,-46.6277"/>
<polygon fill="#7f7f7f" stroke="#7f7f7f" points="582.9124,-49.8332 591.2965,-43.3558 580.703,-43.1911 582.9124,-49.8332"/>
</g>
<!-- BackgroundCallFlush -->
<g id="node8" class="node">
<title>BackgroundCallFlush</title>
<polygon fill="none" stroke="#000000" points="906.3799,-121.3 767.6142,-121.3 767.6142,-85.3 906.3799,-85.3 906.3799,-121.3"/>
<text text-anchor="middle" x="836.9971" y="-99.1" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundCallFlush</text>
</g>
<!-- BGWorkFlush&#45;&gt;BackgroundCallFlush -->
<g id="edge7" class="edge">
<title>BGWorkFlush&#45;&gt;BackgroundCallFlush</title>
<path fill="none" stroke="#666666" d="M694.3765,-87.6535C713.5011,-89.7516 735.9457,-92.2139 757.2963,-94.5562"/>
<polygon fill="#666666" stroke="#666666" points="757.0184,-98.0467 767.3405,-95.6581 757.7818,-91.0884 757.0184,-98.0467"/>
</g>
<!-- BGWorkCompaction&#45;&gt;MaybeScheduleFlushOrCompaction -->
<g id="edge13" class="edge">
<title>BGWorkCompaction&#45;&gt;MaybeScheduleFlushOrCompaction</title>
<path fill="none" stroke="#666666" d="M578.2008,-18.4523C499.2975,-12.6476 365.5215,-9.7577 256.5244,-42.3 223.4426,-52.1769 190.0873,-71.1639 163.601,-88.8862"/>
<polygon fill="#666666" stroke="#666666" points="161.5398,-86.0555 155.252,-94.5827 165.4851,-91.8378 161.5398,-86.0555"/>
</g>
<!-- BackgroundCallCompaction -->
<g id="node13" class="node">
<title>BackgroundCallCompaction</title>
<polygon fill="none" stroke="#000000" points="925.1905,-43.3 748.8036,-43.3 748.8036,-7.3 925.1905,-7.3 925.1905,-43.3"/>
<text text-anchor="middle" x="836.9971" y="-21.1" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundCallCompaction</text>
</g>
<!-- BGWorkCompaction&#45;&gt;BackgroundCallCompaction -->
<g id="edge14" class="edge">
<title>BGWorkCompaction&#45;&gt;BackgroundCallCompaction</title>
<path fill="none" stroke="#666666" d="M712.7961,-25.3C721.1583,-25.3 729.8398,-25.3 738.5515,-25.3"/>
<polygon fill="#666666" stroke="#666666" points="738.7749,-28.8001 748.7749,-25.3 738.7749,-21.8001 738.7749,-28.8001"/>
</g>
<!-- BackgroundCallFlush&#45;&gt;MaybeScheduleFlushOrCompaction -->
<g id="edge8" class="edge">
<title>BackgroundCallFlush&#45;&gt;MaybeScheduleFlushOrCompaction</title>
<path fill="none" stroke="#666666" d="M767.4335,-106.8491C749.6563,-107.705 730.5729,-108.5795 712.9004,-109.3 545.8,-116.112 352.5639,-122.2108 230.8894,-125.8336"/>
<polygon fill="#666666" stroke="#666666" points="230.6912,-122.3378 220.7996,-126.1332 230.8991,-129.3348 230.6912,-122.3378"/>
</g>
<!-- BackgroundFlush -->
<g id="node9" class="node">
<title>BackgroundFlush</title>
<polygon fill="none" stroke="#000000" points="979.749,-68.7 979.749,-137.8999 1095.3008,-137.8999 1095.3008,-68.7 979.749,-68.7"/>
<text text-anchor="middle" x="1037.5249" y="-122.6999" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundFlush</text>
<polyline fill="none" stroke="#000000" points="979.749,-115.8999 1095.3008,-115.8999 "/>
<text text-anchor="start" x="987.749" y="-100.6999" font-family="Times,serif" font-size="14.00" fill="#000000">将memTable</text>
<text text-anchor="start" x="987.749" y="-81.1" font-family="Times,serif" font-size="14.00" fill="#000000"> 刷到磁盘上</text>
</g>
<!-- BackgroundCallFlush&#45;&gt;BackgroundFlush -->
<g id="edge9" class="edge">
<title>BackgroundCallFlush&#45;&gt;BackgroundFlush</title>
<path fill="none" stroke="#666666" d="M906.5692,-103.3C926.9877,-103.3 949.2857,-103.3 969.6,-103.3"/>
<polygon fill="#666666" stroke="#666666" points="969.7079,-106.8001 979.7079,-103.3 969.7079,-99.8001 969.7079,-106.8001"/>
</g>
<!-- Flush_Job -->
<g id="node10" class="node">
<title>Flush_Job</title>
<polygon fill="none" stroke="#000000" points="1238.471,-120.3 1165.324,-120.3 1165.324,-84.3 1238.471,-84.3 1238.471,-120.3"/>
<text text-anchor="middle" x="1201.8975" y="-98.1" font-family="Times,serif" font-size="14.00" fill="#000000">Flush_Job</text>
</g>
<!-- BackgroundFlush&#45;&gt;Flush_Job -->
<g id="edge10" class="edge">
<title>BackgroundFlush&#45;&gt;Flush_Job</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1095.4765,-102.9474C1114.8831,-102.8293 1136.2695,-102.6992 1154.7485,-102.5868"/>
<polygon fill="#666666" stroke="#666666" points="1154.9906,-106.0855 1164.969,-102.5246 1154.9479,-99.0856 1154.9906,-106.0855"/>
</g>
<!-- WriteLevel0Table -->
<g id="node11" class="node">
<title>WriteLevel0Table</title>
<polygon fill="none" stroke="#000000" points="1303.4424,-76.5 1303.4424,-126.0999 1458.6426,-126.0999 1458.6426,-76.5 1303.4424,-76.5"/>
<text text-anchor="middle" x="1381.0425" y="-110.8999" font-family="Times,serif" font-size="14.00" fill="#000000">WriteLevel0Table</text>
<polyline fill="none" stroke="#000000" points="1303.4424,-104.0999 1458.6426,-104.0999 "/>
<text text-anchor="middle" x="1381.0425" y="-88.8999" font-family="Times,serif" font-size="14.00" fill="#000000">将memtable刷入磁盘中</text>
</g>
<!-- Flush_Job&#45;&gt;WriteLevel0Table -->
<g id="edge11" class="edge">
<title>Flush_Job&#45;&gt;WriteLevel0Table</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1238.5824,-102.0952C1254.5347,-102.0061 1273.9736,-101.8976 1293.299,-101.7897"/>
<polygon fill="#666666" stroke="#666666" points="1293.3953,-105.2894 1303.3756,-101.7335 1293.3562,-98.2895 1293.3953,-105.2894"/>
</g>
<!-- TableBuilder -->
<g id="node12" class="node">
<title>TableBuilder</title>
<polygon fill="none" stroke="#000000" points="1597.0733,-83.3 1508.3036,-83.3 1508.3036,-47.3 1597.0733,-47.3 1597.0733,-83.3"/>
<text text-anchor="middle" x="1552.6885" y="-61.1" font-family="Times,serif" font-size="14.00" fill="#000000">TableBuilder</text>
</g>
<!-- WriteLevel0Table&#45;&gt;TableBuilder -->
<g id="edge12" class="edge">
<title>WriteLevel0Table&#45;&gt;TableBuilder</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1458.83,-84.9853C1472.1284,-82.1961 1485.6864,-79.3526 1498.2117,-76.7256"/>
<polygon fill="#666666" stroke="#666666" points="1498.942,-80.1487 1508.0106,-74.6704 1497.5051,-73.2977 1498.942,-80.1487"/>
</g>
<!-- BackgroundCompaction -->
<g id="node14" class="node">
<title>BackgroundCompaction</title>
<polygon fill="none" stroke="#000000" points="961.0938,-.5 961.0938,-50.0999 1113.9561,-50.0999 1113.9561,-.5 961.0938,-.5"/>
<text text-anchor="middle" x="1037.5249" y="-34.8999" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundCompaction</text>
<polyline fill="none" stroke="#000000" points="961.0938,-28.0999 1113.9561,-28.0999 "/>
<text text-anchor="start" x="969.0938" y="-12.8999" font-family="Times,serif" font-size="14.00" fill="#000000">压缩</text>
</g>
<!-- BackgroundCallCompaction&#45;&gt;BackgroundCompaction -->
<g id="edge15" class="edge">
<title>BackgroundCallCompaction&#45;&gt;BackgroundCompaction</title>
<path fill="none" stroke="#666666" d="M925.2433,-25.3C933.6847,-25.3 942.2415,-25.3 950.6695,-25.3"/>
<polygon fill="#666666" stroke="#666666" points="950.8696,-28.8001 960.8696,-25.3 950.8695,-21.8001 950.8696,-28.8001"/>
</g>
<!-- CompactionJob -->
<g id="node15" class="node">
<title>CompactionJob</title>
<polygon fill="none" stroke="#000000" points="1253.7803,-47.3 1150.0146,-47.3 1150.0146,-11.3 1253.7803,-11.3 1253.7803,-47.3"/>
<text text-anchor="middle" x="1201.8975" y="-25.1" font-family="Times,serif" font-size="14.00" fill="#000000">CompactionJob</text>
</g>
<!-- BackgroundCompaction&#45;&gt;CompactionJob -->
<g id="edge16" class="edge">
<title>BackgroundCompaction&#45;&gt;CompactionJob</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1114.4173,-27.1711C1122.8771,-27.377 1131.4121,-27.5847 1139.6616,-27.7855"/>
<polygon fill="#666666" stroke="#666666" points="1139.8491,-31.291 1149.9313,-28.0354 1140.0194,-24.293 1139.8491,-31.291"/>
</g>
<!-- ProcessKeyValueCompaction -->
<g id="node16" class="node">
<title>ProcessKeyValueCompaction</title>
<polygon fill="none" stroke="#000000" points="1289.8389,-6.5 1289.8389,-56.0999 1472.2461,-56.0999 1472.2461,-6.5 1289.8389,-6.5"/>
<text text-anchor="middle" x="1381.0425" y="-40.8999" font-family="Times,serif" font-size="14.00" fill="#000000">ProcessKeyValueCompaction</text>
<polyline fill="none" stroke="#000000" points="1289.8389,-34.0999 1472.2461,-34.0999 "/>
<text text-anchor="start" x="1297.8389" y="-18.8999" font-family="Times,serif" font-size="14.00" fill="#000000">最归并排序compaction</text>
</g>
<!-- CompactionJob&#45;&gt;ProcessKeyValueCompaction -->
<g id="edge17" class="edge">
<title>CompactionJob&#45;&gt;ProcessKeyValueCompaction</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1254.1952,-29.8838C1262.212,-29.9733 1270.7136,-30.0682 1279.3688,-30.1649"/>
<polygon fill="#666666" stroke="#666666" points="1279.5414,-33.6669 1289.5799,-30.2789 1279.6196,-26.6673 1279.5414,-33.6669"/>
</g>
<!-- ProcessKeyValueCompaction&#45;&gt;TableBuilder -->
<g id="edge18" class="edge">
<title>ProcessKeyValueCompaction&#45;&gt;TableBuilder</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1472.3936,-49.395C1481.1592,-51.1313 1489.8475,-52.8523 1498.0908,-54.4851"/>
<polygon fill="#666666" stroke="#666666" points="1497.4109,-57.9184 1507.9005,-56.4283 1498.7711,-51.0518 1497.4109,-57.9184"/>
</g>
</g>
</svg>
