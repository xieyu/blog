<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: atomic_flush Pages: 1 -->
<svg width="1665pt" height="368pt"
 viewBox="0.00 0.00 1664.56 368.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 364)">
<title>atomic_flush</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-364 1660.5596,-364 1660.5596,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ColumnFamilyData</title>
<polygon fill="none" stroke="#000000" points="1034.9316,-8 1034.9316,-88 1209.3525,-88 1209.3525,-8 1034.9316,-8"/>
<text text-anchor="middle" x="1122.1421" y="-68" font-family="Times,serif" font-size="20.00" fill="#000000">ColumnFamilyData</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_DBImpl</title>
<polygon fill="none" stroke="#000000" points="8,-96 8,-352 1648.5596,-352 1648.5596,-96 8,-96"/>
<text text-anchor="middle" x="828.2798" y="-332" font-family="Times,serif" font-size="20.00" fill="#000000">DBImpl</text>
</g>
<!-- NeedsCompaction -->
<g id="node1" class="node">
<title>NeedsCompaction</title>
<polygon fill="none" stroke="#000000" points="1181.5637,-52 1061.7204,-52 1061.7204,-16 1181.5637,-16 1181.5637,-52"/>
<text text-anchor="middle" x="1121.6421" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">NeedsCompaction</text>
</g>
<!-- AddToCompactionQueue -->
<g id="node9" class="node">
<title>AddToCompactionQueue</title>
<polygon fill="none" stroke="#000000" points="1396.8387,-151 1237.5236,-151 1237.5236,-115 1396.8387,-115 1396.8387,-151"/>
<text text-anchor="middle" x="1317.1812" y="-128.8" font-family="Times,serif" font-size="14.00" fill="#000000">AddToCompactionQueue</text>
</g>
<!-- NeedsCompaction&#45;&gt;AddToCompactionQueue -->
<g id="edge11" class="edge">
<title>NeedsCompaction&#45;&gt;AddToCompactionQueue</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M1157.507,-52.1581C1189.8943,-68.5556 1237.6779,-92.7481 1272.5302,-110.3936"/>
<polygon fill="#666666" stroke="#666666" points="1271.041,-113.5625 1281.5436,-114.957 1274.2029,-107.3173 1271.041,-113.5625"/>
</g>
<!-- SwitchMemtable -->
<g id="node2" class="node">
<title>SwitchMemtable</title>
<polygon fill="none" stroke="#000000" points="46.7207,-246.4001 46.7207,-315.5999 220.9795,-315.5999 220.9795,-246.4001 46.7207,-246.4001"/>
<text text-anchor="middle" x="133.8501" y="-300.3999" font-family="Times,serif" font-size="14.00" fill="#000000">SwitchMemtable</text>
<polyline fill="none" stroke="#000000" points="46.7207,-293.5999 220.9795,-293.5999 "/>
<text text-anchor="start" x="54.7207" y="-278.3999" font-family="Times,serif" font-size="14.00" fill="#000000">将memtable加到Imm list中</text>
<text text-anchor="start" x="54.7207" y="-258.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 并创建新的memtable</text>
</g>
<!-- InstallSuperVersionAndScheduleWork -->
<g id="node7" class="node">
<title>InstallSuperVersionAndScheduleWork</title>
<polygon fill="none" stroke="#000000" points="520.1263,-202 287.8913,-202 287.8913,-166 520.1263,-166 520.1263,-202"/>
<text text-anchor="middle" x="404.0088" y="-179.8" font-family="Times,serif" font-size="14.00" fill="#000000">InstallSuperVersionAndScheduleWork</text>
</g>
<!-- SwitchMemtable&#45;&gt;InstallSuperVersionAndScheduleWork -->
<g id="edge1" class="edge">
<title>SwitchMemtable&#45;&gt;InstallSuperVersionAndScheduleWork</title>
<path fill="none" stroke="#666666" d="M221.1898,-249.6408C261.3802,-235.2105 308.0414,-218.4569 344.1635,-205.4874"/>
<polygon fill="#666666" stroke="#666666" points="345.3537,-208.7789 353.5826,-202.1054 342.9881,-202.1906 345.3537,-208.7789"/>
</g>
<!-- SchedulePendingCompaction -->
<g id="node3" class="node">
<title>SchedulePendingCompaction</title>
<polygon fill="none" stroke="#000000" points="812.8418,-168.2 812.8418,-217.8 1006.9316,-217.8 1006.9316,-168.2 812.8418,-168.2"/>
<text text-anchor="middle" x="909.8867" y="-202.6" font-family="Times,serif" font-size="14.00" fill="#000000">SchedulePendingCompaction</text>
<polyline fill="none" stroke="#000000" points="812.8418,-195.8 1006.9316,-195.8 "/>
<text text-anchor="start" x="820.8418" y="-180.6" font-family="Times,serif" font-size="14.00" fill="#000000">将columnFamilyData加入队列</text>
</g>
<!-- SchedulePendingCompaction&#45;&gt;AddToCompactionQueue -->
<g id="edge7" class="edge">
<title>SchedulePendingCompaction&#45;&gt;AddToCompactionQueue</title>
<path fill="none" stroke="#666666" d="M1007.185,-178.6666C1073.9717,-168.828 1161.9706,-155.8646 1227.1424,-146.2639"/>
<polygon fill="#666666" stroke="#666666" points="1228.0162,-149.6731 1237.3993,-144.753 1226.9959,-142.7478 1228.0162,-149.6731"/>
</g>
<!-- MaybeScheduleFlushOrCompaction -->
<g id="node4" class="node">
<title>MaybeScheduleFlushOrCompaction</title>
<polygon fill="none" stroke="#000000" points="556.3174,-106.2 556.3174,-155.8 776.8418,-155.8 776.8418,-106.2 556.3174,-106.2"/>
<text text-anchor="middle" x="666.5796" y="-140.6" font-family="Times,serif" font-size="14.00" fill="#000000">MaybeScheduleFlushOrCompaction</text>
<polyline fill="none" stroke="#000000" points="556.3174,-133.8 776.8418,-133.8 "/>
<text text-anchor="start" x="564.3174" y="-118.6" font-family="Times,serif" font-size="14.00" fill="#000000">触发后台线程compact</text>
</g>
<!-- BackgroundCompaction -->
<g id="node8" class="node">
<title>BackgroundCompaction</title>
<polygon fill="none" stroke="#000000" points="986.2491,-149 833.5244,-149 833.5244,-113 986.2491,-113 986.2491,-149"/>
<text text-anchor="middle" x="909.8867" y="-126.8" font-family="Times,serif" font-size="14.00" fill="#000000">BackgroundCompaction</text>
</g>
<!-- MaybeScheduleFlushOrCompaction&#45;&gt;BackgroundCompaction -->
<g id="edge6" class="edge">
<title>MaybeScheduleFlushOrCompaction&#45;&gt;BackgroundCompaction</title>
<path fill="none" stroke="#666666" stroke-dasharray="5,2" d="M776.843,-131C792.3712,-131 808.1491,-131 823.1527,-131"/>
<polygon fill="#666666" stroke="#666666" points="823.4037,-134.5001 833.4036,-131 823.4036,-127.5001 823.4037,-134.5001"/>
</g>
<!-- FlushMemTableToOutputFile -->
<g id="node5" class="node">
<title>FlushMemTableToOutputFile</title>
<polygon fill="none" stroke="#000000" points="42.4448,-158.4001 42.4448,-227.5999 225.2554,-227.5999 225.2554,-158.4001 42.4448,-158.4001"/>
<text text-anchor="middle" x="133.8501" y="-212.3999" font-family="Times,serif" font-size="14.00" fill="#000000">FlushMemTableToOutputFile</text>
<polyline fill="none" stroke="#000000" points="42.4448,-205.5999 225.2554,-205.5999 "/>
<text text-anchor="start" x="50.4448" y="-190.3999" font-family="Times,serif" font-size="14.00" fill="#000000">将memtable刷到level0</text>
<text text-anchor="start" x="50.4448" y="-170.8" font-family="Times,serif" font-size="14.00" fill="#000000"> sstable文件</text>
</g>
<!-- FlushMemTableToOutputFile&#45;&gt;InstallSuperVersionAndScheduleWork -->
<g id="edge2" class="edge">
<title>FlushMemTableToOutputFile&#45;&gt;InstallSuperVersionAndScheduleWork</title>
<path fill="none" stroke="#666666" d="M225.3135,-189.953C242.0766,-189.3946 259.8435,-188.8027 277.4181,-188.2172"/>
<polygon fill="#666666" stroke="#666666" points="277.8566,-191.7046 287.7345,-187.8735 277.6235,-184.7085 277.8566,-191.7046"/>
</g>
<!-- AtomicFlushMemTablesToOutputFiles -->
<g id="node6" class="node">
<title>AtomicFlushMemTablesToOutputFiles</title>
<polygon fill="none" stroke="#000000" points="251.5505,-140 16.1497,-140 16.1497,-104 251.5505,-104 251.5505,-140"/>
<text text-anchor="middle" x="133.8501" y="-117.8" font-family="Times,serif" font-size="14.00" fill="#000000">AtomicFlushMemTablesToOutputFiles</text>
</g>
<!-- AtomicFlushMemTablesToOutputFiles&#45;&gt;InstallSuperVersionAndScheduleWork -->
<g id="edge3" class="edge">
<title>AtomicFlushMemTablesToOutputFiles&#45;&gt;InstallSuperVersionAndScheduleWork</title>
<path fill="none" stroke="#666666" d="M212.458,-140.0019C225.5631,-143.0052 239.0159,-146.0896 251.7002,-149 272.3604,-153.7405 294.5959,-158.8474 315.5209,-163.6554"/>
<polygon fill="#666666" stroke="#666666" points="314.8227,-167.0861 325.3526,-165.9147 316.3905,-160.2639 314.8227,-167.0861"/>
</g>
<!-- InstallSuperVersionAndScheduleWork&#45;&gt;SchedulePendingCompaction -->
<g id="edge4" class="edge">
<title>InstallSuperVersionAndScheduleWork&#45;&gt;SchedulePendingCompaction</title>
<path fill="none" stroke="#666666" d="M520.3849,-186.0704C605.3854,-187.5827 719.7716,-189.6177 802.5766,-191.0909"/>
<polygon fill="#666666" stroke="#666666" points="802.7078,-194.5937 812.7685,-191.2722 802.8324,-187.5948 802.7078,-194.5937"/>
</g>
<!-- InstallSuperVersionAndScheduleWork&#45;&gt;MaybeScheduleFlushOrCompaction -->
<g id="edge5" class="edge">
<title>InstallSuperVersionAndScheduleWork&#45;&gt;MaybeScheduleFlushOrCompaction</title>
<path fill="none" stroke="#666666" d="M493.2697,-165.9827C510.3297,-162.5391 528.4481,-158.8819 546.2936,-155.2798"/>
<polygon fill="#666666" stroke="#666666" points="547.0614,-158.6955 556.1711,-153.286 545.6763,-151.8338 547.0614,-158.6955"/>
</g>
<!-- BackgroundCompaction&#45;&gt;NeedsCompaction -->
<g id="edge8" class="edge">
<title>BackgroundCompaction&#45;&gt;NeedsCompaction</title>
<path fill="none" stroke="#b83b5e" d="M949.22,-112.9824C984.1729,-96.9713 1035.3971,-73.5068 1072.9313,-56.3132"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1074.5268,-59.4322 1082.1607,-52.0855 1071.6115,-53.0681 1074.5268,-59.4322"/>
</g>
<!-- BackgroundCompaction&#45;&gt;InstallSuperVersionAndScheduleWork -->
<g id="edge9" class="edge">
<title>BackgroundCompaction&#45;&gt;InstallSuperVersionAndScheduleWork</title>
<path fill="none" stroke="#b83b5e" d="M849.8073,-149.0596C827.1437,-155.154 801.0018,-161.3348 776.8418,-165 730.9518,-171.9618 619.7035,-177.081 530.5969,-180.2403"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="530.2697,-176.7495 520.3982,-180.5968 530.5144,-183.7452 530.2697,-176.7495"/>
</g>
<!-- BackgroundCompaction&#45;&gt;AddToCompactionQueue -->
<g id="edge10" class="edge">
<title>BackgroundCompaction&#45;&gt;AddToCompactionQueue</title>
<path fill="none" stroke="#b83b5e" d="M986.4957,-131.3762C1054.802,-131.7116 1154.8563,-132.2029 1227.0027,-132.5572"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1227.4206,-136.0592 1237.4377,-132.6084 1227.455,-129.0593 1227.4206,-136.0592"/>
</g>
<!-- compaction_queue_ -->
<g id="node10" class="node">
<title>compaction_queue_</title>
<polygon fill="#95e1d3" stroke="#000000" points="1433.0098,-105 1433.0098,-163 1640.5596,-163 1640.5596,-105 1433.0098,-105"/>
<text text-anchor="middle" x="1536.7847" y="-147.8" font-family="Times,serif" font-size="14.00" fill="#000000">compaction_queue_</text>
<polyline fill="none" stroke="#000000" points="1433.0098,-141 1640.5596,-141 "/>
<text text-anchor="start" x="1441.0098" y="-125.8" font-family="Times,serif" font-size="14.00" fill="#000000">std::deque&lt;ColumnFamilyData*&gt;</text>
<text text-anchor="start" x="1441.0098" y="-111.8" font-family="Times,serif" font-size="14.00" fill="#000000"> compaction_queue_;</text>
</g>
<!-- AddToCompactionQueue&#45;&gt;compaction_queue_ -->
<g id="edge12" class="edge">
<title>AddToCompactionQueue&#45;&gt;compaction_queue_</title>
<path fill="none" stroke="#666666" d="M1397.0843,-133.3639C1405.4581,-133.402 1414.083,-133.4413 1422.7432,-133.4807"/>
<polygon fill="#666666" stroke="#666666" points="1422.8968,-136.9813 1432.9127,-133.527 1422.9287,-129.9814 1422.8968,-136.9813"/>
</g>
</g>
</svg>
