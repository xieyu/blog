<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: transaction_struct Pages: 1 -->
<svg width="2010pt" height="768pt"
 viewBox="0.00 0.00 2009.90 767.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 763.5034)">
<title>transaction_struct</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-763.5034 2005.9043,-763.5034 2005.9043,4 -4,4"/>
<!-- Transaction -->
<g id="node1" class="node">
<title>Transaction</title>
<polygon fill="none" stroke="#000000" points="0,-271.9001 0,-757.0999 404.1172,-757.0999 404.1172,-271.9001 0,-271.9001"/>
<text text-anchor="middle" x="202.0586" y="-741.8999" font-family="Times,serif" font-size="14.00" fill="#000000">Transaction</text>
<polyline fill="none" stroke="#000000" points="0,-735.0999 404.1172,-735.0999 "/>
<text text-anchor="middle" x="202.0586" y="-719.8999" font-family="Times,serif" font-size="14.00" fill="#000000">对外接口</text>
<polyline fill="none" stroke="#000000" points="0,-707.5 404.1172,-707.5 "/>
<text text-anchor="start" x="8" y="-692.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual void SetSnapshot() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-685.5 404.1172,-685.5 "/>
<text text-anchor="start" x="8" y="-670.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual void SetSnapshotOnNextOperation(</text>
<text text-anchor="start" x="8" y="-656.3" font-family="Times,serif" font-size="14.00" fill="#000000"> std::shared_ptr&lt;TransactionNotifier&gt;</text>
<text text-anchor="start" x="8" y="-642.3" font-family="Times,serif" font-size="14.00" fill="#000000"> notifier = nullptr) = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-635.5 404.1172,-635.5 "/>
<text text-anchor="start" x="8" y="-620.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual void ClearSnapshot() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-613.5 404.1172,-613.5 "/>
<text text-anchor="start" x="8" y="-598.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status Prepare() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-591.5 404.1172,-591.5 "/>
<text text-anchor="start" x="8" y="-576.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status Commit() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-569.5 404.1172,-569.5 "/>
<text text-anchor="start" x="8" y="-554.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status Rollback() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-547.5 404.1172,-547.5 "/>
<text text-anchor="start" x="8" y="-532.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual void SetSavePoint() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-525.5 404.1172,-525.5 "/>
<text text-anchor="start" x="8" y="-510.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status RollbackToSavePoint() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-503.5 404.1172,-503.5 "/>
<text text-anchor="start" x="8" y="-488.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status PopSavePoint() = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-481.5 404.1172,-481.5 "/>
<text text-anchor="start" x="8" y="-466.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status Get(const ReadOptions&amp; options,</text>
<text text-anchor="start" x="8" y="-452.3" font-family="Times,serif" font-size="14.00" fill="#000000"> ColumnFamilyHandle* column_family, const Slice&amp; key,</text>
<text text-anchor="start" x="8" y="-438.3" font-family="Times,serif" font-size="14.00" fill="#000000"> std::string* value) = 0;</text>
<polyline fill="none" stroke="#000000" points="0,-431.5 404.1172,-431.5 "/>
<text text-anchor="start" x="8" y="-416.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Status GetForUpdate(const ReadOptions&amp; options,...</text>
<polyline fill="none" stroke="#000000" points="0,-409.5 404.1172,-409.5 "/>
<text text-anchor="start" x="8" y="-394.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual Iterator* GetIterator(const ReadOptions&amp; read_options) = 0..;</text>
<polyline fill="none" stroke="#000000" points="0,-387.5 404.1172,-387.5 "/>
<text text-anchor="middle" x="202.0586" y="-372.3" font-family="Times,serif" font-size="14.00" fill="#000000">数据成员</text>
<polyline fill="none" stroke="#000000" points="0,-359.9001 404.1172,-359.9001 "/>
<text text-anchor="start" x="8" y="-344.7001" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t log_number_;</text>
<polyline fill="none" stroke="#000000" points="0,-337.9001 404.1172,-337.9001 "/>
<text text-anchor="start" x="8" y="-322.7001" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionName name_;</text>
<polyline fill="none" stroke="#000000" points="0,-315.9001 404.1172,-315.9001 "/>
<text text-anchor="start" x="8" y="-300.7001" font-family="Times,serif" font-size="14.00" fill="#000000">std::atomic&lt;TransactionState&gt; txn_state_;</text>
<polyline fill="none" stroke="#000000" points="0,-293.9001 404.1172,-293.9001 "/>
<text text-anchor="start" x="8" y="-278.7001" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t id_ = 0;</text>
</g>
<!-- TransactionBaseImpl -->
<g id="node2" class="node">
<title>TransactionBaseImpl</title>
<polygon fill="none" stroke="#000000" points="440.1172,-324.5 440.1172,-704.5 921.4053,-704.5 921.4053,-324.5 440.1172,-324.5"/>
<text text-anchor="middle" x="680.7612" y="-689.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionBaseImpl</text>
<polyline fill="none" stroke="#000000" points="440.1172,-682.5 921.4053,-682.5 "/>
<text text-anchor="start" x="448.1172" y="-667.3" font-family="Times,serif" font-size="14.00" fill="#000000">DB *db_</text>
<polyline fill="none" stroke="#000000" points="440.1172,-660.5 921.4053,-660.5 "/>
<text text-anchor="start" x="448.1172" y="-645.3" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl* dbimpl_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-638.5 921.4053,-638.5 "/>
<text text-anchor="start" x="448.1172" y="-623.3" font-family="Times,serif" font-size="14.00" fill="#000000">WriteOptions write_options_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-616.5 921.4053,-616.5 "/>
<text text-anchor="start" x="448.1172" y="-601.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t start_time_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-594.5 921.4053,-594.5 "/>
<text text-anchor="start" x="448.1172" y="-579.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::shared_ptr&lt;const Snapshot&gt; snapshot_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-572.5 921.4053,-572.5 "/>
<text text-anchor="start" x="448.1172" y="-557.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t num_puts_ = 0;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-550.5 921.4053,-550.5 "/>
<text text-anchor="start" x="448.1172" y="-535.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t num_deletes_ = 0;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-528.5 921.4053,-528.5 "/>
<text text-anchor="start" x="448.1172" y="-513.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t num_merges_ = 0;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-506.5 921.4053,-506.5 "/>
<text text-anchor="start" x="448.1172" y="-491.3" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatchWithIndex write_batch_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-484.5 921.4053,-484.5 "/>
<text text-anchor="start" x="448.1172" y="-469.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionKeyMap tracked_keys_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-462.5 921.4053,-462.5 "/>
<text text-anchor="start" x="448.1172" y="-447.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::unique_ptr&lt;std::stack&lt;</text>
<text text-anchor="start" x="448.1172" y="-433.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionBaseImpl::SavePoint, autovector&lt;TransactionBaseImpl::SavePoint&gt;&gt;&gt;</text>
<text text-anchor="start" x="448.1172" y="-419.3" font-family="Times,serif" font-size="14.00" fill="#000000"> save_points_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-412.5 921.4053,-412.5 "/>
<text text-anchor="start" x="448.1172" y="-397.3" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch commit_time_batch_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-390.5 921.4053,-390.5 "/>
<text text-anchor="start" x="448.1172" y="-375.3" font-family="Times,serif" font-size="14.00" fill="#000000">bool indexing_enabled_;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-368.5 921.4053,-368.5 "/>
<text text-anchor="start" x="448.1172" y="-353.3" font-family="Times,serif" font-size="14.00" fill="#000000">bool snapshot_needed_ = false;</text>
<polyline fill="none" stroke="#000000" points="440.1172,-346.5 921.4053,-346.5 "/>
<text text-anchor="start" x="448.1172" y="-331.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::shared_ptr&lt;TransactionNotifier&gt; snapshot_notifier_ = nullptr;</text>
</g>
<!-- Transaction&#45;&gt;TransactionBaseImpl -->
<g id="edge1" class="edge">
<title>Transaction&#45;&gt;TransactionBaseImpl</title>
<path fill="none" stroke="#666666" d="M404.3778,-514.5C412.8144,-514.5 421.314,-514.5 429.8332,-514.5"/>
<polygon fill="#666666" stroke="#666666" points="429.8404,-518.0001 439.8404,-514.5 429.8403,-511.0001 429.8404,-518.0001"/>
</g>
<!-- SavePoint -->
<g id="node3" class="node">
<title>SavePoint</title>
<polygon fill="none" stroke="#000000" points="957.4053,-220.5 957.4053,-374.5 1292.3838,-374.5 1292.3838,-220.5 957.4053,-220.5"/>
<text text-anchor="middle" x="1124.8945" y="-359.3" font-family="Times,serif" font-size="14.00" fill="#000000">SavePoint</text>
<polyline fill="none" stroke="#000000" points="957.4053,-352.5 1292.3838,-352.5 "/>
<text text-anchor="start" x="965.4053" y="-337.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::shared_ptr&lt;const Snapshot&gt; snapshot_;</text>
<polyline fill="none" stroke="#000000" points="957.4053,-330.5 1292.3838,-330.5 "/>
<text text-anchor="start" x="965.4053" y="-315.3" font-family="Times,serif" font-size="14.00" fill="#000000">bool snapshot_needed_ = false;</text>
<polyline fill="none" stroke="#000000" points="957.4053,-308.5 1292.3838,-308.5 "/>
<text text-anchor="start" x="965.4053" y="-293.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::shared_ptr&lt;TransactionNotifier&gt; snapshot_notifier_;</text>
<polyline fill="none" stroke="#000000" points="957.4053,-286.5 1292.3838,-286.5 "/>
<text text-anchor="start" x="965.4053" y="-271.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t num_puts_ = 0;</text>
<polyline fill="none" stroke="#000000" points="957.4053,-264.5 1292.3838,-264.5 "/>
<text text-anchor="start" x="965.4053" y="-249.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t num_deletes_ = 0;</text>
<polyline fill="none" stroke="#000000" points="957.4053,-242.5 1292.3838,-242.5 "/>
<text text-anchor="start" x="965.4053" y="-227.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t num_merges_ = 0;</text>
</g>
<!-- TransactionBaseImpl&#45;&gt;SavePoint -->
<g id="edge2" class="edge">
<title>TransactionBaseImpl:SavePoint&#45;&gt;SavePoint</title>
<path fill="none" stroke="#666666" d="M921.4053,-437.5C949.881,-437.5 936.1216,-403.4174 957.4053,-384.5 958.7102,-383.3402 960.0333,-382.1909 961.3734,-381.0523"/>
<polygon fill="#666666" stroke="#666666" points="963.6875,-383.6814 969.224,-374.6482 959.2627,-378.2573 963.6875,-383.6814"/>
</g>
<!-- Snapshot -->
<g id="node4" class="node">
<title>Snapshot</title>
<polygon fill="none" stroke="#000000" points="1354.6611,-324.5 1354.6611,-368.5 1701.6162,-368.5 1701.6162,-324.5 1354.6611,-324.5"/>
<text text-anchor="middle" x="1528.1387" y="-353.3" font-family="Times,serif" font-size="14.00" fill="#000000">Snapshot</text>
<polyline fill="none" stroke="#000000" points="1354.6611,-346.5 1701.6162,-346.5 "/>
<text text-anchor="start" x="1362.6611" y="-331.3" font-family="Times,serif" font-size="14.00" fill="#000000">virtual SequenceNumber GetSequenceNumber() const = 0;</text>
</g>
<!-- TransactionBaseImpl&#45;&gt;Snapshot -->
<g id="edge3" class="edge">
<title>TransactionBaseImpl:Snapshot&#45;&gt;Snapshot</title>
<path fill="none" stroke="#666666" d="M921.4053,-583.5C975.3865,-583.5 913.9445,-667.4822 957.4053,-699.5 1077.2693,-787.8045 1161.0916,-769.6957 1292.3838,-699.5 1423.3526,-629.4772 1494.2169,-450.9527 1518.4465,-378.1414"/>
<polygon fill="#666666" stroke="#666666" points="1521.788,-379.1836 1521.5573,-368.5913 1515.1322,-377.0155 1521.788,-379.1836"/>
</g>
<!-- TransactionKeyMap -->
<g id="node5" class="node">
<title>TransactionKeyMap</title>
<polygon fill="none" stroke="#000000" points="1025.457,-129.5 1025.457,-201.5 1224.332,-201.5 1224.332,-129.5 1025.457,-129.5"/>
<text text-anchor="middle" x="1124.8945" y="-186.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionKeyMap</text>
<polyline fill="none" stroke="#000000" points="1025.457,-179.5 1224.332,-179.5 "/>
<text text-anchor="start" x="1033.457" y="-164.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::unordered_map&lt;uint32_t</text>
<text text-anchor="start" x="1033.457" y="-150.3" font-family="Times,serif" font-size="14.00" fill="#000000">, std::unordered_map&lt;std::string</text>
<text text-anchor="start" x="1033.457" y="-136.3" font-family="Times,serif" font-size="14.00" fill="#000000">, TransactionKeyMapInfo&gt;&gt;</text>
</g>
<!-- TransactionBaseImpl&#45;&gt;TransactionKeyMap -->
<g id="edge4" class="edge">
<title>TransactionBaseImpl:TransactionKeyMap&#45;&gt;TransactionKeyMap</title>
<path fill="none" stroke="#666666" d="M921.4053,-473.5C980.3947,-473.5 918.412,-254.7637 957.4053,-210.5 972.5753,-193.2795 993.5595,-182.3242 1015.5509,-175.4299"/>
<polygon fill="#666666" stroke="#666666" points="1016.7091,-178.7392 1025.3644,-172.6289 1014.7878,-172.008 1016.7091,-178.7392"/>
</g>
<!-- OptimisticTransaction -->
<g id="node6" class="node">
<title>OptimisticTransaction</title>
<polygon fill="none" stroke="#000000" points="1195.1028,-690.5 1054.6862,-690.5 1054.6862,-654.5 1195.1028,-654.5 1195.1028,-690.5"/>
<text text-anchor="middle" x="1124.8945" y="-668.3" font-family="Times,serif" font-size="14.00" fill="#000000">OptimisticTransaction</text>
</g>
<!-- TransactionBaseImpl&#45;&gt;OptimisticTransaction -->
<g id="edge5" class="edge">
<title>TransactionBaseImpl&#45;&gt;OptimisticTransaction</title>
<path fill="none" stroke="#666666" d="M921.7131,-633.3698C933.6674,-637.7579 945.6056,-641.8365 957.4053,-645.5 985.2133,-654.1337 1016.5212,-660.1257 1044.479,-664.2287"/>
<polygon fill="#666666" stroke="#666666" points="1044.2246,-667.7274 1054.615,-665.6563 1045.2009,-660.7958 1044.2246,-667.7274"/>
</g>
<!-- PessimisticTransaction -->
<g id="node7" class="node">
<title>PessimisticTransaction</title>
<polygon fill="none" stroke="#000000" points="996.394,-393.5 996.394,-635.5 1253.395,-635.5 1253.395,-393.5 996.394,-393.5"/>
<text text-anchor="middle" x="1124.8945" y="-620.3" font-family="Times,serif" font-size="14.00" fill="#000000">PessimisticTransaction</text>
<polyline fill="none" stroke="#000000" points="996.394,-613.5 1253.395,-613.5 "/>
<text text-anchor="start" x="1004.394" y="-598.3" font-family="Times,serif" font-size="14.00" fill="#000000">PessimisticTransactionDB* txn_db_impl_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-591.5 1253.395,-591.5 "/>
<text text-anchor="start" x="1004.394" y="-576.3" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl* db_impl_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-569.5 1253.395,-569.5 "/>
<text text-anchor="start" x="1004.394" y="-554.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t expiration_time_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-547.5 1253.395,-547.5 "/>
<text text-anchor="start" x="1004.394" y="-532.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionID txn_id_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-525.5 1253.395,-525.5 "/>
<polyline fill="none" stroke="#000000" points="996.394,-525.5 1253.395,-525.5 "/>
<text text-anchor="start" x="1004.394" y="-510.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint32_t waiting_cf_id_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-503.5 1253.395,-503.5 "/>
<text text-anchor="start" x="1004.394" y="-488.3" font-family="Times,serif" font-size="14.00" fill="#000000">const std::string* waiting_key_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-481.5 1253.395,-481.5 "/>
<text text-anchor="start" x="1004.394" y="-466.3" font-family="Times,serif" font-size="14.00" fill="#000000">mutable std::mutex wait_mutex_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-459.5 1253.395,-459.5 "/>
<text text-anchor="start" x="1004.394" y="-444.3" font-family="Times,serif" font-size="14.00" fill="#000000">int64_t lock_timeout_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-437.5 1253.395,-437.5 "/>
<text text-anchor="start" x="1004.394" y="-422.3" font-family="Times,serif" font-size="14.00" fill="#000000">bool deadlock_detect_;</text>
<polyline fill="none" stroke="#000000" points="996.394,-415.5 1253.395,-415.5 "/>
<text text-anchor="start" x="1004.394" y="-400.3" font-family="Times,serif" font-size="14.00" fill="#000000">bool skip_concurrency_control_;</text>
</g>
<!-- TransactionBaseImpl&#45;&gt;PessimisticTransaction -->
<g id="edge6" class="edge">
<title>TransactionBaseImpl&#45;&gt;PessimisticTransaction</title>
<path fill="none" stroke="#666666" d="M921.6747,-514.5C943.7557,-514.5 965.5863,-514.5 986.2849,-514.5"/>
<polygon fill="#666666" stroke="#666666" points="986.3513,-518.0001 996.3513,-514.5 986.3512,-511.0001 986.3513,-518.0001"/>
</g>
<!-- SavePoint&#45;&gt;Snapshot -->
<g id="edge7" class="edge">
<title>SavePoint:Snapshot&#45;&gt;Snapshot</title>
<path fill="none" stroke="#666666" d="M1291.8945,-341.5C1308.8697,-341.5 1326.5295,-341.6306 1344.209,-341.8497"/>
<polygon fill="#666666" stroke="#666666" points="1344.5699,-345.3547 1354.6157,-341.9885 1344.6634,-338.3553 1344.5699,-345.3547"/>
</g>
<!-- SequenceNumber -->
<g id="node14" class="node">
<title>SequenceNumber</title>
<polygon fill="none" stroke="#000000" points="1775.3711,-276.5 1775.3711,-320.5 1990.4268,-320.5 1990.4268,-276.5 1775.3711,-276.5"/>
<text text-anchor="middle" x="1882.8989" y="-305.3" font-family="Times,serif" font-size="14.00" fill="#000000">SequenceNumber</text>
<polyline fill="none" stroke="#000000" points="1775.3711,-298.5 1990.4268,-298.5 "/>
<text text-anchor="middle" x="1882.8989" y="-283.3" font-family="Times,serif" font-size="14.00" fill="#000000">typedef uint64_t SequenceNumber;</text>
</g>
<!-- Snapshot&#45;&gt;SequenceNumber -->
<g id="edge14" class="edge">
<title>Snapshot&#45;&gt;SequenceNumber</title>
<path fill="none" stroke="#666666" d="M1690.9826,-324.4668C1716.0054,-321.0811 1741.4166,-317.6429 1765.2063,-314.4241"/>
<polygon fill="#666666" stroke="#666666" points="1765.8564,-317.8681 1775.2968,-313.0588 1764.9178,-310.9313 1765.8564,-317.8681"/>
</g>
<!-- TransactionKeyMapInfo -->
<g id="node15" class="node">
<title>TransactionKeyMapInfo</title>
<polygon fill="none" stroke="#000000" points="1451.1846,-195.5 1451.1846,-305.5 1605.0928,-305.5 1605.0928,-195.5 1451.1846,-195.5"/>
<text text-anchor="middle" x="1528.1387" y="-290.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionKeyMapInfo</text>
<polyline fill="none" stroke="#000000" points="1451.1846,-283.5 1605.0928,-283.5 "/>
<text text-anchor="start" x="1459.1846" y="-268.3" font-family="Times,serif" font-size="14.00" fill="#000000">SequenceNumber seq;</text>
<polyline fill="none" stroke="#000000" points="1451.1846,-261.5 1605.0928,-261.5 "/>
<text text-anchor="start" x="1459.1846" y="-246.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint32_t num_writes;</text>
<polyline fill="none" stroke="#000000" points="1451.1846,-239.5 1605.0928,-239.5 "/>
<text text-anchor="start" x="1459.1846" y="-224.3" font-family="Times,serif" font-size="14.00" fill="#000000">uint32_t num_reads;</text>
<polyline fill="none" stroke="#000000" points="1451.1846,-217.5 1605.0928,-217.5 "/>
<text text-anchor="start" x="1459.1846" y="-202.3" font-family="Times,serif" font-size="14.00" fill="#000000">bool exclusive;</text>
</g>
<!-- TransactionKeyMap&#45;&gt;TransactionKeyMapInfo -->
<g id="edge15" class="edge">
<title>TransactionKeyMap&#45;&gt;TransactionKeyMapInfo</title>
<path fill="none" stroke="#666666" d="M1224.5729,-186.5112C1290.9879,-200.5109 1377.4299,-218.732 1441.0769,-232.1482"/>
<polygon fill="#666666" stroke="#666666" points="1440.5827,-235.6209 1451.0896,-234.2588 1442.0265,-228.7714 1440.5827,-235.6209"/>
</g>
<!-- PessimisticTransactionDB -->
<g id="node8" class="node">
<title>PessimisticTransactionDB</title>
<polygon fill="none" stroke="#000000" points="1328.3838,-.5 1328.3838,-176.5 1727.8936,-176.5 1727.8936,-.5 1328.3838,-.5"/>
<text text-anchor="middle" x="1528.1387" y="-161.3" font-family="Times,serif" font-size="14.00" fill="#000000">PessimisticTransactionDB</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-154.5 1727.8936,-154.5 "/>
<text text-anchor="start" x="1336.3838" y="-139.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionLockMgr lock_mgr_;</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-132.5 1727.8936,-132.5 "/>
<text text-anchor="start" x="1336.3838" y="-117.3" font-family="Times,serif" font-size="14.00" fill="#000000">InstrumentedMutex column_family_mutex_;</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-110.5 1727.8936,-110.5 "/>
<text text-anchor="start" x="1336.3838" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::mutex map_mutex_;</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-88.5 1727.8936,-88.5 "/>
<text text-anchor="start" x="1336.3838" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::unordered_map&lt;TransactionID, PessimisticTransaction*&gt;</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-66.5 1727.8936,-66.5 "/>
<text text-anchor="start" x="1336.3838" y="-51.3" font-family="Times,serif" font-size="14.00" fill="#000000">expirable_transactions_map_;</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-44.5 1727.8936,-44.5 "/>
<text text-anchor="start" x="1336.3838" y="-29.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::mutex name_map_mutex_;</text>
<polyline fill="none" stroke="#000000" points="1328.3838,-22.5 1727.8936,-22.5 "/>
<text text-anchor="start" x="1336.3838" y="-7.3" font-family="Times,serif" font-size="14.00" fill="#000000">std::unordered_map&lt;TransactionName, Transaction*&gt; transactions_</text>
</g>
<!-- PessimisticTransaction&#45;&gt;PessimisticTransactionDB -->
<g id="edge8" class="edge">
<title>PessimisticTransaction:PessimisticTransactionDB&#45;&gt;PessimisticTransactionDB</title>
<path fill="none" stroke="#666666" d="M1253.8945,-602.5C1348.028,-602.5 1271.584,-260.566 1328.3838,-185.5 1328.6746,-185.1157 1328.9673,-184.7329 1329.2619,-184.3514"/>
<polygon fill="#666666" stroke="#666666" points="1332.0383,-186.4862 1335.7185,-176.5511 1326.6459,-182.0227 1332.0383,-186.4862"/>
</g>
<!-- TransactionLockMgr -->
<g id="node9" class="node">
<title>TransactionLockMgr</title>
<polygon fill="none" stroke="#000000" points="1763.8936,-99.5 1763.8936,-187.5 2001.9043,-187.5 2001.9043,-99.5 1763.8936,-99.5"/>
<text text-anchor="middle" x="1882.8989" y="-172.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionLockMgr</text>
<polyline fill="none" stroke="#000000" points="1763.8936,-165.5 2001.9043,-165.5 "/>
<text text-anchor="start" x="1771.8936" y="-150.3" font-family="Times,serif" font-size="14.00" fill="#000000">InstrumentedMutex lock_map_mutex_;</text>
<polyline fill="none" stroke="#000000" points="1763.8936,-143.5 2001.9043,-143.5 "/>
<text text-anchor="start" x="1771.8936" y="-128.3" font-family="Times,serif" font-size="14.00" fill="#000000">LockMaps lock_maps_;</text>
<polyline fill="none" stroke="#000000" points="1763.8936,-121.5 2001.9043,-121.5 "/>
<polyline fill="none" stroke="#000000" points="1763.8936,-121.5 2001.9043,-121.5 "/>
<polyline fill="none" stroke="#000000" points="1763.8936,-121.5 2001.9043,-121.5 "/>
<text text-anchor="middle" x="1882.8989" y="-106.3" font-family="Times,serif" font-size="14.00" fill="#000000">...</text>
</g>
<!-- PessimisticTransactionDB&#45;&gt;TransactionLockMgr -->
<g id="edge9" class="edge">
<title>PessimisticTransactionDB:TransactionLockMgr&#45;&gt;TransactionLockMgr</title>
<path fill="none" stroke="#666666" d="M1727.8936,-143.5C1736.2106,-143.5 1744.7787,-143.5 1753.416,-143.5"/>
<polygon fill="#666666" stroke="#666666" points="1753.5764,-147.0001 1763.5763,-143.5 1753.5763,-140.0001 1753.5764,-147.0001"/>
</g>
<!-- DB -->
<g id="node10" class="node">
<title>DB</title>
<polygon fill="none" stroke="#000000" points="229.0586,-79.5 175.0586,-79.5 175.0586,-43.5 229.0586,-43.5 229.0586,-79.5"/>
<text text-anchor="middle" x="202.0586" y="-57.3" font-family="Times,serif" font-size="14.00" fill="#000000">DB</text>
</g>
<!-- StackableDB -->
<g id="node11" class="node">
<title>StackableDB</title>
<polygon fill="none" stroke="#000000" points="635.8267,-39.5 635.8267,-83.5 725.6958,-83.5 725.6958,-39.5 635.8267,-39.5"/>
<text text-anchor="middle" x="680.7612" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#000000">StackableDB</text>
<polyline fill="none" stroke="#000000" points="635.8267,-61.5 725.6958,-61.5 "/>
<text text-anchor="start" x="643.8267" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#000000">DB* db_;</text>
<polyline fill="none" stroke="#000000" points="635.8267,-39.5 725.6958,-39.5 "/>
</g>
<!-- DB&#45;&gt;StackableDB -->
<g id="edge10" class="edge">
<title>DB&#45;&gt;StackableDB</title>
<path fill="none" stroke="#666666" d="M229.1673,-61.5C305.3681,-61.5 522.5928,-61.5 625.4601,-61.5"/>
<polygon fill="#666666" stroke="#666666" points="625.6436,-65.0001 635.6436,-61.5 625.6435,-58.0001 625.6436,-65.0001"/>
</g>
<!-- TransactionDB -->
<g id="node12" class="node">
<title>TransactionDB</title>
<polygon fill="none" stroke="#000000" points="1175.4404,-106.5 1074.3486,-106.5 1074.3486,-70.5 1175.4404,-70.5 1175.4404,-106.5"/>
<text text-anchor="middle" x="1124.8945" y="-84.3" font-family="Times,serif" font-size="14.00" fill="#000000">TransactionDB</text>
</g>
<!-- StackableDB&#45;&gt;TransactionDB -->
<g id="edge11" class="edge">
<title>StackableDB&#45;&gt;TransactionDB</title>
<path fill="none" stroke="#666666" d="M725.7912,-64.2375C806.0583,-69.1171 973.8935,-79.3203 1064.2318,-84.8122"/>
<polygon fill="#666666" stroke="#666666" points="1064.1279,-88.3122 1074.3219,-85.4256 1064.5527,-81.3251 1064.1279,-88.3122"/>
</g>
<!-- OptimisticTransactionDB -->
<g id="node13" class="node">
<title>OptimisticTransactionDB</title>
<polygon fill="none" stroke="#000000" points="1205.0509,-52.5 1044.7382,-52.5 1044.7382,-16.5 1205.0509,-16.5 1205.0509,-52.5"/>
<text text-anchor="middle" x="1124.8945" y="-30.3" font-family="Times,serif" font-size="14.00" fill="#000000">OptimisticTransactionDB</text>
</g>
<!-- StackableDB&#45;&gt;OptimisticTransactionDB -->
<g id="edge13" class="edge">
<title>StackableDB&#45;&gt;OptimisticTransactionDB</title>
<path fill="none" stroke="#666666" d="M725.7912,-58.7625C797.9228,-54.3774 940.7711,-45.6933 1034.5465,-39.9925"/>
<polygon fill="#666666" stroke="#666666" points="1034.8268,-43.482 1044.596,-39.3816 1034.402,-36.4949 1034.8268,-43.482"/>
</g>
<!-- TransactionDB&#45;&gt;PessimisticTransactionDB -->
<g id="edge12" class="edge">
<title>TransactionDB&#45;&gt;PessimisticTransactionDB</title>
<path fill="none" stroke="#666666" d="M1175.5574,-88.5C1212.3209,-88.5 1264.7525,-88.5 1317.9789,-88.5"/>
<polygon fill="#666666" stroke="#666666" points="1318.276,-92.0001 1328.276,-88.5 1318.2759,-85.0001 1318.276,-92.0001"/>
</g>
<!-- TransactionKeyMapInfo&#45;&gt;SequenceNumber -->
<g id="edge16" class="edge">
<title>TransactionKeyMapInfo&#45;&gt;SequenceNumber</title>
<path fill="none" stroke="#666666" d="M1605.1164,-260.9153C1651.8293,-267.2357 1712.3941,-275.4302 1765.0444,-282.554"/>
<polygon fill="#666666" stroke="#666666" points="1764.7407,-286.0447 1775.1198,-283.9172 1765.6794,-279.1079 1764.7407,-286.0447"/>
</g>
</g>
</svg>
