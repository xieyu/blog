<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: schema_load Pages: 1 -->
<svg width="1915pt" height="696pt"
 viewBox="0.00 0.00 1915.00 696.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 692)">
<title>schema_load</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-692 1911,-692 1911,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_meta_meta_go</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1312,-302C1312,-302 1678,-302 1678,-302 1684,-302 1690,-308 1690,-314 1690,-314 1690,-518 1690,-518 1690,-524 1684,-530 1678,-530 1678,-530 1312,-530 1312,-530 1306,-530 1300,-524 1300,-518 1300,-518 1300,-314 1300,-314 1300,-308 1306,-302 1312,-302"/>
<text text-anchor="middle" x="1495" y="-510" font-family="Times,serif" font-size="20.00">meta/meta.go</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_TxnStructure</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1573,-410C1573,-410 1670,-410 1670,-410 1676,-410 1682,-416 1682,-422 1682,-422 1682,-480 1682,-480 1682,-486 1676,-492 1670,-492 1670,-492 1573,-492 1573,-492 1567,-492 1561,-486 1561,-480 1561,-480 1561,-422 1561,-422 1561,-416 1567,-410 1573,-410"/>
<text text-anchor="middle" x="1621.5" y="-472" font-family="Times,serif" font-size="20.00">TxnStructure</text>
</g>
<!-- GetSchemaDiff&#45;&gt;schemaDiffKey -->
<g id="edge1" class="edge">
<title>GetSchemaDiff&#45;&gt;schemaDiffKey</title>
<path fill="none" stroke="black" d="M1457.26,-417.76C1470.41,-413.53 1484.04,-409.42 1497,-406 1517.16,-400.68 1539.45,-395.98 1559.47,-392.19"/>
<polygon fill="black" stroke="black" points="1560.2,-395.61 1569.39,-390.34 1558.92,-388.73 1560.2,-395.61"/>
</g>
<!-- GetSchemaDiff&#45;&gt;txn_Get -->
<g id="edge2" class="edge">
<title>GetSchemaDiff&#45;&gt;txn_Get</title>
<path fill="none" stroke="black" d="M1457.03,-441.51C1497.78,-440.13 1546.83,-438.48 1580.4,-437.34"/>
<polygon fill="black" stroke="black" points="1580.85,-440.83 1590.73,-436.99 1580.62,-433.83 1580.85,-440.83"/>
</g>
<!-- GetSchemaDiff&#45;&gt;ApplyDiff -->
<g id="edge26" class="edge">
<title>GetSchemaDiff&#45;&gt;ApplyDiff</title>
<path fill="none" stroke="#3f72af" stroke-dasharray="5,2" d="M1457.03,-480.69C1491.71,-497.99 1532.41,-518.3 1564.46,-534.29"/>
<polygon fill="#3f72af" stroke="#3f72af" points="1563.17,-537.56 1573.68,-538.89 1566.3,-531.29 1563.17,-537.56"/>
</g>
<!-- ApplyDiff&#45;&gt;applyDropTable -->
<g id="edge3" class="edge">
<title>ApplyDiff&#45;&gt;applyDropTable</title>
<path fill="none" stroke="black" d="M1665.82,-585C1697.8,-601.59 1742.3,-624.26 1782,-643 1785.3,-644.56 1788.72,-646.14 1792.18,-647.72"/>
<polygon fill="black" stroke="black" points="1790.79,-650.94 1801.35,-651.86 1793.67,-644.56 1790.79,-650.94"/>
</g>
<!-- ApplyDiff&#45;&gt;applyCreateTable -->
<g id="edge4" class="edge">
<title>ApplyDiff&#45;&gt;applyCreateTable</title>
<path fill="none" stroke="black" d="M1716.58,-585.06C1737.31,-590.11 1758.8,-595.35 1778.09,-600.05"/>
<polygon fill="black" stroke="black" points="1777.41,-603.49 1787.95,-602.46 1779.07,-596.69 1777.41,-603.49"/>
</g>
<!-- ApplyDiff&#45;&gt;copySchemaTables -->
<g id="edge5" class="edge">
<title>ApplyDiff&#45;&gt;copySchemaTables</title>
<path fill="none" stroke="black" d="M1725.29,-562C1741.42,-562 1757.76,-562 1772.94,-562"/>
<polygon fill="black" stroke="black" points="1773.24,-565.5 1783.24,-562 1773.24,-558.5 1773.24,-565.5"/>
</g>
<!-- ApplyDiff&#45;&gt;copySortedTables -->
<g id="edge6" class="edge">
<title>ApplyDiff&#45;&gt;copySortedTables</title>
<path fill="none" stroke="black" d="M1716.58,-538.94C1737.11,-533.94 1758.39,-528.75 1777.53,-524.08"/>
<polygon fill="black" stroke="black" points="1778.44,-527.46 1787.33,-521.69 1776.78,-520.66 1778.44,-527.46"/>
</g>
<!-- ApplyDiff&#45;&gt;applyCreateSchema -->
<g id="edge7" class="edge">
<title>ApplyDiff&#45;&gt;applyCreateSchema</title>
<path fill="none" stroke="black" d="M1665.82,-539C1697.8,-522.41 1742.3,-499.74 1782,-481 1785.3,-479.44 1788.72,-477.86 1792.18,-476.28"/>
<polygon fill="black" stroke="black" points="1793.67,-479.44 1801.35,-472.14 1790.79,-473.06 1793.67,-479.44"/>
</g>
<!-- loadSchemaInLoop&#45;&gt;Reload -->
<g id="edge11" class="edge">
<title>loadSchemaInLoop&#45;&gt;Reload</title>
<path fill="none" stroke="black" d="M332.07,-158.02C365.02,-166.05 403.61,-175.45 437.86,-183.79"/>
<polygon fill="black" stroke="black" points="437.32,-187.27 447.86,-186.23 438.98,-180.46 437.32,-187.27"/>
<text text-anchor="middle" x="390" y="-184.8" font-family="Times,serif" font-size="14.00">tiker=(lease/2)</text>
</g>
<!-- loadSchemaInLoop&#45;&gt;WatchGlobalSchemaVer -->
<g id="edge12" class="edge">
<title>loadSchemaInLoop&#45;&gt;WatchGlobalSchemaVer</title>
<path fill="none" stroke="black" d="M332.07,-139C366.9,-139 408.03,-139 443.67,-139"/>
<polygon fill="black" stroke="black" points="444.05,-142.5 454.05,-139 444.05,-135.5 444.05,-142.5"/>
</g>
<!-- loadSchemaInLoop&#45;&gt;mustRestartSyncer -->
<g id="edge13" class="edge">
<title>loadSchemaInLoop&#45;&gt;mustRestartSyncer</title>
<path fill="none" stroke="black" d="M332.07,-123.67C372.45,-115.74 421.29,-106.15 460.23,-98.5"/>
<polygon fill="black" stroke="black" points="461.28,-101.86 470.42,-96.5 459.93,-95 461.28,-101.86"/>
</g>
<!-- Reload&#45;&gt;loadInfoSchema -->
<g id="edge14" class="edge">
<title>Reload&#45;&gt;loadInfoSchema</title>
<path fill="none" stroke="black" d="M612.4,-231.33C644.02,-241.17 681.23,-252.75 717.13,-263.92"/>
<polygon fill="black" stroke="black" points="716.13,-267.27 726.72,-266.9 718.21,-260.59 716.13,-267.27"/>
<text text-anchor="middle" x="669.5" y="-264.8" font-family="Times,serif" font-size="14.00">do.infoHandle</text>
</g>
<!-- Reload&#45;&gt;SchemaMetaVersion -->
<g id="edge15" class="edge">
<title>Reload&#45;&gt;SchemaMetaVersion</title>
<path fill="none" stroke="black" d="M612.4,-206C658.68,-206 716.92,-206 765.5,-206"/>
<polygon fill="black" stroke="black" points="765.71,-209.5 775.71,-206 765.71,-202.5 765.71,-209.5"/>
</g>
<!-- Reload&#45;&gt;CurrentVersion -->
<g id="edge16" class="edge">
<title>Reload&#45;&gt;CurrentVersion</title>
<path fill="none" stroke="black" d="M612.4,-190.02C656.45,-181.37 711.33,-170.59 758.4,-161.34"/>
<polygon fill="black" stroke="black" points="759.18,-164.76 768.32,-159.4 757.83,-157.89 759.18,-164.76"/>
</g>
<!-- Domain_Init&#45;&gt;loadSchemaInLoop -->
<g id="edge8" class="edge">
<title>Domain_Init&#45;&gt;loadSchemaInLoop</title>
<path fill="none" stroke="black" d="M86.09,-85.56C108.51,-92.78 136.95,-101.94 163.93,-110.63"/>
<polygon fill="black" stroke="black" points="163.2,-114.07 173.79,-113.81 165.34,-107.41 163.2,-114.07"/>
<text text-anchor="middle" x="130" y="-111.8" font-family="Times,serif" font-size="14.00">goroutine</text>
</g>
<!-- Domain_Init&#45;&gt;topNSlowQueryLoop -->
<g id="edge9" class="edge">
<title>Domain_Init&#45;&gt;topNSlowQueryLoop</title>
<path fill="none" stroke="black" d="M86.09,-72C111.79,-72 145.43,-72 175.69,-72"/>
<polygon fill="black" stroke="black" points="175.81,-75.5 185.81,-72 175.81,-68.5 175.81,-75.5"/>
<text text-anchor="middle" x="130" y="-75.8" font-family="Times,serif" font-size="14.00">goroutine</text>
</g>
<!-- Domain_Init&#45;&gt;infoSyncerKeeper -->
<g id="edge10" class="edge">
<title>Domain_Init&#45;&gt;infoSyncerKeeper</title>
<path fill="none" stroke="black" d="M86.17,-58.21C92.13,-56.39 98.21,-54.6 104,-53 130.4,-45.71 159.7,-38.58 185.23,-32.68"/>
<polygon fill="black" stroke="black" points="186.21,-36.04 195.17,-30.4 184.64,-29.22 186.21,-36.04"/>
<text text-anchor="middle" x="130" y="-56.8" font-family="Times,serif" font-size="14.00">goroutine</text>
</g>
<!-- loadInfoSchema&#45;&gt;tryLoadSchemaDiffs -->
<g id="edge17" class="edge">
<title>loadInfoSchema&#45;&gt;tryLoadSchemaDiffs</title>
<path fill="none" stroke="#b83b5e" d="M955.99,-370.22C1006.86,-404.07 1067.68,-444.55 1107.72,-471.19"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1105.92,-474.2 1116.18,-476.83 1109.79,-468.37 1105.92,-474.2"/>
</g>
<!-- loadInfoSchema&#45;&gt;fetchAllSchemasWithTables -->
<g id="edge18" class="edge">
<title>loadInfoSchema&#45;&gt;fetchAllSchemasWithTables</title>
<path fill="none" stroke="#b83b5e" d="M999.1,-309C1015.44,-309 1031.92,-309 1047.7,-309"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1047.96,-312.5 1057.96,-309 1047.96,-305.5 1047.96,-312.5"/>
</g>
<!-- loadInfoSchema&#45;&gt;InitWithDBInfos -->
<g id="edge19" class="edge">
<title>loadInfoSchema&#45;&gt;InitWithDBInfos</title>
<path fill="none" stroke="#b83b5e" d="M999.3,-275.5C1011.66,-273.05 1024.03,-270.83 1036,-269 1189.35,-245.5 1367.69,-239.01 1486.56,-237.6"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1486.83,-241.09 1496.8,-237.48 1486.76,-234.09 1486.83,-241.09"/>
</g>
<!-- tryLoadSchemaDiffs&#45;&gt;GetSchemaDiff -->
<g id="edge23" class="edge">
<title>tryLoadSchemaDiffs&#45;&gt;GetSchemaDiff</title>
<path fill="none" stroke="#3f72af" d="M1246.93,-476.98C1263.75,-472.86 1281.17,-468.59 1297.69,-464.54"/>
<polygon fill="#3f72af" stroke="#3f72af" points="1298.96,-467.83 1307.84,-462.05 1297.29,-461.03 1298.96,-467.83"/>
</g>
<!-- tryLoadSchemaDiffs&#45;&gt;ApplyDiff -->
<g id="edge24" class="edge">
<title>tryLoadSchemaDiffs&#45;&gt;ApplyDiff</title>
<path fill="none" stroke="#3f72af" d="M1243.57,-523.04C1262.14,-527.17 1281.63,-531.09 1300,-534 1368.22,-544.82 1445.33,-551.72 1506.76,-555.97"/>
<polygon fill="#3f72af" stroke="#3f72af" points="1506.66,-559.47 1516.87,-556.65 1507.13,-552.49 1506.66,-559.47"/>
</g>
<!-- tryLoadSchemaDiffs&#45;&gt;InitWithOldInfoSchema -->
<g id="edge25" class="edge">
<title>tryLoadSchemaDiffs&#45;&gt;InitWithOldInfoSchema</title>
<path fill="none" stroke="#3f72af" d="M1199.21,-523.11C1224.54,-535.38 1256.66,-550.29 1286,-562 1295.14,-565.65 1304.87,-569.23 1314.49,-572.62"/>
<polygon fill="#3f72af" stroke="#3f72af" points="1313.46,-575.96 1324.05,-575.92 1315.75,-569.35 1313.46,-575.96"/>
</g>
<!-- fetchAllSchemasWithTables&#45;&gt;ListDatabases -->
<g id="edge20" class="edge">
<title>fetchAllSchemasWithTables&#45;&gt;ListDatabases</title>
<path fill="none" stroke="black" d="M1246.27,-317.57C1273.48,-320.07 1302.33,-322.72 1326.37,-324.93"/>
<polygon fill="black" stroke="black" points="1326.08,-328.42 1336.36,-325.85 1326.72,-321.45 1326.08,-328.42"/>
</g>
<!-- fetchAllSchemasWithTables&#45;&gt;fetchSchemasWithTables -->
<g id="edge21" class="edge">
<title>fetchAllSchemasWithTables&#45;&gt;fetchSchemasWithTables</title>
<path fill="none" stroke="black" d="M1246.27,-295.53C1262.26,-293.22 1278.83,-290.83 1294.64,-288.54"/>
<polygon fill="black" stroke="black" points="1295.52,-291.95 1304.92,-287.06 1294.52,-285.03 1295.52,-291.95"/>
</g>
<!-- fetchSchemasWithTables&#45;&gt;ListTables -->
<g id="edge22" class="edge">
<title>fetchSchemasWithTables&#45;&gt;ListTables</title>
<path fill="none" stroke="black" d="M1460.28,-292.88C1497.77,-301.12 1541.62,-310.77 1573.88,-317.86"/>
<polygon fill="black" stroke="black" points="1573.41,-321.34 1583.92,-320.07 1574.91,-314.5 1573.41,-321.34"/>
</g>
<!-- fetchSchemasWithTables&#45;&gt;InitWithDBInfos -->
<g id="edge28" class="edge">
<title>fetchSchemasWithTables&#45;&gt;InitWithDBInfos</title>
<path fill="none" stroke="#3f72af" stroke-dasharray="5,2" d="M1460.28,-263.66C1468.9,-262.28 1477.86,-260.84 1486.93,-259.38"/>
<polygon fill="#3f72af" stroke="#3f72af" points="1487.49,-262.84 1496.81,-257.79 1486.38,-255.92 1487.49,-262.84"/>
</g>
<!-- InitWithOldInfoSchema&#45;&gt;ApplyDiff -->
<g id="edge27" class="edge">
<title>InitWithOldInfoSchema&#45;&gt;ApplyDiff</title>
<path fill="none" stroke="#3f72af" stroke-dasharray="5,2" d="M1457.03,-584.05C1472.9,-581.9 1490.03,-579.59 1507.02,-577.29"/>
<polygon fill="#3f72af" stroke="#3f72af" points="1507.55,-580.75 1516.99,-575.94 1506.61,-573.81 1507.55,-580.75"/>
</g>
<!-- ListDatabases -->
<g id="node1" class="node">
<title>ListDatabases</title>
<polygon fill="none" stroke="black" points="1428.5,-348 1336.5,-348 1336.5,-312 1428.5,-312 1428.5,-348"/>
<text text-anchor="middle" x="1382.5" y="-326.3" font-family="Times,serif" font-size="14.00">ListDatabases</text>
</g>
<!-- ListTables -->
<g id="node2" class="node">
<title>ListTables</title>
<polygon fill="none" stroke="black" points="1658,-346 1584,-346 1584,-310 1658,-310 1658,-346"/>
<text text-anchor="middle" x="1621" y="-324.3" font-family="Times,serif" font-size="14.00">ListTables</text>
</g>
<!-- GetSchemaDiff -->
<g id="node3" class="node">
<title>GetSchemaDiff</title>
<polygon fill="none" stroke="black" points="1308,-406 1308,-482 1457,-482 1457,-406 1308,-406"/>
<text text-anchor="middle" x="1382.5" y="-466.8" font-family="Times,serif" font-size="14.00">GetSchemaDiff</text>
<polyline fill="none" stroke="black" points="1308,-459 1457,-459 "/>
<text text-anchor="start" x="1316" y="-443.8" font-family="Times,serif" font-size="14.00">get the modification</text>
<text text-anchor="start" x="1316" y="-428.8" font-family="Times,serif" font-size="14.00"> information on a given </text>
<text text-anchor="start" x="1316" y="-413.8" font-family="Times,serif" font-size="14.00"> schema version</text>
</g>
<!-- schemaDiffKey -->
<g id="node4" class="node">
<title>schemaDiffKey</title>
<polygon fill="none" stroke="black" points="1672.5,-400 1569.5,-400 1569.5,-364 1672.5,-364 1672.5,-400"/>
<text text-anchor="middle" x="1621" y="-378.3" font-family="Times,serif" font-size="14.00">schemaDiffKey</text>
</g>
<!-- txn_Get -->
<g id="node5" class="node">
<title>txn_Get</title>
<polygon fill="none" stroke="black" points="1651,-454 1591,-454 1591,-418 1651,-418 1651,-454"/>
<text text-anchor="middle" x="1621" y="-432.3" font-family="Times,serif" font-size="14.00">txn_Get</text>
</g>
<!-- ApplyDiff -->
<g id="node6" class="node">
<title>ApplyDiff</title>
<polygon fill="none" stroke="black" points="1517,-539 1517,-585 1725,-585 1725,-539 1517,-539"/>
<text text-anchor="middle" x="1621" y="-569.8" font-family="Times,serif" font-size="14.00">ApplyDiff</text>
<polyline fill="none" stroke="black" points="1517,-562 1725,-562 "/>
<text text-anchor="start" x="1525" y="-546.8" font-family="Times,serif" font-size="14.00">将schemadiff应用到infoShema上</text>
</g>
<!-- applyDropTable -->
<g id="node7" class="node">
<title>applyDropTable</title>
<polygon fill="none" stroke="black" points="1897,-688 1792,-688 1792,-652 1897,-652 1897,-688"/>
<text text-anchor="middle" x="1844.5" y="-666.3" font-family="Times,serif" font-size="14.00">applyDropTable</text>
</g>
<!-- applyCreateTable -->
<g id="node8" class="node">
<title>applyCreateTable</title>
<polygon fill="none" stroke="black" points="1901,-634 1788,-634 1788,-598 1901,-598 1901,-634"/>
<text text-anchor="middle" x="1844.5" y="-612.3" font-family="Times,serif" font-size="14.00">applyCreateTable</text>
</g>
<!-- copySchemaTables -->
<g id="node9" class="node">
<title>copySchemaTables</title>
<polygon fill="none" stroke="black" points="1905.5,-580 1783.5,-580 1783.5,-544 1905.5,-544 1905.5,-580"/>
<text text-anchor="middle" x="1844.5" y="-558.3" font-family="Times,serif" font-size="14.00">copySchemaTables</text>
</g>
<!-- copySortedTables -->
<g id="node10" class="node">
<title>copySortedTables</title>
<polygon fill="none" stroke="black" points="1901.5,-526 1787.5,-526 1787.5,-490 1901.5,-490 1901.5,-526"/>
<text text-anchor="middle" x="1844.5" y="-504.3" font-family="Times,serif" font-size="14.00">copySortedTables</text>
</g>
<!-- applyCreateSchema -->
<g id="node11" class="node">
<title>applyCreateSchema</title>
<polygon fill="none" stroke="black" points="1907,-472 1782,-472 1782,-436 1907,-436 1907,-472"/>
<text text-anchor="middle" x="1844.5" y="-450.3" font-family="Times,serif" font-size="14.00">applyCreateSchema</text>
</g>
<!-- loadSchemaInLoop -->
<g id="node12" class="node">
<title>loadSchemaInLoop</title>
<polygon fill="none" stroke="black" points="174,-108.5 174,-169.5 332,-169.5 332,-108.5 174,-108.5"/>
<text text-anchor="middle" x="253" y="-154.3" font-family="Times,serif" font-size="14.00">loadSchemaInLoop</text>
<polyline fill="none" stroke="black" points="174,-146.5 332,-146.5 "/>
<text text-anchor="start" x="182" y="-131.3" font-family="Times,serif" font-size="14.00">每隔lease/2去</text>
<text text-anchor="start" x="182" y="-116.3" font-family="Times,serif" font-size="14.00"> tikv中加载一次 schema</text>
</g>
<!-- Reload -->
<g id="node13" class="node">
<title>Reload</title>
<polygon fill="none" stroke="black" points="448,-175.5 448,-236.5 612,-236.5 612,-175.5 448,-175.5"/>
<text text-anchor="middle" x="530" y="-221.3" font-family="Times,serif" font-size="14.00">Reload</text>
<polyline fill="none" stroke="black" points="448,-213.5 612,-213.5 "/>
<text text-anchor="start" x="456" y="-198.3" font-family="Times,serif" font-size="14.00">去tikv中重新加载schema</text>
<text text-anchor="start" x="456" y="-183.3" font-family="Times,serif" font-size="14.00"> 指定版本的schema</text>
</g>
<!-- Domain_Init -->
<g id="node14" class="node">
<title>Domain_Init</title>
<polygon fill="none" stroke="black" points="86,-90 0,-90 0,-54 86,-54 86,-90"/>
<text text-anchor="middle" x="43" y="-68.3" font-family="Times,serif" font-size="14.00">Domain_Init</text>
</g>
<!-- topNSlowQueryLoop -->
<g id="node15" class="node">
<title>topNSlowQueryLoop</title>
<polygon fill="none" stroke="black" points="320,-90 186,-90 186,-54 320,-54 320,-90"/>
<text text-anchor="middle" x="253" y="-68.3" font-family="Times,serif" font-size="14.00">topNSlowQueryLoop</text>
</g>
<!-- infoSyncerKeeper -->
<g id="node16" class="node">
<title>infoSyncerKeeper</title>
<polygon fill="none" stroke="black" points="310.5,-36 195.5,-36 195.5,0 310.5,0 310.5,-36"/>
<text text-anchor="middle" x="253" y="-14.3" font-family="Times,serif" font-size="14.00">infoSyncerKeeper</text>
</g>
<!-- WatchGlobalSchemaVer -->
<g id="node17" class="node">
<title>WatchGlobalSchemaVer</title>
<polygon fill="none" stroke="black" points="605.5,-157 454.5,-157 454.5,-121 605.5,-121 605.5,-157"/>
<text text-anchor="middle" x="530" y="-135.3" font-family="Times,serif" font-size="14.00">WatchGlobalSchemaVer</text>
</g>
<!-- mustRestartSyncer -->
<g id="node18" class="node">
<title>mustRestartSyncer</title>
<polygon fill="none" stroke="black" points="589.5,-103 470.5,-103 470.5,-67 589.5,-67 589.5,-103"/>
<text text-anchor="middle" x="530" y="-81.3" font-family="Times,serif" font-size="14.00">mustRestartSyncer</text>
</g>
<!-- loadInfoSchema -->
<g id="node19" class="node">
<title>loadInfoSchema</title>
<polygon fill="#f38181" stroke="black" points="727,-248 727,-370 999,-370 999,-248 727,-248"/>
<text text-anchor="middle" x="863" y="-354.8" font-family="Times,serif" font-size="14.00">loadInfoSchema</text>
<polyline fill="none" stroke="black" points="727,-347 999,-347 "/>
<text text-anchor="start" x="735" y="-331.8" font-family="Times,serif" font-size="14.00">loads inforscham at startTS into handle</text>
<polyline fill="none" stroke="black" points="727,-324 999,-324 "/>
<text text-anchor="start" x="735" y="-308.8" font-family="Times,serif" font-size="14.00">1. load之前会检查usedVersion和needVersion</text>
<text text-anchor="start" x="735" y="-293.8" font-family="Times,serif" font-size="14.00"> 如果一样的话就不用重新reload了。</text>
<polyline fill="none" stroke="black" points="727,-286 999,-286 "/>
<text text-anchor="start" x="735" y="-270.8" font-family="Times,serif" font-size="14.00">2. 首先尝试只load schema diff</text>
<text text-anchor="start" x="735" y="-255.8" font-family="Times,serif" font-size="14.00"> 如果失败的话，就去fetch allschema</text>
</g>
<!-- SchemaMetaVersion -->
<g id="node20" class="node">
<title>SchemaMetaVersion</title>
<polygon fill="none" stroke="black" points="776,-183 776,-229 950,-229 950,-183 776,-183"/>
<text text-anchor="middle" x="863" y="-213.8" font-family="Times,serif" font-size="14.00">SchemaMetaVersion</text>
<polyline fill="none" stroke="black" points="776,-206 950,-206 "/>
<text text-anchor="start" x="784" y="-190.8" font-family="Times,serif" font-size="14.00">获取TiDB当前schema版本</text>
</g>
<!-- CurrentVersion -->
<g id="node21" class="node">
<title>CurrentVersion</title>
<polygon fill="none" stroke="black" points="768.5,-118 768.5,-164 957.5,-164 957.5,-118 768.5,-118"/>
<text text-anchor="middle" x="863" y="-148.8" font-family="Times,serif" font-size="14.00">CurrentVersion</text>
<polyline fill="none" stroke="black" points="768.5,-141 957.5,-141 "/>
<text text-anchor="start" x="776.5" y="-125.8" font-family="Times,serif" font-size="14.00">获取当前TiKV中schema版本</text>
</g>
<!-- tryLoadSchemaDiffs -->
<g id="node22" class="node">
<title>tryLoadSchemaDiffs</title>
<polygon fill="none" stroke="black" points="1036,-477 1036,-523 1268,-523 1268,-477 1036,-477"/>
<text text-anchor="middle" x="1152" y="-507.8" font-family="Times,serif" font-size="14.00">tryLoadSchemaDiffs</text>
<polyline fill="none" stroke="black" points="1036,-500 1268,-500 "/>
<text text-anchor="start" x="1044" y="-484.8" font-family="Times,serif" font-size="14.00">tries to only load lastest schema chages</text>
</g>
<!-- fetchAllSchemasWithTables -->
<g id="node23" class="node">
<title>fetchAllSchemasWithTables</title>
<polygon fill="none" stroke="black" points="1058,-278.5 1058,-339.5 1246,-339.5 1246,-278.5 1058,-278.5"/>
<text text-anchor="middle" x="1152" y="-324.3" font-family="Times,serif" font-size="14.00">fetchAllSchemasWithTables</text>
<polyline fill="none" stroke="black" points="1058,-316.5 1246,-316.5 "/>
<text text-anchor="start" x="1066" y="-301.3" font-family="Times,serif" font-size="14.00">首先获取所有的db</text>
<text text-anchor="start" x="1066" y="-286.3" font-family="Times,serif" font-size="14.00"> 然后对每个db加所有的table</text>
</g>
<!-- InitWithDBInfos -->
<g id="node24" class="node">
<title>InitWithDBInfos</title>
<polygon fill="none" stroke="black" points="1497,-192.5 1497,-283.5 1745,-283.5 1745,-192.5 1497,-192.5"/>
<text text-anchor="middle" x="1621" y="-268.3" font-family="Times,serif" font-size="14.00">InitWithDBInfos</text>
<polyline fill="none" stroke="black" points="1497,-260.5 1745,-260.5 "/>
<text text-anchor="start" x="1505" y="-245.3" font-family="Times,serif" font-size="14.00">initializes an empty new InfoSchema with</text>
<text text-anchor="start" x="1505" y="-230.3" font-family="Times,serif" font-size="14.00"> 1. a slice of DBInfo</text>
<text text-anchor="start" x="1505" y="-215.3" font-family="Times,serif" font-size="14.00"> 2. all placement rules</text>
<text text-anchor="start" x="1505" y="-200.3" font-family="Times,serif" font-size="14.00"> 3. schema version</text>
</g>
<!-- fetchSchemasWithTables -->
<g id="node25" class="node">
<title>fetchSchemasWithTables</title>
<polygon fill="none" stroke="black" points="1460,-294 1305,-294 1305,-258 1460,-258 1460,-294"/>
<text text-anchor="middle" x="1382.5" y="-272.3" font-family="Times,serif" font-size="14.00">fetchSchemasWithTables</text>
</g>
<!-- InitWithOldInfoSchema -->
<g id="node26" class="node">
<title>InitWithOldInfoSchema</title>
<polygon fill="none" stroke="black" points="1457,-612 1308,-612 1308,-576 1457,-576 1457,-612"/>
<text text-anchor="middle" x="1382.5" y="-590.3" font-family="Times,serif" font-size="14.00">InitWithOldInfoSchema</text>
</g>
</g>
</svg>
