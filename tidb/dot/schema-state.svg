<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: schema_state Pages: 1 -->
<svg width="1681pt" height="337pt"
 viewBox="0.00 0.00 1681.00 337.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 333)">
<title>schema_state</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-333 1677,-333 1677,4 -4,4"/>
<!-- rank1 -->
<!-- rank2 -->
<!-- rank1&#45;&gt;rank2 -->
<!-- rank3 -->
<!-- rank2&#45;&gt;rank3 -->
<!-- rank4 -->
<!-- rank3&#45;&gt;rank4 -->
<!-- rank5 -->
<!-- rank4&#45;&gt;rank5 -->
<!-- rank6 -->
<!-- rank5&#45;&gt;rank6 -->
<!-- StateReplicaOnly -->
<g id="node7" class="node">
<title>StateReplicaOnly</title>
<polygon fill="none" stroke="black" points="565,-130.5 565,-191.5 699,-191.5 699,-130.5 565,-130.5"/>
<text text-anchor="middle" x="632" y="-176.3" font-family="Times,serif" font-size="14.00">StateReplicaOnly</text>
<polyline fill="none" stroke="black" points="565,-168.5 699,-168.5 "/>
<text text-anchor="start" x="573" y="-153.3" font-family="Times,serif" font-size="14.00">we&#39;re waiting tiflash</text>
<text text-anchor="start" x="573" y="-138.3" font-family="Times,serif" font-size="14.00"> replica to be finished</text>
</g>
<!-- StatePublic -->
<g id="node12" class="node">
<title>StatePublic</title>
<polygon fill="lightgreen" stroke="black" points="1478,-155.5 1478,-216.5 1673,-216.5 1673,-155.5 1478,-155.5"/>
<text text-anchor="middle" x="1575.5" y="-201.3" font-family="Times,serif" font-size="14.00">StatePublic</text>
<polyline fill="none" stroke="black" points="1478,-193.5 1673,-193.5 "/>
<text text-anchor="start" x="1486" y="-178.3" font-family="Times,serif" font-size="14.00">this schema element is ok</text>
<text text-anchor="start" x="1486" y="-163.3" font-family="Times,serif" font-size="14.00"> for all write and read operations</text>
</g>
<!-- StateReplicaOnly&#45;&gt;StatePublic -->
<g id="edge25" class="edge">
<title>StateReplicaOnly&#45;&gt;StatePublic</title>
<path fill="none" stroke="deepskyblue" d="M699.25,-160.65C839.63,-160.26 1177.32,-161.11 1460,-176 1462.53,-176.13 1465.09,-176.28 1467.67,-176.43"/>
<polygon fill="deepskyblue" stroke="deepskyblue" points="1467.5,-179.93 1477.71,-177.07 1467.95,-172.94 1467.5,-179.93"/>
<text text-anchor="middle" x="1115.5" y="-168.8" font-family="Times,serif" font-size="14.00" fill="deepskyblue">addTablePartition</text>
</g>
<!-- StateDeleteOnly -->
<g id="node8" class="node">
<title>StateDeleteOnly</title>
<polygon fill="none" stroke="black" points="556,-230.5 556,-291.5 708,-291.5 708,-230.5 556,-230.5"/>
<text text-anchor="middle" x="632" y="-276.3" font-family="Times,serif" font-size="14.00">StateDeleteOnly</text>
<polyline fill="none" stroke="black" points="556,-268.5 708,-268.5 "/>
<text text-anchor="start" x="564" y="-253.3" font-family="Times,serif" font-size="14.00">we can only delete items</text>
<text text-anchor="start" x="564" y="-238.3" font-family="Times,serif" font-size="14.00"> for this schema element</text>
</g>
<!-- StateWriteOnly -->
<g id="node9" class="node">
<title>StateWriteOnly</title>
<polygon fill="none" stroke="black" points="829,-225 829,-301 1049,-301 1049,-225 829,-225"/>
<text text-anchor="middle" x="939" y="-285.8" font-family="Times,serif" font-size="14.00">StateWriteOnly</text>
<polyline fill="none" stroke="black" points="829,-278 1049,-278 "/>
<text text-anchor="start" x="837" y="-262.8" font-family="Times,serif" font-size="14.00">we can ouse any write operation</text>
<text text-anchor="start" x="837" y="-247.8" font-family="Times,serif" font-size="14.00"> on this schema element</text>
<text text-anchor="start" x="837" y="-232.8" font-family="Times,serif" font-size="14.00"> but outer can&#39;t read the changed data</text>
</g>
<!-- StateDeleteOnly&#45;&gt;StateWriteOnly -->
<g id="edge11" class="edge">
<title>StateDeleteOnly&#45;&gt;StateWriteOnly</title>
<path fill="none" stroke="limegreen" d="M708.08,-232.83C714.08,-231.3 720.11,-229.99 726,-229 763.26,-222.77 773.54,-224.07 811,-229 813.57,-229.34 816.17,-229.71 818.78,-230.12"/>
<polygon fill="limegreen" stroke="limegreen" points="818.47,-233.62 828.91,-231.86 819.64,-226.72 818.47,-233.62"/>
<text text-anchor="middle" x="768.5" y="-232.8" font-family="Times,serif" font-size="14.00" fill="limegreen">createIndex</text>
</g>
<!-- StateDeleteOnly&#45;&gt;StateWriteOnly -->
<g id="edge17" class="edge">
<title>StateDeleteOnly&#45;&gt;StateWriteOnly</title>
<path fill="none" stroke="teal" d="M672.91,-230.47C688.59,-220.28 707.3,-210.2 726,-205 762.4,-194.89 774.09,-196.97 811,-205 827.08,-208.5 843.57,-214.22 859.12,-220.74"/>
<polygon fill="teal" stroke="teal" points="858.09,-224.12 868.66,-224.9 860.89,-217.7 858.09,-224.12"/>
<text text-anchor="middle" x="768.5" y="-208.8" font-family="Times,serif" font-size="14.00" fill="teal">AddColumn</text>
</g>
<!-- StateDeleteReorganization -->
<g id="node10" class="node">
<title>StateDeleteReorganization</title>
<polygon fill="turquoise" stroke="black" points="258,-232.5 258,-293.5 450,-293.5 450,-232.5 258,-232.5"/>
<text text-anchor="middle" x="354" y="-278.3" font-family="Times,serif" font-size="14.00">StateDeleteReorganization</text>
<polyline fill="none" stroke="black" points="258,-270.5 450,-270.5 "/>
<text text-anchor="start" x="266" y="-255.3" font-family="Times,serif" font-size="14.00">we are re&#45;organizing whole data</text>
<text text-anchor="start" x="266" y="-240.3" font-family="Times,serif" font-size="14.00"> after delete only state</text>
</g>
<!-- StateDeleteOnly&#45;&gt;StateDeleteReorganization -->
<g id="edge8" class="edge">
<title>StateDeleteOnly&#45;&gt;StateDeleteReorganization</title>
<path fill="none" stroke="salmon" d="M555.95,-270.65C549.88,-271.19 543.84,-271.66 538,-272 512.91,-273.48 485.88,-273.19 460.49,-272.08"/>
<polygon fill="salmon" stroke="salmon" points="460.63,-268.58 450.47,-271.59 460.29,-275.57 460.63,-268.58"/>
<text text-anchor="middle" x="503" y="-276.8" font-family="Times,serif" font-size="14.00" fill="salmon">dropIndex</text>
</g>
<!-- StateDeleteOnly&#45;&gt;StateDeleteReorganization -->
<g id="edge22" class="edge">
<title>StateDeleteOnly&#45;&gt;StateDeleteReorganization</title>
<path fill="none" stroke="orange" d="M555.91,-253.98C549.86,-253.59 543.83,-253.25 538,-253 506.92,-251.67 499.08,-251.63 468,-253 465.46,-253.11 462.89,-253.24 460.3,-253.38"/>
<polygon fill="orange" stroke="orange" points="459.99,-249.89 450.21,-253.97 460.4,-256.88 459.99,-249.89"/>
<text text-anchor="middle" x="503" y="-256.8" font-family="Times,serif" font-size="14.00" fill="orange">dropColumn</text>
</g>
<!-- StateWriteOnly&#45;&gt;StateDeleteOnly -->
<g id="edge7" class="edge">
<title>StateWriteOnly&#45;&gt;StateDeleteOnly</title>
<path fill="none" stroke="salmon" d="M828.97,-281.15C795.87,-284.4 759.42,-285.73 726,-282 723.45,-281.72 720.86,-281.39 718.25,-281.02"/>
<polygon fill="salmon" stroke="salmon" points="718.55,-277.53 708.13,-279.45 717.48,-284.45 718.55,-277.53"/>
<text text-anchor="middle" x="768.5" y="-287.8" font-family="Times,serif" font-size="14.00" fill="salmon">dropIndex</text>
</g>
<!-- StateWriteOnly&#45;&gt;StateDeleteOnly -->
<g id="edge21" class="edge">
<title>StateWriteOnly&#45;&gt;StateDeleteOnly</title>
<path fill="none" stroke="orange" d="M828.97,-262.29C792.48,-262.05 752.38,-261.78 718,-261.56"/>
<polygon fill="orange" stroke="orange" points="718.02,-258.06 708,-261.49 717.98,-265.06 718.02,-258.06"/>
<text text-anchor="middle" x="768.5" y="-265.8" font-family="Times,serif" font-size="14.00" fill="orange">dropColumn</text>
</g>
<!-- StateWriteReorganization -->
<g id="node11" class="node">
<title>StateWriteReorganization</title>
<polygon fill="turquoise" stroke="black" points="1182,-219.5 1182,-280.5 1374,-280.5 1374,-219.5 1182,-219.5"/>
<text text-anchor="middle" x="1278" y="-265.3" font-family="Times,serif" font-size="14.00">StateWriteReorganization</text>
<polyline fill="none" stroke="black" points="1182,-257.5 1374,-257.5 "/>
<text text-anchor="start" x="1190" y="-242.3" font-family="Times,serif" font-size="14.00">we are re&#45;organizing whole data</text>
<text text-anchor="start" x="1190" y="-227.3" font-family="Times,serif" font-size="14.00"> after write only state</text>
</g>
<!-- StateWriteOnly&#45;&gt;StateWriteReorganization -->
<g id="edge12" class="edge">
<title>StateWriteOnly&#45;&gt;StateWriteReorganization</title>
<path fill="none" stroke="limegreen" d="M1049.41,-258.78C1088.58,-257.27 1132.62,-255.57 1171.46,-254.07"/>
<polygon fill="limegreen" stroke="limegreen" points="1171.88,-257.56 1181.73,-253.67 1171.61,-250.56 1171.88,-257.56"/>
<text text-anchor="middle" x="1115.5" y="-261.8" font-family="Times,serif" font-size="14.00" fill="limegreen">createIndex</text>
</g>
<!-- StateWriteOnly&#45;&gt;StateWriteReorganization -->
<g id="edge18" class="edge">
<title>StateWriteOnly&#45;&gt;StateWriteReorganization</title>
<path fill="none" stroke="teal" d="M1049.2,-237.35C1055.2,-236.43 1061.16,-235.64 1067,-235 1109.86,-230.33 1120.98,-232.16 1164,-235 1166.55,-235.17 1169.13,-235.36 1171.73,-235.57"/>
<polygon fill="teal" stroke="teal" points="1171.57,-239.07 1181.84,-236.46 1172.18,-232.09 1171.57,-239.07"/>
<text text-anchor="middle" x="1115.5" y="-238.8" font-family="Times,serif" font-size="14.00" fill="teal">AddColumn</text>
</g>
<!-- StateNone -->
<g id="node13" class="node">
<title>StateNone</title>
<polygon fill="lightgreen" stroke="black" points="0,-168.5 0,-229.5 152,-229.5 152,-168.5 0,-168.5"/>
<text text-anchor="middle" x="76" y="-214.3" font-family="Times,serif" font-size="14.00">StateNone</text>
<polyline fill="none" stroke="black" points="0,-206.5 152,-206.5 "/>
<text text-anchor="start" x="8" y="-191.3" font-family="Times,serif" font-size="14.00">this schema element is</text>
<text text-anchor="start" x="8" y="-176.3" font-family="Times,serif" font-size="14.00"> absent and can&#39;t be used</text>
</g>
<!-- StateDeleteReorganization&#45;&gt;StateNone -->
<g id="edge9" class="edge">
<title>StateDeleteReorganization&#45;&gt;StateNone</title>
<path fill="none" stroke="salmon" d="M257.64,-262.45C229.03,-260.35 197.85,-256.11 170,-248 158.36,-244.61 146.51,-239.68 135.33,-234.24"/>
<polygon fill="salmon" stroke="salmon" points="136.62,-230.97 126.11,-229.58 133.45,-237.22 136.62,-230.97"/>
<text text-anchor="middle" x="205" y="-263.8" font-family="Times,serif" font-size="14.00" fill="salmon">dropIndex</text>
</g>
<!-- StateDeleteReorganization&#45;&gt;StateNone -->
<g id="edge23" class="edge">
<title>StateDeleteReorganization&#45;&gt;StateNone</title>
<path fill="none" stroke="orange" d="M257.95,-233.58C251.9,-231.96 245.87,-230.42 240,-229 214.82,-222.91 187.18,-217.4 161.94,-212.8"/>
<polygon fill="orange" stroke="orange" points="162.48,-209.34 152.02,-211.02 161.24,-216.23 162.48,-209.34"/>
<text text-anchor="middle" x="205" y="-232.8" font-family="Times,serif" font-size="14.00" fill="orange">dropColumn</text>
</g>
<!-- StateWriteReorganization&#45;&gt;StatePublic -->
<g id="edge13" class="edge">
<title>StateWriteReorganization&#45;&gt;StatePublic</title>
<path fill="none" stroke="limegreen" d="M1374.34,-247.85C1402.25,-245.68 1432.61,-241.8 1460,-235 1474.41,-231.42 1489.32,-226.24 1503.44,-220.57"/>
<polygon fill="limegreen" stroke="limegreen" points="1505.16,-223.64 1513.06,-216.58 1502.49,-217.17 1505.16,-223.64"/>
<text text-anchor="middle" x="1426" y="-248.8" font-family="Times,serif" font-size="14.00" fill="limegreen">createIndex</text>
</g>
<!-- StateWriteReorganization&#45;&gt;StatePublic -->
<g id="edge19" class="edge">
<title>StateWriteReorganization&#45;&gt;StatePublic</title>
<path fill="none" stroke="teal" d="M1374.02,-220.45C1380.08,-218.86 1386.11,-217.36 1392,-216 1416.44,-210.34 1442.96,-205.34 1468.01,-201.12"/>
<polygon fill="teal" stroke="teal" points="1468.61,-204.57 1477.91,-199.49 1467.47,-197.67 1468.61,-204.57"/>
<text text-anchor="middle" x="1426" y="-219.8" font-family="Times,serif" font-size="14.00" fill="teal">AddColumn</text>
</g>
<!-- StatePublic&#45;&gt;StateWriteOnly -->
<g id="edge6" class="edge">
<title>StatePublic&#45;&gt;StateWriteOnly</title>
<path fill="none" stroke="salmon" d="M1536.03,-216.57C1514.62,-232.44 1486.91,-251.14 1460,-264 1423.97,-281.22 1413.5,-284.16 1374,-290 1268.29,-305.63 1146.8,-295.72 1059.29,-283.74"/>
<polygon fill="salmon" stroke="salmon" points="1059.72,-280.26 1049.33,-282.34 1058.75,-287.2 1059.72,-280.26"/>
<text text-anchor="middle" x="1278" y="-301.8" font-family="Times,serif" font-size="14.00" fill="salmon">dropIndex</text>
</g>
<!-- StatePublic&#45;&gt;StateWriteOnly -->
<g id="edge20" class="edge">
<title>StatePublic&#45;&gt;StateWriteOnly</title>
<path fill="none" stroke="orange" d="M1477.95,-181.51C1398.15,-179.4 1282.11,-180.03 1182,-195 1141.32,-201.08 1097.78,-211.91 1059.01,-223.15"/>
<polygon fill="orange" stroke="orange" points="1057.87,-219.84 1049.26,-226.02 1059.85,-226.56 1057.87,-219.84"/>
<text text-anchor="middle" x="1278" y="-198.8" font-family="Times,serif" font-size="14.00" fill="orange">dropColumn</text>
</g>
<!-- StateNone&#45;&gt;StateReplicaOnly -->
<g id="edge24" class="edge">
<title>StateNone&#45;&gt;StateReplicaOnly</title>
<path fill="none" stroke="deepskyblue" d="M152.22,-180.13C184.55,-172.94 222.9,-165.6 258,-162 360.13,-151.53 478.82,-153.64 554.39,-156.77"/>
<polygon fill="deepskyblue" stroke="deepskyblue" points="554.62,-160.29 564.76,-157.22 554.92,-153.29 554.62,-160.29"/>
<text text-anchor="middle" x="354" y="-165.8" font-family="Times,serif" font-size="14.00" fill="deepskyblue">addTablePartition</text>
</g>
<!-- StateNone&#45;&gt;StateDeleteOnly -->
<g id="edge10" class="edge">
<title>StateNone&#45;&gt;StateDeleteOnly</title>
<path fill="none" stroke="limegreen" d="M105.85,-229.8C123.04,-246.52 146.11,-266.31 170,-279 205.8,-298.02 217.82,-297.62 258,-303 381.44,-319.53 416.54,-319.55 538,-292 540.67,-291.39 543.37,-290.74 546.09,-290.05"/>
<polygon fill="limegreen" stroke="limegreen" points="547.23,-293.37 555.98,-287.4 545.42,-286.61 547.23,-293.37"/>
<text text-anchor="middle" x="354" y="-317.8" font-family="Times,serif" font-size="14.00" fill="limegreen">createIndex</text>
</g>
<!-- StateNone&#45;&gt;StateDeleteOnly -->
<g id="edge16" class="edge">
<title>StateNone&#45;&gt;StateDeleteOnly</title>
<path fill="none" stroke="teal" d="M152.17,-195.11C227.87,-192.52 347.75,-192.08 450,-208 481.97,-212.98 516.22,-222.01 546.23,-231.22"/>
<polygon fill="teal" stroke="teal" points="545.23,-234.58 555.82,-234.22 547.32,-227.89 545.23,-234.58"/>
<text text-anchor="middle" x="354" y="-211.8" font-family="Times,serif" font-size="14.00" fill="teal">AddColumn</text>
</g>
<!-- StateNone&#45;&gt;StatePublic -->
<g id="edge14" class="edge">
<title>StateNone&#45;&gt;StatePublic</title>
<path fill="none" stroke="burlywood" d="M129.79,-168.44C183.97,-140.01 271.61,-102 353,-102 353,-102 353,-102 1279,-102 1355.54,-102 1439.13,-128.4 1497.81,-151.6"/>
<polygon fill="burlywood" stroke="burlywood" points="1496.79,-154.96 1507.37,-155.44 1499.4,-148.46 1496.79,-154.96"/>
<text text-anchor="middle" x="768.5" y="-105.8" font-family="Times,serif" font-size="14.00" fill="burlywood">CreateDatabase</text>
</g>
<!-- StateNone&#45;&gt;StatePublic -->
<g id="edge15" class="edge">
<title>StateNone&#45;&gt;StatePublic</title>
<path fill="none" stroke="#666666" d="M105.48,-168.39C122.72,-151.43 145.97,-131.18 170,-118 244.35,-77.22 268.2,-64 353,-64 353,-64 353,-64 1279,-64 1362.46,-64 1384.05,-79.4 1460,-114 1481.68,-123.88 1504.16,-137.23 1523.4,-149.76"/>
<polygon fill="#666666" stroke="#666666" points="1521.73,-152.85 1532,-155.44 1525.59,-147.01 1521.73,-152.85"/>
<text text-anchor="middle" x="768.5" y="-67.8" font-family="Times,serif" font-size="14.00">CreateTable</text>
</g>
</g>
</svg>
