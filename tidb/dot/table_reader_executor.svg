<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: table_reader_executor Pages: 1 -->
<svg width="1302pt" height="712pt"
 viewBox="0.00 0.00 1302.00 712.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 708)">
<title>table_reader_executor</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-708 1298,-708 1298,4 -4,4"/>
<g id="clust4" class="cluster">
<title>cluster_distsql</title>
<polygon fill="none" stroke="black" points="162,-44 162,-326 1286,-326 1286,-44 162,-44"/>
<text text-anchor="middle" x="724" y="-306" font-family="Times,serif" font-size="20.00">distsql</text>
</g>
<!-- Open -->
<g id="node1" class="node">
<title>Open</title>
<polygon fill="none" stroke="black" points="54,-569 0,-569 0,-533 54,-533 54,-569"/>
<text text-anchor="middle" x="27" y="-547.3" font-family="Times,serif" font-size="14.00">Open</text>
</g>
<!-- BuildTableRange -->
<g id="node2" class="node">
<title>BuildTableRange</title>
<polygon fill="none" stroke="black" points="285.5,-596 173.5,-596 173.5,-560 285.5,-560 285.5,-596"/>
<text text-anchor="middle" x="229.5" y="-574.3" font-family="Times,serif" font-size="14.00">BuildTableRange</text>
</g>
<!-- Open&#45;&gt;BuildTableRange -->
<g id="edge1" class="edge">
<title>Open&#45;&gt;BuildTableRange</title>
<path fill="none" stroke="#b83b5e" d="M54.21,-554.53C81.67,-558.23 125.87,-564.18 162.89,-569.16"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="162.74,-572.68 173.12,-570.54 163.68,-565.74 162.74,-572.68"/>
</g>
<!-- splitRanges -->
<g id="node3" class="node">
<title>splitRanges</title>
<polygon fill="none" stroke="black" points="269.5,-542 189.5,-542 189.5,-506 269.5,-506 269.5,-542"/>
<text text-anchor="middle" x="229.5" y="-520.3" font-family="Times,serif" font-size="14.00">splitRanges</text>
</g>
<!-- Open&#45;&gt;splitRanges -->
<g id="edge2" class="edge">
<title>Open&#45;&gt;splitRanges</title>
<path fill="none" stroke="#b83b5e" d="M54.21,-547.47C85.85,-543.21 139.72,-535.96 179.21,-530.64"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="179.73,-534.1 189.17,-529.3 178.79,-527.16 179.73,-534.1"/>
</g>
<!-- buildResp -->
<g id="node4" class="node">
<title>buildResp</title>
<polygon fill="none" stroke="black" points="90,-388.5 90,-487.5 369,-487.5 369,-388.5 90,-388.5"/>
<text text-anchor="middle" x="229.5" y="-472.3" font-family="Times,serif" font-size="14.00">buildRes</text>
<polyline fill="none" stroke="black" points="90,-464.5 369,-464.5 "/>
<text text-anchor="start" x="98" y="-449.3" font-family="Times,serif" font-size="14.00">first builds request and sends it to tikv</text>
<text text-anchor="start" x="98" y="-434.3" font-family="Times,serif" font-size="14.00"> using distsql.Select it uses selectResut</text>
<text text-anchor="start" x="98" y="-419.3" font-family="Times,serif" font-size="14.00"> returned by the called to fetch all results</text>
<polyline fill="none" stroke="black" points="90,-411.5 369,-411.5 "/>
<text text-anchor="start" x="98" y="-396.3" font-family="Times,serif" font-size="14.00">发送请求到tikv,通过SelectResult来获取结果</text>
</g>
<!-- Open&#45;&gt;buildResp -->
<g id="edge3" class="edge">
<title>Open&#45;&gt;buildResp</title>
<path fill="none" stroke="#b83b5e" d="M45.78,-532.82C57.56,-521.47 73.79,-507.15 90,-497 92.44,-495.47 94.93,-493.97 97.45,-492.48"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="99.2,-495.51 106.17,-487.53 95.74,-489.43 99.2,-495.51"/>
</g>
<!-- tableResultHandler_open -->
<g id="node5" class="node">
<title>tableResultHandler_open</title>
<polygon fill="none" stroke="black" points="306.5,-370 152.5,-370 152.5,-334 306.5,-334 306.5,-370"/>
<text text-anchor="middle" x="229.5" y="-348.3" font-family="Times,serif" font-size="14.00">tableResultHandler_open</text>
</g>
<!-- Open&#45;&gt;tableResultHandler_open -->
<g id="edge4" class="edge">
<title>Open&#45;&gt;tableResultHandler_open</title>
<path fill="none" stroke="#b83b5e" d="M28.9,-532.95C31.69,-497.59 43.13,-419.18 90,-379 104.65,-366.44 123.4,-359.05 142.33,-354.85"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="143.08,-358.27 152.23,-352.92 141.75,-351.39 143.08,-358.27"/>
</g>
<!-- constructDistExec -->
<g id="node6" class="node">
<title>constructDistExec</title>
<polygon fill="none" stroke="black" points="287.5,-704 171.5,-704 171.5,-668 287.5,-668 287.5,-704"/>
<text text-anchor="middle" x="229.5" y="-682.3" font-family="Times,serif" font-size="14.00">constructDistExec</text>
</g>
<!-- Open&#45;&gt;constructDistExec -->
<g id="edge5" class="edge">
<title>Open&#45;&gt;constructDistExec</title>
<path fill="none" stroke="#b83b5e" d="M33.18,-569.14C41.15,-593.63 58.88,-636.73 90,-659 110.48,-673.66 136.85,-680.9 161.08,-684.31"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="160.95,-687.82 171.3,-685.55 161.8,-680.87 160.95,-687.82"/>
</g>
<!-- constructDistExecForTiFlash -->
<g id="node7" class="node">
<title>constructDistExecForTiFlash</title>
<polygon fill="none" stroke="black" points="317.5,-650 141.5,-650 141.5,-614 317.5,-614 317.5,-650"/>
<text text-anchor="middle" x="229.5" y="-628.3" font-family="Times,serif" font-size="14.00">constructDistExecForTiFlash</text>
</g>
<!-- Open&#45;&gt;constructDistExecForTiFlash -->
<g id="edge6" class="edge">
<title>Open&#45;&gt;constructDistExecForTiFlash</title>
<path fill="none" stroke="#b83b5e" d="M43.84,-569.07C55.43,-581.12 72.17,-596.29 90,-605 102.88,-611.29 117.1,-616.12 131.38,-619.82"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="130.72,-623.26 141.26,-622.21 132.37,-616.46 130.72,-623.26"/>
</g>
<!-- buildColumnRange -->
<g id="node9" class="node">
<title>buildColumnRange</title>
<polygon fill="none" stroke="black" points="572.5,-596 449.5,-596 449.5,-560 572.5,-560 572.5,-596"/>
<text text-anchor="middle" x="511" y="-574.3" font-family="Times,serif" font-size="14.00">buildColumnRange</text>
</g>
<!-- BuildTableRange&#45;&gt;buildColumnRange -->
<g id="edge8" class="edge">
<title>BuildTableRange&#45;&gt;buildColumnRange</title>
<path fill="none" stroke="#666666" d="M285.72,-578C329.59,-578 391.27,-578 438.84,-578"/>
<polygon fill="#666666" stroke="#666666" points="439.07,-581.5 449.07,-578 439.07,-574.5 439.07,-581.5"/>
</g>
<!-- SelectResult -->
<g id="node13" class="node">
<title>SelectResult</title>
<polygon fill="none" stroke="black" points="553,-288 469,-288 469,-252 553,-252 553,-288"/>
<text text-anchor="middle" x="511" y="-266.3" font-family="Times,serif" font-size="14.00">SelectResult</text>
</g>
<!-- buildResp&#45;&gt;SelectResult -->
<g id="edge11" class="edge">
<title>buildResp&#45;&gt;SelectResult</title>
<path fill="none" stroke="#666666" d="M351.89,-388.46C357.74,-385.4 363.48,-382.24 369,-379 411.27,-354.21 455.2,-318.38 482.56,-294.65"/>
<polygon fill="#666666" stroke="#666666" points="484.94,-297.22 490.16,-288 480.33,-291.95 484.94,-297.22"/>
</g>
<!-- buildKeyRange -->
<g id="node14" class="node">
<title>buildKeyRange</title>
<polygon fill="none" stroke="black" points="561.5,-456 460.5,-456 460.5,-420 561.5,-420 561.5,-456"/>
<text text-anchor="middle" x="511" y="-434.3" font-family="Times,serif" font-size="14.00">buildKeyRange</text>
</g>
<!-- buildResp&#45;&gt;buildKeyRange -->
<g id="edge12" class="edge">
<title>buildResp&#45;&gt;buildKeyRange</title>
<path fill="none" stroke="#666666" d="M369.02,-438C397.6,-438 426.25,-438 450.18,-438"/>
<polygon fill="#666666" stroke="#666666" points="450.48,-441.5 460.48,-438 450.48,-434.5 450.48,-441.5"/>
</g>
<!-- Fetch -->
<g id="node15" class="node">
<title>Fetch</title>
<polygon fill="none" stroke="black" points="538,-234 484,-234 484,-198 538,-198 538,-234"/>
<text text-anchor="middle" x="511" y="-212.3" font-family="Times,serif" font-size="14.00">Fetch</text>
</g>
<!-- buildResp&#45;&gt;Fetch -->
<g id="edge13" class="edge">
<title>buildResp&#45;&gt;Fetch</title>
<path fill="none" stroke="#666666" d="M359.94,-388.27C363.14,-385.35 366.18,-382.26 369,-379 409.92,-331.72 360.63,-287.06 405,-243 422.99,-225.14 451.11,-218.6 473.72,-216.41"/>
<polygon fill="#666666" stroke="#666666" points="474.27,-219.88 483.99,-215.67 473.76,-212.9 474.27,-219.88"/>
</g>
<!-- physicalPlan_ToPB -->
<g id="node8" class="node">
<title>physicalPlan_ToPB</title>
<polygon fill="none" stroke="black" points="573,-704 449,-704 449,-668 573,-668 573,-704"/>
<text text-anchor="middle" x="511" y="-682.3" font-family="Times,serif" font-size="14.00">physicalPlan_ToPB</text>
</g>
<!-- constructDistExec&#45;&gt;physicalPlan_ToPB -->
<g id="edge7" class="edge">
<title>constructDistExec&#45;&gt;physicalPlan_ToPB</title>
<path fill="none" stroke="#666666" d="M287.74,-686C331.48,-686 392.03,-686 438.89,-686"/>
<polygon fill="#666666" stroke="#666666" points="438.97,-689.5 448.97,-686 438.97,-682.5 438.97,-689.5"/>
</g>
<!-- Next -->
<g id="node10" class="node">
<title>Next</title>
<polygon fill="none" stroke="black" points="54,-36 0,-36 0,0 54,0 54,-36"/>
<text text-anchor="middle" x="27" y="-14.3" font-family="Times,serif" font-size="14.00">Next</text>
</g>
<!-- tableResultHandler_nextChunk -->
<g id="node11" class="node">
<title>tableResultHandler_nextChunk</title>
<polygon fill="none" stroke="black" points="323,-36 136,-36 136,0 323,0 323,-36"/>
<text text-anchor="middle" x="229.5" y="-14.3" font-family="Times,serif" font-size="14.00">tableResultHandler_nextChunk</text>
</g>
<!-- Next&#45;&gt;tableResultHandler_nextChunk -->
<g id="edge9" class="edge">
<title>Next&#45;&gt;tableResultHandler_nextChunk</title>
<path fill="none" stroke="#666666" d="M54.21,-18C72.85,-18 99.2,-18 125.78,-18"/>
<polygon fill="#666666" stroke="#666666" points="125.96,-21.5 135.96,-18 125.96,-14.5 125.96,-21.5"/>
</g>
<!-- selectResult_Next -->
<g id="node12" class="node">
<title>selectResult_Next</title>
<polygon fill="none" stroke="black" points="455,-53 455,-99 567,-99 567,-53 455,-53"/>
<text text-anchor="middle" x="511" y="-83.8" font-family="Times,serif" font-size="14.00">selectResult.Next</text>
<polyline fill="none" stroke="black" points="455,-76 567,-76 "/>
<text text-anchor="middle" x="511" y="-60.8" font-family="Times,serif" font-size="14.00">迭代获取结果</text>
</g>
<!-- tableResultHandler_nextChunk&#45;&gt;selectResult_Next -->
<g id="edge10" class="edge">
<title>tableResultHandler_nextChunk&#45;&gt;selectResult_Next</title>
<path fill="none" stroke="#666666" d="M323.1,-31.49C338.47,-34.08 354.22,-36.95 369,-40 393.9,-45.14 421.01,-51.81 444.74,-58"/>
<polygon fill="#666666" stroke="#666666" points="444.13,-61.46 454.69,-60.62 445.91,-54.69 444.13,-61.46"/>
</g>
<!-- fetchResp -->
<g id="node20" class="node">
<title>fetchResp</title>
<polygon fill="none" stroke="black" points="763.5,-94 692.5,-94 692.5,-58 763.5,-58 763.5,-94"/>
<text text-anchor="middle" x="728" y="-72.3" font-family="Times,serif" font-size="14.00">fetchResp</text>
</g>
<!-- selectResult_Next&#45;&gt;fetchResp -->
<g id="edge16" class="edge">
<title>selectResult_Next&#45;&gt;fetchResp</title>
<path fill="none" stroke="#666666" d="M567.09,-76C602.68,-76 648.41,-76 681.85,-76"/>
<polygon fill="#666666" stroke="#666666" points="682.24,-79.5 692.24,-76 682.24,-72.5 682.24,-79.5"/>
</g>
<!-- SelectWithRuntimeStats -->
<g id="node16" class="node">
<title>SelectWithRuntimeStats</title>
<polygon fill="none" stroke="black" points="803,-277 653,-277 653,-241 803,-241 803,-277"/>
<text text-anchor="middle" x="728" y="-255.3" font-family="Times,serif" font-size="14.00">SelectWithRuntimeStats</text>
</g>
<!-- SelectResult&#45;&gt;SelectWithRuntimeStats -->
<g id="edge14" class="edge">
<title>SelectResult&#45;&gt;SelectWithRuntimeStats</title>
<path fill="none" stroke="#666666" d="M553.2,-267.89C578.51,-266.6 611.85,-264.89 642.56,-263.32"/>
<polygon fill="#666666" stroke="#666666" points="643.05,-266.8 652.86,-262.79 642.7,-259.81 643.05,-266.8"/>
</g>
<!-- Select -->
<g id="node19" class="node">
<title>Select</title>
<polygon fill="none" stroke="black" points="839,-211 839,-287 1067,-287 1067,-211 839,-211"/>
<text text-anchor="middle" x="953" y="-271.8" font-family="Times,serif" font-size="14.00">Select</text>
<polyline fill="none" stroke="black" points="839,-264 1067,-264 "/>
<text text-anchor="start" x="847" y="-248.8" font-family="Times,serif" font-size="14.00">通过copIterator发送请求到tikv</text>
<text text-anchor="start" x="847" y="-233.8" font-family="Times,serif" font-size="14.00"> 并返回streamResult或者selectResult</text>
<text text-anchor="start" x="847" y="-218.8" font-family="Times,serif" font-size="14.00"> 来获取结果</text>
</g>
<!-- SelectWithRuntimeStats&#45;&gt;Select -->
<g id="edge20" class="edge">
<title>SelectWithRuntimeStats&#45;&gt;Select</title>
<path fill="none" stroke="#666666" d="M803.26,-255.67C811.45,-255.3 819.95,-254.92 828.55,-254.54"/>
<polygon fill="#666666" stroke="#666666" points="828.83,-258.03 838.67,-254.08 828.52,-251.03 828.83,-258.03"/>
</g>
<!-- Close -->
<g id="node17" class="node">
<title>Close</title>
<polygon fill="none" stroke="black" points="54,-167 0,-167 0,-131 54,-131 54,-167"/>
<text text-anchor="middle" x="27" y="-145.3" font-family="Times,serif" font-size="14.00">Close</text>
</g>
<!-- selectResult_Close -->
<g id="node18" class="node">
<title>selectResult_Close</title>
<polygon fill="none" stroke="black" points="170,-126 170,-172 289,-172 289,-126 170,-126"/>
<text text-anchor="middle" x="229.5" y="-156.8" font-family="Times,serif" font-size="14.00">SelectResult.Close</text>
<polyline fill="none" stroke="black" points="170,-149 289,-149 "/>
<text text-anchor="middle" x="229.5" y="-133.8" font-family="Times,serif" font-size="14.00">关闭迭代器</text>
</g>
<!-- Close&#45;&gt;selectResult_Close -->
<g id="edge15" class="edge">
<title>Close&#45;&gt;selectResult_Close</title>
<path fill="none" stroke="#666666" d="M54.21,-149C80.89,-149 123.39,-149 159.73,-149"/>
<polygon fill="#666666" stroke="#666666" points="159.8,-152.5 169.8,-149 159.8,-145.5 159.8,-152.5"/>
</g>
<!-- copIterator_Close -->
<g id="node25" class="node">
<title>copIterator_Close</title>
<polygon fill="none" stroke="black" points="405,-118.5 405,-179.5 617,-179.5 617,-118.5 405,-118.5"/>
<text text-anchor="middle" x="511" y="-164.3" font-family="Times,serif" font-size="14.00">copIteator_Close</text>
<polyline fill="none" stroke="black" points="405,-156.5 617,-156.5 "/>
<text text-anchor="start" x="413" y="-141.3" font-family="Times,serif" font-size="14.00">关闭worker/taskSender等goroutine</text>
<text text-anchor="start" x="413" y="-126.3" font-family="Times,serif" font-size="14.00"> cancel rpc请求</text>
</g>
<!-- selectResult_Close&#45;&gt;copIterator_Close -->
<g id="edge22" class="edge">
<title>selectResult_Close&#45;&gt;copIterator_Close</title>
<path fill="none" stroke="#666666" d="M289.09,-149C319.75,-149 358.37,-149 394.72,-149"/>
<polygon fill="#666666" stroke="#666666" points="394.9,-152.5 404.9,-149 394.9,-145.5 394.9,-152.5"/>
</g>
<!-- copClient_Send -->
<g id="node24" class="node">
<title>copClient_Send</title>
<polygon fill="none" stroke="black" points="1103,-211 1103,-287 1278,-287 1278,-211 1103,-211"/>
<text text-anchor="middle" x="1190.5" y="-271.8" font-family="Times,serif" font-size="14.00">copClient.Send</text>
<polyline fill="none" stroke="black" points="1103,-264 1278,-264 "/>
<text text-anchor="start" x="1111" y="-248.8" font-family="Times,serif" font-size="14.00">开启copIteratorWorker</text>
<text text-anchor="start" x="1111" y="-233.8" font-family="Times,serif" font-size="14.00"> goroutine开始执行copTask</text>
<text text-anchor="start" x="1111" y="-218.8" font-family="Times,serif" font-size="14.00"> 并将结果放到respCh中</text>
</g>
<!-- Select&#45;&gt;copClient_Send -->
<g id="edge21" class="edge">
<title>Select&#45;&gt;copClient_Send</title>
<path fill="none" stroke="#666666" d="M1067.27,-249C1075.73,-249 1084.22,-249 1092.57,-249"/>
<polygon fill="#666666" stroke="#666666" points="1092.67,-252.5 1102.67,-249 1092.67,-245.5 1092.67,-252.5"/>
</g>
<!-- kv_Response_Next -->
<g id="node21" class="node">
<title>kv_Response_Next</title>
<polygon fill="none" stroke="black" points="1014,-94 892,-94 892,-58 1014,-58 1014,-94"/>
<text text-anchor="middle" x="953" y="-72.3" font-family="Times,serif" font-size="14.00">kv_Response_Next</text>
</g>
<!-- fetchResp&#45;&gt;kv_Response_Next -->
<g id="edge17" class="edge">
<title>fetchResp&#45;&gt;kv_Response_Next</title>
<path fill="none" stroke="#666666" d="M763.84,-76C795.28,-76 842.48,-76 881.74,-76"/>
<polygon fill="#666666" stroke="#666666" points="881.8,-79.5 891.8,-76 881.8,-72.5 881.8,-79.5"/>
</g>
<!-- copIterator_Next -->
<g id="node22" class="node">
<title>copIterator_Next</title>
<polygon fill="none" stroke="black" points="1245,-91 1136,-91 1136,-55 1245,-55 1245,-91"/>
<text text-anchor="middle" x="1190.5" y="-69.3" font-family="Times,serif" font-size="14.00">copIterator_Next</text>
</g>
<!-- kv_Response_Next&#45;&gt;copIterator_Next -->
<g id="edge18" class="edge">
<title>kv_Response_Next&#45;&gt;copIterator_Next</title>
<path fill="none" stroke="#666666" d="M1014.04,-75.24C1048.14,-74.8 1090.84,-74.26 1125.57,-73.81"/>
<polygon fill="#666666" stroke="#666666" points="1125.65,-77.31 1135.61,-73.69 1125.56,-70.31 1125.65,-77.31"/>
</g>
<!-- batchCopIterator_Next -->
<g id="node23" class="node">
<title>batchCopIterator_Next</title>
<polygon fill="none" stroke="black" points="1261,-145 1120,-145 1120,-109 1261,-109 1261,-145"/>
<text text-anchor="middle" x="1190.5" y="-123.3" font-family="Times,serif" font-size="14.00">batchCopIterator_Next</text>
</g>
<!-- kv_Response_Next&#45;&gt;batchCopIterator_Next -->
<g id="edge19" class="edge">
<title>kv_Response_Next&#45;&gt;batchCopIterator_Next</title>
<path fill="none" stroke="#666666" d="M1014.04,-89C1043.18,-95.31 1078.59,-102.98 1109.95,-109.77"/>
<polygon fill="#666666" stroke="#666666" points="1109.46,-113.25 1119.97,-111.94 1110.94,-106.41 1109.46,-113.25"/>
</g>
</g>
</svg>
