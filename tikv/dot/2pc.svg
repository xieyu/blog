<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: sequence Pages: 1 -->
<svg width="961pt" height="611pt"
 viewBox="0.00 0.00 961.00 611.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 607)">
<title>sequence</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-607 957,-607 957,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_CoordinatorLog</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M304,-371C304,-371 487,-371 487,-371 493,-371 499,-377 499,-383 499,-383 499,-583 499,-583 499,-589 493,-595 487,-595 487,-595 304,-595 304,-595 298,-595 292,-589 292,-583 292,-583 292,-383 292,-383 292,-377 298,-371 304,-371"/>
<text text-anchor="middle" x="395.5" y="-575" font-family="Times,serif" font-size="20.00">CoordinatorLog</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Coordinator</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-49C20,-49 259,-49 259,-49 265,-49 271,-55 271,-61 271,-61 271,-381 271,-381 271,-387 265,-393 259,-393 259,-393 20,-393 20,-393 14,-393 8,-387 8,-381 8,-381 8,-61 8,-61 8,-55 14,-49 20,-49"/>
<text text-anchor="middle" x="139.5" y="-373" font-family="Times,serif" font-size="20.00">Coordinator</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Participant</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M574,-129C574,-129 933,-129 933,-129 939,-129 945,-135 945,-141 945,-141 945,-373 945,-373 945,-379 939,-385 933,-385 933,-385 574,-385 574,-385 568,-385 562,-379 562,-373 562,-373 562,-141 562,-141 562,-135 568,-129 574,-129"/>
<text text-anchor="middle" x="753.5" y="-365" font-family="Times,serif" font-size="20.00">Participant</text>
</g>
<!-- 1 -->
<g id="node1" class="node">
<title>1</title>
<ellipse fill="black" stroke="black" cx="139.5" cy="0" rx="0" ry="0"/>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<ellipse fill="black" stroke="black" cx="395.5" cy="0" rx="0" ry="0"/>
</g>
<!-- 1&#45;&gt;2 -->
<!-- 3 -->
<g id="node3" class="node">
<title>3</title>
<ellipse fill="black" stroke="black" cx="650" cy="0" rx="0" ry="0"/>
</g>
<!-- 2&#45;&gt;3 -->
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<ellipse fill="black" stroke="black" cx="852" cy="0" rx="0" ry="0"/>
</g>
<!-- 3&#45;&gt;4 -->
<!-- write_begin_commit -->
<g id="node5" class="node">
<title>write_begin_commit</title>
<path fill="none" stroke="#1c2123" d="M316.5,-510C316.5,-510 474.5,-510 474.5,-510 480.5,-510 486.5,-516 486.5,-522 486.5,-522 486.5,-544 486.5,-544 486.5,-550 480.5,-556 474.5,-556 474.5,-556 316.5,-556 316.5,-556 310.5,-556 304.5,-550 304.5,-544 304.5,-544 304.5,-522 304.5,-522 304.5,-516 310.5,-510 316.5,-510"/>
<text text-anchor="middle" x="395.5" y="-540.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">begin_commit</text>
<polyline fill="none" stroke="#1c2123" points="304.5,-533 486.5,-533 "/>
<text text-anchor="start" x="312.5" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向日志中写入begin_commit</text>
</g>
<!-- write_commit -->
<g id="node6" class="node">
<title>write_commit</title>
<path fill="none" stroke="#1c2123" d="M335,-445C335,-445 456,-445 456,-445 462,-445 468,-451 468,-457 468,-457 468,-479 468,-479 468,-485 462,-491 456,-491 456,-491 335,-491 335,-491 329,-491 323,-485 323,-479 323,-479 323,-457 323,-457 323,-451 329,-445 335,-445"/>
<text text-anchor="middle" x="395.5" y="-475.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_commit</text>
<polyline fill="none" stroke="#1c2123" points="323,-468 468,-468 "/>
<text text-anchor="start" x="331" y="-452.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向日志中写入commit</text>
</g>
<!-- write_end_of_transaction -->
<g id="node7" class="node">
<title>write_end_of_transaction</title>
<path fill="none" stroke="#1c2123" d="M312,-380C312,-380 479,-380 479,-380 485,-380 491,-386 491,-392 491,-392 491,-414 491,-414 491,-420 485,-426 479,-426 479,-426 312,-426 312,-426 306,-426 300,-420 300,-414 300,-414 300,-392 300,-392 300,-386 306,-380 312,-380"/>
<text text-anchor="middle" x="395.5" y="-410.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_end_of_transaction</text>
<polyline fill="none" stroke="#1c2123" points="300,-403 491,-403 "/>
<text text-anchor="start" x="308" y="-387.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向日志写入end_of_transaction</text>
</g>
<!-- prepare -->
<g id="node8" class="node">
<title>prepare</title>
<path fill="none" stroke="#1c2123" d="M28,-278C28,-278 251,-278 251,-278 257,-278 263,-284 263,-290 263,-290 263,-342 263,-342 263,-348 257,-354 251,-354 251,-354 28,-354 28,-354 22,-354 16,-348 16,-342 16,-342 16,-290 16,-290 16,-284 22,-278 28,-278"/>
<text text-anchor="middle" x="139.5" y="-338.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">prepare phase</text>
<polyline fill="none" stroke="#1c2123" points="16,-331 263,-331 "/>
<text text-anchor="start" x="24" y="-315.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">1.写入begin_commit日志</text>
<text text-anchor="start" x="24" y="-300.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.所有的参与者发送prepare</text>
<text text-anchor="start" x="24" y="-285.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3.进入Wait状态,等待participant的回复</text>
</g>
<!-- prepare&#45;&gt;write_begin_commit -->
<g id="edge4" class="edge">
<title>prepare&#45;&gt;write_begin_commit</title>
<path fill="none" stroke="#666666" d="M162.33,-354.23C188.13,-396.11 234.88,-462.45 292,-501 294.13,-502.44 296.33,-503.81 298.58,-505.13"/>
<polygon fill="#666666" stroke="#666666" points="297.04,-508.27 307.5,-509.91 300.34,-502.1 297.04,-508.27"/>
</g>
<!-- participant_01_prepare -->
<g id="node11" class="node">
<title>participant_01_prepare</title>
<path fill="none" stroke="#1c2123" d="M583,-217.5C583,-217.5 717,-217.5 717,-217.5 723,-217.5 729,-223.5 729,-229.5 729,-229.5 729,-334.5 729,-334.5 729,-340.5 723,-346.5 717,-346.5 717,-346.5 583,-346.5 583,-346.5 577,-346.5 571,-340.5 571,-334.5 571,-334.5 571,-229.5 571,-229.5 571,-223.5 577,-217.5 583,-217.5"/>
<text text-anchor="middle" x="650" y="-331.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">participant 1</text>
<polyline fill="none" stroke="#1c2123" points="571,-323.5 729,-323.5 "/>
<text text-anchor="start" x="579" y="-308.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">1. 写入ready record日志</text>
<text text-anchor="start" x="579" y="-293.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2. 向coordinator发送yes</text>
<text text-anchor="start" x="579" y="-278.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3. 进入ready状态</text>
<polyline fill="none" stroke="#1c2123" points="571,-270.5 729,-270.5 "/>
<text text-anchor="start" x="579" y="-255.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">会一直block直到收到</text>
<text text-anchor="start" x="579" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> coordinator的commit</text>
<text text-anchor="start" x="579" y="-225.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 或者rollback</text>
</g>
<!-- prepare&#45;&gt;participant_01_prepare -->
<g id="edge8" class="edge">
<title>prepare&#45;&gt;participant_01_prepare</title>
<path fill="none" stroke="green" d="M263.09,-324.44C345.47,-327.54 456.09,-326.73 552,-309 555,-308.45 558.04,-307.84 561.1,-307.2"/>
<polygon fill="green" stroke="green" points="561.92,-310.6 570.93,-305.01 560.4,-303.77 561.92,-310.6"/>
<text text-anchor="middle" x="395.5" y="-328.8" font-family="Times,serif" font-size="14.00">prepare</text>
</g>
<!-- participant_02_prepare -->
<g id="node14" class="node">
<title>participant_02_prepare</title>
<path fill="none" stroke="#1c2123" d="M582,-137.5C582,-137.5 718,-137.5 718,-137.5 724,-137.5 730,-143.5 730,-149.5 730,-149.5 730,-186.5 730,-186.5 730,-192.5 724,-198.5 718,-198.5 718,-198.5 582,-198.5 582,-198.5 576,-198.5 570,-192.5 570,-186.5 570,-186.5 570,-149.5 570,-149.5 570,-143.5 576,-137.5 582,-137.5"/>
<text text-anchor="middle" x="650" y="-183.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">participant 2</text>
<polyline fill="none" stroke="#1c2123" points="570,-175.5 730,-175.5 "/>
<text text-anchor="start" x="578" y="-160.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">prepare</text>
<text text-anchor="start" x="578" y="-145.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 行为和participant 1相同</text>
</g>
<!-- prepare&#45;&gt;participant_02_prepare -->
<g id="edge9" class="edge">
<title>prepare&#45;&gt;participant_02_prepare</title>
<path fill="none" stroke="green" d="M263.26,-297.34C333.46,-284.77 422.48,-265.59 499,-239 528.48,-228.76 533.82,-221.41 562,-208 565.53,-206.32 569.15,-204.61 572.8,-202.89"/>
<polygon fill="green" stroke="green" points="574.37,-206.02 581.94,-198.61 571.4,-199.68 574.37,-206.02"/>
<text text-anchor="middle" x="395.5" y="-294.8" font-family="Times,serif" font-size="14.00">prepare</text>
</g>
<!-- commit -->
<g id="node9" class="node">
<title>commit</title>
<path fill="none" stroke="#1c2123" d="M60.5,-153C60.5,-153 218.5,-153 218.5,-153 224.5,-153 230.5,-159 230.5,-165 230.5,-165 230.5,-247 230.5,-247 230.5,-253 224.5,-259 218.5,-259 218.5,-259 60.5,-259 60.5,-259 54.5,-259 48.5,-253 48.5,-247 48.5,-247 48.5,-165 48.5,-165 48.5,-159 54.5,-153 60.5,-153"/>
<text text-anchor="middle" x="139.5" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit phase</text>
<polyline fill="none" stroke="#1c2123" points="48.5,-236 230.5,-236 "/>
<text text-anchor="start" x="56.5" y="-220.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">收到所有的参与者reply yes</text>
<text text-anchor="start" x="56.5" y="-205.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 1.写入commit 日志</text>
<text text-anchor="start" x="56.5" y="-190.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2. coordinator向所有参与者</text>
<text text-anchor="start" x="56.5" y="-175.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送commit.</text>
<text text-anchor="start" x="56.5" y="-160.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3. 进入commit状态</text>
</g>
<!-- commit&#45;&gt;write_commit -->
<g id="edge5" class="edge">
<title>commit&#45;&gt;write_commit</title>
<path fill="none" stroke="#666666" d="M230.79,-234.8C246.31,-243.51 260.72,-254.7 271,-269 314.65,-329.75 244,-378.62 292,-436 297.93,-443.09 305.41,-448.63 313.61,-452.96"/>
<polygon fill="#666666" stroke="#666666" points="312.21,-456.17 322.75,-457.2 315.15,-449.82 312.21,-456.17"/>
</g>
<!-- participant_01_commit -->
<g id="node13" class="node">
<title>participant_01_commit</title>
<path fill="none" stroke="#1c2123" d="M806,-285.5C806,-285.5 898,-285.5 898,-285.5 904,-285.5 910,-291.5 910,-297.5 910,-297.5 910,-334.5 910,-334.5 910,-340.5 904,-346.5 898,-346.5 898,-346.5 806,-346.5 806,-346.5 800,-346.5 794,-340.5 794,-334.5 794,-334.5 794,-297.5 794,-297.5 794,-291.5 800,-285.5 806,-285.5"/>
<text text-anchor="middle" x="852" y="-331.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">participant 1</text>
<polyline fill="none" stroke="#1c2123" points="794,-323.5 910,-323.5 "/>
<text text-anchor="start" x="802" y="-308.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">收到commit消息</text>
<text text-anchor="start" x="802" y="-293.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 完成commit</text>
</g>
<!-- commit&#45;&gt;participant_01_commit -->
<g id="edge12" class="edge">
<title>commit&#45;&gt;participant_01_commit</title>
<path fill="none" stroke="red" d="M230.88,-224.14C250.97,-227.94 272.18,-231.76 292,-235 383.63,-249.95 420.09,-214.09 499,-263 541.43,-289.3 517.9,-332.61 562,-356 631.45,-392.84 722.91,-370.31 784.16,-346.86"/>
<polygon fill="red" stroke="red" points="785.7,-350.01 793.73,-343.09 783.14,-343.5 785.7,-350.01"/>
<text text-anchor="middle" x="530.5" y="-352.8" font-family="Times,serif" font-size="14.00">commit</text>
</g>
<!-- participant_02_commit -->
<g id="node15" class="node">
<title>participant_02_commit</title>
<path fill="none" stroke="#1c2123" d="M784,-137.5C784,-137.5 920,-137.5 920,-137.5 926,-137.5 932,-143.5 932,-149.5 932,-149.5 932,-186.5 932,-186.5 932,-192.5 926,-198.5 920,-198.5 920,-198.5 784,-198.5 784,-198.5 778,-198.5 772,-192.5 772,-186.5 772,-186.5 772,-149.5 772,-149.5 772,-143.5 778,-137.5 784,-137.5"/>
<text text-anchor="middle" x="852" y="-183.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">participant 2</text>
<polyline fill="none" stroke="#1c2123" points="772,-175.5 932,-175.5 "/>
<text text-anchor="start" x="780" y="-160.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit</text>
<text text-anchor="start" x="780" y="-145.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 行为和participant 1相同</text>
</g>
<!-- commit&#45;&gt;participant_02_commit -->
<g id="edge13" class="edge">
<title>commit&#45;&gt;participant_02_commit</title>
<path fill="none" stroke="red" d="M230.55,-172.76C250.56,-166.36 271.82,-160.32 292,-156 482.74,-115.14 537.42,-96.99 730,-128 740.54,-129.7 751.4,-132.17 762.09,-135.08"/>
<polygon fill="red" stroke="red" points="761.27,-138.48 771.84,-137.85 763.18,-131.75 761.27,-138.48"/>
<text text-anchor="middle" x="530.5" y="-118.8" font-family="Times,serif" font-size="14.00">commit</text>
</g>
<!-- commit_done -->
<g id="node10" class="node">
<title>commit_done</title>
<path fill="none" stroke="#1c2123" d="M48.5,-58C48.5,-58 230.5,-58 230.5,-58 236.5,-58 242.5,-64 242.5,-70 242.5,-70 242.5,-122 242.5,-122 242.5,-128 236.5,-134 230.5,-134 230.5,-134 48.5,-134 48.5,-134 42.5,-134 36.5,-128 36.5,-122 36.5,-122 36.5,-70 36.5,-70 36.5,-64 42.5,-58 48.5,-58"/>
<text text-anchor="middle" x="139.5" y="-118.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit phase</text>
<polyline fill="none" stroke="#1c2123" points="36.5,-111 242.5,-111 "/>
<text text-anchor="start" x="44.5" y="-95.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">1.收到所有参与者的commit ack</text>
<text text-anchor="start" x="44.5" y="-80.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.写入end_of_transaction日志</text>
<text text-anchor="start" x="44.5" y="-65.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3.事务提交完成</text>
</g>
<!-- commit_done&#45;&gt;write_end_of_transaction -->
<g id="edge6" class="edge">
<title>commit_done&#45;&gt;write_end_of_transaction</title>
<path fill="none" stroke="#666666" d="M242.75,-120.1C253.6,-126.32 263.41,-134.15 271,-144 301.11,-183.08 261.94,-325.88 292,-365 294.33,-368.04 296.94,-370.83 299.75,-373.4"/>
<polygon fill="#666666" stroke="#666666" points="297.66,-376.21 307.67,-379.7 302.02,-370.74 297.66,-376.21"/>
</g>
<!-- participant_01_prepare&#45;&gt;commit -->
<g id="edge10" class="edge">
<title>participant_01_prepare&#45;&gt;commit</title>
<path fill="none" stroke="blue" d="M570.9,-243.63C548.23,-234.18 523.09,-225.27 499,-220 413.28,-201.24 313.34,-198.89 240.79,-200.56"/>
<polygon fill="blue" stroke="blue" points="240.65,-197.07 230.74,-200.83 240.83,-204.06 240.65,-197.07"/>
<text text-anchor="middle" x="395.5" y="-223.8" font-family="Times,serif" font-size="14.00">yes</text>
</g>
<!-- write_ready_log -->
<g id="node12" class="node">
<title>write_ready_log</title>
<path fill="none" stroke="#1c2123" d="M779,-220C779,-220 925,-220 925,-220 931,-220 937,-226 937,-232 937,-232 937,-254 937,-254 937,-260 931,-266 925,-266 925,-266 779,-266 779,-266 773,-266 767,-260 767,-254 767,-254 767,-232 767,-232 767,-226 773,-220 779,-220"/>
<text text-anchor="middle" x="852" y="-250.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_ready_log</text>
<polyline fill="none" stroke="#1c2123" points="767,-243 937,-243 "/>
<text text-anchor="start" x="775" y="-227.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向日志中写入ready record</text>
</g>
<!-- participant_01_prepare&#45;&gt;write_ready_log -->
<g id="edge7" class="edge">
<title>participant_01_prepare&#45;&gt;write_ready_log</title>
<path fill="none" stroke="#666666" d="M729.18,-266.75C738.28,-264.98 747.62,-263.16 756.9,-261.35"/>
<polygon fill="#666666" stroke="#666666" points="757.78,-264.74 766.92,-259.4 756.44,-257.87 757.78,-264.74"/>
</g>
<!-- participant_01_commit&#45;&gt;commit_done -->
<g id="edge14" class="edge">
<title>participant_01_commit&#45;&gt;commit_done</title>
<path fill="none" stroke="green" d="M793.75,-297.2C783.68,-291.71 774.16,-284.75 767,-276 724.07,-223.52 779.15,-174.71 730,-128 663.87,-65.15 404.61,-74.24 252.83,-85.61"/>
<polygon fill="green" stroke="green" points="252.24,-82.14 242.54,-86.39 252.78,-89.12 252.24,-82.14"/>
<text text-anchor="middle" x="530.5" y="-83.8" font-family="Times,serif" font-size="14.00">done</text>
</g>
<!-- participant_02_prepare&#45;&gt;commit -->
<g id="edge11" class="edge">
<title>participant_02_prepare&#45;&gt;commit</title>
<path fill="none" stroke="blue" d="M569.97,-162.89C497.41,-159.46 387.06,-157.43 292,-169 275.26,-171.04 257.7,-174.27 240.71,-178"/>
<polygon fill="blue" stroke="blue" points="239.76,-174.63 230.78,-180.25 241.31,-181.46 239.76,-174.63"/>
<text text-anchor="middle" x="395.5" y="-172.8" font-family="Times,serif" font-size="14.00">yes</text>
</g>
<!-- participant_02_commit&#45;&gt;commit_done -->
<g id="edge15" class="edge">
<title>participant_02_commit&#45;&gt;commit_done</title>
<path fill="none" stroke="green" d="M827.2,-137.49C805.04,-111.45 769.55,-75.4 730,-57 576.41,14.45 375.65,-22.52 252.5,-57.76"/>
<polygon fill="green" stroke="green" points="251.29,-54.46 242.67,-60.62 253.25,-61.19 251.29,-54.46"/>
<text text-anchor="middle" x="530.5" y="-19.8" font-family="Times,serif" font-size="14.00">done</text>
</g>
</g>
</svg>
