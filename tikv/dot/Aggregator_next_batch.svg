<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: AggregationExecutor_next_batch Pages: 1 -->
<svg width="1452pt" height="225pt"
 viewBox="0.00 0.00 1452.00 225.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 221)">
<title>AggregationExecutor_next_batch</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-221 1448,-221 1448,4 -4,4"/>
<!-- AggregationExecutor_next_batch -->
<g id="node1" class="node">
<title>AggregationExecutor_next_batch</title>
<path fill="none" stroke="#1c2123" d="M12,-89C12,-89 128,-89 128,-89 134,-89 140,-95 140,-101 140,-101 140,-115 140,-115 140,-121 134,-127 128,-127 128,-127 12,-127 12,-127 6,-127 0,-121 0,-115 0,-115 0,-101 0,-101 0,-95 6,-89 12,-89"/>
<text text-anchor="start" x="8" y="-111.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AggregationExecutor::</text>
<text text-anchor="start" x="8" y="-96.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">next_batch</text>
</g>
<!-- AggregationExecutor_handle_next_batch -->
<g id="node2" class="node">
<title>AggregationExecutor_handle_next_batch</title>
<path fill="none" stroke="#1c2123" d="M188,-89C188,-89 304,-89 304,-89 310,-89 316,-95 316,-101 316,-101 316,-115 316,-115 316,-121 310,-127 304,-127 304,-127 188,-127 188,-127 182,-127 176,-121 176,-115 176,-115 176,-101 176,-101 176,-95 182,-89 188,-89"/>
<text text-anchor="start" x="184" y="-111.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AggregationExecutor::</text>
<text text-anchor="start" x="184" y="-96.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_next_batch</text>
</g>
<!-- AggregationExecutor_next_batch&#45;&gt;AggregationExecutor_handle_next_batch -->
<g id="edge1" class="edge">
<title>AggregationExecutor_next_batch&#45;&gt;AggregationExecutor_handle_next_batch</title>
<path fill="none" stroke="#666666" d="M140.02,-108C148.48,-108 157.17,-108 165.76,-108"/>
<polygon fill="#666666" stroke="#666666" points="165.78,-111.5 175.78,-108 165.78,-104.5 165.78,-111.5"/>
</g>
<!-- entities_src_next_batch -->
<g id="node3" class="node">
<title>entities_src_next_batch</title>
<path fill="#feed9b" stroke="#f7e495" d="M364,-155.5C364,-155.5 527,-155.5 527,-155.5 533,-155.5 539,-161.5 539,-167.5 539,-167.5 539,-204.5 539,-204.5 539,-210.5 533,-216.5 527,-216.5 527,-216.5 364,-216.5 364,-216.5 358,-216.5 352,-210.5 352,-204.5 352,-204.5 352,-167.5 352,-167.5 352,-161.5 358,-155.5 364,-155.5"/>
<text text-anchor="middle" x="445.5" y="-201.3" font-family="Times,serif" font-size="14.00" fill="#40575d">entities.src.next_batch</text>
<polyline fill="none" stroke="#f7e495" points="352,-193.5 539,-193.5 "/>
<text text-anchor="start" x="360" y="-178.3" font-family="Times,serif" font-size="14.00" fill="#40575d">从src BatchExecutor</text>
<text text-anchor="start" x="360" y="-163.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 获取一个BatchExecuteResult</text>
</g>
<!-- AggregationExecutor_handle_next_batch&#45;&gt;entities_src_next_batch -->
<g id="edge2" class="edge">
<title>AggregationExecutor_handle_next_batch&#45;&gt;entities_src_next_batch</title>
<path fill="none" stroke="#666666" d="M295.31,-127.08C314.12,-134.51 336.25,-143.25 357.63,-151.69"/>
<polygon fill="#666666" stroke="#666666" points="356.48,-155 367.06,-155.42 359.05,-148.49 356.48,-155"/>
</g>
<!-- imp_process_batch_input -->
<g id="node4" class="node">
<title>imp_process_batch_input</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M587,-123.5C587,-123.5 740,-123.5 740,-123.5 746,-123.5 752,-129.5 752,-135.5 752,-135.5 752,-164.5 752,-164.5 752,-170.5 746,-176.5 740,-176.5 740,-176.5 587,-176.5 587,-176.5 581,-176.5 575,-170.5 575,-164.5 575,-164.5 575,-135.5 575,-135.5 575,-129.5 581,-123.5 587,-123.5"/>
<text text-anchor="start" x="583" y="-161.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">AggregationExecutorImpl::</text>
<text text-anchor="start" x="583" y="-146.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">process_batch_input</text>
<text text-anchor="start" x="583" y="-131.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 对这一批数据做聚合处理</text>
</g>
<!-- AggregationExecutor_handle_next_batch&#45;&gt;imp_process_batch_input -->
<g id="edge3" class="edge">
<title>AggregationExecutor_handle_next_batch&#45;&gt;imp_process_batch_input</title>
<path fill="none" stroke="#666666" d="M316.08,-114.98C383.99,-121.85 488.28,-132.39 564.69,-140.11"/>
<polygon fill="#666666" stroke="#666666" points="564.51,-143.61 574.81,-141.14 565.21,-136.65 564.51,-143.61"/>
</g>
<!-- AggregationExecutor_aggregate_partial_results -->
<g id="node5" class="node">
<title>AggregationExecutor_aggregate_partial_results</title>
<path fill="none" stroke="#1c2123" d="M593.5,-27C593.5,-27 733.5,-27 733.5,-27 739.5,-27 745.5,-33 745.5,-39 745.5,-39 745.5,-91 745.5,-91 745.5,-97 739.5,-103 733.5,-103 733.5,-103 593.5,-103 593.5,-103 587.5,-103 581.5,-97 581.5,-91 581.5,-91 581.5,-39 581.5,-39 581.5,-33 587.5,-27 593.5,-27"/>
<text text-anchor="start" x="589.5" y="-87.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AggregationExecutor::</text>
<text text-anchor="start" x="589.5" y="-72.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> aggregate_partial_results</text>
<polyline fill="none" stroke="#1c2123" points="581.5,-65 745.5,-65 "/>
<text text-anchor="start" x="589.5" y="-49.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Generates aggregation </text>
<text text-anchor="start" x="589.5" y="-34.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> results of available groups</text>
</g>
<!-- AggregationExecutor_handle_next_batch&#45;&gt;AggregationExecutor_aggregate_partial_results -->
<g id="edge4" class="edge">
<title>AggregationExecutor_handle_next_batch&#45;&gt;AggregationExecutor_aggregate_partial_results</title>
<path fill="none" stroke="#666666" d="M316.08,-100.85C385.98,-93.62 494.42,-82.4 571.33,-74.44"/>
<polygon fill="#666666" stroke="#666666" points="571.91,-77.89 581.49,-73.38 571.19,-70.93 571.91,-77.89"/>
</g>
<!-- imp_is_partial_results_ready -->
<g id="node6" class="node">
<title>imp_is_partial_results_ready</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M374,-22C374,-22 517,-22 517,-22 523,-22 529,-28 529,-34 529,-34 529,-48 529,-48 529,-54 523,-60 517,-60 517,-60 374,-60 374,-60 368,-60 362,-54 362,-48 362,-48 362,-34 362,-34 362,-28 368,-22 374,-22"/>
<text text-anchor="start" x="370" y="-44.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">AggregationExecutorImpl::</text>
<text text-anchor="middle" x="445.5" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">is_partial_results_ready</text>
</g>
<!-- AggregationExecutor_handle_next_batch&#45;&gt;imp_is_partial_results_ready -->
<g id="edge5" class="edge">
<title>AggregationExecutor_handle_next_batch&#45;&gt;imp_is_partial_results_ready</title>
<path fill="none" stroke="#666666" d="M303.07,-88.98C326.63,-80.99 354.2,-71.63 378.71,-63.32"/>
<polygon fill="#666666" stroke="#666666" points="379.95,-66.59 388.29,-60.07 377.7,-59.97 379.95,-66.59"/>
</g>
<!-- entities_src_next_batch&#45;&gt;imp_process_batch_input -->
<g id="edge12" class="edge">
<title>entities_src_next_batch&#45;&gt;imp_process_batch_input</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M539.04,-170.58C547.6,-169.15 556.29,-167.7 564.9,-166.27"/>
<polygon fill="green" stroke="green" points="565.65,-169.69 574.94,-164.59 564.5,-162.78 565.65,-169.69"/>
</g>
<!-- imp_iterate_available_groups -->
<g id="node7" class="node">
<title>imp_iterate_available_groups</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M800,-0.5C800,-0.5 953,-0.5 953,-0.5 959,-0.5 965,-6.5 965,-12.5 965,-12.5 965,-117.5 965,-117.5 965,-123.5 959,-129.5 953,-129.5 953,-129.5 800,-129.5 800,-129.5 794,-129.5 788,-123.5 788,-117.5 788,-117.5 788,-12.5 788,-12.5 788,-6.5 794,-0.5 800,-0.5"/>
<text text-anchor="start" x="796" y="-114.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">AggregationExecutorImpl::</text>
<text text-anchor="start" x="796" y="-99.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">iterate_available_groups</text>
<polyline fill="none" stroke="#60b5ac" points="788,-91.5 965,-91.5 "/>
<text text-anchor="start" x="796" y="-76.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Pull aggregate results of each</text>
<text text-anchor="start" x="796" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> available group</text>
<polyline fill="none" stroke="#60b5ac" points="788,-53.5 965,-53.5 "/>
<text text-anchor="start" x="796" y="-38.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">遍历所有的group</text>
<text text-anchor="start" x="796" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 调用传进来的闭包函数</text>
<text text-anchor="start" x="796" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 对entities和states做处理</text>
</g>
<!-- AggregationExecutor_aggregate_partial_results&#45;&gt;imp_iterate_available_groups -->
<g id="edge6" class="edge">
<title>AggregationExecutor_aggregate_partial_results&#45;&gt;imp_iterate_available_groups</title>
<path fill="none" stroke="#666666" d="M745.78,-65C756.25,-65 767.05,-65 777.75,-65"/>
<polygon fill="#666666" stroke="#666666" points="777.96,-68.5 787.96,-65 777.96,-61.5 777.96,-68.5"/>
</g>
<!-- imp_is_partial_results_ready&#45;&gt;AggregationExecutor_aggregate_partial_results -->
<g id="edge8" class="edge">
<title>imp_is_partial_results_ready&#45;&gt;AggregationExecutor_aggregate_partial_results</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M529.08,-50.18C542.89,-51.71 557.27,-53.31 571.27,-54.86"/>
<polygon fill="green" stroke="green" points="571.06,-58.36 581.39,-55.99 571.84,-51.4 571.06,-58.36"/>
</g>
<!-- state_push_result -->
<g id="node8" class="node">
<title>state_push_result</title>
<path fill="none" stroke="#1c2123" d="M1173,-46C1173,-46 1276,-46 1276,-46 1282,-46 1288,-52 1288,-58 1288,-58 1288,-72 1288,-72 1288,-78 1282,-84 1276,-84 1276,-84 1173,-84 1173,-84 1167,-84 1161,-78 1161,-72 1161,-72 1161,-58 1161,-58 1161,-52 1167,-46 1173,-46"/>
<text text-anchor="start" x="1169" y="-68.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AggrFunctionState::</text>
<text text-anchor="middle" x="1224.5" y="-53.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">push_result</text>
</g>
<!-- imp_iterate_available_groups&#45;&gt;state_push_result -->
<g id="edge7" class="edge">
<title>imp_iterate_available_groups&#45;&gt;state_push_result</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M965.16,-72.18C977.2,-72.93 989.4,-73.58 1001,-74 1056.07,-76 1069.95,-76.51 1125,-74 1133.32,-73.62 1142.03,-73.06 1150.67,-72.41"/>
<polygon fill="green" stroke="green" points="1151.08,-75.88 1160.77,-71.59 1150.52,-68.91 1151.08,-75.88"/>
</g>
<!-- group_closure -->
<g id="node9" class="node">
<title>group_closure</title>
<path fill="none" stroke="#1c2123" d="M1013,-11.5C1013,-11.5 1113,-11.5 1113,-11.5 1119,-11.5 1125,-17.5 1125,-23.5 1125,-23.5 1125,-52.5 1125,-52.5 1125,-58.5 1119,-64.5 1113,-64.5 1113,-64.5 1013,-64.5 1013,-64.5 1007,-64.5 1001,-58.5 1001,-52.5 1001,-52.5 1001,-23.5 1001,-23.5 1001,-17.5 1007,-11.5 1013,-11.5"/>
<text text-anchor="start" x="1009" y="-49.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">闭包函数</text>
<text text-anchor="start" x="1009" y="-34.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 迭代处理states</text>
<text text-anchor="middle" x="1063" y="-19.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> |entities,states|{...}</text>
</g>
<!-- imp_iterate_available_groups&#45;&gt;group_closure -->
<g id="edge9" class="edge">
<title>imp_iterate_available_groups&#45;&gt;group_closure</title>
<path fill="none" stroke="#666666" d="M965.16,-52.17C973.75,-50.91 982.4,-49.65 990.8,-48.42"/>
<polygon fill="#666666" stroke="#666666" points="991.51,-51.85 1000.9,-46.94 990.5,-44.93 991.51,-51.85"/>
</g>
<!-- all_result_columns -->
<g id="node10" class="node">
<title>all_result_columns</title>
<path fill="none" stroke="#1c2123" d="M1432,-83C1432,-83 1336,-83 1336,-83 1330,-83 1324,-77 1324,-71 1324,-71 1324,-59 1324,-59 1324,-53 1330,-47 1336,-47 1336,-47 1432,-47 1432,-47 1438,-47 1444,-53 1444,-59 1444,-59 1444,-71 1444,-71 1444,-77 1438,-83 1432,-83"/>
<text text-anchor="middle" x="1384" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">all_result_columns</text>
</g>
<!-- state_push_result&#45;&gt;all_result_columns -->
<g id="edge10" class="edge">
<title>state_push_result&#45;&gt;all_result_columns</title>
<path fill="none" stroke="#666666" d="M1288.2,-65C1296.56,-65 1305.16,-65 1313.62,-65"/>
<polygon fill="#666666" stroke="#666666" points="1313.84,-68.5 1323.84,-65 1313.84,-61.5 1313.84,-68.5"/>
</g>
<!-- group_closure&#45;&gt;state_push_result -->
<g id="edge11" class="edge">
<title>group_closure&#45;&gt;state_push_result</title>
<path fill="none" stroke="#666666" d="M1125.21,-48.36C1133.61,-49.78 1142.3,-51.25 1150.87,-52.71"/>
<polygon fill="#666666" stroke="#666666" points="1150.43,-56.18 1160.87,-54.4 1151.59,-49.28 1150.43,-56.18"/>
</g>
</g>
</svg>
