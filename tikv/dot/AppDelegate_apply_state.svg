<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: AppDelegate_apply_state Pages: 1 -->
<svg width="2350pt" height="624pt"
 viewBox="0.00 0.00 2350.00 624.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 620)">
<title>AppDelegate_apply_state</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-620 2346,-620 2346,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ApplyDelegate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M276,-8C276,-8 1774.5,-8 1774.5,-8 1780.5,-8 1786.5,-14 1786.5,-20 1786.5,-20 1786.5,-210 1786.5,-210 1786.5,-216 1780.5,-222 1774.5,-222 1774.5,-222 276,-222 276,-222 270,-222 264,-216 264,-210 264,-210 264,-20 264,-20 264,-14 270,-8 276,-8"/>
<text text-anchor="middle" x="1025.25" y="-202" font-family="Times,serif" font-size="20.00">ApplyDelegate</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_ApplyContext</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M723,-230C723,-230 2322,-230 2322,-230 2328,-230 2334,-236 2334,-242 2334,-242 2334,-480 2334,-480 2334,-486 2328,-492 2322,-492 2322,-492 723,-492 723,-492 717,-492 711,-486 711,-480 711,-480 711,-242 711,-242 711,-236 717,-230 723,-230"/>
<text text-anchor="middle" x="1522.5" y="-472" font-family="Times,serif" font-size="20.00">ApplyContext</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_ApplyFsm</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M154,-268C154,-268 232,-268 232,-268 238,-268 244,-274 244,-280 244,-280 244,-338 244,-338 244,-344 238,-350 232,-350 232,-350 154,-350 154,-350 148,-350 142,-344 142,-338 142,-338 142,-280 142,-280 142,-274 148,-268 154,-268"/>
<text text-anchor="middle" x="193" y="-330" font-family="Times,serif" font-size="20.00">ApplyFsm</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_ApplyPollder</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-500C20,-500 1593,-500 1593,-500 1599,-500 1605,-506 1605,-512 1605,-512 1605,-596 1605,-596 1605,-602 1599,-608 1593,-608 1593,-608 20,-608 20,-608 14,-608 8,-602 8,-596 8,-596 8,-512 8,-512 8,-506 14,-500 20,-500"/>
<text text-anchor="middle" x="806.5" y="-588" font-family="Times,serif" font-size="20.00">ApplyPollder</text>
</g>
<!-- write_apply_state -->
<g id="node1" class="node">
<title>write_apply_state</title>
<path fill="none" stroke="#1c2123" d="M1669.5,-107C1669.5,-107 1766.5,-107 1766.5,-107 1772.5,-107 1778.5,-113 1778.5,-119 1778.5,-119 1778.5,-171 1778.5,-171 1778.5,-177 1772.5,-183 1766.5,-183 1766.5,-183 1669.5,-183 1669.5,-183 1663.5,-183 1657.5,-177 1657.5,-171 1657.5,-171 1657.5,-119 1657.5,-119 1657.5,-113 1663.5,-107 1669.5,-107"/>
<text text-anchor="middle" x="1718" y="-167.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_apply_state</text>
<polyline fill="none" stroke="#1c2123" points="1657.5,-160 1778.5,-160 "/>
<text text-anchor="start" x="1665.5" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将apply_state写入</text>
<text text-anchor="start" x="1665.5" y="-129.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> apply context的</text>
<text text-anchor="start" x="1665.5" y="-114.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> kv_wb中</text>
</g>
<!-- kv_wb -->
<g id="node18" class="node">
<title>kv_wb</title>
<path fill="none" stroke="#1c2123" d="M1985.5,-274C1985.5,-274 1955.5,-274 1955.5,-274 1949.5,-274 1943.5,-268 1943.5,-262 1943.5,-262 1943.5,-250 1943.5,-250 1943.5,-244 1949.5,-238 1955.5,-238 1955.5,-238 1985.5,-238 1985.5,-238 1991.5,-238 1997.5,-244 1997.5,-250 1997.5,-250 1997.5,-262 1997.5,-262 1997.5,-268 1991.5,-274 1985.5,-274"/>
<text text-anchor="middle" x="1970.5" y="-252.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">kv_wb</text>
</g>
<!-- write_apply_state&#45;&gt;kv_wb -->
<g id="edge24" class="edge">
<title>write_apply_state&#45;&gt;kv_wb</title>
<path fill="none" stroke="#666666" d="M1778.68,-171.45C1827.18,-192.94 1893.94,-222.52 1934.28,-240.39"/>
<polygon fill="#666666" stroke="#666666" points="1932.89,-243.61 1943.45,-244.46 1935.73,-237.21 1932.89,-243.61"/>
</g>
<!-- apply_raft_cmd -->
<g id="node2" class="node">
<title>apply_raft_cmd</title>
<path fill="none" stroke="#1c2123" d="M914,-102.5C914,-102.5 1015,-102.5 1015,-102.5 1021,-102.5 1027,-108.5 1027,-114.5 1027,-114.5 1027,-151.5 1027,-151.5 1027,-157.5 1021,-163.5 1015,-163.5 1015,-163.5 914,-163.5 914,-163.5 908,-163.5 902,-157.5 902,-151.5 902,-151.5 902,-114.5 902,-114.5 902,-108.5 908,-102.5 914,-102.5"/>
<text text-anchor="middle" x="964.5" y="-148.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_raft_cmd</text>
<polyline fill="none" stroke="#1c2123" points="902,-140.5 1027,-140.5 "/>
<text text-anchor="start" x="910" y="-125.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">执行完req后，</text>
<text text-anchor="start" x="910" y="-110.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 更新applied_index</text>
</g>
<!-- exec_raft_cmd -->
<g id="node3" class="node">
<title>exec_raft_cmd</title>
<path fill="none" stroke="#1c2123" d="M1089.5,-82.5C1089.5,-82.5 1193.5,-82.5 1193.5,-82.5 1199.5,-82.5 1205.5,-88.5 1205.5,-94.5 1205.5,-94.5 1205.5,-131.5 1205.5,-131.5 1205.5,-137.5 1199.5,-143.5 1193.5,-143.5 1193.5,-143.5 1089.5,-143.5 1089.5,-143.5 1083.5,-143.5 1077.5,-137.5 1077.5,-131.5 1077.5,-131.5 1077.5,-94.5 1077.5,-94.5 1077.5,-88.5 1083.5,-82.5 1089.5,-82.5"/>
<text text-anchor="middle" x="1141.5" y="-128.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_raft_cmd</text>
<polyline fill="none" stroke="#1c2123" points="1077.5,-120.5 1205.5,-120.5 "/>
<text text-anchor="start" x="1085.5" y="-105.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">执行raft cmd</text>
<text text-anchor="start" x="1085.5" y="-90.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将结果写入kv_wb</text>
</g>
<!-- apply_raft_cmd&#45;&gt;exec_raft_cmd -->
<g id="edge1" class="edge">
<title>apply_raft_cmd&#45;&gt;exec_raft_cmd</title>
<path fill="none" stroke="#666666" d="M1027.2,-125.95C1040.14,-124.47 1053.9,-122.9 1067.22,-121.38"/>
<polygon fill="#666666" stroke="#666666" points="1067.75,-124.84 1077.29,-120.22 1066.96,-117.88 1067.75,-124.84"/>
</g>
<!-- apply_state -->
<g id="node4" class="node">
<title>apply_state</title>
<path fill="#feed9b" stroke="#f7e495" d="M1463.5,-130C1463.5,-130 1540.5,-130 1540.5,-130 1546.5,-130 1552.5,-136 1552.5,-142 1552.5,-142 1552.5,-164 1552.5,-164 1552.5,-170 1546.5,-176 1540.5,-176 1540.5,-176 1463.5,-176 1463.5,-176 1457.5,-176 1451.5,-170 1451.5,-164 1451.5,-164 1451.5,-142 1451.5,-142 1451.5,-136 1457.5,-130 1463.5,-130"/>
<text text-anchor="middle" x="1502" y="-160.8" font-family="Times,serif" font-size="14.00" fill="#40575d">apply_state</text>
<polyline fill="none" stroke="#f7e495" points="1451.5,-153 1552.5,-153 "/>
<text text-anchor="middle" x="1502" y="-137.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftApplyState</text>
</g>
<!-- apply_raft_cmd&#45;&gt;apply_state -->
<g id="edge2" class="edge">
<title>apply_raft_cmd&#45;&gt;apply_state</title>
<path fill="none" stroke="#666666" d="M1027.23,-152.12C1039.01,-155.19 1051.31,-158.01 1063,-160 1198.07,-183 1234.39,-183.45 1371,-173 1394.1,-171.23 1419.31,-167.73 1441.33,-164.13"/>
<polygon fill="#666666" stroke="#666666" points="1441.92,-167.58 1451.2,-162.48 1440.76,-160.68 1441.92,-167.58"/>
</g>
<!-- set_applied_index -->
<g id="node5" class="node">
<title>set_applied_index</title>
<path fill="none" stroke="#1c2123" d="M1359,-164C1359,-164 1268,-164 1268,-164 1262,-164 1256,-158 1256,-152 1256,-152 1256,-140 1256,-140 1256,-134 1262,-128 1268,-128 1268,-128 1359,-128 1359,-128 1365,-128 1371,-134 1371,-140 1371,-140 1371,-152 1371,-152 1371,-158 1365,-164 1359,-164"/>
<text text-anchor="middle" x="1313.5" y="-142.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_applied_index</text>
</g>
<!-- apply_raft_cmd&#45;&gt;set_applied_index -->
<g id="edge3" class="edge">
<title>apply_raft_cmd&#45;&gt;set_applied_index</title>
<path fill="none" stroke="#666666" d="M1027.1,-147.6C1038.95,-149.85 1051.31,-151.81 1063,-153 1124.71,-159.26 1195.41,-156.33 1245.76,-152.53"/>
<polygon fill="#666666" stroke="#666666" points="1246.17,-156.01 1255.87,-151.74 1245.62,-149.03 1246.17,-156.01"/>
</g>
<!-- applied_index_term -->
<g id="node6" class="node">
<title>applied_index_term</title>
<path fill="#feed9b" stroke="#f7e495" d="M1075,-17C1075,-17 1208,-17 1208,-17 1214,-17 1220,-23 1220,-29 1220,-29 1220,-51 1220,-51 1220,-57 1214,-63 1208,-63 1208,-63 1075,-63 1075,-63 1069,-63 1063,-57 1063,-51 1063,-51 1063,-29 1063,-29 1063,-23 1069,-17 1075,-17"/>
<text text-anchor="middle" x="1141.5" y="-47.8" font-family="Times,serif" font-size="14.00" fill="#40575d">applied_index_term</text>
<polyline fill="none" stroke="#f7e495" points="1063,-40 1220,-40 "/>
<text text-anchor="start" x="1071" y="-24.8" font-family="Times,serif" font-size="14.00" fill="#40575d">applied_index_term: u64,</text>
</g>
<!-- apply_raft_cmd&#45;&gt;applied_index_term -->
<g id="edge4" class="edge">
<title>apply_raft_cmd&#45;&gt;applied_index_term</title>
<path fill="none" stroke="#666666" d="M1012.29,-102.25C1028.1,-92.39 1046.05,-81.76 1063,-73 1066.73,-71.07 1070.59,-69.16 1074.52,-67.29"/>
<polygon fill="#666666" stroke="#666666" points="1076.15,-70.39 1083.75,-63 1073.2,-64.04 1076.15,-70.39"/>
</g>
<!-- exec_raft_cmd&#45;&gt;set_applied_index -->
<g id="edge11" class="edge">
<title>exec_raft_cmd&#45;&gt;set_applied_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1205.8,-125.29C1218.89,-127.83 1232.72,-130.51 1245.92,-133.08"/>
<polygon fill="green" stroke="green" points="1245.39,-136.54 1255.87,-135.01 1246.72,-129.67 1245.39,-136.54"/>
</g>
<!-- exec_raft_cmd&#45;&gt;kv_wb -->
<g id="edge25" class="edge">
<title>exec_raft_cmd&#45;&gt;kv_wb</title>
<path fill="none" stroke="#666666" d="M1205.95,-95.49C1327.15,-65.43 1597.78,-14.75 1803,-97 1869.81,-123.77 1925.01,-191.55 1951.88,-229.4"/>
<polygon fill="#666666" stroke="#666666" points="1949.2,-231.68 1957.78,-237.89 1954.94,-227.68 1949.2,-231.68"/>
</g>
<!-- apply_state&#45;&gt;write_apply_state -->
<g id="edge5" class="edge">
<title>apply_state&#45;&gt;write_apply_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1552.63,-151.14C1580.7,-150.1 1616.24,-148.77 1647.09,-147.61"/>
<polygon fill="green" stroke="green" points="1647.49,-151.1 1657.35,-147.23 1647.23,-144.11 1647.49,-151.1"/>
</g>
<!-- ApplyRes -->
<g id="node13" class="node">
<title>ApplyRes</title>
<path fill="none" stroke="#1c2123" d="M1645,-313.5C1645,-313.5 1791,-313.5 1791,-313.5 1797,-313.5 1803,-319.5 1803,-325.5 1803,-325.5 1803,-362.5 1803,-362.5 1803,-368.5 1797,-374.5 1791,-374.5 1791,-374.5 1645,-374.5 1645,-374.5 1639,-374.5 1633,-368.5 1633,-362.5 1633,-362.5 1633,-325.5 1633,-325.5 1633,-319.5 1639,-313.5 1645,-313.5"/>
<text text-anchor="middle" x="1718" y="-359.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ApplyRes</text>
<polyline fill="none" stroke="#1c2123" points="1633,-351.5 1803,-351.5 "/>
<text text-anchor="start" x="1641" y="-336.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">新建一个ApplyRes并加到</text>
<text text-anchor="start" x="1641" y="-321.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> apply_res数组中</text>
</g>
<!-- apply_state&#45;&gt;ApplyRes -->
<g id="edge14" class="edge">
<title>apply_state&#45;&gt;ApplyRes</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1546.72,-176.06C1566.82,-188.53 1589.57,-205.59 1605,-226 1627.21,-255.39 1608.29,-276.69 1633,-304 1633.76,-304.84 1634.54,-305.66 1635.34,-306.47"/>
<polygon fill="green" stroke="green" points="1633.22,-309.27 1643.02,-313.31 1637.88,-304.04 1633.22,-309.27"/>
</g>
<!-- set_applied_index&#45;&gt;apply_state -->
<g id="edge12" class="edge">
<title>set_applied_index&#45;&gt;apply_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1371.22,-148.13C1393.43,-148.96 1418.92,-149.92 1441.4,-150.76"/>
<polygon fill="green" stroke="green" points="1441.37,-154.26 1451.5,-151.14 1441.64,-147.27 1441.37,-154.26"/>
</g>
<!-- process_raft_cmd -->
<g id="node7" class="node">
<title>process_raft_cmd</title>
<path fill="none" stroke="#1c2123" d="M837,-151C837,-151 748,-151 748,-151 742,-151 736,-145 736,-139 736,-139 736,-127 736,-127 736,-121 742,-115 748,-115 748,-115 837,-115 837,-115 843,-115 849,-121 849,-127 849,-127 849,-139 849,-139 849,-145 843,-151 837,-151"/>
<text text-anchor="middle" x="792.5" y="-129.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">process_raft_cmd</text>
</g>
<!-- process_raft_cmd&#45;&gt;apply_raft_cmd -->
<g id="edge6" class="edge">
<title>process_raft_cmd&#45;&gt;apply_raft_cmd</title>
<path fill="none" stroke="#666666" d="M849.16,-133C862.72,-133 877.42,-133 891.61,-133"/>
<polygon fill="#666666" stroke="#666666" points="891.83,-136.5 901.83,-133 891.83,-129.5 891.83,-136.5"/>
</g>
<!-- handle_raft_committed_entries -->
<g id="node8" class="node">
<title>handle_raft_committed_entries</title>
<path fill="none" stroke="#1c2123" d="M284,-122.5C284,-122.5 447,-122.5 447,-122.5 453,-122.5 459,-128.5 459,-134.5 459,-134.5 459,-171.5 459,-171.5 459,-177.5 453,-183.5 447,-183.5 447,-183.5 284,-183.5 284,-183.5 278,-183.5 272,-177.5 272,-171.5 272,-171.5 272,-134.5 272,-134.5 272,-128.5 278,-122.5 284,-122.5"/>
<text text-anchor="middle" x="365.5" y="-168.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_committed_entries</text>
<polyline fill="none" stroke="#1c2123" points="272,-160.5 459,-160.5 "/>
<text text-anchor="start" x="280" y="-145.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历执行所有的</text>
<text text-anchor="start" x="280" y="-130.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> committed entries</text>
</g>
<!-- handle_raft_entry_normal -->
<g id="node9" class="node">
<title>handle_raft_entry_normal</title>
<path fill="none" stroke="#1c2123" d="M656,-184C656,-184 522,-184 522,-184 516,-184 510,-178 510,-172 510,-172 510,-160 510,-160 510,-154 516,-148 522,-148 522,-148 656,-148 656,-148 662,-148 668,-154 668,-160 668,-160 668,-172 668,-172 668,-178 662,-184 656,-184"/>
<text text-anchor="middle" x="589" y="-162.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_entry_normal</text>
</g>
<!-- handle_raft_committed_entries&#45;&gt;handle_raft_entry_normal -->
<g id="edge7" class="edge">
<title>handle_raft_committed_entries&#45;&gt;handle_raft_entry_normal</title>
<path fill="none" stroke="#666666" d="M459.15,-158.44C472.57,-159.23 486.35,-160.03 499.67,-160.82"/>
<polygon fill="#666666" stroke="#666666" points="499.57,-164.32 509.76,-161.41 499.98,-157.33 499.57,-164.32"/>
</g>
<!-- handle_raft_entry_conf_change -->
<g id="node10" class="node">
<title>handle_raft_entry_conf_change</title>
<path fill="none" stroke="#1c2123" d="M671,-130C671,-130 507,-130 507,-130 501,-130 495,-124 495,-118 495,-118 495,-106 495,-106 495,-100 501,-94 507,-94 507,-94 671,-94 671,-94 677,-94 683,-100 683,-106 683,-106 683,-118 683,-118 683,-124 677,-130 671,-130"/>
<text text-anchor="middle" x="589" y="-108.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_entry_conf_change</text>
</g>
<!-- handle_raft_committed_entries&#45;&gt;handle_raft_entry_conf_change -->
<g id="edge8" class="edge">
<title>handle_raft_committed_entries&#45;&gt;handle_raft_entry_conf_change</title>
<path fill="none" stroke="#666666" d="M459.15,-135.85C467.59,-134.29 476.17,-132.7 484.69,-131.12"/>
<polygon fill="#666666" stroke="#666666" points="485.45,-134.54 494.65,-129.28 484.18,-127.66 485.45,-134.54"/>
</g>
<!-- finish_for -->
<g id="node11" class="node">
<title>finish_for</title>
<path fill="none" stroke="#1c2123" d="M1424,-302C1424,-302 1580,-302 1580,-302 1586,-302 1592,-308 1592,-314 1592,-314 1592,-366 1592,-366 1592,-372 1586,-378 1580,-378 1580,-378 1424,-378 1424,-378 1418,-378 1412,-372 1412,-366 1412,-366 1412,-314 1412,-314 1412,-308 1418,-302 1424,-302"/>
<text text-anchor="middle" x="1502" y="-362.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">finish_for</text>
<polyline fill="none" stroke="#1c2123" points="1412,-355 1592,-355 "/>
<text text-anchor="start" x="1420" y="-339.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">传入commit_opt参数为false</text>
<text text-anchor="start" x="1420" y="-324.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 所以还不会将write batch</text>
<text text-anchor="start" x="1420" y="-309.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入rocksdb中</text>
</g>
<!-- handle_raft_committed_entries&#45;&gt;finish_for -->
<g id="edge13" class="edge">
<title>handle_raft_committed_entries&#45;&gt;finish_for</title>
<path fill="none" stroke="#666666" d="M405.85,-183.67C478,-236.72 638.14,-340 791.5,-340 791.5,-340 791.5,-340 1142.5,-340 1230,-340 1329.51,-340 1401.46,-340"/>
<polygon fill="#666666" stroke="#666666" points="1401.87,-343.5 1411.87,-340 1401.87,-336.5 1401.87,-343.5"/>
</g>
<!-- handle_raft_entry_normal&#45;&gt;process_raft_cmd -->
<g id="edge9" class="edge">
<title>handle_raft_entry_normal&#45;&gt;process_raft_cmd</title>
<path fill="none" stroke="#666666" d="M668.19,-153.19C687.23,-150.08 707.41,-146.77 725.8,-143.76"/>
<polygon fill="#666666" stroke="#666666" points="726.52,-147.19 735.82,-142.12 725.39,-140.28 726.52,-147.19"/>
</g>
<!-- commit -->
<g id="node19" class="node">
<title>commit</title>
<path fill="none" stroke="#1c2123" d="M982,-295C982,-295 947,-295 947,-295 941,-295 935,-289 935,-283 935,-283 935,-271 935,-271 935,-265 941,-259 947,-259 947,-259 982,-259 982,-259 988,-259 994,-265 994,-271 994,-271 994,-283 994,-283 994,-289 988,-295 982,-295"/>
<text text-anchor="middle" x="964.5" y="-273.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit</text>
</g>
<!-- handle_raft_entry_normal&#45;&gt;commit -->
<g id="edge26" class="edge">
<title>handle_raft_entry_normal&#45;&gt;commit</title>
<path fill="none" stroke="#666666" d="M601.81,-184.22C620.9,-211.78 661.43,-262.95 711,-283 782.12,-311.76 873.96,-298.41 924.98,-287.07"/>
<polygon fill="#666666" stroke="#666666" points="925.97,-290.44 934.93,-284.77 924.39,-283.62 925.97,-290.44"/>
</g>
<!-- should_write_to_engine -->
<g id="node20" class="node">
<title>should_write_to_engine</title>
<path fill="none" stroke="#1c2123" d="M854,-274C854,-274 731,-274 731,-274 725,-274 719,-268 719,-262 719,-262 719,-250 719,-250 719,-244 725,-238 731,-238 731,-238 854,-238 854,-238 860,-238 866,-244 866,-250 866,-250 866,-262 866,-262 866,-268 860,-274 854,-274"/>
<text text-anchor="middle" x="792.5" y="-252.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">should_write_to_engine</text>
</g>
<!-- handle_raft_entry_normal&#45;&gt;should_write_to_engine -->
<g id="edge27" class="edge">
<title>handle_raft_entry_normal&#45;&gt;should_write_to_engine</title>
<path fill="none" stroke="#666666" d="M623.98,-184.03C647.99,-196.48 681.09,-213.05 711,-226 717.35,-228.75 724.03,-231.48 730.73,-234.12"/>
<polygon fill="#666666" stroke="#666666" points="729.92,-237.56 740.51,-237.91 732.45,-231.03 729.92,-237.56"/>
</g>
<!-- handle_raft_entry_conf_change&#45;&gt;process_raft_cmd -->
<g id="edge10" class="edge">
<title>handle_raft_entry_conf_change&#45;&gt;process_raft_cmd</title>
<path fill="none" stroke="#666666" d="M683.08,-121.7C697.46,-123.2 712.05,-124.72 725.67,-126.14"/>
<polygon fill="#666666" stroke="#666666" points="725.57,-129.65 735.88,-127.2 726.29,-122.69 725.57,-129.65"/>
</g>
<!-- finish_for&#45;&gt;write_apply_state -->
<g id="edge20" class="edge">
<title>finish_for&#45;&gt;write_apply_state</title>
<path fill="none" stroke="#666666" d="M1544.77,-301.94C1579.86,-269.96 1630.08,-224.2 1667.25,-190.33"/>
<polygon fill="#666666" stroke="#666666" points="1669.94,-192.62 1674.97,-183.3 1665.22,-187.45 1669.94,-192.62"/>
</g>
<!-- apply_res -->
<g id="node12" class="node">
<title>apply_res</title>
<path fill="#feed9b" stroke="#f7e495" d="M1851,-367C1851,-367 2090,-367 2090,-367 2096,-367 2102,-373 2102,-379 2102,-379 2102,-401 2102,-401 2102,-407 2096,-413 2090,-413 2090,-413 1851,-413 1851,-413 1845,-413 1839,-407 1839,-401 1839,-401 1839,-379 1839,-379 1839,-373 1845,-367 1851,-367"/>
<text text-anchor="middle" x="1970.5" y="-397.8" font-family="Times,serif" font-size="14.00" fill="#40575d">apply_res</text>
<polyline fill="none" stroke="#f7e495" points="1839,-390 2102,-390 "/>
<text text-anchor="start" x="1847" y="-374.8" font-family="Times,serif" font-size="14.00" fill="#40575d">apply_res: Vec&lt;ApplyRes&lt;EK::Snapshot&gt;&gt;,</text>
</g>
<!-- finish_for&#45;&gt;apply_res -->
<g id="edge21" class="edge">
<title>finish_for&#45;&gt;apply_res</title>
<path fill="none" stroke="#666666" d="M1592.28,-374.21C1605.75,-378.2 1619.62,-381.67 1633,-384 1696.66,-395.07 1768.12,-397.69 1828.76,-397.1"/>
<polygon fill="#666666" stroke="#666666" points="1828.83,-400.6 1838.78,-396.97 1828.74,-393.6 1828.83,-400.6"/>
</g>
<!-- finish_for&#45;&gt;ApplyRes -->
<g id="edge22" class="edge">
<title>finish_for&#45;&gt;ApplyRes</title>
<path fill="none" stroke="#666666" d="M1592.21,-341.67C1602.27,-341.86 1612.55,-342.05 1622.68,-342.24"/>
<polygon fill="#666666" stroke="#666666" points="1622.67,-345.74 1632.74,-342.42 1622.8,-338.74 1622.67,-345.74"/>
</g>
<!-- commit_opt -->
<g id="node17" class="node">
<title>commit_opt</title>
<path fill="none" stroke="#1c2123" d="M1747.5,-295C1747.5,-295 1688.5,-295 1688.5,-295 1682.5,-295 1676.5,-289 1676.5,-283 1676.5,-283 1676.5,-271 1676.5,-271 1676.5,-265 1682.5,-259 1688.5,-259 1688.5,-259 1747.5,-259 1747.5,-259 1753.5,-259 1759.5,-265 1759.5,-271 1759.5,-271 1759.5,-283 1759.5,-283 1759.5,-289 1753.5,-295 1747.5,-295"/>
<text text-anchor="middle" x="1718" y="-273.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit_opt</text>
</g>
<!-- finish_for&#45;&gt;commit_opt -->
<g id="edge23" class="edge">
<title>finish_for&#45;&gt;commit_opt</title>
<path fill="none" stroke="#666666" d="M1592.21,-313.74C1617.57,-306.27 1644.3,-298.4 1666.49,-291.87"/>
<polygon fill="#666666" stroke="#666666" points="1667.74,-295.15 1676.34,-288.97 1665.76,-288.44 1667.74,-295.15"/>
</g>
<!-- notify -->
<g id="node14" class="node">
<title>notify</title>
<path fill="none" stroke="#1c2123" d="M2150,-369.5C2150,-369.5 2314,-369.5 2314,-369.5 2320,-369.5 2326,-375.5 2326,-381.5 2326,-381.5 2326,-426.5 2326,-426.5 2326,-432.5 2320,-438.5 2314,-438.5 2314,-438.5 2150,-438.5 2150,-438.5 2144,-438.5 2138,-432.5 2138,-426.5 2138,-426.5 2138,-381.5 2138,-381.5 2138,-375.5 2144,-369.5 2150,-369.5"/>
<text text-anchor="middle" x="2232" y="-423.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">notify</text>
<polyline fill="none" stroke="#1c2123" points="2138,-415.5 2326,-415.5 "/>
<text text-anchor="start" x="2146" y="-400.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.notifier.notify(apply_res)</text>
<polyline fill="none" stroke="#1c2123" points="2138,-392.5 2326,-392.5 "/>
<text text-anchor="start" x="2146" y="-377.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将apply_res发给PeerFsm处理</text>
</g>
<!-- apply_res&#45;&gt;notify -->
<g id="edge16" class="edge">
<title>apply_res&#45;&gt;notify</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M2102.01,-397.04C2110.62,-397.51 2119.23,-397.97 2127.69,-398.43"/>
<polygon fill="green" stroke="green" points="2127.74,-401.93 2137.91,-398.98 2128.11,-394.94 2127.74,-401.93"/>
</g>
<!-- ApplyRes&#45;&gt;apply_res -->
<g id="edge15" class="edge">
<title>ApplyRes&#45;&gt;apply_res</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1803.11,-359.45C1813.13,-361.28 1823.54,-363.2 1834.05,-365.13"/>
<polygon fill="green" stroke="green" points="1833.67,-368.62 1844.14,-366.98 1834.94,-361.73 1833.67,-368.62"/>
</g>
<!-- flush -->
<g id="node15" class="node">
<title>flush</title>
<path fill="none" stroke="#1c2123" d="M1733,-452C1733,-452 1703,-452 1703,-452 1697,-452 1691,-446 1691,-440 1691,-440 1691,-428 1691,-428 1691,-422 1697,-416 1703,-416 1703,-416 1733,-416 1733,-416 1739,-416 1745,-422 1745,-428 1745,-428 1745,-440 1745,-440 1745,-446 1739,-452 1733,-452"/>
<text text-anchor="middle" x="1718" y="-430.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">flush</text>
</g>
<!-- flush&#45;&gt;apply_res -->
<g id="edge17" class="edge">
<title>flush&#45;&gt;apply_res</title>
<path fill="none" stroke="#666666" d="M1745.33,-429.37C1766.11,-425.73 1796.85,-420.32 1828.96,-414.69"/>
<polygon fill="#666666" stroke="#666666" points="1829.71,-418.11 1838.96,-412.93 1828.5,-411.21 1829.71,-418.11"/>
</g>
<!-- flush&#45;&gt;notify -->
<g id="edge18" class="edge">
<title>flush&#45;&gt;notify</title>
<path fill="none" stroke="#666666" d="M1745.15,-436.76C1807.34,-442.79 1968.79,-455.26 2102,-438 2110.51,-436.9 2119.26,-435.4 2128,-433.65"/>
<polygon fill="#666666" stroke="#666666" points="2128.79,-437.06 2137.85,-431.57 2127.35,-430.21 2128.79,-437.06"/>
</g>
<!-- write_to_db -->
<g id="node16" class="node">
<title>write_to_db</title>
<path fill="none" stroke="#1c2123" d="M2261,-311C2261,-311 2203,-311 2203,-311 2197,-311 2191,-305 2191,-299 2191,-299 2191,-287 2191,-287 2191,-281 2197,-275 2203,-275 2203,-275 2261,-275 2261,-275 2267,-275 2273,-281 2273,-287 2273,-287 2273,-299 2273,-299 2273,-305 2267,-311 2261,-311"/>
<text text-anchor="middle" x="2232" y="-289.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_to_db</text>
</g>
<!-- flush&#45;&gt;write_to_db -->
<g id="edge19" class="edge">
<title>flush&#45;&gt;write_to_db</title>
<path fill="none" stroke="#666666" d="M1745.22,-434.72C1826.65,-436.73 2071.62,-441.22 2102,-423 2129.66,-406.41 2116.43,-383.97 2138,-360 2152.96,-343.37 2172.72,-328.43 2190.17,-316.9"/>
<polygon fill="#666666" stroke="#666666" points="2192.53,-319.54 2199.05,-311.19 2188.74,-313.65 2192.53,-319.54"/>
</g>
<!-- commit_opt&#45;&gt;write_to_db -->
<g id="edge30" class="edge">
<title>commit_opt&#45;&gt;write_to_db</title>
<path fill="none" stroke="#666666" d="M1759.54,-279.27C1782.79,-280.52 1812.53,-282 1839,-283 1961.8,-287.64 2106.32,-290.71 2180.88,-292.11"/>
<polygon fill="#666666" stroke="#666666" points="2180.86,-295.61 2190.92,-292.3 2180.99,-288.61 2180.86,-295.61"/>
</g>
<!-- prepare_for -->
<g id="node21" class="node">
<title>prepare_for</title>
<path fill="none" stroke="#1c2123" d="M1998.5,-348C1998.5,-348 1942.5,-348 1942.5,-348 1936.5,-348 1930.5,-342 1930.5,-336 1930.5,-336 1930.5,-324 1930.5,-324 1930.5,-318 1936.5,-312 1942.5,-312 1942.5,-312 1998.5,-312 1998.5,-312 2004.5,-312 2010.5,-318 2010.5,-324 2010.5,-324 2010.5,-336 2010.5,-336 2010.5,-342 2004.5,-348 1998.5,-348"/>
<text text-anchor="middle" x="1970.5" y="-326.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">prepare_for</text>
</g>
<!-- commit_opt&#45;&gt;prepare_for -->
<g id="edge31" class="edge">
<title>commit_opt&#45;&gt;prepare_for</title>
<path fill="none" stroke="#666666" d="M1759.53,-285.57C1803.39,-294.85 1873.34,-309.66 1920.32,-319.59"/>
<polygon fill="#666666" stroke="#666666" points="1919.76,-323.05 1930.27,-321.7 1921.21,-316.21 1919.76,-323.05"/>
</g>
<!-- kv_wb&#45;&gt;write_to_db -->
<g id="edge32" class="edge">
<title>kv_wb&#45;&gt;write_to_db</title>
<path fill="none" stroke="#666666" d="M1997.81,-259.75C2040.54,-265.84 2125.75,-277.99 2180.48,-285.8"/>
<polygon fill="#666666" stroke="#666666" points="2180.27,-289.3 2190.66,-287.25 2181.26,-282.37 2180.27,-289.3"/>
</g>
<!-- commit&#45;&gt;commit_opt -->
<g id="edge29" class="edge">
<title>commit&#45;&gt;commit_opt</title>
<path fill="none" stroke="#666666" d="M994.04,-277C1106.51,-277 1520.01,-277 1665.75,-277"/>
<polygon fill="#666666" stroke="#666666" points="1666.18,-280.5 1676.18,-277 1666.18,-273.5 1666.18,-280.5"/>
</g>
<!-- should_write_to_engine&#45;&gt;commit -->
<g id="edge28" class="edge">
<title>should_write_to_engine&#45;&gt;commit</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M866.09,-264.97C886.12,-267.44 907.09,-270.03 924.42,-272.17"/>
<polygon fill="green" stroke="green" points="924.34,-275.69 934.69,-273.44 925.2,-268.74 924.34,-275.69"/>
</g>
<!-- handle_tasks -->
<g id="node22" class="node">
<title>handle_tasks</title>
<path fill="none" stroke="#1c2123" d="M224,-312C224,-312 162,-312 162,-312 156,-312 150,-306 150,-300 150,-300 150,-288 150,-288 150,-282 156,-276 162,-276 162,-276 224,-276 224,-276 230,-276 236,-282 236,-288 236,-288 236,-300 236,-300 236,-306 230,-312 224,-312"/>
<text text-anchor="middle" x="193" y="-290.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_tasks</text>
</g>
<!-- handle_tasks&#45;&gt;handle_raft_committed_entries -->
<g id="edge33" class="edge">
<title>handle_tasks&#45;&gt;handle_raft_committed_entries</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M215.94,-275.86C242,-254.3 286.15,-217.79 319.56,-190.16"/>
<polygon fill="green" stroke="green" points="321.9,-192.77 327.38,-183.7 317.44,-187.38 321.9,-192.77"/>
</g>
<!-- end -->
<g id="node23" class="node">
<title>end</title>
<path fill="none" stroke="#1c2123" d="M1419,-508.5C1419,-508.5 1585,-508.5 1585,-508.5 1591,-508.5 1597,-514.5 1597,-520.5 1597,-520.5 1597,-557.5 1597,-557.5 1597,-563.5 1591,-569.5 1585,-569.5 1585,-569.5 1419,-569.5 1419,-569.5 1413,-569.5 1407,-563.5 1407,-557.5 1407,-557.5 1407,-520.5 1407,-520.5 1407,-514.5 1413,-508.5 1419,-508.5"/>
<text text-anchor="middle" x="1502" y="-554.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">end</text>
<polyline fill="none" stroke="#1c2123" points="1407,-546.5 1597,-546.5 "/>
<text text-anchor="start" x="1415" y="-531.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">1.将kv_wb写入磁盘</text>
<text text-anchor="start" x="1415" y="-516.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.将ApplyRes发送给PeerFsm</text>
</g>
<!-- end&#45;&gt;flush -->
<g id="edge34" class="edge">
<title>end&#45;&gt;flush</title>
<path fill="none" stroke="#666666" d="M1578.06,-508.44C1587.2,-504.4 1596.36,-500.2 1605,-496 1631.24,-483.25 1660.01,-467.28 1681.82,-454.74"/>
<polygon fill="#666666" stroke="#666666" points="1683.81,-457.63 1690.72,-449.59 1680.31,-451.57 1683.81,-457.63"/>
</g>
<!-- handle_normal -->
<g id="node24" class="node">
<title>handle_normal</title>
<path fill="none" stroke="#1c2123" d="M102,-544C102,-544 28,-544 28,-544 22,-544 16,-538 16,-532 16,-532 16,-520 16,-520 16,-514 22,-508 28,-508 28,-508 102,-508 102,-508 108,-508 114,-514 114,-520 114,-520 114,-532 114,-532 114,-538 108,-544 102,-544"/>
<text text-anchor="middle" x="65" y="-522.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_normal</text>
</g>
<!-- handle_normal&#45;&gt;handle_tasks -->
<g id="edge35" class="edge">
<title>handle_normal&#45;&gt;handle_tasks</title>
<path fill="none" stroke="#666666" d="M75.89,-507.8C97.97,-467.14 151.39,-368.77 177.35,-320.97"/>
<polygon fill="#666666" stroke="#666666" points="180.46,-322.58 182.16,-312.12 174.31,-319.24 180.46,-322.58"/>
</g>
</g>
</svg>
