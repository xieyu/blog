<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: end Pages: 1 -->
<svg width="1118pt" height="378pt"
 viewBox="0.00 0.00 1118.00 378.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 374)">
<title>end</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-374 1114,-374 1114,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_RaftRouter</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M757,-8C757,-8 1090,-8 1090,-8 1096,-8 1102,-14 1102,-20 1102,-20 1102,-134 1102,-134 1102,-140 1096,-146 1090,-146 1090,-146 757,-146 757,-146 751,-146 745,-140 745,-134 745,-134 745,-20 745,-20 745,-14 751,-8 757,-8"/>
<text text-anchor="middle" x="923.5" y="-126" font-family="Times,serif" font-size="20.00">RaftRouter</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ApplyContext</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M458,-154C458,-154 902,-154 902,-154 908,-154 914,-160 914,-166 914,-166 914,-350 914,-350 914,-356 908,-362 902,-362 902,-362 458,-362 458,-362 452,-362 446,-356 446,-350 446,-350 446,-166 446,-166 446,-160 452,-154 458,-154"/>
<text text-anchor="middle" x="680" y="-342" font-family="Times,serif" font-size="20.00">ApplyContext</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_ApplyPoller</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M272.5,-153C272.5,-153 361.5,-153 361.5,-153 367.5,-153 373.5,-159 373.5,-165 373.5,-165 373.5,-223 373.5,-223 373.5,-229 367.5,-235 361.5,-235 361.5,-235 272.5,-235 272.5,-235 266.5,-235 260.5,-229 260.5,-223 260.5,-223 260.5,-165 260.5,-165 260.5,-159 266.5,-153 272.5,-153"/>
<text text-anchor="middle" x="317" y="-215" font-family="Times,serif" font-size="20.00">ApplyPoller</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_Poller</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M38.5,-145C38.5,-145 140.5,-145 140.5,-145 146.5,-145 152.5,-151 152.5,-157 152.5,-157 152.5,-227 152.5,-227 152.5,-233 146.5,-239 140.5,-239 140.5,-239 38.5,-239 38.5,-239 32.5,-239 26.5,-233 26.5,-227 26.5,-227 26.5,-157 26.5,-157 26.5,-151 32.5,-145 38.5,-145"/>
<text text-anchor="middle" x="89.5" y="-219" font-family="Times,serif" font-size="20.00">Poller</text>
</g>
<!-- RaftBatchSystem -->
<g id="node1" class="node">
<title>RaftBatchSystem</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M12,-248C12,-248 167,-248 167,-248 173,-248 179,-254 179,-260 179,-260 179,-282 179,-282 179,-288 173,-294 167,-294 167,-294 12,-294 12,-294 6,-294 0,-288 0,-282 0,-282 0,-260 0,-260 0,-254 6,-248 12,-248"/>
<text text-anchor="middle" x="89.5" y="-278.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftBatchSystem</text>
<polyline fill="none" stroke="#60b5ac" points="0,-271 179,-271 "/>
<text text-anchor="start" x="8" y="-255.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">router: RaftRouter&lt;EK, ER&gt;,</text>
</g>
<!-- ApplyPollerBuilder -->
<g id="node2" class="node">
<title>ApplyPollerBuilder</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M227,-267C227,-267 406,-267 406,-267 412,-267 418,-273 418,-279 418,-279 418,-301 418,-301 418,-307 412,-313 406,-313 406,-313 227,-313 227,-313 221,-313 215,-307 215,-301 215,-301 215,-279 215,-279 215,-273 221,-267 227,-267"/>
<text text-anchor="middle" x="316.5" y="-297.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ApplyPollerBuilder</text>
<polyline fill="none" stroke="#60b5ac" points="215,-290 418,-290 "/>
<text text-anchor="start" x="223" y="-274.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">sender: Box&lt;dyn Notifier&lt;EK&gt;&gt;,</text>
</g>
<!-- RaftBatchSystem&#45;&gt;ApplyPollerBuilder -->
<g id="edge1" class="edge">
<title>RaftBatchSystem:router&#45;&gt;ApplyPollerBuilder:sender</title>
<path fill="none" stroke="#666666" d="M179.29,-259.29C278,-247.62 422.94,-234.51 424.33,-258.03"/>
<polygon fill="#666666" stroke="#666666" points="421.16,-256.54 419.5,-267 427.32,-259.85 421.16,-256.54"/>
</g>
<!-- ApplyContext -->
<g id="node3" class="node">
<title>ApplyContext</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M466,-216.5C466,-216.5 705,-216.5 705,-216.5 711,-216.5 717,-222.5 717,-228.5 717,-228.5 717,-311.5 717,-311.5 717,-317.5 711,-323.5 705,-323.5 705,-323.5 466,-323.5 466,-323.5 460,-323.5 454,-317.5 454,-311.5 454,-311.5 454,-228.5 454,-228.5 454,-222.5 460,-216.5 466,-216.5"/>
<text text-anchor="middle" x="585.5" y="-308.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ApplyContext</text>
<polyline fill="none" stroke="#60b5ac" points="454,-300.5 717,-300.5 "/>
<text text-anchor="start" x="462" y="-285.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">router: ApplyRouter&lt;EK&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="454,-277.5 717,-277.5 "/>
<text text-anchor="start" x="462" y="-262.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">notifier: Box&lt;dyn Notifier&lt;EK&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="454,-254.5 717,-254.5 "/>
<text text-anchor="start" x="462" y="-239.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">apply_res: Vec&lt;ApplyRes&lt;EK::Snapshot&gt;&gt;,</text>
<text text-anchor="start" x="462" y="-224.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> kv_wb: W,</text>
</g>
<!-- ApplyPollerBuilder&#45;&gt;ApplyContext -->
<g id="edge2" class="edge">
<title>ApplyPollerBuilder:sender&#45;&gt;ApplyContext:notifier</title>
<path fill="none" stroke="#666666" d="M418,-267C426.22,-258.78 432.98,-262.44 442.46,-264.7"/>
<polygon fill="#666666" stroke="#666666" points="442.13,-268.19 452.5,-266 443.03,-261.25 442.13,-268.19"/>
</g>
<!-- notify -->
<g id="node4" class="node">
<title>notify</title>
<path fill="none" stroke="#1c2123" d="M765,-16.5C765,-16.5 908,-16.5 908,-16.5 914,-16.5 920,-22.5 920,-28.5 920,-28.5 920,-95.5 920,-95.5 920,-101.5 914,-107.5 908,-107.5 908,-107.5 765,-107.5 765,-107.5 759,-107.5 753,-101.5 753,-95.5 753,-95.5 753,-28.5 753,-28.5 753,-22.5 759,-16.5 765,-16.5"/>
<text text-anchor="middle" x="836.5" y="-92.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">notify</text>
<polyline fill="none" stroke="#1c2123" points="753,-84.5 920,-84.5 "/>
<text text-anchor="start" x="761" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历apply_res</text>
<text text-anchor="start" x="761" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将ApplyRes 发送给</text>
<text text-anchor="start" x="761" y="-39.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ApplyRes.region_id</text>
<text text-anchor="start" x="761" y="-24.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 对应的PeerFSM的reciver</text>
</g>
<!-- ApplyContext&#45;&gt;notify -->
<g id="edge4" class="edge">
<title>ApplyContext&#45;&gt;notify</title>
<path fill="none" stroke="#666666" d="M706.53,-216.41C710.19,-213.41 713.7,-210.28 717,-207 737.03,-187.11 728.42,-172.84 745,-150 753.87,-137.78 764.52,-125.76 775.36,-114.73"/>
<polygon fill="#666666" stroke="#666666" points="777.87,-117.16 782.48,-107.62 772.93,-112.2 777.87,-117.16"/>
</g>
<!-- try_send -->
<g id="node5" class="node">
<title>try_send</title>
<path fill="none" stroke="#1c2123" d="M968,-20C968,-20 1082,-20 1082,-20 1088,-20 1094,-26 1094,-32 1094,-32 1094,-92 1094,-92 1094,-98 1088,-104 1082,-104 1082,-104 968,-104 968,-104 962,-104 956,-98 956,-92 956,-92 956,-32 956,-32 956,-26 962,-20 968,-20"/>
<text text-anchor="middle" x="1025" y="-88.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">try_send</text>
<polyline fill="none" stroke="#1c2123" points="956,-81 1094,-81 "/>
<text text-anchor="start" x="964" y="-65.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">发送消息给Region</text>
<polyline fill="none" stroke="#1c2123" points="956,-58 1094,-58 "/>
<text text-anchor="start" x="964" y="-42.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">该消息将在raftpoller</text>
<text text-anchor="start" x="964" y="-27.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 线程池处理</text>
</g>
<!-- notify&#45;&gt;try_send -->
<g id="edge3" class="edge">
<title>notify&#45;&gt;try_send</title>
<path fill="none" stroke="#666666" d="M920.12,-62C928.64,-62 937.28,-62 945.75,-62"/>
<polygon fill="#666666" stroke="#666666" points="945.98,-65.5 955.98,-62 945.98,-58.5 945.98,-65.5"/>
</g>
<!-- flush -->
<g id="node6" class="node">
<title>flush</title>
<path fill="none" stroke="#1c2123" d="M600.5,-198C600.5,-198 570.5,-198 570.5,-198 564.5,-198 558.5,-192 558.5,-186 558.5,-186 558.5,-174 558.5,-174 558.5,-168 564.5,-162 570.5,-162 570.5,-162 600.5,-162 600.5,-162 606.5,-162 612.5,-168 612.5,-174 612.5,-174 612.5,-186 612.5,-186 612.5,-192 606.5,-198 600.5,-198"/>
<text text-anchor="middle" x="585.5" y="-176.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">flush</text>
</g>
<!-- flush&#45;&gt;notify -->
<g id="edge5" class="edge">
<title>flush&#45;&gt;notify</title>
<path fill="none" stroke="#666666" d="M612.68,-167.59C643.64,-152.92 696.88,-127.69 743.55,-105.58"/>
<polygon fill="#666666" stroke="#666666" points="745.25,-108.64 752.79,-101.2 742.25,-102.32 745.25,-108.64"/>
</g>
<!-- write_to_db -->
<g id="node7" class="node">
<title>write_to_db</title>
<path fill="none" stroke="#1c2123" d="M779,-163C779,-163 894,-163 894,-163 900,-163 906,-169 906,-175 906,-175 906,-197 906,-197 906,-203 900,-209 894,-209 894,-209 779,-209 779,-209 773,-209 767,-203 767,-197 767,-197 767,-175 767,-175 767,-169 773,-163 779,-163"/>
<text text-anchor="middle" x="836.5" y="-193.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_to_db</text>
<polyline fill="none" stroke="#1c2123" points="767,-186 906,-186 "/>
<text text-anchor="start" x="775" y="-170.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将kv_wb写入rocksdb</text>
</g>
<!-- flush&#45;&gt;write_to_db -->
<g id="edge6" class="edge">
<title>flush&#45;&gt;write_to_db</title>
<path fill="none" stroke="#666666" d="M612.68,-180.63C646.61,-181.45 707.3,-182.91 756.79,-184.1"/>
<polygon fill="#666666" stroke="#666666" points="756.76,-187.6 766.84,-184.35 756.93,-180.61 756.76,-187.6"/>
</g>
<!-- end -->
<g id="node8" class="node">
<title>end</title>
<path fill="none" stroke="#1c2123" d="M331.5,-197C331.5,-197 301.5,-197 301.5,-197 295.5,-197 289.5,-191 289.5,-185 289.5,-185 289.5,-173 289.5,-173 289.5,-167 295.5,-161 301.5,-161 301.5,-161 331.5,-161 331.5,-161 337.5,-161 343.5,-167 343.5,-173 343.5,-173 343.5,-185 343.5,-185 343.5,-191 337.5,-197 331.5,-197"/>
<text text-anchor="middle" x="316.5" y="-175.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">end</text>
</g>
<!-- end&#45;&gt;flush -->
<g id="edge7" class="edge">
<title>end&#45;&gt;flush</title>
<path fill="none" stroke="#666666" d="M343.59,-179.1C391.44,-179.28 493.35,-179.66 548.03,-179.86"/>
<polygon fill="#666666" stroke="#666666" points="548.29,-183.36 558.31,-179.9 548.32,-176.36 548.29,-183.36"/>
</g>
<!-- poll -->
<g id="node9" class="node">
<title>poll</title>
<path fill="none" stroke="#1c2123" d="M46.5,-154C46.5,-154 132.5,-154 132.5,-154 138.5,-154 144.5,-160 144.5,-166 144.5,-166 144.5,-188 144.5,-188 144.5,-194 138.5,-200 132.5,-200 132.5,-200 46.5,-200 46.5,-200 40.5,-200 34.5,-194 34.5,-188 34.5,-188 34.5,-166 34.5,-166 34.5,-160 40.5,-154 46.5,-154"/>
<text text-anchor="middle" x="89.5" y="-184.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">poll</text>
<polyline fill="none" stroke="#1c2123" points="34.5,-177 144.5,-177 "/>
<text text-anchor="middle" x="89.5" y="-161.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply poller线程</text>
</g>
<!-- poll&#45;&gt;end -->
<g id="edge8" class="edge">
<title>poll&#45;&gt;end</title>
<path fill="none" stroke="#666666" d="M144.68,-177.48C186.34,-177.85 242.75,-178.35 279.13,-178.68"/>
<polygon fill="#666666" stroke="#666666" points="279.26,-182.18 289.29,-178.77 279.32,-175.18 279.26,-182.18"/>
</g>
</g>
</svg>
