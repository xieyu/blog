<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: process_write2 Pages: 1 -->
<svg width="1126pt" height="172pt"
 viewBox="0.00 0.00 1126.00 172.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 168.25)">
<title>process_write2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-168.25 1122,-168.25 1122,4 -4,4"/>
<!-- Commit__process_write -->
<g id="node1" class="node">
<title>Commit__process_write</title>
<path fill="none" stroke="#1c2123" d="M12,-43C12,-43 139,-43 139,-43 145,-43 151,-49 151,-55 151,-55 151,-92 151,-92 151,-98 145,-104 139,-104 139,-104 12,-104 12,-104 6,-104 0,-98 0,-92 0,-92 0,-55 0,-55 0,-49 6,-43 12,-43"/>
<text text-anchor="start" x="8" y="-88.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Commit</text>
<text text-anchor="start" x="8" y="-73.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> process_write</text>
<polyline fill="none" stroke="#1c2123" points="0,-66 151,-66 "/>
<text text-anchor="start" x="8" y="-50.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理TiDB commit请求</text>
</g>
<!-- commit -->
<g id="node2" class="node">
<title>commit</title>
<path fill="none" stroke="#1c2123" d="M352.5,-86.5C352.5,-86.5 421.5,-86.5 421.5,-86.5 427.5,-86.5 433.5,-92.5 433.5,-98.5 433.5,-98.5 433.5,-120.5 433.5,-120.5 433.5,-126.5 427.5,-132.5 421.5,-132.5 421.5,-132.5 352.5,-132.5 352.5,-132.5 346.5,-132.5 340.5,-126.5 340.5,-120.5 340.5,-120.5 340.5,-98.5 340.5,-98.5 340.5,-92.5 346.5,-86.5 352.5,-86.5"/>
<text text-anchor="start" x="348.5" y="-117.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit</text>
<polyline fill="none" stroke="#1c2123" points="340.5,-109.5 433.5,-109.5 "/>
<text text-anchor="middle" x="387" y="-94.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">提交单个key</text>
</g>
<!-- Commit__process_write&#45;&gt;commit -->
<g id="edge1" class="edge">
<title>Commit__process_write&#45;&gt;commit</title>
<path fill="none" stroke="#666666" d="M106.7,-104.36C127.32,-123.13 156.38,-145.38 187,-155.5 227.93,-169.03 241.85,-164.56 284,-155.5 301.62,-151.71 319.87,-144.62 335.97,-137.13"/>
<polygon fill="#666666" stroke="#666666" points="337.7,-140.18 345.19,-132.69 334.66,-133.88 337.7,-140.18"/>
</g>
<!-- ReleasedLocks__new -->
<g id="node3" class="node">
<title>ReleasedLocks__new</title>
<path fill="none" stroke="#1c2123" d="M442,-64.5C442,-64.5 332,-64.5 332,-64.5 326,-64.5 320,-58.5 320,-52.5 320,-52.5 320,-40.5 320,-40.5 320,-34.5 326,-28.5 332,-28.5 332,-28.5 442,-28.5 442,-28.5 448,-28.5 454,-34.5 454,-40.5 454,-40.5 454,-52.5 454,-52.5 454,-58.5 448,-64.5 442,-64.5"/>
<text text-anchor="middle" x="387" y="-42.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReleasedLocks__new</text>
</g>
<!-- Commit__process_write&#45;&gt;ReleasedLocks__new -->
<g id="edge2" class="edge">
<title>Commit__process_write&#45;&gt;ReleasedLocks__new</title>
<path fill="none" stroke="#666666" d="M151.05,-64.25C163.06,-62.9 175.36,-61.59 187,-60.5 227.34,-56.71 272.38,-53.46 309.39,-51.05"/>
<polygon fill="#666666" stroke="#666666" points="309.85,-54.53 319.6,-50.39 309.4,-47.54 309.85,-54.53"/>
</g>
<!-- Commit__keys -->
<g id="node4" class="node">
<title>Commit__keys</title>
<path fill="#feed9b" stroke="#f7e495" d="M199,-69.5C199,-69.5 272,-69.5 272,-69.5 278,-69.5 284,-75.5 284,-81.5 284,-81.5 284,-133.5 284,-133.5 284,-139.5 278,-145.5 272,-145.5 272,-145.5 199,-145.5 199,-145.5 193,-145.5 187,-139.5 187,-133.5 187,-133.5 187,-81.5 187,-81.5 187,-75.5 193,-69.5 199,-69.5"/>
<text text-anchor="middle" x="235.5" y="-130.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Commit::keys</text>
<polyline fill="none" stroke="#f7e495" points="187,-122.5 284,-122.5 "/>
<text text-anchor="start" x="195" y="-107.3" font-family="Times,serif" font-size="14.00" fill="#40575d">遍历keys</text>
<text text-anchor="start" x="195" y="-92.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 对于每个key</text>
<text text-anchor="start" x="195" y="-77.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 调用commit</text>
</g>
<!-- Commit__process_write&#45;&gt;Commit__keys -->
<g id="edge3" class="edge">
<title>Commit__process_write&#45;&gt;Commit__keys</title>
<path fill="none" stroke="#666666" d="M151.34,-89.6C159.95,-91.46 168.64,-93.33 176.98,-95.12"/>
<polygon fill="#666666" stroke="#666666" points="176.44,-98.59 186.95,-97.27 177.91,-91.74 176.44,-98.59"/>
</g>
<!-- ReleasedLocks__wakeup -->
<g id="node5" class="node">
<title>ReleasedLocks__wakeup</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M982,-0.5C982,-0.5 1106,-0.5 1106,-0.5 1112,-0.5 1118,-6.5 1118,-12.5 1118,-12.5 1118,-34.5 1118,-34.5 1118,-40.5 1112,-46.5 1106,-46.5 1106,-46.5 982,-46.5 982,-46.5 976,-46.5 970,-40.5 970,-34.5 970,-34.5 970,-12.5 970,-12.5 970,-6.5 976,-0.5 982,-0.5"/>
<text text-anchor="middle" x="1044" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReleasedLocks::wakeup</text>
<polyline fill="none" stroke="#8a8898" points="970,-23.5 1118,-23.5 "/>
<text text-anchor="start" x="978" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">唤醒等待的事务</text>
</g>
<!-- Commit__process_write&#45;&gt;ReleasedLocks__wakeup -->
<g id="edge4" class="edge">
<title>Commit__process_write&#45;&gt;ReleasedLocks__wakeup</title>
<path fill="none" stroke="#666666" d="M151.02,-45.69C213,-25.06 304.02,-0.5 386,-0.5 386,-0.5 386,-0.5 732.5,-0.5 809.56,-0.5 897.09,-7.63 959.52,-13.95"/>
<polygon fill="#666666" stroke="#666666" points="959.41,-17.46 969.71,-15 960.12,-10.5 959.41,-17.46"/>
</g>
<!-- ReleasedLock -->
<g id="node7" class="node">
<title>ReleasedLock</title>
<path fill="none" stroke="#1c2123" d="M502,-75C502,-75 615,-75 615,-75 621,-75 627,-81 627,-87 627,-87 627,-132 627,-132 627,-138 621,-144 615,-144 615,-144 502,-144 502,-144 496,-144 490,-138 490,-132 490,-132 490,-87 490,-87 490,-81 496,-75 502,-75"/>
<text text-anchor="start" x="498" y="-128.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReleasedLock</text>
<polyline fill="none" stroke="#1c2123" points="490,-121 627,-121 "/>
<text text-anchor="start" x="498" y="-105.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub hash: u64,</text>
<polyline fill="none" stroke="#1c2123" points="490,-98 627,-98 "/>
<text text-anchor="start" x="498" y="-82.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub pessimistic: bool,</text>
</g>
<!-- commit&#45;&gt;ReleasedLock -->
<g id="edge8" class="edge">
<title>commit&#45;&gt;ReleasedLock</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M433.87,-109.5C448.02,-109.5 464.03,-109.5 479.71,-109.5"/>
<polygon fill="green" stroke="green" points="479.95,-113 489.95,-109.5 479.95,-106 479.95,-113"/>
</g>
<!-- ReleasedLocks -->
<g id="node6" class="node">
<title>ReleasedLocks</title>
<path fill="none" stroke="#1c2123" d="M922,-64.5C922,-64.5 848,-64.5 848,-64.5 842,-64.5 836,-58.5 836,-52.5 836,-52.5 836,-40.5 836,-40.5 836,-34.5 842,-28.5 848,-28.5 848,-28.5 922,-28.5 922,-28.5 928,-28.5 934,-34.5 934,-40.5 934,-40.5 934,-52.5 934,-52.5 934,-58.5 928,-64.5 922,-64.5"/>
<text text-anchor="middle" x="885" y="-42.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReleasedLocks</text>
</g>
<!-- ReleasedLocks__new&#45;&gt;ReleasedLocks -->
<g id="edge6" class="edge">
<title>ReleasedLocks__new&#45;&gt;ReleasedLocks</title>
<path fill="none" stroke="#666666" d="M454.12,-46.5C551.74,-46.5 732.87,-46.5 825.76,-46.5"/>
<polygon fill="#666666" stroke="#666666" points="825.82,-50 835.82,-46.5 825.82,-43 825.82,-50"/>
</g>
<!-- Commit__keys&#45;&gt;commit -->
<g id="edge5" class="edge">
<title>Commit__keys&#45;&gt;commit</title>
<path fill="none" stroke="#666666" d="M284.21,-108.14C298.79,-108.33 314.96,-108.55 330.04,-108.75"/>
<polygon fill="#666666" stroke="#666666" points="330.22,-112.25 340.27,-108.89 330.32,-105.25 330.22,-112.25"/>
</g>
<!-- ReleasedLocks&#45;&gt;ReleasedLocks__wakeup -->
<g id="edge7" class="edge">
<title>ReleasedLocks&#45;&gt;ReleasedLocks__wakeup</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M934.39,-39.41C942.57,-38.21 951.27,-36.94 960.04,-35.65"/>
<polygon fill="green" stroke="green" points="960.56,-39.11 969.95,-34.2 959.55,-32.19 960.56,-39.11"/>
</g>
<!-- ReleasedLocks__push -->
<g id="node8" class="node">
<title>ReleasedLocks__push</title>
<path fill="none" stroke="#1c2123" d="M788,-118.5C788,-118.5 675,-118.5 675,-118.5 669,-118.5 663,-112.5 663,-106.5 663,-106.5 663,-94.5 663,-94.5 663,-88.5 669,-82.5 675,-82.5 675,-82.5 788,-82.5 788,-82.5 794,-82.5 800,-88.5 800,-94.5 800,-94.5 800,-106.5 800,-106.5 800,-112.5 794,-118.5 788,-118.5"/>
<text text-anchor="middle" x="731.5" y="-96.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReleasedLocks__push</text>
</g>
<!-- ReleasedLock&#45;&gt;ReleasedLocks__push -->
<g id="edge9" class="edge">
<title>ReleasedLock&#45;&gt;ReleasedLocks__push</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M627.08,-105.94C635.54,-105.5 644.24,-105.04 652.83,-104.59"/>
<polygon fill="green" stroke="green" points="653.05,-108.08 662.85,-104.06 652.68,-101.09 653.05,-108.08"/>
</g>
<!-- ReleasedLocks__push&#45;&gt;ReleasedLocks -->
<g id="edge10" class="edge">
<title>ReleasedLocks__push&#45;&gt;ReleasedLocks</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M783.37,-82.37C797.13,-77.46 812.12,-72.12 826.23,-67.09"/>
<polygon fill="green" stroke="green" points="827.58,-70.32 835.83,-63.67 825.23,-63.73 827.58,-70.32"/>
</g>
</g>
</svg>
