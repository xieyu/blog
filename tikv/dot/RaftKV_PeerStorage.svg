<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: PeerStorage Pages: 1 -->
<svg width="1875pt" height="1160pt"
 viewBox="0.00 0.00 1875.00 1160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1156)">
<title>PeerStorage</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1156 1871,-1156 1871,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_PollContext</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1104,-656C1104,-656 1399,-656 1399,-656 1405,-656 1411,-662 1411,-668 1411,-668 1411,-818 1411,-818 1411,-824 1405,-830 1399,-830 1399,-830 1104,-830 1104,-830 1098,-830 1092,-824 1092,-818 1092,-818 1092,-668 1092,-668 1092,-662 1098,-656 1104,-656"/>
<text text-anchor="middle" x="1251.5" y="-810" font-family="Times,serif" font-size="20.00">PollContext</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_PeerStorage</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M691,-838C691,-838 1847,-838 1847,-838 1853,-838 1859,-844 1859,-850 1859,-850 1859,-1132 1859,-1132 1859,-1138 1853,-1144 1847,-1144 1847,-1144 691,-1144 691,-1144 685,-1144 679,-1138 679,-1132 679,-1132 679,-850 679,-850 679,-844 685,-838 691,-838"/>
<text text-anchor="middle" x="1269" y="-1124" font-family="Times,serif" font-size="20.00">PeerStorage</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_InvokeContext</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M885,-846C885,-846 1046,-846 1046,-846 1052,-846 1058,-852 1058,-858 1058,-858 1058,-1024 1058,-1024 1058,-1030 1052,-1036 1046,-1036 1046,-1036 885,-1036 885,-1036 879,-1036 873,-1030 873,-1024 873,-1024 873,-858 873,-858 873,-852 879,-846 885,-846"/>
<text text-anchor="middle" x="965.5" y="-1016" font-family="Times,serif" font-size="20.00">InvokeContext</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_Peer</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M488,-8C488,-8 1608,-8 1608,-8 1614,-8 1620,-14 1620,-20 1620,-20 1620,-196 1620,-196 1620,-202 1614,-208 1608,-208 1608,-208 488,-208 488,-208 482,-208 476,-202 476,-196 476,-196 476,-20 476,-20 476,-14 482,-8 488,-8"/>
<text text-anchor="middle" x="1048" y="-188" font-family="Times,serif" font-size="20.00">Peer</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_RaftGroup</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M695,-62C695,-62 1026,-62 1026,-62 1032,-62 1038,-68 1038,-74 1038,-74 1038,-158 1038,-158 1038,-164 1032,-170 1026,-170 1026,-170 695,-170 695,-170 689,-170 683,-164 683,-158 683,-158 683,-74 683,-74 683,-68 689,-62 695,-62"/>
<text text-anchor="middle" x="860.5" y="-150" font-family="Times,serif" font-size="20.00">RaftGroup</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_PeerFsmDelegate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M363,-216C363,-216 1389.5,-216 1389.5,-216 1395.5,-216 1401.5,-222 1401.5,-228 1401.5,-228 1401.5,-340 1401.5,-340 1401.5,-346 1395.5,-352 1389.5,-352 1389.5,-352 363,-352 363,-352 357,-352 351,-346 351,-340 351,-340 351,-228 351,-228 351,-222 357,-216 363,-216"/>
<text text-anchor="middle" x="876.25" y="-332" font-family="Times,serif" font-size="20.00">PeerFsmDelegate</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_RaftPoller</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M185,-360C185,-360 1197,-360 1197,-360 1203,-360 1209,-366 1209,-372 1209,-372 1209,-636 1209,-636 1209,-642 1203,-648 1197,-648 1197,-648 185,-648 185,-648 179,-648 173,-642 173,-636 173,-636 173,-372 173,-372 173,-366 179,-360 185,-360"/>
<text text-anchor="middle" x="691" y="-628" font-family="Times,serif" font-size="20.00">RaftPoller</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_Poller</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M12,-470C12,-470 141,-470 141,-470 147,-470 153,-476 153,-482 153,-482 153,-540 153,-540 153,-546 147,-552 141,-552 141,-552 12,-552 12,-552 6,-552 0,-546 0,-540 0,-540 0,-482 0,-482 0,-476 6,-470 12,-470"/>
<text text-anchor="middle" x="76.5" y="-532" font-family="Times,serif" font-size="20.00">RaftPoller thread</text>
</g>
<!-- raft_wb_mut -->
<g id="node1" class="node">
<title>raft_wb_mut</title>
<path fill="none" stroke="#1c2123" d="M1175,-792C1175,-792 1112,-792 1112,-792 1106,-792 1100,-786 1100,-780 1100,-780 1100,-768 1100,-768 1100,-762 1106,-756 1112,-756 1112,-756 1175,-756 1175,-756 1181,-756 1187,-762 1187,-768 1187,-768 1187,-780 1187,-780 1187,-786 1181,-792 1175,-792"/>
<text text-anchor="middle" x="1143.5" y="-770.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_wb_mut</text>
</g>
<!-- poll_ctx_engines_raft_consume_and_shrink -->
<g id="node3" class="node">
<title>poll_ctx_engines_raft_consume_and_shrink</title>
<path fill="none" stroke="#1c2123" d="M1259.5,-730.5C1259.5,-730.5 1380.5,-730.5 1380.5,-730.5 1386.5,-730.5 1392.5,-736.5 1392.5,-742.5 1392.5,-742.5 1392.5,-779.5 1392.5,-779.5 1392.5,-785.5 1386.5,-791.5 1380.5,-791.5 1380.5,-791.5 1259.5,-791.5 1259.5,-791.5 1253.5,-791.5 1247.5,-785.5 1247.5,-779.5 1247.5,-779.5 1247.5,-742.5 1247.5,-742.5 1247.5,-736.5 1253.5,-730.5 1259.5,-730.5"/>
<text text-anchor="start" x="1255.5" y="-776.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">poll_ctx.engines.raft</text>
<text text-anchor="middle" x="1320" y="-761.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">.consume_and_shrink()</text>
<polyline fill="none" stroke="#1c2123" points="1247.5,-753.5 1392.5,-753.5 "/>
<text text-anchor="start" x="1255.5" y="-738.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将raft_wb 写入磁盘</text>
</g>
<!-- raft_wb_mut&#45;&gt;poll_ctx_engines_raft_consume_and_shrink -->
<g id="edge2" class="edge">
<title>raft_wb_mut&#45;&gt;poll_ctx_engines_raft_consume_and_shrink</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1187.19,-770.82C1202.29,-769.7 1219.82,-768.39 1237.07,-767.1"/>
<polygon fill="green" stroke="green" points="1237.46,-770.58 1247.18,-766.35 1236.94,-763.6 1237.46,-770.58"/>
</g>
<!-- kv_wb_mut -->
<g id="node2" class="node">
<title>kv_wb_mut</title>
<path fill="none" stroke="#1c2123" d="M1172.5,-738C1172.5,-738 1114.5,-738 1114.5,-738 1108.5,-738 1102.5,-732 1102.5,-726 1102.5,-726 1102.5,-714 1102.5,-714 1102.5,-708 1108.5,-702 1114.5,-702 1114.5,-702 1172.5,-702 1172.5,-702 1178.5,-702 1184.5,-708 1184.5,-714 1184.5,-714 1184.5,-726 1184.5,-726 1184.5,-732 1178.5,-738 1172.5,-738"/>
<text text-anchor="middle" x="1143.5" y="-716.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">kv_wb_mut</text>
</g>
<!-- poll_ctx_kv_wb_write_opt -->
<g id="node4" class="node">
<title>poll_ctx_kv_wb_write_opt</title>
<path fill="none" stroke="#1c2123" d="M1249,-665C1249,-665 1391,-665 1391,-665 1397,-665 1403,-671 1403,-677 1403,-677 1403,-699 1403,-699 1403,-705 1397,-711 1391,-711 1391,-711 1249,-711 1249,-711 1243,-711 1237,-705 1237,-699 1237,-699 1237,-677 1237,-677 1237,-671 1243,-665 1249,-665"/>
<text text-anchor="middle" x="1320" y="-695.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">poll_ctx.kv_wb.write_opt()</text>
<polyline fill="none" stroke="#1c2123" points="1237,-688 1403,-688 "/>
<text text-anchor="start" x="1245" y="-672.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将kv_wb写入磁盘</text>
</g>
<!-- kv_wb_mut&#45;&gt;poll_ctx_kv_wb_write_opt -->
<g id="edge1" class="edge">
<title>kv_wb_mut&#45;&gt;poll_ctx_kv_wb_write_opt</title>
<path fill="none" stroke="#666666" d="M1184.53,-712.66C1197.21,-710.33 1211.78,-707.66 1226.55,-704.95"/>
<polygon fill="#666666" stroke="#666666" points="1227.59,-708.32 1236.79,-703.08 1226.32,-701.44 1227.59,-708.32"/>
</g>
<!-- PeerStorage_handle_raft_ready -->
<g id="node5" class="node">
<title>PeerStorage_handle_raft_ready</title>
<path fill="none" stroke="#1c2123" d="M699,-895.5C699,-895.5 833,-895.5 833,-895.5 839,-895.5 845,-901.5 845,-907.5 845,-907.5 845,-944.5 845,-944.5 845,-950.5 839,-956.5 833,-956.5 833,-956.5 699,-956.5 699,-956.5 693,-956.5 687,-950.5 687,-944.5 687,-944.5 687,-907.5 687,-907.5 687,-901.5 693,-895.5 699,-895.5"/>
<text text-anchor="middle" x="766" y="-941.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_ready</text>
<polyline fill="none" stroke="#1c2123" points="687,-933.5 845,-933.5 "/>
<text text-anchor="start" x="695" y="-918.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将memory states写入raft</text>
<text text-anchor="start" x="695" y="-903.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> write batch</text>
</g>
<!-- save_raft_state_to -->
<g id="node6" class="node">
<title>save_raft_state_to</title>
<path fill="none" stroke="#1c2123" d="M1011,-998C1011,-998 920,-998 920,-998 914,-998 908,-992 908,-986 908,-986 908,-974 908,-974 908,-968 914,-962 920,-962 920,-962 1011,-962 1011,-962 1017,-962 1023,-968 1023,-974 1023,-974 1023,-986 1023,-986 1023,-992 1017,-998 1011,-998"/>
<text text-anchor="middle" x="965.5" y="-976.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">save_raft_state_to</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;save_raft_state_to -->
<g id="edge3" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;save_raft_state_to</title>
<path fill="none" stroke="#666666" d="M845,-950.1C854.41,-952.84 863.91,-955.54 873,-958 881.05,-960.18 889.52,-962.37 897.93,-964.47"/>
<polygon fill="#666666" stroke="#666666" points="897.2,-967.89 907.75,-966.89 898.88,-961.1 897.2,-967.89"/>
</g>
<!-- save_apply_state_to -->
<g id="node7" class="node">
<title>save_apply_state_to</title>
<path fill="none" stroke="#1c2123" d="M1016.5,-944C1016.5,-944 914.5,-944 914.5,-944 908.5,-944 902.5,-938 902.5,-932 902.5,-932 902.5,-920 902.5,-920 902.5,-914 908.5,-908 914.5,-908 914.5,-908 1016.5,-908 1016.5,-908 1022.5,-908 1028.5,-914 1028.5,-920 1028.5,-920 1028.5,-932 1028.5,-932 1028.5,-938 1022.5,-944 1016.5,-944"/>
<text text-anchor="middle" x="965.5" y="-922.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">save_apply_state_to</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;save_apply_state_to -->
<g id="edge4" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;save_apply_state_to</title>
<path fill="none" stroke="#666666" d="M845.06,-926C860.48,-926 876.6,-926 891.83,-926"/>
<polygon fill="#666666" stroke="#666666" points="892.21,-929.5 902.21,-926 892.21,-922.5 892.21,-929.5"/>
</g>
<!-- save_snapshot_raft_state_to -->
<g id="node8" class="node">
<title>save_snapshot_raft_state_to</title>
<path fill="none" stroke="#1c2123" d="M1038,-890C1038,-890 893,-890 893,-890 887,-890 881,-884 881,-878 881,-878 881,-866 881,-866 881,-860 887,-854 893,-854 893,-854 1038,-854 1038,-854 1044,-854 1050,-860 1050,-866 1050,-866 1050,-878 1050,-878 1050,-884 1044,-890 1038,-890"/>
<text text-anchor="middle" x="965.5" y="-868.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">save_snapshot_raft_state_to</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;save_snapshot_raft_state_to -->
<g id="edge5" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;save_snapshot_raft_state_to</title>
<path fill="none" stroke="#666666" d="M845.06,-904.66C859.42,-900.73 874.4,-896.63 888.7,-892.72"/>
<polygon fill="#666666" stroke="#666666" points="889.76,-896.07 898.48,-890.05 887.91,-889.31 889.76,-896.07"/>
</g>
<!-- append -->
<g id="node9" class="node">
<title>append</title>
<path fill="none" stroke="#1c2123" d="M915,-1044.5C915,-1044.5 1016,-1044.5 1016,-1044.5 1022,-1044.5 1028,-1050.5 1028,-1056.5 1028,-1056.5 1028,-1093.5 1028,-1093.5 1028,-1099.5 1022,-1105.5 1016,-1105.5 1016,-1105.5 915,-1105.5 915,-1105.5 909,-1105.5 903,-1099.5 903,-1093.5 903,-1093.5 903,-1056.5 903,-1056.5 903,-1050.5 909,-1044.5 915,-1044.5"/>
<text text-anchor="middle" x="965.5" y="-1090.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">append</text>
<polyline fill="none" stroke="#1c2123" points="903,-1082.5 1028,-1082.5 "/>
<text text-anchor="start" x="911" y="-1067.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将ready中的entries</text>
<text text-anchor="start" x="911" y="-1052.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入raft_wb</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;append -->
<g id="edge6" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;append</title>
<path fill="none" stroke="#666666" d="M788.99,-956.54C808.57,-981.85 839.28,-1017.25 873,-1040 879.34,-1044.28 886.29,-1048.14 893.42,-1051.59"/>
<polygon fill="#666666" stroke="#666666" points="891.97,-1054.78 902.52,-1055.74 894.88,-1048.41 891.97,-1054.78"/>
</g>
<!-- save_raft_state_to&#45;&gt;raft_wb_mut -->
<g id="edge8" class="edge">
<title>save_raft_state_to&#45;&gt;raft_wb_mut</title>
<path fill="none" stroke="#666666" d="M1023.42,-974.62C1035.82,-971.3 1048.16,-966.09 1058,-958 1106.98,-917.73 1128.89,-842.86 1137.56,-802.14"/>
<polygon fill="#666666" stroke="#666666" points="1141.04,-802.58 1139.57,-792.09 1134.18,-801.21 1141.04,-802.58"/>
</g>
<!-- save_apply_state_to&#45;&gt;kv_wb_mut -->
<g id="edge9" class="edge">
<title>save_apply_state_to&#45;&gt;kv_wb_mut</title>
<path fill="none" stroke="#666666" d="M1028.65,-919.1C1039.25,-915.77 1049.54,-910.95 1058,-904 1106.98,-863.73 1128.89,-788.86 1137.56,-748.14"/>
<polygon fill="#666666" stroke="#666666" points="1141.04,-748.58 1139.57,-738.09 1134.18,-747.21 1141.04,-748.58"/>
</g>
<!-- save_snapshot_raft_state_to&#45;&gt;kv_wb_mut -->
<g id="edge10" class="edge">
<title>save_snapshot_raft_state_to&#45;&gt;kv_wb_mut</title>
<path fill="none" stroke="#666666" d="M1050.04,-854.95C1052.8,-853.44 1055.46,-851.79 1058,-850 1094.34,-824.32 1118.98,-777.6 1131.88,-747.72"/>
<polygon fill="#666666" stroke="#666666" points="1135.2,-748.86 1135.81,-738.28 1128.73,-746.17 1135.2,-748.86"/>
</g>
<!-- append&#45;&gt;raft_wb_mut -->
<g id="edge7" class="edge">
<title>append&#45;&gt;raft_wb_mut</title>
<path fill="none" stroke="#666666" d="M1028.28,-1060.13C1039.28,-1055.2 1049.83,-1048.66 1058,-1040 1122.1,-972.09 1137.58,-855.67 1141.31,-802.27"/>
<polygon fill="#666666" stroke="#666666" points="1144.81,-802.37 1141.93,-792.17 1137.83,-801.94 1144.81,-802.37"/>
</g>
<!-- post_ready -->
<g id="node10" class="node">
<title>post_ready</title>
<path fill="none" stroke="#1c2123" d="M1660,-847C1660,-847 1839,-847 1839,-847 1845,-847 1851,-853 1851,-859 1851,-859 1851,-979 1851,-979 1851,-985 1845,-991 1839,-991 1839,-991 1660,-991 1660,-991 1654,-991 1648,-985 1648,-979 1648,-979 1648,-859 1648,-859 1648,-853 1654,-847 1660,-847"/>
<text text-anchor="middle" x="1749.5" y="-975.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">post_ready</text>
<polyline fill="none" stroke="#1c2123" points="1648,-968 1851,-968 "/>
<text text-anchor="start" x="1656" y="-952.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">update memory state after</text>
<text text-anchor="start" x="1656" y="-937.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ready changed are flushed </text>
<text text-anchor="start" x="1656" y="-922.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> to disk successfully</text>
<polyline fill="none" stroke="#1c2123" points="1648,-915 1851,-915 "/>
<text text-anchor="start" x="1656" y="-899.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.raft_state = ctx.raft_state</text>
<text text-anchor="start" x="1656" y="-884.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> self.apply_state = ctx.apply_state</text>
<text text-anchor="start" x="1656" y="-869.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> self.last_term = ctx.last_term</text>
<text text-anchor="middle" x="1749.5" y="-854.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ...</text>
</g>
<!-- handle_raft_ready_append -->
<g id="node11" class="node">
<title>handle_raft_ready_append</title>
<path fill="none" stroke="#1c2123" d="M636,-170C636,-170 499,-170 499,-170 493,-170 487,-164 487,-158 487,-158 487,-146 487,-146 487,-140 493,-134 499,-134 499,-134 636,-134 636,-134 642,-134 648,-140 648,-146 648,-146 648,-158 648,-158 648,-164 642,-170 636,-170"/>
<text text-anchor="middle" x="567.5" y="-148.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_ready_append</text>
</g>
<!-- handle_raft_ready_append&#45;&gt;PeerStorage_handle_raft_ready -->
<g id="edge11" class="edge">
<title>handle_raft_ready_append&#45;&gt;PeerStorage_handle_raft_ready</title>
<path fill="none" stroke="#666666" d="M568.84,-170.02C571.11,-271.76 586.89,-773.86 679,-891 679.21,-891.27 679.43,-891.54 679.65,-891.81"/>
<polygon fill="#666666" stroke="#666666" points="677.18,-894.29 686.65,-899.04 682.21,-889.42 677.18,-894.29"/>
</g>
<!-- raft_group_ready -->
<g id="node12" class="node">
<title>raft_group_ready</title>
<path fill="none" stroke="#1c2123" d="M703,-70.5C703,-70.5 829,-70.5 829,-70.5 835,-70.5 841,-76.5 841,-82.5 841,-82.5 841,-119.5 841,-119.5 841,-125.5 835,-131.5 829,-131.5 829,-131.5 703,-131.5 703,-131.5 697,-131.5 691,-125.5 691,-119.5 691,-119.5 691,-82.5 691,-82.5 691,-76.5 697,-70.5 703,-70.5"/>
<text text-anchor="middle" x="766" y="-116.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.raft_group.ready()</text>
<polyline fill="none" stroke="#1c2123" points="691,-108.5 841,-108.5 "/>
<text text-anchor="start" x="699" y="-93.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取raft_group ready的</text>
<text text-anchor="middle" x="766" y="-78.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> log entries等信息</text>
</g>
<!-- handle_raft_ready_append&#45;&gt;raft_group_ready -->
<g id="edge12" class="edge">
<title>handle_raft_ready_append&#45;&gt;raft_group_ready</title>
<path fill="none" stroke="#666666" d="M638.06,-133.95C651.96,-130.34 666.7,-126.51 681.03,-122.79"/>
<polygon fill="#666666" stroke="#666666" points="682.07,-126.14 690.87,-120.24 680.31,-119.36 682.07,-126.14"/>
</g>
<!-- peer_post_raft_ready_append -->
<g id="node13" class="node">
<title>peer_post_raft_ready_append</title>
<path fill="none" stroke="#1c2123" d="M1451,-123C1451,-123 1600,-123 1600,-123 1606,-123 1612,-129 1612,-135 1612,-135 1612,-157 1612,-157 1612,-163 1606,-169 1600,-169 1600,-169 1451,-169 1451,-169 1445,-169 1439,-163 1439,-157 1439,-157 1439,-135 1439,-135 1439,-129 1445,-123 1451,-123"/>
<text text-anchor="middle" x="1525.5" y="-153.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">post_raft_ready_append</text>
<polyline fill="none" stroke="#1c2123" points="1439,-146 1612,-146 "/>
<text text-anchor="start" x="1447" y="-130.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft ready 写入磁盘后回调</text>
</g>
<!-- peer_post_raft_ready_append&#45;&gt;post_ready -->
<g id="edge13" class="edge">
<title>peer_post_raft_ready_append&#45;&gt;post_ready</title>
<path fill="none" stroke="#666666" d="M1533.14,-169.13C1561.75,-268.75 1675.23,-663.88 1724.95,-837.01"/>
<polygon fill="#666666" stroke="#666666" points="1721.65,-838.19 1727.78,-846.84 1728.38,-836.26 1721.65,-838.19"/>
</g>
<!-- Peer_propose -->
<g id="node14" class="node">
<title>Peer_propose</title>
<path fill="none" stroke="#1c2123" d="M496,-43C496,-43 639,-43 639,-43 645,-43 651,-49 651,-55 651,-55 651,-77 651,-77 651,-83 645,-89 639,-89 639,-89 496,-89 496,-89 490,-89 484,-83 484,-77 484,-77 484,-55 484,-55 484,-49 490,-43 496,-43"/>
<text text-anchor="middle" x="567.5" y="-73.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">propose</text>
<polyline fill="none" stroke="#1c2123" points="484,-66 651,-66 "/>
<text text-anchor="start" x="492" y="-50.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理RaftCmdRequest消息</text>
</g>
<!-- propose_normal -->
<g id="node15" class="node">
<title>propose_normal</title>
<path fill="none" stroke="#1c2123" d="M806.5,-52C806.5,-52 725.5,-52 725.5,-52 719.5,-52 713.5,-46 713.5,-40 713.5,-40 713.5,-28 713.5,-28 713.5,-22 719.5,-16 725.5,-16 725.5,-16 806.5,-16 806.5,-16 812.5,-16 818.5,-22 818.5,-28 818.5,-28 818.5,-40 818.5,-40 818.5,-46 812.5,-52 806.5,-52"/>
<text text-anchor="middle" x="766" y="-30.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">propose_normal</text>
</g>
<!-- Peer_propose&#45;&gt;propose_normal -->
<g id="edge14" class="edge">
<title>Peer_propose&#45;&gt;propose_normal</title>
<path fill="none" stroke="#666666" d="M651.26,-52.52C668.72,-49.68 686.85,-46.73 703.37,-44.04"/>
<polygon fill="#666666" stroke="#666666" points="704.12,-47.46 713.42,-42.4 702.99,-40.55 704.12,-47.46"/>
</g>
<!-- raft_group_propose -->
<g id="node16" class="node">
<title>raft_group_propose</title>
<path fill="none" stroke="#1c2123" d="M913,-71C913,-71 1018,-71 1018,-71 1024,-71 1030,-77 1030,-83 1030,-83 1030,-95 1030,-95 1030,-101 1024,-107 1018,-107 1018,-107 913,-107 913,-107 907,-107 901,-101 901,-95 901,-95 901,-83 901,-83 901,-77 907,-71 913,-71"/>
<text text-anchor="middle" x="965.5" y="-85.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_group.propose()</text>
</g>
<!-- propose_normal&#45;&gt;raft_group_propose -->
<g id="edge15" class="edge">
<title>propose_normal&#45;&gt;raft_group_propose</title>
<path fill="none" stroke="#666666" d="M818.63,-48.38C840.73,-54.53 866.94,-61.83 891.01,-68.53"/>
<polygon fill="#666666" stroke="#666666" points="890.25,-71.95 900.82,-71.27 892.12,-65.21 890.25,-71.95"/>
</g>
<!-- collect_ready -->
<g id="node17" class="node">
<title>collect_ready</title>
<path fill="none" stroke="#1c2123" d="M436,-314C436,-314 371,-314 371,-314 365,-314 359,-308 359,-302 359,-302 359,-290 359,-290 359,-284 365,-278 371,-278 371,-278 436,-278 436,-278 442,-278 448,-284 448,-290 448,-290 448,-302 448,-302 448,-308 442,-314 436,-314"/>
<text text-anchor="middle" x="403.5" y="-292.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">collect_ready</text>
</g>
<!-- collect_ready&#45;&gt;handle_raft_ready_append -->
<g id="edge16" class="edge">
<title>collect_ready&#45;&gt;handle_raft_ready_append</title>
<path fill="none" stroke="#666666" d="M435.51,-277.95C439.81,-275.1 444.09,-272.08 448,-269 483.86,-240.75 520.57,-202.83 543.43,-177.93"/>
<polygon fill="#666666" stroke="#666666" points="546.21,-180.08 550.35,-170.32 541.03,-175.36 546.21,-180.08"/>
</g>
<!-- post_raft_ready_append -->
<g id="node18" class="node">
<title>post_raft_ready_append</title>
<path fill="none" stroke="#1c2123" d="M1381.5,-287C1381.5,-287 1258.5,-287 1258.5,-287 1252.5,-287 1246.5,-281 1246.5,-275 1246.5,-275 1246.5,-263 1246.5,-263 1246.5,-257 1252.5,-251 1258.5,-251 1258.5,-251 1381.5,-251 1381.5,-251 1387.5,-251 1393.5,-257 1393.5,-263 1393.5,-263 1393.5,-275 1393.5,-275 1393.5,-281 1387.5,-287 1381.5,-287"/>
<text text-anchor="middle" x="1320" y="-265.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">post_raft_ready_append</text>
</g>
<!-- post_raft_ready_append&#45;&gt;peer_post_raft_ready_append -->
<g id="edge17" class="edge">
<title>post_raft_ready_append&#45;&gt;peer_post_raft_ready_append</title>
<path fill="none" stroke="#666666" d="M1393.87,-254.49C1399.8,-252.32 1405.59,-249.84 1411,-247 1444.78,-229.26 1476.62,-199.33 1497.93,-176.64"/>
<polygon fill="#666666" stroke="#666666" points="1500.54,-178.97 1504.74,-169.25 1495.39,-174.23 1500.54,-178.97"/>
</g>
<!-- handle_msgs -->
<g id="node19" class="node">
<title>handle_msgs</title>
<path fill="none" stroke="#1c2123" d="M435.5,-260C435.5,-260 371.5,-260 371.5,-260 365.5,-260 359.5,-254 359.5,-248 359.5,-248 359.5,-236 359.5,-236 359.5,-230 365.5,-224 371.5,-224 371.5,-224 435.5,-224 435.5,-224 441.5,-224 447.5,-230 447.5,-236 447.5,-236 447.5,-248 447.5,-248 447.5,-254 441.5,-260 435.5,-260"/>
<text text-anchor="middle" x="403.5" y="-238.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_msgs</text>
</g>
<!-- handle_msgs&#45;&gt;Peer_propose -->
<g id="edge18" class="edge">
<title>handle_msgs&#45;&gt;Peer_propose</title>
<path fill="none" stroke="#666666" d="M412.53,-223.67C423.96,-199.09 446.81,-155.05 476,-125 487.04,-113.63 500.65,-103.34 513.93,-94.65"/>
<polygon fill="#666666" stroke="#666666" points="516,-97.49 522.58,-89.18 512.26,-91.57 516,-97.49"/>
</g>
<!-- handle_raft_ready -->
<g id="node20" class="node">
<title>handle_raft_ready</title>
<path fill="none" stroke="#1c2123" d="M1189,-604C1189,-604 1098,-604 1098,-604 1092,-604 1086,-598 1086,-592 1086,-592 1086,-580 1086,-580 1086,-574 1092,-568 1098,-568 1098,-568 1189,-568 1189,-568 1195,-568 1201,-574 1201,-580 1201,-580 1201,-592 1201,-592 1201,-598 1195,-604 1189,-604"/>
<text text-anchor="middle" x="1143.5" y="-582.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_ready</text>
</g>
<!-- handle_raft_ready&#45;&gt;poll_ctx_engines_raft_consume_and_shrink -->
<g id="edge19" class="edge">
<title>handle_raft_ready&#45;&gt;poll_ctx_engines_raft_consume_and_shrink</title>
<path fill="none" stroke="#666666" d="M1152.35,-604.37C1165.74,-633.74 1195.61,-691.48 1237,-726 1237.6,-726.5 1238.21,-727 1238.83,-727.49"/>
<polygon fill="#666666" stroke="#666666" points="1237.08,-730.54 1247.25,-733.51 1241.15,-724.85 1237.08,-730.54"/>
</g>
<!-- handle_raft_ready&#45;&gt;poll_ctx_kv_wb_write_opt -->
<g id="edge20" class="edge">
<title>handle_raft_ready&#45;&gt;poll_ctx_kv_wb_write_opt</title>
<path fill="none" stroke="#666666" d="M1163.28,-604.31C1181.04,-620.77 1209.05,-644.66 1237,-660 1237.2,-660.11 1237.4,-660.22 1237.59,-660.32"/>
<polygon fill="#666666" stroke="#666666" points="1236.32,-663.6 1246.83,-664.97 1239.47,-657.35 1236.32,-663.6"/>
</g>
<!-- handle_raft_ready&#45;&gt;post_raft_ready_append -->
<g id="edge21" class="edge">
<title>handle_raft_ready&#45;&gt;post_raft_ready_append</title>
<path fill="none" stroke="#666666" d="M1201.2,-570.23C1204,-568.38 1206.62,-566.31 1209,-564 1285.95,-489.19 1309.57,-355.6 1316.4,-297.4"/>
<polygon fill="#666666" stroke="#666666" points="1319.92,-297.45 1317.52,-287.13 1312.96,-296.69 1319.92,-297.45"/>
</g>
<!-- end -->
<g id="node21" class="node">
<title>end</title>
<path fill="none" stroke="#1c2123" d="M198.5,-533C198.5,-533 305.5,-533 305.5,-533 311.5,-533 317.5,-539 317.5,-545 317.5,-545 317.5,-597 317.5,-597 317.5,-603 311.5,-609 305.5,-609 305.5,-609 198.5,-609 198.5,-609 192.5,-609 186.5,-603 186.5,-597 186.5,-597 186.5,-545 186.5,-545 186.5,-539 192.5,-533 198.5,-533"/>
<text text-anchor="middle" x="252" y="-593.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">end</text>
<polyline fill="none" stroke="#1c2123" points="186.5,-586 317.5,-586 "/>
<text text-anchor="start" x="194.5" y="-570.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">整批消息处理完毕</text>
<text text-anchor="start" x="194.5" y="-555.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将write batch批量</text>
<text text-anchor="start" x="194.5" y="-540.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入磁盘</text>
</g>
<!-- end&#45;&gt;handle_raft_ready -->
<g id="edge22" class="edge">
<title>end&#45;&gt;handle_raft_ready</title>
<path fill="none" stroke="#666666" d="M317.54,-572.63C380.92,-574.09 480.36,-576 566.5,-576 566.5,-576 566.5,-576 767,-576 875.06,-576 1000.56,-580.19 1075.64,-583.15"/>
<polygon fill="#666666" stroke="#666666" points="1075.76,-586.65 1085.89,-583.55 1076.04,-579.66 1075.76,-586.65"/>
</g>
<!-- begin -->
<g id="node22" class="node">
<title>begin</title>
<path fill="none" stroke="#1c2123" d="M267,-514C267,-514 237,-514 237,-514 231,-514 225,-508 225,-502 225,-502 225,-490 225,-490 225,-484 231,-478 237,-478 237,-478 267,-478 267,-478 273,-478 279,-484 279,-490 279,-490 279,-502 279,-502 279,-508 273,-514 267,-514"/>
<text text-anchor="middle" x="252" y="-492.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">begin</text>
</g>
<!-- handle_normal -->
<g id="node23" class="node">
<title>handle_normal</title>
<path fill="none" stroke="#1c2123" d="M193,-368.5C193,-368.5 311,-368.5 311,-368.5 317,-368.5 323,-374.5 323,-380.5 323,-380.5 323,-447.5 323,-447.5 323,-453.5 317,-459.5 311,-459.5 311,-459.5 193,-459.5 193,-459.5 187,-459.5 181,-453.5 181,-447.5 181,-447.5 181,-380.5 181,-380.5 181,-374.5 187,-368.5 193,-368.5"/>
<text text-anchor="middle" x="252" y="-444.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_normal</text>
<polyline fill="none" stroke="#1c2123" points="181,-436.5 323,-436.5 "/>
<text text-anchor="start" x="189" y="-421.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">在begin,end之间</text>
<text text-anchor="start" x="189" y="-406.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 会被多次调用</text>
<text text-anchor="start" x="189" y="-391.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将state, log entries 等</text>
<text text-anchor="start" x="189" y="-376.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入write_batch中</text>
</g>
<!-- handle_normal&#45;&gt;collect_ready -->
<g id="edge23" class="edge">
<title>handle_normal&#45;&gt;collect_ready</title>
<path fill="none" stroke="#666666" d="M310.8,-368.38C331.42,-352.1 353.85,-334.4 371.37,-320.57"/>
<polygon fill="#666666" stroke="#666666" points="373.87,-323.06 379.55,-314.12 369.53,-317.56 373.87,-323.06"/>
</g>
<!-- handle_normal&#45;&gt;handle_msgs -->
<g id="edge24" class="edge">
<title>handle_normal&#45;&gt;handle_msgs</title>
<path fill="none" stroke="#666666" d="M275.97,-368.46C293.33,-337.48 319.52,-297.15 351,-269 352.13,-267.99 353.3,-267.01 354.51,-266.05"/>
<polygon fill="#666666" stroke="#666666" points="356.76,-268.74 362.91,-260.11 352.72,-263.03 356.76,-268.74"/>
</g>
<!-- poll -->
<g id="node24" class="node">
<title>poll</title>
<path fill="none" stroke="#1c2123" d="M91,-514C91,-514 61,-514 61,-514 55,-514 49,-508 49,-502 49,-502 49,-490 49,-490 49,-484 55,-478 61,-478 61,-478 91,-478 91,-478 97,-478 103,-484 103,-490 103,-490 103,-502 103,-502 103,-508 97,-514 91,-514"/>
<text text-anchor="middle" x="76" y="-492.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">poll</text>
</g>
<!-- poll&#45;&gt;end -->
<g id="edge25" class="edge">
<title>poll&#45;&gt;end</title>
<path fill="none" stroke="#666666" d="M103.05,-507.23C122.72,-515.71 150.76,-527.79 177.14,-539.16"/>
<polygon fill="#666666" stroke="#666666" points="175.82,-542.41 186.39,-543.15 178.59,-535.98 175.82,-542.41"/>
</g>
<!-- poll&#45;&gt;begin -->
<g id="edge26" class="edge">
<title>poll&#45;&gt;begin</title>
<path fill="none" stroke="#666666" d="M103.05,-496C132.65,-496 181.16,-496 214.52,-496"/>
<polygon fill="#666666" stroke="#666666" points="214.77,-499.5 224.77,-496 214.77,-492.5 214.77,-499.5"/>
</g>
<!-- poll&#45;&gt;handle_normal -->
<g id="edge27" class="edge">
<title>poll&#45;&gt;handle_normal</title>
<path fill="none" stroke="#666666" d="M103.05,-483.72C121.37,-475.09 146.94,-463.04 171.68,-451.38"/>
<polygon fill="#666666" stroke="#666666" points="173.19,-454.54 180.74,-447.11 170.2,-448.21 173.19,-454.54"/>
</g>
</g>
</svg>
