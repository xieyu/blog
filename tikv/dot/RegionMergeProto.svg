<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: region_merge_protps Pages: 1 -->
<svg width="1172pt" height="555pt"
 viewBox="0.00 0.00 1172.00 555.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 551)">
<title>region_merge_protps</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-551 1168,-551 1168,4 -4,4"/>
<!-- CommitMergeRequest -->
<g id="node1" class="node">
<title>CommitMergeRequest</title>
<path fill="none" stroke="#1c2123" d="M469,-120.5C469,-120.5 649,-120.5 649,-120.5 655,-120.5 661,-126.5 661,-132.5 661,-132.5 661,-200.5 661,-200.5 661,-206.5 655,-212.5 649,-212.5 649,-212.5 469,-212.5 469,-212.5 463,-212.5 457,-206.5 457,-200.5 457,-200.5 457,-132.5 457,-132.5 457,-126.5 463,-120.5 469,-120.5"/>
<text text-anchor="middle" x="559" y="-197.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">CommitMergeRequest</text>
<polyline fill="none" stroke="#1c2123" points="457,-189.5 661,-189.5 "/>
<text text-anchor="start" x="465" y="-174.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">metapb.Region source = 1;</text>
<polyline fill="none" stroke="#1c2123" points="457,-166.5 661,-166.5 "/>
<text text-anchor="start" x="465" y="-151.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 commit = 2;</text>
<polyline fill="none" stroke="#1c2123" points="457,-143.5 661,-143.5 "/>
<text text-anchor="start" x="465" y="-128.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">repeated eraftpb.Entry entries = 3;</text>
</g>
<!-- Region -->
<g id="node2" class="node">
<title>Region</title>
<path fill="none" stroke="#1c2123" d="M709,-195.5C709,-195.5 987,-195.5 987,-195.5 993,-195.5 999,-201.5 999,-207.5 999,-207.5 999,-367.5 999,-367.5 999,-373.5 993,-379.5 987,-379.5 987,-379.5 709,-379.5 709,-379.5 703,-379.5 697,-373.5 697,-367.5 697,-367.5 697,-207.5 697,-207.5 697,-201.5 703,-195.5 709,-195.5"/>
<text text-anchor="middle" x="848" y="-364.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Region</text>
<polyline fill="none" stroke="#1c2123" points="697,-356.5 999,-356.5 "/>
<text text-anchor="start" x="705" y="-341.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">要merge的target region</text>
<polyline fill="none" stroke="#1c2123" points="697,-333.5 999,-333.5 "/>
<text text-anchor="start" x="705" y="-318.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 id = 1;</text>
<polyline fill="none" stroke="#1c2123" points="697,-310.5 999,-310.5 "/>
<text text-anchor="start" x="705" y="-295.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">bytes start_key = 2;</text>
<polyline fill="none" stroke="#1c2123" points="697,-287.5 999,-287.5 "/>
<text text-anchor="start" x="705" y="-272.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">bytes end_key = 3;</text>
<polyline fill="none" stroke="#1c2123" points="697,-264.5 999,-264.5 "/>
<text text-anchor="start" x="705" y="-249.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RegionEpoch region_epoch = 4;</text>
<polyline fill="none" stroke="#1c2123" points="697,-241.5 999,-241.5 "/>
<text text-anchor="start" x="705" y="-226.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">repeated Peer peers = 5;</text>
<polyline fill="none" stroke="#1c2123" points="697,-218.5 999,-218.5 "/>
<text text-anchor="start" x="705" y="-203.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">encryptionpb.EncryptionMeta encryption_meta = 6;</text>
</g>
<!-- CommitMergeRequest&#45;&gt;Region -->
<g id="edge1" class="edge">
<title>CommitMergeRequest&#45;&gt;Region</title>
<path fill="none" stroke="#666666" d="M661.19,-209.16C669.81,-212.8 678.66,-216.53 687.59,-220.29"/>
<polygon fill="#666666" stroke="#666666" points="686.35,-223.57 696.92,-224.23 689.07,-217.12 686.35,-223.57"/>
</g>
<!-- Entry -->
<g id="node3" class="node">
<title>Entry</title>
<path fill="none" stroke="#1c2123" d="M786.5,-115C786.5,-115 909.5,-115 909.5,-115 915.5,-115 921.5,-121 921.5,-127 921.5,-127 921.5,-164 921.5,-164 921.5,-170 915.5,-176 909.5,-176 909.5,-176 786.5,-176 786.5,-176 780.5,-176 774.5,-170 774.5,-164 774.5,-164 774.5,-127 774.5,-127 774.5,-121 780.5,-115 786.5,-115"/>
<text text-anchor="middle" x="848" y="-160.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Entry</text>
<polyline fill="none" stroke="#1c2123" points="774.5,-153 921.5,-153 "/>
<text text-anchor="start" x="782.5" y="-137.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">source region要补齐的</text>
<text text-anchor="start" x="782.5" y="-122.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> log entries</text>
</g>
<!-- CommitMergeRequest&#45;&gt;Entry -->
<g id="edge2" class="edge">
<title>CommitMergeRequest&#45;&gt;Entry</title>
<path fill="none" stroke="#666666" d="M661.19,-159.1C694.82,-156.63 731.87,-153.92 763.97,-151.58"/>
<polygon fill="#666666" stroke="#666666" points="764.5,-155.05 774.21,-150.83 763.99,-148.06 764.5,-155.05"/>
</g>
<!-- RegionEpoch -->
<g id="node12" class="node">
<title>RegionEpoch</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M1047,-303C1047,-303 1152,-303 1152,-303 1158,-303 1164,-309 1164,-315 1164,-315 1164,-360 1164,-360 1164,-366 1158,-372 1152,-372 1152,-372 1047,-372 1047,-372 1041,-372 1035,-366 1035,-360 1035,-360 1035,-315 1035,-315 1035,-309 1041,-303 1047,-303"/>
<text text-anchor="middle" x="1099.5" y="-356.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RegionEpoch</text>
<polyline fill="none" stroke="#8a8898" points="1035,-349 1164,-349 "/>
<text text-anchor="start" x="1043" y="-333.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">uint64 conf_ver = 1;</text>
<polyline fill="none" stroke="#8a8898" points="1035,-326 1164,-326 "/>
<text text-anchor="start" x="1043" y="-310.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">uint64 version = 2;</text>
</g>
<!-- Region&#45;&gt;RegionEpoch -->
<g id="edge12" class="edge">
<title>Region&#45;&gt;RegionEpoch</title>
<path fill="none" stroke="#666666" d="M999.17,-317.6C1007.98,-319.36 1016.61,-321.09 1024.87,-322.75"/>
<polygon fill="#666666" stroke="#666666" points="1024.27,-326.19 1034.76,-324.73 1025.65,-319.33 1024.27,-326.19"/>
</g>
<!-- Peer -->
<g id="node13" class="node">
<title>Peer</title>
<path fill="none" stroke="#1c2123" d="M1049,-191.5C1049,-191.5 1150,-191.5 1150,-191.5 1156,-191.5 1162,-197.5 1162,-203.5 1162,-203.5 1162,-271.5 1162,-271.5 1162,-277.5 1156,-283.5 1150,-283.5 1150,-283.5 1049,-283.5 1049,-283.5 1043,-283.5 1037,-277.5 1037,-271.5 1037,-271.5 1037,-203.5 1037,-203.5 1037,-197.5 1043,-191.5 1049,-191.5"/>
<text text-anchor="middle" x="1099.5" y="-268.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<polyline fill="none" stroke="#1c2123" points="1037,-260.5 1162,-260.5 "/>
<text text-anchor="start" x="1045" y="-245.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 id = 1;</text>
<polyline fill="none" stroke="#1c2123" points="1037,-237.5 1162,-237.5 "/>
<text text-anchor="start" x="1045" y="-222.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 store_id = 2;</text>
<polyline fill="none" stroke="#1c2123" points="1037,-214.5 1162,-214.5 "/>
<text text-anchor="start" x="1045" y="-199.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerRole role = 3;</text>
</g>
<!-- Region&#45;&gt;Peer -->
<g id="edge13" class="edge">
<title>Region&#45;&gt;Peer</title>
<path fill="none" stroke="#666666" d="M999.17,-257.4C1008.77,-255.48 1018.16,-253.6 1027.1,-251.81"/>
<polygon fill="#666666" stroke="#666666" points="1027.87,-255.22 1036.99,-249.83 1026.49,-248.36 1027.87,-255.22"/>
</g>
<!-- MergeState -->
<g id="node4" class="node">
<title>MergeState</title>
<path fill="none" stroke="#1c2123" d="M490.5,-454.5C490.5,-454.5 627.5,-454.5 627.5,-454.5 633.5,-454.5 639.5,-460.5 639.5,-466.5 639.5,-466.5 639.5,-534.5 639.5,-534.5 639.5,-540.5 633.5,-546.5 627.5,-546.5 627.5,-546.5 490.5,-546.5 490.5,-546.5 484.5,-546.5 478.5,-540.5 478.5,-534.5 478.5,-534.5 478.5,-466.5 478.5,-466.5 478.5,-460.5 484.5,-454.5 490.5,-454.5"/>
<text text-anchor="middle" x="559" y="-531.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">MergeState</text>
<polyline fill="none" stroke="#1c2123" points="478.5,-523.5 639.5,-523.5 "/>
<text text-anchor="start" x="486.5" y="-508.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 min_index = 1;</text>
<polyline fill="none" stroke="#1c2123" points="478.5,-500.5 639.5,-500.5 "/>
<text text-anchor="start" x="486.5" y="-485.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">metapb.Region target = 2;</text>
<polyline fill="none" stroke="#1c2123" points="478.5,-477.5 639.5,-477.5 "/>
<text text-anchor="start" x="486.5" y="-462.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 commit = 3;</text>
</g>
<!-- MergeState&#45;&gt;Region -->
<g id="edge3" class="edge">
<title>MergeState&#45;&gt;Region</title>
<path fill="none" stroke="#666666" d="M639.74,-458.22C647.04,-453.77 654.23,-449.17 661,-444.5 686.58,-426.86 712.82,-406.4 737.22,-386.19"/>
<polygon fill="#666666" stroke="#666666" points="739.63,-388.74 745.07,-379.64 735.15,-383.36 739.63,-388.74"/>
</g>
<!-- PrepareMergeRequest -->
<g id="node5" class="node">
<title>PrepareMergeRequest</title>
<path fill="none" stroke="#1c2123" d="M490.5,-232C490.5,-232 627.5,-232 627.5,-232 633.5,-232 639.5,-238 639.5,-244 639.5,-244 639.5,-289 639.5,-289 639.5,-295 633.5,-301 627.5,-301 627.5,-301 490.5,-301 490.5,-301 484.5,-301 478.5,-295 478.5,-289 478.5,-289 478.5,-244 478.5,-244 478.5,-238 484.5,-232 490.5,-232"/>
<text text-anchor="middle" x="559" y="-285.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PerpareMergeRequest</text>
<polyline fill="none" stroke="#1c2123" points="478.5,-278 639.5,-278 "/>
<text text-anchor="start" x="486.5" y="-262.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 min_index = 1;</text>
<polyline fill="none" stroke="#1c2123" points="478.5,-255 639.5,-255 "/>
<text text-anchor="start" x="486.5" y="-239.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">metapb.Region target = 2;</text>
</g>
<!-- PrepareMergeRequest&#45;&gt;Region -->
<g id="edge4" class="edge">
<title>PrepareMergeRequest&#45;&gt;Region</title>
<path fill="none" stroke="#666666" d="M639.56,-272.32C654.4,-273.41 670.38,-274.58 686.66,-275.77"/>
<polygon fill="#666666" stroke="#666666" points="686.6,-279.27 696.82,-276.51 687.11,-272.29 686.6,-279.27"/>
</g>
<!-- PeerState -->
<g id="node6" class="node">
<title>PeerState</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M519,-320C519,-320 599,-320 599,-320 605,-320 611,-326 611,-332 611,-332 611,-423 611,-423 611,-429 605,-435 599,-435 599,-435 519,-435 519,-435 513,-435 507,-429 507,-423 507,-423 507,-332 507,-332 507,-326 513,-320 519,-320"/>
<text text-anchor="middle" x="559" y="-419.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">PeerState</text>
<polyline fill="none" stroke="#8a8898" points="507,-412 611,-412 "/>
<text text-anchor="start" x="515" y="-396.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Normal = 0;</text>
<polyline fill="none" stroke="#8a8898" points="507,-389 611,-389 "/>
<text text-anchor="start" x="515" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Applying = 1;</text>
<polyline fill="none" stroke="#8a8898" points="507,-366 611,-366 "/>
<text text-anchor="start" x="515" y="-350.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Tombstone = 2;</text>
<polyline fill="none" stroke="#8a8898" points="507,-343 611,-343 "/>
<text text-anchor="start" x="515" y="-327.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Merging = 3;</text>
</g>
<!-- RaftLocalState -->
<g id="node7" class="node">
<title>RaftLocalState</title>
<path fill="none" stroke="#1c2123" d="M257,-392.5C257,-392.5 409,-392.5 409,-392.5 415,-392.5 421,-398.5 421,-404.5 421,-404.5 421,-472.5 421,-472.5 421,-478.5 415,-484.5 409,-484.5 409,-484.5 257,-484.5 257,-484.5 251,-484.5 245,-478.5 245,-472.5 245,-472.5 245,-404.5 245,-404.5 245,-398.5 251,-392.5 257,-392.5"/>
<text text-anchor="middle" x="333" y="-469.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLocalState</text>
<polyline fill="none" stroke="#1c2123" points="245,-461.5 421,-461.5 "/>
<text text-anchor="start" x="253" y="-446.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerState state = 1;</text>
<polyline fill="none" stroke="#1c2123" points="245,-438.5 421,-438.5 "/>
<text text-anchor="start" x="253" y="-423.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">metapb.Region region = 2;</text>
<polyline fill="none" stroke="#1c2123" points="245,-415.5 421,-415.5 "/>
<text text-anchor="start" x="253" y="-400.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">MergeState merge_state = 3;</text>
</g>
<!-- RaftLocalState&#45;&gt;MergeState -->
<g id="edge5" class="edge">
<title>RaftLocalState&#45;&gt;MergeState</title>
<path fill="none" stroke="#666666" d="M421.25,-462.65C436.66,-466.92 452.74,-471.37 468.23,-475.65"/>
<polygon fill="#666666" stroke="#666666" points="467.73,-479.15 478.3,-478.44 469.6,-472.4 467.73,-479.15"/>
</g>
<!-- RaftLocalState&#45;&gt;PeerState -->
<g id="edge6" class="edge">
<title>RaftLocalState&#45;&gt;PeerState</title>
<path fill="none" stroke="#666666" d="M421.25,-414.74C446.61,-407.83 473.76,-400.44 497.13,-394.08"/>
<polygon fill="#666666" stroke="#666666" points="498.17,-397.42 506.9,-391.42 496.33,-390.67 498.17,-397.42"/>
</g>
<!-- AdminRequest -->
<g id="node8" class="node">
<title>AdminRequest</title>
<path fill="none" stroke="#1c2123" d="M370,-143.5C370,-143.5 296,-143.5 296,-143.5 290,-143.5 284,-137.5 284,-131.5 284,-131.5 284,-119.5 284,-119.5 284,-113.5 290,-107.5 296,-107.5 296,-107.5 370,-107.5 370,-107.5 376,-107.5 382,-113.5 382,-119.5 382,-119.5 382,-131.5 382,-131.5 382,-137.5 376,-143.5 370,-143.5"/>
<text text-anchor="middle" x="333" y="-121.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AdminRequest</text>
</g>
<!-- AdminRequest&#45;&gt;CommitMergeRequest -->
<g id="edge7" class="edge">
<title>AdminRequest&#45;&gt;CommitMergeRequest</title>
<path fill="none" stroke="#666666" d="M382.05,-134.3C401.09,-137.78 423.83,-141.94 446.55,-146.1"/>
<polygon fill="#666666" stroke="#666666" points="446.15,-149.59 456.62,-147.94 447.41,-142.7 446.15,-149.59"/>
</g>
<!-- AdminRequest&#45;&gt;PrepareMergeRequest -->
<g id="edge8" class="edge">
<title>AdminRequest&#45;&gt;PrepareMergeRequest</title>
<path fill="none" stroke="#666666" d="M354.2,-143.79C377.69,-164.45 418.22,-198.21 457,-221.5 461.05,-223.94 465.26,-226.32 469.56,-228.64"/>
<polygon fill="#666666" stroke="#666666" points="468,-231.77 478.49,-233.3 471.25,-225.57 468,-231.77"/>
</g>
<!-- AdminCmdType -->
<g id="node9" class="node">
<title>AdminCmdType</title>
<path fill="none" stroke="#1c2123" d="M602,-101.5C602,-101.5 516,-101.5 516,-101.5 510,-101.5 504,-95.5 504,-89.5 504,-89.5 504,-77.5 504,-77.5 504,-71.5 510,-65.5 516,-65.5 516,-65.5 602,-65.5 602,-65.5 608,-65.5 614,-71.5 614,-77.5 614,-77.5 614,-89.5 614,-89.5 614,-95.5 608,-101.5 602,-101.5"/>
<text text-anchor="middle" x="559" y="-79.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AdminCmdType</text>
</g>
<!-- AdminRequest&#45;&gt;AdminCmdType -->
<g id="edge9" class="edge">
<title>AdminRequest&#45;&gt;AdminCmdType</title>
<path fill="none" stroke="#666666" d="M382.05,-116.49C414.58,-110.39 457.93,-102.26 493.46,-95.6"/>
<polygon fill="#666666" stroke="#666666" points="494.55,-98.96 503.73,-93.67 493.26,-92.08 494.55,-98.96"/>
</g>
<!-- RollbackMergeRequest -->
<g id="node10" class="node">
<title>RollbackMergeRequest</title>
<path fill="none" stroke="#1c2123" d="M498.5,-0.5C498.5,-0.5 619.5,-0.5 619.5,-0.5 625.5,-0.5 631.5,-6.5 631.5,-12.5 631.5,-12.5 631.5,-34.5 631.5,-34.5 631.5,-40.5 625.5,-46.5 619.5,-46.5 619.5,-46.5 498.5,-46.5 498.5,-46.5 492.5,-46.5 486.5,-40.5 486.5,-34.5 486.5,-34.5 486.5,-12.5 486.5,-12.5 486.5,-6.5 492.5,-0.5 498.5,-0.5"/>
<text text-anchor="middle" x="559" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RollbackMergeRequest</text>
<polyline fill="none" stroke="#1c2123" points="486.5,-23.5 631.5,-23.5 "/>
<text text-anchor="start" x="494.5" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">uint64 commit = 1;</text>
</g>
<!-- AdminRequest&#45;&gt;RollbackMergeRequest -->
<g id="edge10" class="edge">
<title>AdminRequest&#45;&gt;RollbackMergeRequest</title>
<path fill="none" stroke="#666666" d="M362.5,-107.4C386.92,-92.41 423.37,-71.26 457,-56.5 463.3,-53.74 469.91,-51.08 476.6,-48.55"/>
<polygon fill="#666666" stroke="#666666" points="478.25,-51.67 486.44,-44.95 475.84,-45.1 478.25,-51.67"/>
</g>
<!-- RaftCmdRequest -->
<g id="node11" class="node">
<title>RaftCmdRequest</title>
<path fill="none" stroke="#1c2123" d="M12,-68C12,-68 197,-68 197,-68 203,-68 209,-74 209,-80 209,-80 209,-171 209,-171 209,-177 203,-183 197,-183 197,-183 12,-183 12,-183 6,-183 0,-177 0,-171 0,-171 0,-80 0,-80 0,-74 6,-68 12,-68"/>
<text text-anchor="middle" x="104.5" y="-167.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCmdRequest</text>
<polyline fill="none" stroke="#1c2123" points="0,-160 209,-160 "/>
<text text-anchor="start" x="8" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftRequestHeader header = 1;</text>
<polyline fill="none" stroke="#1c2123" points="0,-137 209,-137 "/>
<text text-anchor="start" x="8" y="-121.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">repeated Request requests = 2;</text>
<polyline fill="none" stroke="#1c2123" points="0,-114 209,-114 "/>
<text text-anchor="start" x="8" y="-98.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">AdminRequest admin_request = 3;</text>
<polyline fill="none" stroke="#1c2123" points="0,-91 209,-91 "/>
<text text-anchor="start" x="8" y="-75.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">StatusRequest status_request = 4;</text>
</g>
<!-- RaftCmdRequest&#45;&gt;AdminRequest -->
<g id="edge11" class="edge">
<title>RaftCmdRequest&#45;&gt;AdminRequest</title>
<path fill="none" stroke="#666666" d="M209.14,-125.5C231.36,-125.5 254.07,-125.5 273.83,-125.5"/>
<polygon fill="#666666" stroke="#666666" points="273.88,-129 283.88,-125.5 273.88,-122 273.88,-129"/>
</g>
</g>
</svg>
