<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: release_lock Pages: 1 -->
<svg width="1389pt" height="546pt"
 viewBox="0.00 0.00 1389.00 546.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 542)">
<title>release_lock</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-542 1385,-542 1385,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Latch</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M501.5,-8C501.5,-8 1361,-8 1361,-8 1367,-8 1373,-14 1373,-20 1373,-20 1373,-90 1373,-90 1373,-96 1367,-102 1361,-102 1361,-102 501.5,-102 501.5,-102 495.5,-102 489.5,-96 489.5,-90 489.5,-90 489.5,-20 489.5,-20 489.5,-14 495.5,-8 501.5,-8"/>
<text text-anchor="middle" x="931.25" y="-82" font-family="Times,serif" font-size="20.00">Latch</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Latches</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M247,-110C247,-110 1050,-110 1050,-110 1056,-110 1062,-116 1062,-122 1062,-122 1062,-268 1062,-268 1062,-274 1056,-280 1050,-280 1050,-280 247,-280 247,-280 241,-280 235,-274 235,-268 235,-268 235,-122 235,-122 235,-116 241,-110 247,-110"/>
<text text-anchor="middle" x="648.5" y="-260" font-family="Times,serif" font-size="20.00">Latches</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_Scheduler</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-288C20,-288 659,-288 659,-288 665,-288 671,-294 671,-300 671,-300 671,-518 671,-518 671,-524 665,-530 659,-530 659,-530 20,-530 20,-530 14,-530 8,-524 8,-518 8,-518 8,-300 8,-300 8,-294 14,-288 20,-288"/>
<text text-anchor="middle" x="339.5" y="-510" font-family="Times,serif" font-size="20.00">Scheduler</text>
</g>
<!-- Latch -->
<g id="node1" class="node">
<title>Latch</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1102,-17C1102,-17 1353,-17 1353,-17 1359,-17 1365,-23 1365,-29 1365,-29 1365,-51 1365,-51 1365,-57 1359,-63 1353,-63 1353,-63 1102,-63 1102,-63 1096,-63 1090,-57 1090,-51 1090,-51 1090,-29 1090,-29 1090,-23 1096,-17 1102,-17"/>
<text text-anchor="middle" x="1227.5" y="-47.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Latch</text>
<polyline fill="none" stroke="#60b5ac" points="1090,-40 1365,-40 "/>
<text text-anchor="start" x="1098" y="-24.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub waiting: VecDeque&lt;Option&lt;(u64, u64)&gt;&gt;,</text>
</g>
<!-- get_first_req_by_hash -->
<g id="node2" class="node">
<title>get_first_req_by_hash</title>
<path fill="none" stroke="#1c2123" d="M622.5,-64C622.5,-64 509.5,-64 509.5,-64 503.5,-64 497.5,-58 497.5,-52 497.5,-52 497.5,-40 497.5,-40 497.5,-34 503.5,-28 509.5,-28 509.5,-28 622.5,-28 622.5,-28 628.5,-28 634.5,-34 634.5,-40 634.5,-40 634.5,-52 634.5,-52 634.5,-58 628.5,-64 622.5,-64"/>
<text text-anchor="middle" x="566" y="-42.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_first_req_by_hash</text>
</g>
<!-- Latches -->
<g id="node3" class="node">
<title>Latches</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M803,-172.5C803,-172.5 1042,-172.5 1042,-172.5 1048,-172.5 1054,-178.5 1054,-184.5 1054,-184.5 1054,-229.5 1054,-229.5 1054,-235.5 1048,-241.5 1042,-241.5 1042,-241.5 803,-241.5 803,-241.5 797,-241.5 791,-235.5 791,-229.5 791,-229.5 791,-184.5 791,-184.5 791,-178.5 797,-172.5 803,-172.5"/>
<text text-anchor="middle" x="922.5" y="-226.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Latches</text>
<polyline fill="none" stroke="#60b5ac" points="791,-218.5 1054,-218.5 "/>
<text text-anchor="start" x="799" y="-203.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">slots: Vec&lt;CachePadded&lt;Mutex&lt;Latch&gt;&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="791,-195.5 1054,-195.5 "/>
<text text-anchor="start" x="799" y="-180.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">size: usize,</text>
</g>
<!-- Latches&#45;&gt;Latch -->
<g id="edge1" class="edge">
<title>Latches&#45;&gt;Latch</title>
<path fill="none" stroke="#666666" d="M1052.78,-172.41C1055.91,-170.99 1058.99,-169.52 1062,-168 1113.21,-142.12 1164.09,-99.2 1195.41,-70.27"/>
<polygon fill="#666666" stroke="#666666" points="1198.02,-72.62 1202.93,-63.23 1193.24,-67.5 1198.02,-72.62"/>
</g>
<!-- release -->
<g id="node4" class="node">
<title>release</title>
<path fill="none" stroke="#1c2123" d="M255,-118.5C255,-118.5 414,-118.5 414,-118.5 420,-118.5 426,-124.5 426,-130.5 426,-130.5 426,-167.5 426,-167.5 426,-173.5 420,-179.5 414,-179.5 414,-179.5 255,-179.5 255,-179.5 249,-179.5 243,-173.5 243,-167.5 243,-167.5 243,-130.5 243,-130.5 243,-124.5 249,-118.5 255,-118.5"/>
<text text-anchor="middle" x="334.5" y="-164.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">release</text>
<polyline fill="none" stroke="#1c2123" points="243,-156.5 426,-156.5 "/>
<text text-anchor="start" x="251" y="-141.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">release all latches owned by</text>
<text text-anchor="start" x="251" y="-126.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> the lock of command with ID</text>
</g>
<!-- release&#45;&gt;get_first_req_by_hash -->
<g id="edge2" class="edge">
<title>release&#45;&gt;get_first_req_by_hash</title>
<path fill="none" stroke="#666666" d="M403.74,-118.38C439.57,-102.29 482.7,-82.94 515.33,-68.29"/>
<polygon fill="#666666" stroke="#666666" points="516.98,-71.39 524.67,-64.1 514.11,-65 516.98,-71.39"/>
</g>
<!-- lock_latch -->
<g id="node5" class="node">
<title>lock_latch</title>
<path fill="none" stroke="#1c2123" d="M947,-154C947,-154 898,-154 898,-154 892,-154 886,-148 886,-142 886,-142 886,-130 886,-130 886,-124 892,-118 898,-118 898,-118 947,-118 947,-118 953,-118 959,-124 959,-130 959,-130 959,-142 959,-142 959,-148 953,-154 947,-154"/>
<text text-anchor="middle" x="922.5" y="-132.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">lock_latch</text>
</g>
<!-- release&#45;&gt;lock_latch -->
<g id="edge3" class="edge">
<title>release&#45;&gt;lock_latch</title>
<path fill="none" stroke="#666666" d="M426.1,-146.99C553.03,-144.17 779.07,-139.16 875.67,-137.02"/>
<polygon fill="#666666" stroke="#666666" points="875.78,-140.52 885.7,-136.79 875.63,-133.52 875.78,-140.52"/>
</g>
<!-- lock_latch&#45;&gt;Latch -->
<g id="edge4" class="edge">
<title>lock_latch&#45;&gt;Latch</title>
<path fill="none" stroke="#666666" d="M959.08,-132.97C987.41,-129.93 1027.82,-124.2 1062,-114 1101.05,-102.34 1142.92,-83.41 1174.64,-67.61"/>
<polygon fill="#666666" stroke="#666666" points="1176.37,-70.66 1183.72,-63.04 1173.22,-64.41 1176.37,-70.66"/>
</g>
<!-- acquire -->
<g id="node6" class="node">
<title>acquire</title>
<path fill="none" stroke="#1c2123" d="M743,-222C743,-222 711,-222 711,-222 705,-222 699,-216 699,-210 699,-210 699,-198 699,-198 699,-192 705,-186 711,-186 711,-186 743,-186 743,-186 749,-186 755,-192 755,-198 755,-198 755,-210 755,-210 755,-216 749,-222 743,-222"/>
<text text-anchor="middle" x="727" y="-200.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">acquire</text>
</g>
<!-- acquire&#45;&gt;lock_latch -->
<g id="edge5" class="edge">
<title>acquire&#45;&gt;lock_latch</title>
<path fill="none" stroke="#666666" d="M755.31,-194.4C786.68,-183.38 838.63,-165.12 876.1,-151.95"/>
<polygon fill="#666666" stroke="#666666" points="877.5,-155.17 885.78,-148.55 875.18,-148.57 877.5,-155.17"/>
</g>
<!-- TaskContext -->
<g id="node7" class="node">
<title>TaskContext</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M28,-376.5C28,-376.5 188,-376.5 188,-376.5 194,-376.5 200,-382.5 200,-388.5 200,-388.5 200,-479.5 200,-479.5 200,-485.5 194,-491.5 188,-491.5 188,-491.5 28,-491.5 28,-491.5 22,-491.5 16,-485.5 16,-479.5 16,-479.5 16,-388.5 16,-388.5 16,-382.5 22,-376.5 28,-376.5"/>
<text text-anchor="middle" x="108" y="-476.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">TaskContext</text>
<polyline fill="none" stroke="#60b5ac" points="16,-468.5 200,-468.5 "/>
<text text-anchor="start" x="24" y="-453.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">task: Option&lt;Task&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="16,-445.5 200,-445.5 "/>
<text text-anchor="start" x="24" y="-430.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">lock: Lock,</text>
<polyline fill="none" stroke="#60b5ac" points="16,-422.5 200,-422.5 "/>
<text text-anchor="start" x="24" y="-407.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">cb: Option&lt;StorageCallback&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="16,-399.5 200,-399.5 "/>
<text text-anchor="start" x="24" y="-384.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pr: Option&lt;ProcessResult&gt;,</text>
</g>
<!-- Lock -->
<g id="node8" class="node">
<title>Lock</title>
<path fill="#feed9b" stroke="#f7e495" d="M248,-387.5C248,-387.5 421,-387.5 421,-387.5 427,-387.5 433,-393.5 433,-399.5 433,-399.5 433,-444.5 433,-444.5 433,-450.5 427,-456.5 421,-456.5 421,-456.5 248,-456.5 248,-456.5 242,-456.5 236,-450.5 236,-444.5 236,-444.5 236,-399.5 236,-399.5 236,-393.5 242,-387.5 248,-387.5"/>
<text text-anchor="middle" x="334.5" y="-441.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Lock</text>
<polyline fill="none" stroke="#f7e495" points="236,-433.5 433,-433.5 "/>
<text text-anchor="start" x="244" y="-418.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pub required_hashes: Vec&lt;u64&gt;,</text>
<polyline fill="none" stroke="#f7e495" points="236,-410.5 433,-410.5 "/>
<text text-anchor="start" x="244" y="-395.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pub owned_count: usize,</text>
</g>
<!-- TaskContext&#45;&gt;Lock -->
<g id="edge6" class="edge">
<title>TaskContext&#45;&gt;Lock</title>
<path fill="none" stroke="#666666" d="M200.31,-429.12C208.6,-428.68 217.04,-428.22 225.45,-427.78"/>
<polygon fill="#666666" stroke="#666666" points="225.89,-431.26 235.68,-427.23 225.51,-424.27 225.89,-431.26"/>
</g>
<!-- release_lock -->
<g id="node9" class="node">
<title>release_lock</title>
<path fill="none" stroke="#1c2123" d="M30.5,-296.5C30.5,-296.5 185.5,-296.5 185.5,-296.5 191.5,-296.5 197.5,-302.5 197.5,-308.5 197.5,-308.5 197.5,-345.5 197.5,-345.5 197.5,-351.5 191.5,-357.5 185.5,-357.5 185.5,-357.5 30.5,-357.5 30.5,-357.5 24.5,-357.5 18.5,-351.5 18.5,-345.5 18.5,-345.5 18.5,-308.5 18.5,-308.5 18.5,-302.5 24.5,-296.5 30.5,-296.5"/>
<text text-anchor="middle" x="108" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">release_lock</text>
<polyline fill="none" stroke="#1c2123" points="18.5,-334.5 197.5,-334.5 "/>
<text text-anchor="start" x="26.5" y="-319.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">对于wakeup_list中每个wcid</text>
<text text-anchor="start" x="26.5" y="-304.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用try_to_wake_up</text>
</g>
<!-- release_lock&#45;&gt;release -->
<g id="edge7" class="edge">
<title>release_lock&#45;&gt;release</title>
<path fill="none" stroke="#666666" d="M147.59,-296.4C186.14,-265.84 245.45,-218.82 286.67,-186.13"/>
<polygon fill="#666666" stroke="#666666" points="289,-188.75 294.66,-179.8 284.65,-183.27 289,-188.75"/>
</g>
<!-- release_lock&#45;&gt;Lock -->
<g id="edge8" class="edge">
<title>release_lock&#45;&gt;Lock</title>
<path fill="none" stroke="#666666" d="M181.27,-357.58C200.72,-365.81 222.02,-374.82 242.35,-383.43"/>
<polygon fill="#666666" stroke="#666666" points="241.05,-386.68 251.62,-387.35 243.77,-380.23 241.05,-386.68"/>
</g>
<!-- try_to_wake_up -->
<g id="node10" class="node">
<title>try_to_wake_up</title>
<path fill="none" stroke="#1c2123" d="M294.5,-296.5C294.5,-296.5 374.5,-296.5 374.5,-296.5 380.5,-296.5 386.5,-302.5 386.5,-308.5 386.5,-308.5 386.5,-345.5 386.5,-345.5 386.5,-351.5 380.5,-357.5 374.5,-357.5 374.5,-357.5 294.5,-357.5 294.5,-357.5 288.5,-357.5 282.5,-351.5 282.5,-345.5 282.5,-345.5 282.5,-308.5 282.5,-308.5 282.5,-302.5 288.5,-296.5 294.5,-296.5"/>
<text text-anchor="middle" x="334.5" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">try_to_wake_up</text>
<polyline fill="none" stroke="#1c2123" points="282.5,-334.5 386.5,-334.5 "/>
<text text-anchor="start" x="290.5" y="-319.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">重新去获lock</text>
<text text-anchor="start" x="290.5" y="-304.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后执行task</text>
</g>
<!-- release_lock&#45;&gt;try_to_wake_up -->
<g id="edge9" class="edge">
<title>release_lock&#45;&gt;try_to_wake_up</title>
<path fill="none" stroke="#666666" d="M197.73,-327C222.6,-327 249.08,-327 271.99,-327"/>
<polygon fill="#666666" stroke="#666666" points="272.25,-330.5 282.25,-327 272.25,-323.5 272.25,-330.5"/>
</g>
<!-- acquire_lock -->
<g id="node11" class="node">
<title>acquire_lock</title>
<path fill="none" stroke="#1c2123" d="M481,-296.5C481,-296.5 651,-296.5 651,-296.5 657,-296.5 663,-302.5 663,-308.5 663,-308.5 663,-345.5 663,-345.5 663,-351.5 657,-357.5 651,-357.5 651,-357.5 481,-357.5 481,-357.5 475,-357.5 469,-351.5 469,-345.5 469,-345.5 469,-308.5 469,-308.5 469,-302.5 475,-296.5 481,-296.5"/>
<text text-anchor="middle" x="566" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">acquire_lock</text>
<polyline fill="none" stroke="#1c2123" points="469,-334.5 663,-334.5 "/>
<text text-anchor="start" x="477" y="-319.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Tries to acquire all the</text>
<text text-anchor="start" x="477" y="-304.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> required latches for a command</text>
</g>
<!-- try_to_wake_up&#45;&gt;acquire_lock -->
<g id="edge11" class="edge">
<title>try_to_wake_up&#45;&gt;acquire_lock</title>
<path fill="none" stroke="#666666" d="M386.72,-327C407.97,-327 433.46,-327 458.43,-327"/>
<polygon fill="#666666" stroke="#666666" points="458.71,-330.5 468.71,-327 458.71,-323.5 458.71,-330.5"/>
</g>
<!-- execute -->
<g id="node12" class="node">
<title>execute</title>
<path fill="none" stroke="#1c2123" d="M583,-412C583,-412 549,-412 549,-412 543,-412 537,-406 537,-400 537,-400 537,-388 537,-388 537,-382 543,-376 549,-376 549,-376 583,-376 583,-376 589,-376 595,-382 595,-388 595,-388 595,-400 595,-400 595,-406 589,-412 583,-412"/>
<text text-anchor="middle" x="566" y="-390.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">execute</text>
</g>
<!-- try_to_wake_up&#45;&gt;execute -->
<g id="edge12" class="edge">
<title>try_to_wake_up&#45;&gt;execute</title>
<path fill="none" stroke="#666666" d="M386.79,-342.59C411.59,-350.07 441.81,-359.11 469,-367 488.04,-372.53 509.26,-378.52 526.89,-383.44"/>
<polygon fill="#666666" stroke="#666666" points="526.25,-386.9 536.82,-386.21 528.13,-380.15 526.25,-386.9"/>
</g>
<!-- acquire_lock&#45;&gt;acquire -->
<g id="edge10" class="edge">
<title>acquire_lock&#45;&gt;acquire</title>
<path fill="none" stroke="#666666" d="M652.77,-296.42C659.21,-292.68 665.38,-288.55 671,-284 688.69,-269.69 703.02,-248.22 712.61,-231.13"/>
<polygon fill="#666666" stroke="#666666" points="715.78,-232.62 717.44,-222.16 709.62,-229.3 715.78,-232.62"/>
</g>
</g>
</svg>
