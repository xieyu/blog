<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: acquire_latches_lock Pages: 1 -->
<svg width="1411pt" height="700pt"
 viewBox="0.00 0.00 1411.00 700.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 696)">
<title>acquire_latches_lock</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-696 1407,-696 1407,4 -4,4"/>
<g id="clust4" class="cluster">
<title>cluster_Scheduler</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-398C20,-398 1051.5,-398 1051.5,-398 1057.5,-398 1063.5,-404 1063.5,-410 1063.5,-410 1063.5,-672 1063.5,-672 1063.5,-678 1057.5,-684 1051.5,-684 1051.5,-684 20,-684 20,-684 14,-684 8,-678 8,-672 8,-672 8,-410 8,-410 8,-404 14,-398 20,-398"/>
<text text-anchor="middle" x="535.75" y="-664" font-family="Times,serif" font-size="20.00">Scheduler</text>
</g>
<!-- Latches_acquire -->
<g id="node1" class="node">
<title>Latches_acquire</title>
<path fill="none" stroke="#1c2123" d="M663.5,-183.5C663.5,-183.5 805.5,-183.5 805.5,-183.5 811.5,-183.5 817.5,-189.5 817.5,-195.5 817.5,-195.5 817.5,-262.5 817.5,-262.5 817.5,-268.5 811.5,-274.5 805.5,-274.5 805.5,-274.5 663.5,-274.5 663.5,-274.5 657.5,-274.5 651.5,-268.5 651.5,-262.5 651.5,-262.5 651.5,-195.5 651.5,-195.5 651.5,-189.5 657.5,-183.5 663.5,-183.5"/>
<text text-anchor="middle" x="734.5" y="-259.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latches::acquire</text>
<polyline fill="none" stroke="#1c2123" points="651.5,-251.5 817.5,-251.5 "/>
<text text-anchor="start" x="659.5" y="-236.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历lock::required_hashes</text>
<text text-anchor="start" x="659.5" y="-221.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 对于每个key_hash</text>
<text text-anchor="start" x="659.5" y="-206.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 尝试获取Lock 成功的话</text>
<text text-anchor="start" x="659.5" y="-191.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 增加lock owned_count</text>
</g>
<!-- lock_latch -->
<g id="node2" class="node">
<title>lock_latch</title>
<path fill="none" stroke="#1c2123" d="M889,-191C889,-191 1076,-191 1076,-191 1082,-191 1088,-197 1088,-203 1088,-203 1088,-255 1088,-255 1088,-261 1082,-267 1076,-267 1076,-267 889,-267 889,-267 883,-267 877,-261 877,-255 877,-255 877,-203 877,-203 877,-197 883,-191 889,-191"/>
<text text-anchor="middle" x="982.5" y="-251.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latch::lock_latch</text>
<polyline fill="none" stroke="#1c2123" points="877,-244 1088,-244 "/>
<text text-anchor="start" x="885" y="-228.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取key_hash 对应slot的mutex锁</text>
<text text-anchor="start" x="885" y="-213.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> self.slots[(hash as usize) </text>
<text text-anchor="middle" x="982.5" y="-198.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">&amp; (self.size &#45; 1)].lock()</text>
</g>
<!-- Latches_acquire&#45;&gt;lock_latch -->
<g id="edge1" class="edge">
<title>Latches_acquire&#45;&gt;lock_latch</title>
<path fill="none" stroke="#666666" d="M817.76,-229C833.37,-229 849.97,-229 866.39,-229"/>
<polygon fill="#666666" stroke="#666666" points="866.58,-232.5 876.58,-229 866.58,-225.5 866.58,-232.5"/>
</g>
<!-- Latch_wait_for_wake -->
<g id="node3" class="node">
<title>Latch_wait_for_wake</title>
<path fill="none" stroke="#1c2123" d="M902.5,-110.5C902.5,-110.5 1062.5,-110.5 1062.5,-110.5 1068.5,-110.5 1074.5,-116.5 1074.5,-122.5 1074.5,-122.5 1074.5,-159.5 1074.5,-159.5 1074.5,-165.5 1068.5,-171.5 1062.5,-171.5 1062.5,-171.5 902.5,-171.5 902.5,-171.5 896.5,-171.5 890.5,-165.5 890.5,-159.5 890.5,-159.5 890.5,-122.5 890.5,-122.5 890.5,-116.5 896.5,-110.5 902.5,-110.5"/>
<text text-anchor="middle" x="982.5" y="-156.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latch::wait_for_wake</text>
<polyline fill="none" stroke="#1c2123" points="890.5,-148.5 1074.5,-148.5 "/>
<text text-anchor="start" x="898.5" y="-133.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将key_hash, cid</text>
<text text-anchor="start" x="898.5" y="-118.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> push到latch的waiting队列中</text>
</g>
<!-- Latches_acquire&#45;&gt;Latch_wait_for_wake -->
<g id="edge2" class="edge">
<title>Latches_acquire&#45;&gt;Latch_wait_for_wake</title>
<path fill="none" stroke="#666666" d="M817.76,-199.57C839.76,-191.71 863.71,-183.13 886.35,-175.04"/>
<polygon fill="#666666" stroke="#666666" points="887.72,-178.27 895.95,-171.6 885.36,-171.67 887.72,-178.27"/>
</g>
<!-- Latch_get_first_req_by_hash -->
<g id="node4" class="node">
<title>Latch_get_first_req_by_hash</title>
<path fill="none" stroke="#1c2123" d="M895.5,-0.5C895.5,-0.5 1069.5,-0.5 1069.5,-0.5 1075.5,-0.5 1081.5,-6.5 1081.5,-12.5 1081.5,-12.5 1081.5,-79.5 1081.5,-79.5 1081.5,-85.5 1075.5,-91.5 1069.5,-91.5 1069.5,-91.5 895.5,-91.5 895.5,-91.5 889.5,-91.5 883.5,-85.5 883.5,-79.5 883.5,-79.5 883.5,-12.5 883.5,-12.5 883.5,-6.5 889.5,-0.5 895.5,-0.5"/>
<text text-anchor="middle" x="982.5" y="-76.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latch::get_first_req_by_hash</text>
<polyline fill="none" stroke="#1c2123" points="883.5,-68.5 1081.5,-68.5 "/>
<text text-anchor="start" x="891.5" y="-53.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取key_hash对应的队首的cid</text>
<text text-anchor="start" x="891.5" y="-38.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果cid==自己或者是None</text>
<text text-anchor="start" x="891.5" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 继续lock下一个key</text>
<text text-anchor="start" x="891.5" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 否则就break</text>
</g>
<!-- Latches_acquire&#45;&gt;Latch_get_first_req_by_hash -->
<g id="edge3" class="edge">
<title>Latches_acquire&#45;&gt;Latch_get_first_req_by_hash</title>
<path fill="none" stroke="#666666" d="M780.18,-183.22C806.87,-157.29 842.24,-125.29 877,-101 878.88,-99.69 880.79,-98.39 882.73,-97.1"/>
<polygon fill="#666666" stroke="#666666" points="884.89,-99.87 891.4,-91.51 881.1,-93.98 884.89,-99.87"/>
</g>
<!-- Lock_acquired -->
<g id="node5" class="node">
<title>Lock_acquired</title>
<path fill="none" stroke="#1c2123" d="M1147.5,-315.5C1147.5,-315.5 1379.5,-315.5 1379.5,-315.5 1385.5,-315.5 1391.5,-321.5 1391.5,-327.5 1391.5,-327.5 1391.5,-364.5 1391.5,-364.5 1391.5,-370.5 1385.5,-376.5 1379.5,-376.5 1379.5,-376.5 1147.5,-376.5 1147.5,-376.5 1141.5,-376.5 1135.5,-370.5 1135.5,-364.5 1135.5,-364.5 1135.5,-327.5 1135.5,-327.5 1135.5,-321.5 1141.5,-315.5 1147.5,-315.5"/>
<text text-anchor="middle" x="1263.5" y="-361.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Lock::acquired</text>
<polyline fill="none" stroke="#1c2123" points="1135.5,-353.5 1391.5,-353.5 "/>
<text text-anchor="start" x="1143.5" y="-338.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果required_hashes.len() == owned count</text>
<text text-anchor="start" x="1143.5" y="-323.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 说明就获取lock了</text>
</g>
<!-- Latches_acquire&#45;&gt;Lock_acquired -->
<g id="edge4" class="edge">
<title>Latches_acquire&#45;&gt;Lock_acquired</title>
<path fill="none" stroke="#666666" d="M778.93,-274.77C811.58,-307.9 854.43,-348.31 877,-357 955.33,-387.17 1049.4,-385.15 1125,-375.24"/>
<polygon fill="#666666" stroke="#666666" points="1125.64,-378.68 1135.07,-373.86 1124.68,-371.75 1125.64,-378.68"/>
</g>
<!-- Lock -->
<g id="node6" class="node">
<title>Lock</title>
<path fill="#feed9b" stroke="#f7e495" d="M896,-286.5C896,-286.5 1069,-286.5 1069,-286.5 1075,-286.5 1081,-292.5 1081,-298.5 1081,-298.5 1081,-335.5 1081,-335.5 1081,-341.5 1075,-347.5 1069,-347.5 1069,-347.5 896,-347.5 896,-347.5 890,-347.5 884,-341.5 884,-335.5 884,-335.5 884,-298.5 884,-298.5 884,-292.5 890,-286.5 896,-286.5"/>
<text text-anchor="middle" x="982.5" y="-332.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Lock</text>
<polyline fill="none" stroke="#f7e495" points="884,-324.5 1081,-324.5 "/>
<text text-anchor="start" x="892" y="-309.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pub required_hashes: Vec&lt;u64&gt;,</text>
<text text-anchor="start" x="892" y="-294.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> pub owned_count: usize,</text>
</g>
<!-- Latches_acquire&#45;&gt;Lock -->
<g id="edge11" class="edge">
<title>Latches_acquire&#45;&gt;Lock</title>
<path fill="none" stroke="#666666" d="M817.76,-258.43C839.76,-266.29 863.71,-274.87 886.35,-282.96"/>
<polygon fill="#666666" stroke="#666666" points="885.36,-286.33 895.95,-286.4 887.72,-279.73 885.36,-286.33"/>
</g>
<!-- Latch -->
<g id="node11" class="node">
<title>Latch</title>
<path fill="#feed9b" stroke="#f7e495" d="M1136,-110.5C1136,-110.5 1391,-110.5 1391,-110.5 1397,-110.5 1403,-116.5 1403,-122.5 1403,-122.5 1403,-159.5 1403,-159.5 1403,-165.5 1397,-171.5 1391,-171.5 1391,-171.5 1136,-171.5 1136,-171.5 1130,-171.5 1124,-165.5 1124,-159.5 1124,-159.5 1124,-122.5 1124,-122.5 1124,-116.5 1130,-110.5 1136,-110.5"/>
<text text-anchor="middle" x="1263.5" y="-156.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Latch</text>
<polyline fill="none" stroke="#f7e495" points="1124,-148.5 1403,-148.5 "/>
<text text-anchor="start" x="1132" y="-133.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pari存储的是：hash_key, cid</text>
<text text-anchor="start" x="1132" y="-118.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> pub waiting: VecDeque&lt;Option&lt;(u64, u64)&gt;&gt;,</text>
</g>
<!-- Latch_wait_for_wake&#45;&gt;Latch -->
<g id="edge12" class="edge">
<title>Latch_wait_for_wake&#45;&gt;Latch</title>
<path fill="none" stroke="#666666" d="M1074.86,-141C1087.39,-141 1100.52,-141 1113.76,-141"/>
<polygon fill="#666666" stroke="#666666" points="1113.9,-144.5 1123.9,-141 1113.9,-137.5 1113.9,-144.5"/>
</g>
<!-- Lock&#45;&gt;Lock_acquired -->
<g id="edge5" class="edge">
<title>Lock&#45;&gt;Lock_acquired</title>
<path fill="none" stroke="#666666" d="M1081.08,-327.14C1095.25,-328.62 1110.06,-330.16 1124.84,-331.69"/>
<polygon fill="#666666" stroke="#666666" points="1124.75,-335.2 1135.06,-332.75 1125.48,-328.24 1124.75,-335.2"/>
</g>
<!-- schedule_command -->
<g id="node7" class="node">
<title>schedule_command</title>
<path fill="none" stroke="#1c2123" d="M129,-474.5C129,-474.5 318,-474.5 318,-474.5 324,-474.5 330,-480.5 330,-486.5 330,-486.5 330,-523.5 330,-523.5 330,-529.5 324,-535.5 318,-535.5 318,-535.5 129,-535.5 129,-535.5 123,-535.5 117,-529.5 117,-523.5 117,-523.5 117,-486.5 117,-486.5 117,-480.5 123,-474.5 129,-474.5"/>
<text text-anchor="middle" x="223.5" y="-520.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">schedule_command</text>
<polyline fill="none" stroke="#1c2123" points="117,-512.5 330,-512.5 "/>
<text text-anchor="start" x="125" y="-497.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">先尝试获取lock的所有key hashes</text>
<text text-anchor="start" x="125" y="-482.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 成功的话，执行task</text>
</g>
<!-- schedule_command&#45;&gt;Latches_acquire -->
<g id="edge6" class="edge">
<title>schedule_command&#45;&gt;Latches_acquire</title>
<path fill="none" stroke="#666666" d="M230.71,-474.34C244.08,-417.24 281.52,-295.59 366,-243 448.26,-191.79 562.14,-196.38 641.24,-208.6"/>
<polygon fill="#666666" stroke="#666666" points="640.76,-212.07 651.19,-210.21 641.88,-205.16 640.76,-212.07"/>
</g>
<!-- SchedulerInner_gen_id -->
<g id="node8" class="node">
<title>SchedulerInner_gen_id</title>
<path fill="none" stroke="#1c2123" d="M378,-252.5C378,-252.5 580,-252.5 580,-252.5 586,-252.5 592,-258.5 592,-264.5 592,-264.5 592,-377.5 592,-377.5 592,-383.5 586,-389.5 580,-389.5 580,-389.5 378,-389.5 378,-389.5 372,-389.5 366,-383.5 366,-377.5 366,-377.5 366,-264.5 366,-264.5 366,-258.5 372,-252.5 378,-252.5"/>
<text text-anchor="middle" x="479" y="-374.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">SchedulerInner::gen_id</text>
<polyline fill="none" stroke="#1c2123" points="366,-366.5 592,-366.5 "/>
<text text-anchor="start" x="374" y="-351.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">generate the </text>
<text text-anchor="start" x="374" y="-336.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> next command ID</text>
<polyline fill="none" stroke="#1c2123" points="366,-328.5 592,-328.5 "/>
<text text-anchor="start" x="374" y="-313.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取lock和释放Lock时候</text>
<text text-anchor="start" x="374" y="-298.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 都需要这个cid</text>
<polyline fill="none" stroke="#1c2123" points="366,-290.5 592,-290.5 "/>
<text text-anchor="start" x="374" y="-275.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用了atomicU64 id_alloc</text>
<text text-anchor="start" x="374" y="-260.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 每次fetch_add(1, Ordering::Relaxed)</text>
</g>
<!-- schedule_command&#45;&gt;SchedulerInner_gen_id -->
<g id="edge7" class="edge">
<title>schedule_command&#45;&gt;SchedulerInner_gen_id</title>
<path fill="none" stroke="#666666" d="M261.65,-474.4C287.93,-453.1 324.45,-424.15 363.86,-395.61"/>
<polygon fill="#666666" stroke="#666666" points="366.23,-398.21 372.31,-389.52 362.15,-392.52 366.23,-398.21"/>
</g>
<!-- execute -->
<g id="node9" class="node">
<title>execute</title>
<path fill="none" stroke="#1c2123" d="M403.5,-474.5C403.5,-474.5 554.5,-474.5 554.5,-474.5 560.5,-474.5 566.5,-480.5 566.5,-486.5 566.5,-486.5 566.5,-523.5 566.5,-523.5 566.5,-529.5 560.5,-535.5 554.5,-535.5 554.5,-535.5 403.5,-535.5 403.5,-535.5 397.5,-535.5 391.5,-529.5 391.5,-523.5 391.5,-523.5 391.5,-486.5 391.5,-486.5 391.5,-480.5 397.5,-474.5 403.5,-474.5"/>
<text text-anchor="middle" x="479" y="-520.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">execute</text>
<polyline fill="none" stroke="#1c2123" points="391.5,-512.5 566.5,-512.5 "/>
<text text-anchor="start" x="399.5" y="-497.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">在async_snapshot的callback</text>
<text text-anchor="start" x="399.5" y="-482.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 中执行process_by_worker</text>
</g>
<!-- schedule_command&#45;&gt;execute -->
<g id="edge8" class="edge">
<title>schedule_command&#45;&gt;execute</title>
<path fill="none" stroke="#666666" d="M330.17,-505C347.05,-505 364.44,-505 381.09,-505"/>
<polygon fill="#666666" stroke="#666666" points="381.36,-508.5 391.36,-505 381.36,-501.5 381.36,-508.5"/>
</g>
<!-- SchedulerInner_gen_id&#45;&gt;Latches_acquire -->
<g id="edge9" class="edge">
<title>SchedulerInner_gen_id&#45;&gt;Latches_acquire</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M592.3,-280.25C608.75,-274.28 625.53,-268.19 641.51,-262.39"/>
<polygon fill="green" stroke="green" points="643.14,-265.52 651.34,-258.82 640.75,-258.94 643.14,-265.52"/>
</g>
<!-- release_lock -->
<g id="node10" class="node">
<title>release_lock</title>
<path fill="none" stroke="#1c2123" d="M921.5,-468.5C921.5,-468.5 1043.5,-468.5 1043.5,-468.5 1049.5,-468.5 1055.5,-474.5 1055.5,-480.5 1055.5,-480.5 1055.5,-517.5 1055.5,-517.5 1055.5,-523.5 1049.5,-529.5 1043.5,-529.5 1043.5,-529.5 921.5,-529.5 921.5,-529.5 915.5,-529.5 909.5,-523.5 909.5,-517.5 909.5,-517.5 909.5,-480.5 909.5,-480.5 909.5,-474.5 915.5,-468.5 921.5,-468.5"/>
<text text-anchor="middle" x="982.5" y="-514.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">release_lock</text>
<polyline fill="none" stroke="#1c2123" points="909.5,-506.5 1055.5,-506.5 "/>
<text text-anchor="start" x="917.5" y="-491.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">释放掉Laches lock</text>
<text text-anchor="start" x="917.5" y="-476.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 唤醒等待latches的cid</text>
</g>
<!-- SchedulerInner_gen_id&#45;&gt;release_lock -->
<g id="edge10" class="edge">
<title>SchedulerInner_gen_id&#45;&gt;release_lock</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M592.34,-332.32C665.55,-342.64 761.82,-361.86 841,-397 877.33,-413.12 913.51,-439.7 940.05,-461.68"/>
<polygon fill="green" stroke="green" points="938.07,-464.58 947.97,-468.34 942.57,-459.22 938.07,-464.58"/>
</g>
<!-- on_write_finished -->
<g id="node12" class="node">
<title>on_write_finished</title>
<path fill="none" stroke="#1c2123" d="M779.5,-646C779.5,-646 689.5,-646 689.5,-646 683.5,-646 677.5,-640 677.5,-634 677.5,-634 677.5,-622 677.5,-622 677.5,-616 683.5,-610 689.5,-610 689.5,-610 779.5,-610 779.5,-610 785.5,-610 791.5,-616 791.5,-622 791.5,-622 791.5,-634 791.5,-634 791.5,-640 785.5,-646 779.5,-646"/>
<text text-anchor="middle" x="734.5" y="-624.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_write_finished</text>
</g>
<!-- execute&#45;&gt;on_write_finished -->
<g id="edge16" class="edge">
<title>execute&#45;&gt;on_write_finished</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M519.43,-535.67C548.15,-556.69 588.73,-583.79 628,-601 640.35,-606.41 654.01,-610.9 667.29,-614.57"/>
<polygon fill="green" stroke="green" points="666.78,-618.05 677.34,-617.21 668.56,-611.28 666.78,-618.05"/>
</g>
<!-- on_read_finished -->
<g id="node13" class="node">
<title>on_read_finished</title>
<path fill="none" stroke="#1c2123" d="M777.5,-592C777.5,-592 691.5,-592 691.5,-592 685.5,-592 679.5,-586 679.5,-580 679.5,-580 679.5,-568 679.5,-568 679.5,-562 685.5,-556 691.5,-556 691.5,-556 777.5,-556 777.5,-556 783.5,-556 789.5,-562 789.5,-568 789.5,-568 789.5,-580 789.5,-580 789.5,-586 783.5,-592 777.5,-592"/>
<text text-anchor="middle" x="734.5" y="-570.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_read_finished</text>
</g>
<!-- execute&#45;&gt;on_read_finished -->
<g id="edge17" class="edge">
<title>execute&#45;&gt;on_read_finished</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M566.76,-530.03C586.84,-535.71 608.14,-541.64 628,-547 641.44,-550.63 655.88,-554.4 669.62,-557.94"/>
<polygon fill="green" stroke="green" points="668.93,-561.37 679.49,-560.46 670.67,-554.59 668.93,-561.37"/>
</g>
<!-- on_wait_for_lock -->
<g id="node15" class="node">
<title>on_wait_for_lock</title>
<path fill="none" stroke="#1c2123" d="M640,-461C640,-461 829,-461 829,-461 835,-461 841,-467 841,-473 841,-473 841,-525 841,-525 841,-531 835,-537 829,-537 829,-537 640,-537 640,-537 634,-537 628,-531 628,-525 628,-525 628,-473 628,-473 628,-467 634,-461 640,-461"/>
<text text-anchor="middle" x="734.5" y="-521.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_wait_for_lock</text>
<polyline fill="none" stroke="#1c2123" points="628,-514 841,-514 "/>
<text text-anchor="start" x="636" y="-498.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">有冲突了，需要加入到task 会被</text>
<text text-anchor="start" x="636" y="-483.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> waiter_manager中</text>
<text text-anchor="start" x="636" y="-468.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 先释放task获取的内存latches</text>
</g>
<!-- execute&#45;&gt;on_wait_for_lock -->
<g id="edge18" class="edge">
<title>execute&#45;&gt;on_wait_for_lock</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M566.53,-502.95C582.96,-502.56 600.39,-502.15 617.55,-501.74"/>
<polygon fill="green" stroke="green" points="617.71,-505.24 627.62,-501.51 617.54,-498.24 617.71,-505.24"/>
</g>
<!-- finish_with_err -->
<g id="node16" class="node">
<title>finish_with_err</title>
<path fill="none" stroke="#1c2123" d="M772,-442C772,-442 697,-442 697,-442 691,-442 685,-436 685,-430 685,-430 685,-418 685,-418 685,-412 691,-406 697,-406 697,-406 772,-406 772,-406 778,-406 784,-412 784,-418 784,-418 784,-430 784,-430 784,-436 778,-442 772,-442"/>
<text text-anchor="middle" x="734.5" y="-420.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">finish_with_err</text>
</g>
<!-- execute&#45;&gt;finish_with_err -->
<g id="edge19" class="edge">
<title>execute&#45;&gt;finish_with_err</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M561.39,-474.46C582.93,-466.76 606.24,-458.77 628,-452 643.14,-447.29 659.65,-442.67 675.02,-438.58"/>
<polygon fill="green" stroke="green" points="676.15,-441.9 684.94,-435.97 674.37,-435.13 676.15,-441.9"/>
</g>
<!-- on_write_finished&#45;&gt;schedule_command -->
<g id="edge13" class="edge">
<title>on_write_finished&#45;&gt;schedule_command</title>
<path fill="none" stroke="#666666" d="M677.31,-621.25C604.53,-611.72 474.18,-591.94 366,-561 345.28,-555.07 323.39,-547.24 303.19,-539.31"/>
<polygon fill="#666666" stroke="#666666" points="304.32,-535.99 293.73,-535.54 301.73,-542.49 304.32,-535.99"/>
</g>
<!-- on_write_finished&#45;&gt;release_lock -->
<g id="edge21" class="edge">
<title>on_write_finished&#45;&gt;release_lock</title>
<path fill="none" stroke="#666666" d="M791.62,-617.79C807.99,-613.72 825.6,-608.24 841,-601 876.73,-584.21 912.67,-557.91 939.25,-536.22"/>
<polygon fill="#666666" stroke="#666666" points="941.72,-538.72 947.19,-529.65 937.26,-533.33 941.72,-538.72"/>
</g>
<!-- on_read_finished&#45;&gt;schedule_command -->
<g id="edge14" class="edge">
<title>on_read_finished&#45;&gt;schedule_command</title>
<path fill="none" stroke="#666666" d="M679.21,-573.05C607.12,-571.02 476.09,-564.71 366,-545 355.21,-543.07 344.07,-540.66 332.98,-537.99"/>
<polygon fill="#666666" stroke="#666666" points="333.82,-534.59 323.27,-535.58 332.13,-541.39 333.82,-534.59"/>
</g>
<!-- on_read_finished&#45;&gt;release_lock -->
<g id="edge20" class="edge">
<title>on_read_finished&#45;&gt;release_lock</title>
<path fill="none" stroke="#666666" d="M789.67,-561.01C806.22,-556.8 824.42,-551.94 841,-547 860.12,-541.3 880.53,-534.65 899.7,-528.16"/>
<polygon fill="#666666" stroke="#666666" points="900.96,-531.43 909.29,-524.88 898.7,-524.8 900.96,-531.43"/>
</g>
<!-- run_cmd -->
<g id="node14" class="node">
<title>run_cmd</title>
<path fill="none" stroke="#1c2123" d="M69,-523C69,-523 28,-523 28,-523 22,-523 16,-517 16,-511 16,-511 16,-499 16,-499 16,-493 22,-487 28,-487 28,-487 69,-487 69,-487 75,-487 81,-493 81,-499 81,-499 81,-511 81,-511 81,-517 75,-523 69,-523"/>
<text text-anchor="middle" x="48.5" y="-501.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">run_cmd</text>
</g>
<!-- run_cmd&#45;&gt;schedule_command -->
<g id="edge15" class="edge">
<title>run_cmd&#45;&gt;schedule_command</title>
<path fill="none" stroke="#666666" d="M81.23,-505C88.9,-505 97.54,-505 106.67,-505"/>
<polygon fill="#666666" stroke="#666666" points="106.75,-508.5 116.75,-505 106.75,-501.5 106.75,-508.5"/>
</g>
<!-- on_wait_for_lock&#45;&gt;release_lock -->
<g id="edge22" class="edge">
<title>on_wait_for_lock&#45;&gt;release_lock</title>
<path fill="none" stroke="#666666" d="M841.25,-499C860.59,-499 880.51,-499 899.05,-499"/>
<polygon fill="#666666" stroke="#666666" points="899.19,-502.5 909.19,-499 899.19,-495.5 899.19,-502.5"/>
</g>
<!-- finish_with_err&#45;&gt;release_lock -->
<g id="edge23" class="edge">
<title>finish_with_err&#45;&gt;release_lock</title>
<path fill="none" stroke="#666666" d="M784.26,-436.25C802.18,-440.93 822.57,-446.48 841,-452 860.08,-457.72 880.46,-464.27 899.62,-470.64"/>
<polygon fill="#666666" stroke="#666666" points="898.63,-474 909.22,-473.85 900.84,-467.36 898.63,-474"/>
</g>
</g>
</svg>
