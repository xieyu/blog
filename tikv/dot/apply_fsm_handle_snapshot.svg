<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: apply_fsm_apply_snapshot Pages: 1 -->
<svg width="781pt" height="554pt"
 viewBox="0.00 0.00 781.00 554.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 550)">
<title>apply_fsm_apply_snapshot</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-550 777,-550 777,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ApplyContext</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M429.5,-456C429.5,-456 533.5,-456 533.5,-456 539.5,-456 545.5,-462 545.5,-468 545.5,-468 545.5,-526 545.5,-526 545.5,-532 539.5,-538 533.5,-538 533.5,-538 429.5,-538 429.5,-538 423.5,-538 417.5,-532 417.5,-526 417.5,-526 417.5,-468 417.5,-468 417.5,-462 423.5,-456 429.5,-456"/>
<text text-anchor="middle" x="481.5" y="-518" font-family="Times,serif" font-size="20.00">ApplyContext</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ApplyDelegate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M426,-222C426,-222 538,-222 538,-222 544,-222 550,-228 550,-234 550,-234 550,-292 550,-292 550,-298 544,-304 538,-304 538,-304 426,-304 426,-304 420,-304 414,-298 414,-292 414,-292 414,-234 414,-234 414,-228 420,-222 426,-222"/>
<text text-anchor="middle" x="482" y="-284" font-family="Times,serif" font-size="20.00">ApplyDelegate</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_GenSnapTask</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M163,-8C163,-8 753,-8 753,-8 759,-8 765,-14 765,-20 765,-20 765,-202 765,-202 765,-208 759,-214 753,-214 753,-214 163,-214 163,-214 157,-214 151,-208 151,-202 151,-202 151,-20 151,-20 151,-14 157,-8 163,-8"/>
<text text-anchor="middle" x="458" y="-194" font-family="Times,serif" font-size="20.00">GenSnapTask</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_ApplyFsm</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-312C20,-312 547.5,-312 547.5,-312 553.5,-312 559.5,-318 559.5,-324 559.5,-324 559.5,-436 559.5,-436 559.5,-442 553.5,-448 547.5,-448 547.5,-448 20,-448 20,-448 14,-448 8,-442 8,-436 8,-436 8,-324 8,-324 8,-318 14,-312 20,-312"/>
<text text-anchor="middle" x="283.75" y="-428" font-family="Times,serif" font-size="20.00">ApplyFsm</text>
</g>
<!-- flush -->
<g id="node1" class="node">
<title>flush</title>
<path fill="none" stroke="#1c2123" d="M496.5,-500C496.5,-500 466.5,-500 466.5,-500 460.5,-500 454.5,-494 454.5,-488 454.5,-488 454.5,-476 454.5,-476 454.5,-470 460.5,-464 466.5,-464 466.5,-464 496.5,-464 496.5,-464 502.5,-464 508.5,-470 508.5,-476 508.5,-476 508.5,-488 508.5,-488 508.5,-494 502.5,-500 496.5,-500"/>
<text text-anchor="middle" x="481.5" y="-478.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">flush</text>
</g>
<!-- write_apply_state -->
<g id="node2" class="node">
<title>write_apply_state</title>
<path fill="none" stroke="#1c2123" d="M526,-266C526,-266 437,-266 437,-266 431,-266 425,-260 425,-254 425,-254 425,-242 425,-242 425,-236 431,-230 437,-230 437,-230 526,-230 526,-230 532,-230 538,-236 538,-242 538,-242 538,-254 538,-254 538,-260 532,-266 526,-266"/>
<text text-anchor="middle" x="481.5" y="-244.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_apply_state</text>
</g>
<!-- generate_and_schedule_snapshot -->
<g id="node3" class="node">
<title>generate_and_schedule_snapshot</title>
<path fill="none" stroke="#1c2123" d="M344,-176C344,-176 171,-176 171,-176 165,-176 159,-170 159,-164 159,-164 159,-152 159,-152 159,-146 165,-140 171,-140 171,-140 344,-140 344,-140 350,-140 356,-146 356,-152 356,-152 356,-164 356,-164 356,-170 350,-176 344,-176"/>
<text text-anchor="middle" x="257.5" y="-154.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">generate_and_schedule_snapshot</text>
</g>
<!-- RegionTask_Gen -->
<g id="node4" class="node">
<title>RegionTask_Gen</title>
<path fill="none" stroke="#1c2123" d="M404,-17C404,-17 559,-17 559,-17 565,-17 571,-23 571,-29 571,-29 571,-143 571,-143 571,-149 565,-155 559,-155 559,-155 404,-155 404,-155 398,-155 392,-149 392,-143 392,-143 392,-29 392,-29 392,-23 398,-17 404,-17"/>
<text text-anchor="middle" x="481.5" y="-139.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RegionTask::Gen</text>
<polyline fill="none" stroke="#1c2123" points="392,-132 571,-132 "/>
<text text-anchor="start" x="400" y="-116.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">region_id: self.region_id,</text>
<polyline fill="none" stroke="#1c2123" points="392,-109 571,-109 "/>
<text text-anchor="start" x="400" y="-93.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">notifier: self.snap_notifier,</text>
<polyline fill="none" stroke="#1c2123" points="392,-86 571,-86 "/>
<text text-anchor="start" x="400" y="-70.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">for_balance: self.for_balance,</text>
<polyline fill="none" stroke="#1c2123" points="392,-63 571,-63 "/>
<text text-anchor="start" x="400" y="-47.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_applied_index_term,</text>
<polyline fill="none" stroke="#1c2123" points="392,-40 571,-40 "/>
<text text-anchor="start" x="400" y="-24.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_applied_state,</text>
</g>
<!-- generate_and_schedule_snapshot&#45;&gt;RegionTask_Gen -->
<g id="edge1" class="edge">
<title>generate_and_schedule_snapshot&#45;&gt;RegionTask_Gen</title>
<path fill="none" stroke="#666666" d="M314.23,-139.92C334.89,-133.22 358.98,-125.41 382.3,-117.85"/>
<polygon fill="#666666" stroke="#666666" points="383.45,-121.15 391.89,-114.74 381.29,-114.5 383.45,-121.15"/>
</g>
<!-- region_sched_schedule -->
<g id="node5" class="node">
<title>region_sched_schedule</title>
<path fill="none" stroke="#1c2123" d="M619,-78.5C619,-78.5 745,-78.5 745,-78.5 751,-78.5 757,-84.5 757,-90.5 757,-90.5 757,-135.5 757,-135.5 757,-141.5 751,-147.5 745,-147.5 745,-147.5 619,-147.5 619,-147.5 613,-147.5 607,-141.5 607,-135.5 607,-135.5 607,-90.5 607,-90.5 607,-84.5 613,-78.5 619,-78.5"/>
<text text-anchor="middle" x="682" y="-132.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">region_sched.schedule</text>
<polyline fill="none" stroke="#1c2123" points="607,-124.5 757,-124.5 "/>
<text text-anchor="middle" x="682" y="-109.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">向sender中发送任务</text>
<polyline fill="none" stroke="#1c2123" points="607,-101.5 757,-101.5 "/>
<text text-anchor="start" x="615" y="-86.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">由worker/region来执行</text>
</g>
<!-- generate_and_schedule_snapshot&#45;&gt;region_sched_schedule -->
<g id="edge2" class="edge">
<title>generate_and_schedule_snapshot&#45;&gt;region_sched_schedule</title>
<path fill="none" stroke="#666666" d="M356.09,-171.52C418.31,-177.3 500.26,-179.6 571,-164 583.78,-161.18 596.83,-156.73 609.28,-151.59"/>
<polygon fill="#666666" stroke="#666666" points="610.87,-154.72 618.67,-147.55 608.1,-148.29 610.87,-154.72"/>
</g>
<!-- RegionTask_Gen&#45;&gt;region_sched_schedule -->
<g id="edge3" class="edge">
<title>RegionTask_Gen&#45;&gt;region_sched_schedule</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M571.01,-98.04C579.63,-99.21 588.36,-100.4 596.93,-101.57"/>
<polygon fill="green" stroke="green" points="596.53,-105.04 606.91,-102.92 597.47,-98.11 596.53,-105.04"/>
</g>
<!-- handle_snapshot -->
<g id="node6" class="node">
<title>handle_snapshot</title>
<path fill="none" stroke="#1c2123" d="M111,-356C111,-356 28,-356 28,-356 22,-356 16,-350 16,-344 16,-344 16,-332 16,-332 16,-326 22,-320 28,-320 28,-320 111,-320 111,-320 117,-320 123,-326 123,-332 123,-332 123,-344 123,-344 123,-350 117,-356 111,-356"/>
<text text-anchor="middle" x="69.5" y="-334.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_snapshot</text>
</g>
<!-- handle_snapshot&#45;&gt;flush -->
<g id="edge4" class="edge">
<title>handle_snapshot&#45;&gt;flush</title>
<path fill="none" stroke="#666666" d="M83.36,-356.3C97.63,-375.14 122.47,-403.83 151,-419 247.98,-470.57 380.89,-480.35 444.16,-481.92"/>
<polygon fill="#666666" stroke="#666666" points="444.36,-485.43 454.43,-482.12 444.5,-478.43 444.36,-485.43"/>
</g>
<!-- handle_snapshot&#45;&gt;write_apply_state -->
<g id="edge5" class="edge">
<title>handle_snapshot&#45;&gt;write_apply_state</title>
<path fill="none" stroke="#666666" d="M120.86,-319.95C130.78,-316.73 141.16,-313.58 151,-311 241.43,-287.3 348,-268.56 414.91,-257.87"/>
<polygon fill="#666666" stroke="#666666" points="415.57,-261.31 424.9,-256.28 414.47,-254.39 415.57,-261.31"/>
</g>
<!-- handle_snapshot&#45;&gt;generate_and_schedule_snapshot -->
<g id="edge6" class="edge">
<title>handle_snapshot&#45;&gt;generate_and_schedule_snapshot</title>
<path fill="none" stroke="#666666" d="M87.85,-319.85C104,-303.07 128.84,-277.56 151,-256 177.01,-230.69 207.45,-202.58 228.93,-182.97"/>
<polygon fill="#666666" stroke="#666666" points="231.38,-185.48 236.41,-176.15 226.66,-180.3 231.38,-185.48"/>
</g>
<!-- need_sync -->
<g id="node7" class="node">
<title>need_sync</title>
<path fill="none" stroke="#1c2123" d="M282.5,-356C282.5,-356 232.5,-356 232.5,-356 226.5,-356 220.5,-350 220.5,-344 220.5,-344 220.5,-332 220.5,-332 220.5,-326 226.5,-320 232.5,-320 232.5,-320 282.5,-320 282.5,-320 288.5,-320 294.5,-326 294.5,-332 294.5,-332 294.5,-344 294.5,-344 294.5,-350 288.5,-356 282.5,-356"/>
<text text-anchor="middle" x="257.5" y="-334.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">need_sync</text>
</g>
<!-- handle_snapshot&#45;&gt;need_sync -->
<g id="edge7" class="edge">
<title>handle_snapshot&#45;&gt;need_sync</title>
<path fill="none" stroke="#666666" d="M123.3,-338C150.7,-338 183.87,-338 210.25,-338"/>
<polygon fill="#666666" stroke="#666666" points="210.37,-341.5 220.37,-338 210.37,-334.5 210.37,-341.5"/>
</g>
<!-- snapshot -->
<g id="node8" class="node">
<title>snapshot</title>
<path fill="none" stroke="#1c2123" d="M277.5,-410C277.5,-410 237.5,-410 237.5,-410 231.5,-410 225.5,-404 225.5,-398 225.5,-398 225.5,-386 225.5,-386 225.5,-380 231.5,-374 237.5,-374 237.5,-374 277.5,-374 277.5,-374 283.5,-374 289.5,-380 289.5,-386 289.5,-386 289.5,-398 289.5,-398 289.5,-404 283.5,-410 277.5,-410"/>
<text text-anchor="middle" x="257.5" y="-388.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">snapshot</text>
</g>
<!-- handle_snapshot&#45;&gt;snapshot -->
<g id="edge8" class="edge">
<title>handle_snapshot&#45;&gt;snapshot</title>
<path fill="none" stroke="#666666" d="M122.72,-356.13C132.1,-359.21 141.81,-362.29 151,-365 172.15,-371.25 195.94,-377.41 215.56,-382.26"/>
<polygon fill="#666666" stroke="#666666" points="214.86,-385.69 225.41,-384.68 216.53,-378.9 214.86,-385.69"/>
</g>
<!-- need_sync&#45;&gt;flush -->
<g id="edge9" class="edge">
<title>need_sync&#45;&gt;flush</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M294.62,-340.33C314.79,-343.35 339.16,-350.1 356,-365 387.34,-392.73 361.46,-423.4 392,-452 406.25,-465.35 426.67,-472.78 444.3,-476.9"/>
<polygon fill="green" stroke="green" points="443.79,-480.37 454.29,-478.97 445.21,-473.52 443.79,-480.37"/>
</g>
<!-- need_sync&#45;&gt;write_apply_state -->
<g id="edge10" class="edge">
<title>need_sync&#45;&gt;write_apply_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M294.66,-323.34C330.45,-308.83 385.68,-286.44 426.63,-269.84"/>
<polygon fill="green" stroke="green" points="427.98,-273.07 435.93,-266.07 425.35,-266.58 427.98,-273.07"/>
</g>
<!-- last_sync_apply_index -->
<g id="node9" class="node">
<title>last_sync_apply_index</title>
<path fill="none" stroke="#1c2123" d="M539.5,-356C539.5,-356 423.5,-356 423.5,-356 417.5,-356 411.5,-350 411.5,-344 411.5,-344 411.5,-332 411.5,-332 411.5,-326 417.5,-320 423.5,-320 423.5,-320 539.5,-320 539.5,-320 545.5,-320 551.5,-326 551.5,-332 551.5,-332 551.5,-344 551.5,-344 551.5,-350 545.5,-356 539.5,-356"/>
<text text-anchor="middle" x="481.5" y="-334.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_sync_apply_index</text>
</g>
<!-- need_sync&#45;&gt;last_sync_apply_index -->
<g id="edge11" class="edge">
<title>need_sync&#45;&gt;last_sync_apply_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M294.66,-338C323.41,-338 364.7,-338 401.06,-338"/>
<polygon fill="green" stroke="green" points="401.17,-341.5 411.17,-338 401.17,-334.5 401.17,-341.5"/>
</g>
</g>
</svg>
