<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: batch_executor Pages: 1 -->
<svg width="1468pt" height="477pt"
 viewBox="0.00 0.00 1468.00 477.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 473)">
<title>batch_executor</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-473 1464,-473 1464,4 -4,4"/>
<!-- BatchExecutor -->
<g id="node1" class="node">
<title>BatchExecutor</title>
<path fill="#feed9b" stroke="#f7e495" d="M12,-155.5C12,-155.5 244,-155.5 244,-155.5 250,-155.5 256,-161.5 256,-167.5 256,-167.5 256,-273.5 256,-273.5 256,-279.5 250,-285.5 244,-285.5 244,-285.5 12,-285.5 12,-285.5 6,-285.5 0,-279.5 0,-273.5 0,-273.5 0,-167.5 0,-167.5 0,-161.5 6,-155.5 12,-155.5"/>
<text text-anchor="middle" x="128" y="-270.3" font-family="Times,serif" font-size="14.00" fill="#40575d">BatchExecutor</text>
<polyline fill="none" stroke="#f7e495" points="0,-262.5 256,-262.5 "/>
<text text-anchor="start" x="8" y="-247.3" font-family="Times,serif" font-size="14.00" fill="#40575d">The interface for pull&#45;based executors</text>
<polyline fill="none" stroke="#f7e495" points="0,-239.5 256,-239.5 "/>
<text text-anchor="start" x="8" y="-224.3" font-family="Times,serif" font-size="14.00" fill="#40575d">fn schema(&amp;self) &#45;&gt; &amp;[FieldType];</text>
<polyline fill="none" stroke="#f7e495" points="0,-216.5 256,-216.5 "/>
<text text-anchor="start" x="8" y="-201.3" font-family="Times,serif" font-size="14.00" fill="#40575d">fn next_batch(&amp;mut self, scan_rows: usize)</text>
<text text-anchor="start" x="8" y="-186.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> &#45;&gt; BatchExecuteResult;</text>
<polyline fill="none" stroke="#f7e495" points="0,-178.5 256,-178.5 "/>
<text text-anchor="middle" x="128" y="-163.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> </text>
</g>
<!-- ScanExecutor -->
<g id="node2" class="node">
<title>ScanExecutor</title>
<path fill="none" stroke="#1c2123" d="M494,-144C494,-144 680,-144 680,-144 686,-144 692,-150 692,-156 692,-156 692,-285 692,-285 692,-291 686,-297 680,-297 680,-297 494,-297 494,-297 488,-297 482,-291 482,-285 482,-285 482,-156 482,-156 482,-150 488,-144 494,-144"/>
<text text-anchor="middle" x="587" y="-281.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ScanExecutor</text>
<polyline fill="none" stroke="#1c2123" points="482,-274 692,-274 "/>
<text text-anchor="start" x="490" y="-258.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">A shared executor implementation</text>
<text text-anchor="start" x="490" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> for both table scan and index scan.</text>
<polyline fill="none" stroke="#1c2123" points="482,-236 692,-236 "/>
<text text-anchor="start" x="490" y="-220.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">imp: I</text>
<polyline fill="none" stroke="#1c2123" points="482,-213 692,-213 "/>
<text text-anchor="start" x="490" y="-197.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">scanner: RangesScanner&lt;S&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="482,-190 692,-190 "/>
<text text-anchor="start" x="490" y="-174.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">is_ended: bool,</text>
<polyline fill="none" stroke="#1c2123" points="482,-167 692,-167 "/>
<text text-anchor="middle" x="587" y="-151.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> </text>
</g>
<!-- BatchExecutor&#45;&gt;ScanExecutor -->
<g id="edge1" class="edge">
<title>BatchExecutor&#45;&gt;ScanExecutor</title>
<path fill="none" stroke="#666666" d="M256.3,-220.5C323.74,-220.5 405.91,-220.5 471.35,-220.5"/>
<polygon fill="#666666" stroke="#666666" points="471.71,-224 481.71,-220.5 471.71,-217 471.71,-224"/>
</g>
<!-- BatchTableScanExecutor -->
<g id="node4" class="node">
<title>BatchTableScanExecutor</title>
<path fill="none" stroke="#1c2123" d="M434,-192.5C434,-192.5 304,-192.5 304,-192.5 298,-192.5 292,-186.5 292,-180.5 292,-180.5 292,-168.5 292,-168.5 292,-162.5 298,-156.5 304,-156.5 304,-156.5 434,-156.5 434,-156.5 440,-156.5 446,-162.5 446,-168.5 446,-168.5 446,-180.5 446,-180.5 446,-186.5 440,-192.5 434,-192.5"/>
<text text-anchor="middle" x="369" y="-170.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">BatchTableScanExecutor</text>
</g>
<!-- BatchExecutor&#45;&gt;BatchTableScanExecutor -->
<g id="edge2" class="edge">
<title>BatchExecutor&#45;&gt;BatchTableScanExecutor</title>
<path fill="none" stroke="#666666" d="M256.2,-196.02C264.84,-194.36 273.42,-192.7 281.77,-191.1"/>
<polygon fill="#666666" stroke="#666666" points="282.67,-194.49 291.83,-189.16 281.34,-187.61 282.67,-194.49"/>
</g>
<!-- BatchIndexScanExecutor -->
<g id="node5" class="node">
<title>BatchIndexScanExecutor</title>
<path fill="none" stroke="#1c2123" d="M434,-284.5C434,-284.5 304,-284.5 304,-284.5 298,-284.5 292,-278.5 292,-272.5 292,-272.5 292,-260.5 292,-260.5 292,-254.5 298,-248.5 304,-248.5 304,-248.5 434,-248.5 434,-248.5 440,-248.5 446,-254.5 446,-260.5 446,-260.5 446,-272.5 446,-272.5 446,-278.5 440,-284.5 434,-284.5"/>
<text text-anchor="middle" x="369" y="-262.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">BatchIndexScanExecutor</text>
</g>
<!-- BatchExecutor&#45;&gt;BatchIndexScanExecutor -->
<g id="edge3" class="edge">
<title>BatchExecutor&#45;&gt;BatchIndexScanExecutor</title>
<path fill="none" stroke="#666666" d="M256.2,-244.98C264.84,-246.64 273.42,-248.3 281.77,-249.9"/>
<polygon fill="#666666" stroke="#666666" points="281.34,-253.39 291.83,-251.84 282.67,-246.51 281.34,-253.39"/>
</g>
<!-- ScanExecutorImpl -->
<g id="node3" class="node">
<title>ScanExecutorImpl</title>
<path fill="none" stroke="#1c2123" d="M740,-121C740,-121 1009,-121 1009,-121 1015,-121 1021,-127 1021,-133 1021,-133 1021,-216 1021,-216 1021,-222 1015,-228 1009,-228 1009,-228 740,-228 740,-228 734,-228 728,-222 728,-216 728,-216 728,-133 728,-133 728,-127 734,-121 740,-121"/>
<text text-anchor="middle" x="874.5" y="-212.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ScanExecutorImpl</text>
<polyline fill="none" stroke="#1c2123" points="728,-205 1021,-205 "/>
<text text-anchor="start" x="736" y="-189.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">fn mut_context(&amp;mut self) &#45;&gt; &amp;mut EvalContext;</text>
<polyline fill="none" stroke="#1c2123" points="728,-182 1021,-182 "/>
<text text-anchor="start" x="736" y="-166.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">fn build_column_vec(&amp;self, scan_rows: usize)</text>
<text text-anchor="start" x="736" y="-151.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> &#45;&gt; LazyBatchColumnVec;</text>
<polyline fill="none" stroke="#1c2123" points="728,-144 1021,-144 "/>
<text text-anchor="start" x="736" y="-128.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">fn process_kv_pair(...</text>
</g>
<!-- ScanExecutor&#45;&gt;ScanExecutorImpl -->
<g id="edge4" class="edge">
<title>ScanExecutor&#45;&gt;ScanExecutorImpl</title>
<path fill="none" stroke="#666666" d="M692.28,-203.7C700.64,-202.35 709.19,-200.97 717.8,-199.59"/>
<polygon fill="#666666" stroke="#666666" points="718.62,-203 727.93,-197.95 717.5,-196.09 718.62,-203"/>
</g>
<!-- RangesScanner -->
<g id="node6" class="node">
<title>RangesScanner</title>
<path fill="none" stroke="#1c2123" d="M764.5,-247.5C764.5,-247.5 984.5,-247.5 984.5,-247.5 990.5,-247.5 996.5,-253.5 996.5,-259.5 996.5,-259.5 996.5,-281.5 996.5,-281.5 996.5,-287.5 990.5,-293.5 984.5,-293.5 984.5,-293.5 764.5,-293.5 764.5,-293.5 758.5,-293.5 752.5,-287.5 752.5,-281.5 752.5,-281.5 752.5,-259.5 752.5,-259.5 752.5,-253.5 758.5,-247.5 764.5,-247.5"/>
<text text-anchor="middle" x="874.5" y="-278.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RangesScanner</text>
<polyline fill="none" stroke="#1c2123" points="752.5,-270.5 996.5,-270.5 "/>
<text text-anchor="start" x="760.5" y="-255.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">A scanner that scans over multiple ranges</text>
</g>
<!-- ScanExecutor&#45;&gt;RangesScanner -->
<g id="edge5" class="edge">
<title>ScanExecutor&#45;&gt;RangesScanner</title>
<path fill="none" stroke="#666666" d="M692.28,-238.76C708.38,-241.58 725.18,-244.52 741.77,-247.43"/>
<polygon fill="#666666" stroke="#666666" points="741.62,-250.96 752.07,-249.23 742.83,-244.06 741.62,-250.96"/>
</g>
<!-- TableScanExecutorImpl -->
<g id="node7" class="node">
<title>TableScanExecutorImpl</title>
<path fill="none" stroke="#1c2123" d="M1088,-0.5C1088,-0.5 1309,-0.5 1309,-0.5 1315,-0.5 1321,-6.5 1321,-12.5 1321,-12.5 1321,-172.5 1321,-172.5 1321,-178.5 1315,-184.5 1309,-184.5 1309,-184.5 1088,-184.5 1088,-184.5 1082,-184.5 1076,-178.5 1076,-172.5 1076,-172.5 1076,-12.5 1076,-12.5 1076,-6.5 1082,-0.5 1088,-0.5"/>
<text text-anchor="middle" x="1198.5" y="-169.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">TableScanExecutorImpl</text>
<polyline fill="none" stroke="#1c2123" points="1076,-161.5 1321,-161.5 "/>
<text text-anchor="start" x="1084" y="-146.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">context: EvalContext,</text>
<polyline fill="none" stroke="#1c2123" points="1076,-138.5 1321,-138.5 "/>
<text text-anchor="start" x="1084" y="-123.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">schema: Vec&lt;FieldType&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1076,-115.5 1321,-115.5 "/>
<text text-anchor="start" x="1084" y="-100.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">columns_default_value: Vec&lt;Vec&lt;u8&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1076,-92.5 1321,-92.5 "/>
<text text-anchor="start" x="1084" y="-77.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">column_id_index: HashMap&lt;i64, usize&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1076,-69.5 1321,-69.5 "/>
<text text-anchor="start" x="1084" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_indices: HandleIndicesVec,</text>
<polyline fill="none" stroke="#1c2123" points="1076,-46.5 1321,-46.5 "/>
<text text-anchor="start" x="1084" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">primary_column_ids: Vec&lt;i64&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1076,-23.5 1321,-23.5 "/>
<text text-anchor="start" x="1084" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">is_column_filled: Vec&lt;bool&gt;,</text>
</g>
<!-- ScanExecutorImpl&#45;&gt;TableScanExecutorImpl -->
<g id="edge6" class="edge">
<title>ScanExecutorImpl&#45;&gt;TableScanExecutorImpl</title>
<path fill="none" stroke="#666666" d="M1021.43,-137.34C1036.16,-133.59 1051.07,-129.79 1065.65,-126.08"/>
<polygon fill="#666666" stroke="#666666" points="1066.85,-129.38 1075.68,-123.52 1065.13,-122.6 1066.85,-129.38"/>
</g>
<!-- IndexScanExecutorImpl -->
<g id="node8" class="node">
<title>IndexScanExecutorImpl</title>
<path fill="none" stroke="#1c2123" d="M1069,-284.5C1069,-284.5 1328,-284.5 1328,-284.5 1334,-284.5 1340,-290.5 1340,-296.5 1340,-296.5 1340,-456.5 1340,-456.5 1340,-462.5 1334,-468.5 1328,-468.5 1328,-468.5 1069,-468.5 1069,-468.5 1063,-468.5 1057,-462.5 1057,-456.5 1057,-456.5 1057,-296.5 1057,-296.5 1057,-290.5 1063,-284.5 1069,-284.5"/>
<text text-anchor="middle" x="1198.5" y="-453.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">IndexScanExecutorImpl</text>
<polyline fill="none" stroke="#1c2123" points="1057,-445.5 1340,-445.5 "/>
<text text-anchor="start" x="1065" y="-430.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">context: EvalContext,</text>
<polyline fill="none" stroke="#1c2123" points="1057,-422.5 1340,-422.5 "/>
<text text-anchor="start" x="1065" y="-407.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">schema: Vec&lt;FieldType&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1057,-399.5 1340,-399.5 "/>
<text text-anchor="start" x="1065" y="-384.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">columns_id_without_handle: Vec&lt;i64&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1057,-376.5 1340,-376.5 "/>
<text text-anchor="start" x="1065" y="-361.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">columns_id_for_common_handle: Vec&lt;i64&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1057,-353.5 1340,-353.5 "/>
<text text-anchor="start" x="1065" y="-338.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">decode_handle_strategy: DecodeHandleStrategy,</text>
<polyline fill="none" stroke="#1c2123" points="1057,-330.5 1340,-330.5 "/>
<text text-anchor="start" x="1065" y="-315.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pid_column_cnt: usize,</text>
<polyline fill="none" stroke="#1c2123" points="1057,-307.5 1340,-307.5 "/>
<text text-anchor="start" x="1065" y="-292.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">index_version: i64,</text>
</g>
<!-- ScanExecutorImpl&#45;&gt;IndexScanExecutorImpl -->
<g id="edge7" class="edge">
<title>ScanExecutorImpl&#45;&gt;IndexScanExecutorImpl</title>
<path fill="none" stroke="#666666" d="M1004.67,-228.14C1010.29,-231.46 1015.76,-234.92 1021,-238.5 1039.68,-251.27 1039.79,-259.81 1057,-274.5 1058.34,-275.64 1059.69,-276.79 1061.05,-277.93"/>
<polygon fill="#666666" stroke="#666666" points="1059.03,-280.8 1068.97,-284.49 1063.5,-275.41 1059.03,-280.8"/>
</g>
<!-- BatchTableScanExecutor&#45;&gt;ScanExecutor -->
<g id="edge10" class="edge">
<title>BatchTableScanExecutor&#45;&gt;ScanExecutor</title>
<path fill="none" stroke="#666666" d="M446.15,-190.72C454.54,-192.5 463.2,-194.35 471.92,-196.21"/>
<polygon fill="#666666" stroke="#666666" points="471.26,-199.64 481.77,-198.3 472.72,-192.8 471.26,-199.64"/>
</g>
<!-- BatchTableScanExecutor&#45;&gt;TableScanExecutorImpl -->
<g id="edge11" class="edge">
<title>BatchTableScanExecutor&#45;&gt;TableScanExecutorImpl</title>
<path fill="none" stroke="#666666" d="M412.61,-156.45C433.21,-148.46 458.52,-139.71 482,-134.5 682.05,-90.16 920.79,-85.48 1065.67,-87.79"/>
<polygon fill="#666666" stroke="#666666" points="1065.88,-91.3 1075.94,-87.97 1066,-84.3 1065.88,-91.3"/>
</g>
<!-- BatchIndexScanExecutor&#45;&gt;ScanExecutor -->
<g id="edge12" class="edge">
<title>BatchIndexScanExecutor&#45;&gt;ScanExecutor</title>
<path fill="none" stroke="#666666" d="M446.15,-250.28C454.54,-248.5 463.2,-246.65 471.92,-244.79"/>
<polygon fill="#666666" stroke="#666666" points="472.72,-248.2 481.77,-242.7 471.26,-241.36 472.72,-248.2"/>
</g>
<!-- BatchIndexScanExecutor&#45;&gt;IndexScanExecutorImpl -->
<g id="edge13" class="edge">
<title>BatchIndexScanExecutor&#45;&gt;IndexScanExecutorImpl</title>
<path fill="none" stroke="#666666" d="M412.62,-284.51C433.22,-292.49 458.53,-301.24 482,-306.5 673.79,-349.44 900.36,-366.04 1046.35,-372.46"/>
<polygon fill="#666666" stroke="#666666" points="1046.58,-375.97 1056.72,-372.9 1046.88,-368.98 1046.58,-375.97"/>
</g>
<!-- RangesIterator -->
<g id="node10" class="node">
<title>RangesIterator</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1140,-204C1140,-204 1257,-204 1257,-204 1263,-204 1269,-210 1269,-216 1269,-216 1269,-253 1269,-253 1269,-259 1263,-265 1257,-265 1257,-265 1140,-265 1140,-265 1134,-265 1128,-259 1128,-253 1128,-253 1128,-216 1128,-216 1128,-210 1134,-204 1140,-204"/>
<text text-anchor="middle" x="1198.5" y="-249.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RangesIterator</text>
<polyline fill="none" stroke="#60b5ac" points="1128,-242 1269,-242 "/>
<text text-anchor="start" x="1136" y="-226.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">从Storage 中point_get</text>
<text text-anchor="start" x="1136" y="-211.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 或者scan数据</text>
</g>
<!-- RangesScanner&#45;&gt;RangesIterator -->
<g id="edge14" class="edge">
<title>RangesScanner&#45;&gt;RangesIterator</title>
<path fill="none" stroke="#666666" d="M996.78,-256.94C1037.19,-252.42 1081.16,-247.51 1117.62,-243.43"/>
<polygon fill="#666666" stroke="#666666" points="1118.15,-246.89 1127.7,-242.3 1117.37,-239.94 1118.15,-246.89"/>
</g>
<!-- EvalContext -->
<g id="node9" class="node">
<title>EvalContext</title>
<path fill="none" stroke="#1c2123" d="M1448,-252.5C1448,-252.5 1388,-252.5 1388,-252.5 1382,-252.5 1376,-246.5 1376,-240.5 1376,-240.5 1376,-228.5 1376,-228.5 1376,-222.5 1382,-216.5 1388,-216.5 1388,-216.5 1448,-216.5 1448,-216.5 1454,-216.5 1460,-222.5 1460,-228.5 1460,-228.5 1460,-240.5 1460,-240.5 1460,-246.5 1454,-252.5 1448,-252.5"/>
<text text-anchor="middle" x="1418" y="-230.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">EvalContext</text>
</g>
<!-- TableScanExecutorImpl&#45;&gt;EvalContext -->
<g id="edge8" class="edge">
<title>TableScanExecutorImpl&#45;&gt;EvalContext</title>
<path fill="none" stroke="#666666" d="M1321.28,-172.01C1343.11,-186.26 1364.22,-200.04 1381.04,-211.02"/>
<polygon fill="#666666" stroke="#666666" points="1379.14,-213.96 1389.42,-216.5 1382.96,-208.1 1379.14,-213.96"/>
</g>
<!-- IndexScanExecutorImpl&#45;&gt;EvalContext -->
<g id="edge9" class="edge">
<title>IndexScanExecutorImpl&#45;&gt;EvalContext</title>
<path fill="none" stroke="#666666" d="M1340.01,-284.76C1354.77,-275.13 1368.67,-266.05 1380.49,-258.34"/>
<polygon fill="#666666" stroke="#666666" points="1382.64,-261.11 1389.1,-252.71 1378.82,-255.25 1382.64,-261.11"/>
</g>
</g>
</svg>
