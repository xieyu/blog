<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: batch_system2 Pages: 1 -->
<svg width="1158pt" height="331pt"
 viewBox="0.00 0.00 1158.00 330.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 326.5)">
<title>batch_system2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-326.5 1154,-326.5 1154,4 -4,4"/>
<!-- Poller -->
<g id="node1" class="node">
<title>Poller</title>
<path fill="none" stroke="#1c2123" d="M867,-174C867,-174 998,-174 998,-174 1004,-174 1010,-180 1010,-186 1010,-186 1010,-261 1010,-261 1010,-267 1004,-273 998,-273 998,-273 867,-273 867,-273 861,-273 855,-267 855,-261 855,-261 855,-186 855,-186 855,-180 861,-174 867,-174"/>
<text text-anchor="middle" x="932.5" y="-257.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Poller 线程池</text>
<polyline fill="none" stroke="#1c2123" points="855,-250 1010,-250 "/>
<text text-anchor="middle" x="878.5" y="-234.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">rx</text>
<polyline fill="none" stroke="#1c2123" points="902,-227 902,-250 "/>
<text text-anchor="middle" x="956" y="-234.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">fsm_receiver</text>
<polyline fill="none" stroke="#1c2123" points="855,-227 1010,-227 "/>
<text text-anchor="start" x="863" y="-211.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">从NormalChannel取fsm</text>
<text text-anchor="start" x="863" y="-196.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后从每个Fsm的rx中</text>
<text text-anchor="start" x="863" y="-181.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 取N个消息, 批量处理</text>
</g>
<!-- begin -->
<g id="node8" class="node">
<title>begin</title>
<path fill="none" stroke="#1c2123" d="M1113,-322.5C1113,-322.5 1083,-322.5 1083,-322.5 1077,-322.5 1071,-316.5 1071,-310.5 1071,-310.5 1071,-298.5 1071,-298.5 1071,-292.5 1077,-286.5 1083,-286.5 1083,-286.5 1113,-286.5 1113,-286.5 1119,-286.5 1125,-292.5 1125,-298.5 1125,-298.5 1125,-310.5 1125,-310.5 1125,-316.5 1119,-322.5 1113,-322.5"/>
<text text-anchor="middle" x="1098" y="-300.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">begin</text>
</g>
<!-- Poller&#45;&gt;begin -->
<g id="edge9" class="edge">
<title>Poller&#45;&gt;begin</title>
<path fill="none" stroke="#666666" d="M1010.46,-261.63C1028.26,-270.45 1046.37,-279.42 1061.39,-286.86"/>
<polygon fill="#666666" stroke="#666666" points="1060.26,-290.2 1070.77,-291.51 1063.37,-283.93 1060.26,-290.2"/>
</g>
<!-- handle_normals -->
<g id="node9" class="node">
<title>handle_normals</title>
<path fill="none" stroke="#1c2123" d="M1138,-268.5C1138,-268.5 1058,-268.5 1058,-268.5 1052,-268.5 1046,-262.5 1046,-256.5 1046,-256.5 1046,-244.5 1046,-244.5 1046,-238.5 1052,-232.5 1058,-232.5 1058,-232.5 1138,-232.5 1138,-232.5 1144,-232.5 1150,-238.5 1150,-244.5 1150,-244.5 1150,-256.5 1150,-256.5 1150,-262.5 1144,-268.5 1138,-268.5"/>
<text text-anchor="middle" x="1098" y="-246.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_normals</text>
</g>
<!-- Poller&#45;&gt;handle_normals -->
<g id="edge10" class="edge">
<title>Poller&#45;&gt;handle_normals</title>
<path fill="none" stroke="#666666" d="M1010.46,-236.21C1018.94,-237.61 1027.49,-239.02 1035.74,-240.38"/>
<polygon fill="#666666" stroke="#666666" points="1035.2,-243.84 1045.63,-242.02 1036.34,-236.93 1035.2,-243.84"/>
</g>
<!-- handle_control -->
<g id="node10" class="node">
<title>handle_control</title>
<path fill="none" stroke="#1c2123" d="M1135,-214.5C1135,-214.5 1061,-214.5 1061,-214.5 1055,-214.5 1049,-208.5 1049,-202.5 1049,-202.5 1049,-190.5 1049,-190.5 1049,-184.5 1055,-178.5 1061,-178.5 1061,-178.5 1135,-178.5 1135,-178.5 1141,-178.5 1147,-184.5 1147,-190.5 1147,-190.5 1147,-202.5 1147,-202.5 1147,-208.5 1141,-214.5 1135,-214.5"/>
<text text-anchor="middle" x="1098" y="-192.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_control</text>
</g>
<!-- Poller&#45;&gt;handle_control -->
<g id="edge11" class="edge">
<title>Poller&#45;&gt;handle_control</title>
<path fill="none" stroke="#666666" d="M1010.46,-210.79C1019.97,-209.22 1029.57,-207.64 1038.73,-206.12"/>
<polygon fill="#666666" stroke="#666666" points="1039.57,-209.53 1048.87,-204.45 1038.43,-202.62 1039.57,-209.53"/>
</g>
<!-- end -->
<g id="node11" class="node">
<title>end</title>
<path fill="none" stroke="#1c2123" d="M1113,-160.5C1113,-160.5 1083,-160.5 1083,-160.5 1077,-160.5 1071,-154.5 1071,-148.5 1071,-148.5 1071,-136.5 1071,-136.5 1071,-130.5 1077,-124.5 1083,-124.5 1083,-124.5 1113,-124.5 1113,-124.5 1119,-124.5 1125,-130.5 1125,-136.5 1125,-136.5 1125,-148.5 1125,-148.5 1125,-154.5 1119,-160.5 1113,-160.5"/>
<text text-anchor="middle" x="1098" y="-138.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">end</text>
</g>
<!-- Poller&#45;&gt;end -->
<g id="edge12" class="edge">
<title>Poller&#45;&gt;end</title>
<path fill="none" stroke="#666666" d="M1010.46,-185.37C1028.26,-176.55 1046.37,-167.58 1061.39,-160.14"/>
<polygon fill="#666666" stroke="#666666" points="1063.37,-163.07 1070.77,-155.49 1060.26,-156.8 1063.37,-163.07"/>
</g>
<!-- NormalChannel -->
<g id="node2" class="node">
<title>NormalChannel</title>
<path fill="none" stroke="#1c2123" d="M727,-27.5C727,-27.5 807,-27.5 807,-27.5 813,-27.5 819,-33.5 819,-39.5 819,-39.5 819,-245.5 819,-245.5 819,-251.5 813,-257.5 807,-257.5 807,-257.5 727,-257.5 727,-257.5 721,-257.5 715,-251.5 715,-245.5 715,-245.5 715,-39.5 715,-39.5 715,-33.5 721,-27.5 727,-27.5"/>
<text text-anchor="middle" x="767" y="-242.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">NormalChannel</text>
<polyline fill="none" stroke="#1c2123" points="715,-234.5 819,-234.5 "/>
<text text-anchor="middle" x="767" y="-219.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> </text>
<polyline fill="none" stroke="#1c2123" points="715,-211.5 819,-211.5 "/>
<text text-anchor="middle" x="731.5" y="-184.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">rx</text>
<polyline fill="none" stroke="#1c2123" points="748,-165.5 748,-211.5 "/>
<text text-anchor="middle" x="783.5" y="-196.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">region1</text>
<polyline fill="none" stroke="#1c2123" points="748,-188.5 819,-188.5 "/>
<text text-anchor="middle" x="783.5" y="-173.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsm</text>
<polyline fill="none" stroke="#1c2123" points="715,-165.5 819,-165.5 "/>
<text text-anchor="middle" x="731.5" y="-138.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">rx</text>
<polyline fill="none" stroke="#1c2123" points="748,-119.5 748,-165.5 "/>
<text text-anchor="middle" x="783.5" y="-150.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">region2</text>
<polyline fill="none" stroke="#1c2123" points="748,-142.5 819,-142.5 "/>
<text text-anchor="middle" x="783.5" y="-127.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsm</text>
<polyline fill="none" stroke="#1c2123" points="715,-119.5 819,-119.5 "/>
<text text-anchor="middle" x="731.5" y="-92.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">rx</text>
<polyline fill="none" stroke="#1c2123" points="748,-73.5 748,-119.5 "/>
<text text-anchor="middle" x="783.5" y="-104.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">region3</text>
<polyline fill="none" stroke="#1c2123" points="748,-96.5 819,-96.5 "/>
<text text-anchor="middle" x="783.5" y="-81.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsm</text>
<polyline fill="none" stroke="#1c2123" points="715,-73.5 819,-73.5 "/>
<text text-anchor="middle" x="767" y="-58.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> </text>
<polyline fill="none" stroke="#1c2123" points="715,-50.5 819,-50.5 "/>
<text text-anchor="middle" x="767" y="-35.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">...</text>
</g>
<!-- NormalChannel&#45;&gt;Poller -->
<g id="edge8" class="edge">
<title>NormalChannel:head&#45;&gt;Poller</title>
<path fill="none" stroke="#666666" d="M819,-223.5C827.35,-223.5 836.05,-223.5 844.75,-223.5"/>
<polygon fill="#666666" stroke="#666666" points="844.95,-227 854.95,-223.5 844.95,-220 844.95,-227"/>
</g>
<!-- RaftRouter_normals -->
<g id="node3" class="node">
<title>RaftRouter_normals</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M12,-65.5C12,-65.5 228,-65.5 228,-65.5 234,-65.5 240,-71.5 240,-77.5 240,-77.5 240,-267.5 240,-267.5 240,-273.5 234,-279.5 228,-279.5 228,-279.5 12,-279.5 12,-279.5 6,-279.5 0,-273.5 0,-267.5 0,-267.5 0,-77.5 0,-77.5 0,-71.5 6,-65.5 12,-65.5"/>
<text text-anchor="middle" x="120" y="-264.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftRouter::normals</text>
<polyline fill="none" stroke="#8a8898" points="0,-256.5 240,-256.5 "/>
<text text-anchor="middle" x="29" y="-214.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">region1</text>
<polyline fill="none" stroke="#8a8898" points="58,-180.5 58,-256.5 "/>
<text text-anchor="middle" x="149" y="-241.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">BasicMailbox</text>
<polyline fill="none" stroke="#8a8898" points="58,-233.5 240,-233.5 "/>
<text text-anchor="start" x="66" y="-218.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">FsmState</text>
<text text-anchor="start" x="66" y="-203.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">标记Fsm是否已发送到</text>
<text text-anchor="start" x="66" y="-188.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> NormalChannel</text>
<polyline fill="none" stroke="#8a8898" points="213,-180.5 213,-233.5 "/>
<text text-anchor="middle" x="226.5" y="-203.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">tx</text>
<polyline fill="none" stroke="#8a8898" points="0,-180.5 240,-180.5 "/>
<text text-anchor="middle" x="50.5" y="-153.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">region2</text>
<polyline fill="none" stroke="#8a8898" points="101,-134.5 101,-180.5 "/>
<text text-anchor="middle" x="170.5" y="-165.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">BasicMailbox</text>
<polyline fill="none" stroke="#8a8898" points="101,-157.5 240,-157.5 "/>
<text text-anchor="middle" x="146" y="-142.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">FsmState</text>
<polyline fill="none" stroke="#8a8898" points="191,-134.5 191,-157.5 "/>
<text text-anchor="middle" x="215.5" y="-142.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">tx</text>
<polyline fill="none" stroke="#8a8898" points="0,-134.5 240,-134.5 "/>
<text text-anchor="middle" x="50.5" y="-107.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">region3</text>
<polyline fill="none" stroke="#8a8898" points="101,-88.5 101,-134.5 "/>
<text text-anchor="middle" x="170.5" y="-119.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">BasicMailbox</text>
<polyline fill="none" stroke="#8a8898" points="101,-111.5 240,-111.5 "/>
<text text-anchor="middle" x="146" y="-96.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">FsmState</text>
<polyline fill="none" stroke="#8a8898" points="191,-88.5 191,-111.5 "/>
<text text-anchor="middle" x="215.5" y="-96.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">tx</text>
<polyline fill="none" stroke="#8a8898" points="0,-88.5 240,-88.5 "/>
<text text-anchor="middle" x="120" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">...</text>
</g>
<!-- PeerMsgChannel -->
<g id="node5" class="node">
<title>PeerMsgChannel</title>
<path fill="#feed9b" stroke="#f7e495" d="M288,-186.5C288,-186.5 667,-186.5 667,-186.5 673,-186.5 679,-192.5 679,-198.5 679,-198.5 679,-212.5 679,-212.5 679,-218.5 673,-224.5 667,-224.5 667,-224.5 288,-224.5 288,-224.5 282,-224.5 276,-218.5 276,-212.5 276,-212.5 276,-198.5 276,-198.5 276,-192.5 282,-186.5 288,-186.5"/>
<text text-anchor="start" x="284" y="-209.3" font-family="Times,serif" font-size="14.00" fill="#40575d">PeerMsg</text>
<text text-anchor="middle" x="308.5" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Channel</text>
<polyline fill="none" stroke="#f7e495" points="341,-186.5 341,-224.5 "/>
<text text-anchor="middle" x="385" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftMessage</text>
<polyline fill="none" stroke="#f7e495" points="429,-186.5 429,-224.5 "/>
<text text-anchor="middle" x="478" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftCommand</text>
<polyline fill="none" stroke="#f7e495" points="527,-186.5 527,-224.5 "/>
<text text-anchor="middle" x="547.5" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#40575d">Tick</text>
<polyline fill="none" stroke="#f7e495" points="568,-186.5 568,-224.5 "/>
<text text-anchor="middle" x="609.5" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#40575d">Heartbeatpd</text>
<polyline fill="none" stroke="#f7e495" points="651,-186.5 651,-224.5 "/>
<text text-anchor="middle" x="665" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#40575d">...</text>
</g>
<!-- RaftRouter_normals&#45;&gt;PeerMsgChannel -->
<g id="edge1" class="edge">
<title>RaftRouter_normals:tx1&#45;&gt;PeerMsgChannel</title>
<path fill="none" stroke="#666666" d="M240,-207.5C248.41,-207.5 256.99,-207.49 265.66,-207.46"/>
<polygon fill="#666666" stroke="#666666" points="265.88,-210.96 275.87,-207.43 265.85,-203.96 265.88,-210.96"/>
</g>
<!-- PeerMsgChannel2 -->
<g id="node6" class="node">
<title>PeerMsgChannel2</title>
<path fill="none" stroke="#1c2123" d="M524,-164.5C524,-164.5 431,-164.5 431,-164.5 425,-164.5 419,-158.5 419,-152.5 419,-152.5 419,-140.5 419,-140.5 419,-134.5 425,-128.5 431,-128.5 431,-128.5 524,-128.5 524,-128.5 530,-128.5 536,-134.5 536,-140.5 536,-140.5 536,-152.5 536,-152.5 536,-158.5 530,-164.5 524,-164.5"/>
<text text-anchor="middle" x="477.5" y="-142.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerMsgChannel2</text>
</g>
<!-- RaftRouter_normals&#45;&gt;PeerMsgChannel2 -->
<g id="edge3" class="edge">
<title>RaftRouter_normals:tx2&#45;&gt;PeerMsgChannel2</title>
<path fill="none" stroke="#666666" d="M240,-145.5C296.81,-145.5 361.28,-145.79 408.55,-146.06"/>
<polygon fill="#666666" stroke="#666666" points="408.65,-149.56 418.67,-146.12 408.69,-142.56 408.65,-149.56"/>
</g>
<!-- PeerMsgChannel3 -->
<g id="node7" class="node">
<title>PeerMsgChannel3</title>
<path fill="none" stroke="#1c2123" d="M524,-110.5C524,-110.5 431,-110.5 431,-110.5 425,-110.5 419,-104.5 419,-98.5 419,-98.5 419,-86.5 419,-86.5 419,-80.5 425,-74.5 431,-74.5 431,-74.5 524,-74.5 524,-74.5 530,-74.5 536,-80.5 536,-86.5 536,-86.5 536,-98.5 536,-98.5 536,-104.5 530,-110.5 524,-110.5"/>
<text text-anchor="middle" x="477.5" y="-88.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerMsgChannel3</text>
</g>
<!-- RaftRouter_normals&#45;&gt;PeerMsgChannel3 -->
<g id="edge5" class="edge">
<title>RaftRouter_normals:tx3&#45;&gt;PeerMsgChannel3</title>
<path fill="none" stroke="#666666" d="M240,-99.5C296.83,-99.5 361.31,-97.46 408.57,-95.58"/>
<polygon fill="#666666" stroke="#666666" points="408.83,-99.07 418.68,-95.17 408.55,-92.07 408.83,-99.07"/>
</g>
<!-- RaftRouter_normalScheduler -->
<g id="node4" class="node">
<title>RaftRouter_normalScheduler</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M43.5,-0.5C43.5,-0.5 196.5,-0.5 196.5,-0.5 202.5,-0.5 208.5,-6.5 208.5,-12.5 208.5,-12.5 208.5,-34.5 208.5,-34.5 208.5,-40.5 202.5,-46.5 196.5,-46.5 196.5,-46.5 43.5,-46.5 43.5,-46.5 37.5,-46.5 31.5,-40.5 31.5,-34.5 31.5,-34.5 31.5,-12.5 31.5,-12.5 31.5,-6.5 37.5,-0.5 43.5,-0.5"/>
<text text-anchor="middle" x="120" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftRouter::normalScheduler</text>
<polyline fill="none" stroke="#8a8898" points="31.5,-23.5 208.5,-23.5 "/>
<text text-anchor="middle" x="120" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">tx</text>
</g>
<!-- RaftRouter_normalScheduler&#45;&gt;NormalChannel -->
<g id="edge7" class="edge">
<title>RaftRouter_normalScheduler&#45;&gt;NormalChannel:tail</title>
<path fill="none" stroke="#666666" d="M208.95,-32.65C322.65,-43.69 527.17,-60.85 704.95,-61.48"/>
<polygon fill="#666666" stroke="#666666" points="704.99,-64.98 715,-61.5 705.01,-57.98 704.99,-64.98"/>
</g>
<!-- PeerMsgChannel&#45;&gt;NormalChannel -->
<g id="edge2" class="edge">
<title>PeerMsgChannel&#45;&gt;NormalChannel:rx1</title>
<path fill="none" stroke="#666666" d="M679.06,-189.09C687.7,-188.82 696.29,-188.64 704.75,-188.55"/>
<polygon fill="#666666" stroke="#666666" points="705.02,-192.05 715,-188.5 704.98,-185.05 705.02,-192.05"/>
</g>
<!-- PeerMsgChannel2&#45;&gt;NormalChannel -->
<g id="edge4" class="edge">
<title>PeerMsgChannel2&#45;&gt;NormalChannel:rx2</title>
<path fill="none" stroke="#666666" d="M536.33,-144.98C581.59,-143.91 646.45,-142.65 704.92,-142.51"/>
<polygon fill="#666666" stroke="#666666" points="705,-146.01 715,-142.5 705,-139.01 705,-146.01"/>
</g>
<!-- PeerMsgChannel3&#45;&gt;NormalChannel -->
<g id="edge6" class="edge">
<title>PeerMsgChannel3&#45;&gt;NormalChannel:rx3</title>
<path fill="none" stroke="#666666" d="M536.33,-94.02C581.59,-95.09 646.45,-96.35 704.92,-96.49"/>
<polygon fill="#666666" stroke="#666666" points="705,-99.99 715,-96.5 705,-92.99 705,-99.99"/>
</g>
</g>
</svg>
