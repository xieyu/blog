<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: batch_system_create Pages: 1 -->
<svg width="1781pt" height="709pt"
 viewBox="0.00 0.00 1781.00 709.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 705)">
<title>batch_system_create</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-705 1777,-705 1777,4 -4,4"/>
<!-- create_raft_batch_system -->
<g id="node1" class="node">
<title>create_raft_batch_system</title>
<path fill="none" stroke="#1c2123" d="M336.5,-561C336.5,-561 481.5,-561 481.5,-561 487.5,-561 493.5,-567 493.5,-573 493.5,-573 493.5,-610 493.5,-610 493.5,-616 487.5,-622 481.5,-622 481.5,-622 336.5,-622 336.5,-622 330.5,-622 324.5,-616 324.5,-610 324.5,-610 324.5,-573 324.5,-573 324.5,-567 330.5,-561 336.5,-561"/>
<text text-anchor="middle" x="409" y="-606.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_raft_batch_system</text>
<polyline fill="none" stroke="#1c2123" points="324.5,-599 493.5,-599 "/>
<text text-anchor="start" x="332.5" y="-583.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建PeerFsm BatchSystem</text>
<text text-anchor="start" x="332.5" y="-568.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 和ApplyBatchSystem</text>
</g>
<!-- create_apply_batch_system -->
<g id="node2" class="node">
<title>create_apply_batch_system</title>
<path fill="none" stroke="#1c2123" d="M756,-602.5C756,-602.5 613,-602.5 613,-602.5 607,-602.5 601,-596.5 601,-590.5 601,-590.5 601,-578.5 601,-578.5 601,-572.5 607,-566.5 613,-566.5 613,-566.5 756,-566.5 756,-566.5 762,-566.5 768,-572.5 768,-578.5 768,-578.5 768,-590.5 768,-590.5 768,-596.5 762,-602.5 756,-602.5"/>
<text text-anchor="middle" x="684.5" y="-580.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_apply_batch_system</text>
</g>
<!-- create_raft_batch_system&#45;&gt;create_apply_batch_system -->
<g id="edge1" class="edge">
<title>create_raft_batch_system&#45;&gt;create_apply_batch_system</title>
<path fill="none" stroke="#666666" d="M493.55,-589.36C524.31,-588.57 559.32,-587.68 590.84,-586.87"/>
<polygon fill="#666666" stroke="#666666" points="591.03,-590.37 600.94,-586.61 590.85,-583.37 591.03,-590.37"/>
</g>
<!-- create_system_1 -->
<g id="node3" class="node">
<title>create_system_1</title>
<path fill="none" stroke="#1c2123" d="M945,-654.5C945,-654.5 1100,-654.5 1100,-654.5 1106,-654.5 1112,-660.5 1112,-666.5 1112,-666.5 1112,-688.5 1112,-688.5 1112,-694.5 1106,-700.5 1100,-700.5 1100,-700.5 945,-700.5 945,-700.5 939,-700.5 933,-694.5 933,-688.5 933,-688.5 933,-666.5 933,-666.5 933,-660.5 939,-654.5 945,-654.5"/>
<text text-anchor="middle" x="1022.5" y="-685.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_system</text>
<polyline fill="none" stroke="#1c2123" points="933,-677.5 1112,-677.5 "/>
<text text-anchor="start" x="941" y="-662.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建PeerFsm的BatchSystem</text>
</g>
<!-- create_raft_batch_system&#45;&gt;create_system_1 -->
<g id="edge2" class="edge">
<title>create_raft_batch_system&#45;&gt;create_system_1</title>
<path fill="none" stroke="#666666" d="M493.67,-603.81C511.28,-606.37 529.75,-609.04 547,-611.5 676.82,-630 826.72,-650.75 922.72,-663.96"/>
<polygon fill="#666666" stroke="#666666" points="922.33,-667.44 932.71,-665.33 923.28,-660.5 922.33,-667.44"/>
</g>
<!-- create_system -->
<g id="node4" class="node">
<title>create_system</title>
<path fill="none" stroke="#1c2123" d="M960,-462.5C960,-462.5 1085,-462.5 1085,-462.5 1091,-462.5 1097,-468.5 1097,-474.5 1097,-474.5 1097,-496.5 1097,-496.5 1097,-502.5 1091,-508.5 1085,-508.5 1085,-508.5 960,-508.5 960,-508.5 954,-508.5 948,-502.5 948,-496.5 948,-496.5 948,-474.5 948,-474.5 948,-468.5 954,-462.5 960,-462.5"/>
<text text-anchor="middle" x="1022.5" y="-493.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_system</text>
<polyline fill="none" stroke="#1c2123" points="948,-485.5 1097,-485.5 "/>
<text text-anchor="start" x="956" y="-470.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建apply Batchsystem</text>
</g>
<!-- create_apply_batch_system&#45;&gt;create_system -->
<g id="edge3" class="edge">
<title>create_apply_batch_system&#45;&gt;create_system</title>
<path fill="none" stroke="#666666" d="M727.01,-566.38C761.55,-551.85 812.27,-531.76 858,-518.5 883.53,-511.09 911.78,-504.76 937.52,-499.67"/>
<polygon fill="#666666" stroke="#666666" points="938.47,-503.05 947.62,-497.71 937.13,-496.18 938.47,-503.05"/>
</g>
<!-- RaftBatchSystem -->
<g id="node10" class="node">
<title>RaftBatchSystem</title>
<path fill="none" stroke="#1c2123" d="M1235,-468.5C1235,-468.5 1567,-468.5 1567,-468.5 1573,-468.5 1579,-474.5 1579,-480.5 1579,-480.5 1579,-594.5 1579,-594.5 1579,-600.5 1573,-606.5 1567,-606.5 1567,-606.5 1235,-606.5 1235,-606.5 1229,-606.5 1223,-600.5 1223,-594.5 1223,-594.5 1223,-480.5 1223,-480.5 1223,-474.5 1229,-468.5 1235,-468.5"/>
<text text-anchor="middle" x="1401" y="-591.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftBatchSystem</text>
<polyline fill="none" stroke="#1c2123" points="1223,-583.5 1579,-583.5 "/>
<text text-anchor="start" x="1231" y="-568.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">system: BatchSystem&lt;PeerFsm&lt;EK, ER&gt;, StoreFsm&lt;EK&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1223,-560.5 1579,-560.5 "/>
<text text-anchor="start" x="1231" y="-545.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_router: ApplyRouter&lt;EK&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1223,-537.5 1579,-537.5 "/>
<text text-anchor="start" x="1231" y="-522.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_system: ApplyBatchSystem&lt;EK&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1223,-514.5 1579,-514.5 "/>
<text text-anchor="start" x="1231" y="-499.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">router: RaftRouter&lt;EK, ER&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1223,-491.5 1579,-491.5 "/>
<text text-anchor="start" x="1231" y="-476.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">workers: Option&lt;Workers&lt;EK&gt;&gt;,</text>
</g>
<!-- create_system_1&#45;&gt;RaftBatchSystem -->
<g id="edge10" class="edge">
<title>create_system_1&#45;&gt;RaftBatchSystem:system</title>
<path fill="none" stroke="#666666" d="M1112.36,-674.23C1138.48,-669.6 1165.73,-660.78 1187,-644.5 1212.19,-625.22 1192.88,-583.52 1213.13,-574.32"/>
<polygon fill="#666666" stroke="#666666" points="1213.8,-577.76 1223,-572.5 1212.53,-570.87 1213.8,-577.76"/>
</g>
<!-- create_system&#45;&gt;RaftBatchSystem -->
<g id="edge11" class="edge">
<title>create_system&#45;&gt;RaftBatchSystem:apply_system</title>
<path fill="none" stroke="#666666" d="M1097.08,-500.34C1140.79,-509.14 1191.72,-519.38 1212.93,-523.57"/>
<polygon fill="#666666" stroke="#666666" points="1212.52,-527.05 1223,-525.5 1213.84,-520.18 1212.52,-527.05"/>
</g>
<!-- TiKVServer_init -->
<g id="node5" class="node">
<title>TiKVServer_init</title>
<path fill="none" stroke="#1c2123" d="M200,-513.5C200,-513.5 259,-513.5 259,-513.5 265,-513.5 271,-519.5 271,-525.5 271,-525.5 271,-539.5 271,-539.5 271,-545.5 265,-551.5 259,-551.5 259,-551.5 200,-551.5 200,-551.5 194,-551.5 188,-545.5 188,-539.5 188,-539.5 188,-525.5 188,-525.5 188,-519.5 194,-513.5 200,-513.5"/>
<text text-anchor="middle" x="229.5" y="-536.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">TiKVServer</text>
<text text-anchor="middle" x="229.5" y="-521.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> init</text>
</g>
<!-- TiKVServer_init&#45;&gt;create_raft_batch_system -->
<g id="edge4" class="edge">
<title>TiKVServer_init&#45;&gt;create_raft_batch_system</title>
<path fill="none" stroke="#666666" d="M271.22,-546.04C284.36,-550.4 299.51,-555.44 314.83,-560.53"/>
<polygon fill="#666666" stroke="#666666" points="313.78,-563.87 324.38,-563.7 315.99,-557.23 313.78,-563.87"/>
</g>
<!-- TiKVServer -->
<g id="node6" class="node">
<title>TiKVServer</title>
<path fill="none" stroke="#1c2123" d="M870,-528C870,-528 1175,-528 1175,-528 1181,-528 1187,-534 1187,-540 1187,-540 1187,-623 1187,-623 1187,-629 1181,-635 1175,-635 1175,-635 870,-635 870,-635 864,-635 858,-629 858,-623 858,-623 858,-540 858,-540 858,-534 864,-528 870,-528"/>
<text text-anchor="middle" x="1022.5" y="-619.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">TiKVServer</text>
<polyline fill="none" stroke="#1c2123" points="858,-612 1187,-612 "/>
<text text-anchor="start" x="866" y="-596.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">config: TiKVConfig</text>
<polyline fill="none" stroke="#1c2123" points="858,-589 1187,-589 "/>
<text text-anchor="start" x="866" y="-573.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">router: RaftRouter&lt;RocksEngine, ER&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="858,-566 1187,-566 "/>
<text text-anchor="start" x="866" y="-550.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">system: Option&lt;RaftBatchSystem&lt;RocksEngine, ER&gt;&gt;,</text>
<text text-anchor="start" x="866" y="-535.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ...</text>
</g>
<!-- TiKVServer_init&#45;&gt;TiKVServer -->
<g id="edge5" class="edge">
<title>TiKVServer_init&#45;&gt;TiKVServer</title>
<path fill="none" stroke="#666666" d="M271.09,-533.13C367.03,-534.86 615.32,-540.73 822,-557.5 830.37,-558.18 838.93,-558.94 847.58,-559.77"/>
<polygon fill="#666666" stroke="#666666" points="847.46,-563.28 857.75,-560.77 848.14,-556.31 847.46,-563.28"/>
</g>
<!-- TiKVServer&#45;&gt;RaftBatchSystem -->
<g id="edge9" class="edge">
<title>TiKVServer:system&#45;&gt;RaftBatchSystem</title>
<path fill="none" stroke="#666666" d="M1187,-546.5C1195.38,-546.5 1203.94,-546.43 1212.59,-546.3"/>
<polygon fill="#666666" stroke="#666666" points="1212.84,-549.8 1222.78,-546.12 1212.72,-542.8 1212.84,-549.8"/>
</g>
<!-- main -->
<g id="node7" class="node">
<title>main</title>
<path fill="none" stroke="#1c2123" d="M42,-489.5C42,-489.5 12,-489.5 12,-489.5 6,-489.5 0,-483.5 0,-477.5 0,-477.5 0,-465.5 0,-465.5 0,-459.5 6,-453.5 12,-453.5 12,-453.5 42,-453.5 42,-453.5 48,-453.5 54,-459.5 54,-465.5 54,-465.5 54,-477.5 54,-477.5 54,-483.5 48,-489.5 42,-489.5"/>
<text text-anchor="middle" x="27" y="-467.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">main</text>
</g>
<!-- run_tikv -->
<g id="node8" class="node">
<title>run_tikv</title>
<path fill="none" stroke="#1c2123" d="M102,-448.5C102,-448.5 140,-448.5 140,-448.5 146,-448.5 152,-454.5 152,-460.5 152,-460.5 152,-482.5 152,-482.5 152,-488.5 146,-494.5 140,-494.5 140,-494.5 102,-494.5 102,-494.5 96,-494.5 90,-488.5 90,-482.5 90,-482.5 90,-460.5 90,-460.5 90,-454.5 96,-448.5 102,-448.5"/>
<text text-anchor="middle" x="121" y="-479.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">run_tikv</text>
<polyline fill="none" stroke="#1c2123" points="90,-471.5 152,-471.5 "/>
<text text-anchor="middle" x="121" y="-456.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">主循环</text>
</g>
<!-- main&#45;&gt;run_tikv -->
<g id="edge6" class="edge">
<title>main&#45;&gt;run_tikv</title>
<path fill="none" stroke="#666666" d="M54.12,-471.5C62.14,-471.5 71.15,-471.5 79.88,-471.5"/>
<polygon fill="#666666" stroke="#666666" points="79.92,-475 89.92,-471.5 79.92,-468 79.92,-475"/>
</g>
<!-- run_tikv&#45;&gt;TiKVServer_init -->
<g id="edge7" class="edge">
<title>run_tikv&#45;&gt;TiKVServer_init</title>
<path fill="none" stroke="#666666" d="M152.23,-488.82C162.81,-494.88 174.89,-501.79 186.27,-508.31"/>
<polygon fill="#666666" stroke="#666666" points="184.78,-511.49 195.2,-513.43 188.26,-505.42 184.78,-511.49"/>
</g>
<!-- TiKVServer_init_servers -->
<g id="node9" class="node">
<title>TiKVServer_init_servers</title>
<path fill="none" stroke="#1c2123" d="M200,-424.5C200,-424.5 259,-424.5 259,-424.5 265,-424.5 271,-430.5 271,-436.5 271,-436.5 271,-450.5 271,-450.5 271,-456.5 265,-462.5 259,-462.5 259,-462.5 200,-462.5 200,-462.5 194,-462.5 188,-456.5 188,-450.5 188,-450.5 188,-436.5 188,-436.5 188,-430.5 194,-424.5 200,-424.5"/>
<text text-anchor="middle" x="229.5" y="-447.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">TiKVServer</text>
<text text-anchor="middle" x="229.5" y="-432.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> init_servers</text>
</g>
<!-- run_tikv&#45;&gt;TiKVServer_init_servers -->
<g id="edge8" class="edge">
<title>run_tikv&#45;&gt;TiKVServer_init_servers</title>
<path fill="none" stroke="#666666" d="M152.23,-463.55C160.28,-461.44 169.19,-459.09 178,-456.78"/>
<polygon fill="#666666" stroke="#666666" points="179.07,-460.12 187.85,-454.19 177.29,-453.35 179.07,-460.12"/>
</g>
<!-- Node_new -->
<g id="node11" class="node">
<title>Node_new</title>
<path fill="none" stroke="#1c2123" d="M559,-426C559,-426 810,-426 810,-426 816,-426 822,-432 822,-438 822,-438 822,-483 822,-483 822,-489 816,-495 810,-495 810,-495 559,-495 559,-495 553,-495 547,-489 547,-483 547,-483 547,-438 547,-438 547,-432 553,-426 559,-426"/>
<text text-anchor="middle" x="684.5" y="-479.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Node_new</text>
<polyline fill="none" stroke="#1c2123" points="547,-472 822,-472 "/>
<text text-anchor="start" x="555" y="-456.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Node包含了对RaftBatchSystem的clone</text>
<polyline fill="none" stroke="#1c2123" points="547,-449 822,-449 "/>
<text text-anchor="start" x="555" y="-433.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">system: RaftBatchSystem&lt;RocksEngine, ER&gt;,</text>
</g>
<!-- TiKVServer_init_servers&#45;&gt;Node_new -->
<g id="edge12" class="edge">
<title>TiKVServer_init_servers&#45;&gt;Node_new</title>
<path fill="none" stroke="#666666" d="M271.29,-458.16C282.69,-461.6 295.2,-464.76 307,-466.5 382.21,-477.56 466.77,-477.34 536.68,-473.8"/>
<polygon fill="#666666" stroke="#666666" points="537.08,-477.28 546.88,-473.25 536.71,-470.29 537.08,-477.28"/>
</g>
<!-- Node_try_bootstrap_store -->
<g id="node12" class="node">
<title>Node_try_bootstrap_store</title>
<path fill="none" stroke="#1c2123" d="M348.5,-366C348.5,-366 469.5,-366 469.5,-366 475.5,-366 481.5,-372 481.5,-378 481.5,-378 481.5,-445 481.5,-445 481.5,-451 475.5,-457 469.5,-457 469.5,-457 348.5,-457 348.5,-457 342.5,-457 336.5,-451 336.5,-445 336.5,-445 336.5,-378 336.5,-378 336.5,-372 342.5,-366 348.5,-366"/>
<text text-anchor="middle" x="409" y="-441.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Node</text>
<text text-anchor="middle" x="409" y="-426.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> try_bootstrap_store</text>
<polyline fill="none" stroke="#1c2123" points="336.5,-419 481.5,-419 "/>
<text text-anchor="start" x="344.5" y="-403.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">从kv engine读取</text>
<text text-anchor="start" x="344.5" y="-388.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> STORE_IDENT_KEY</text>
<text text-anchor="start" x="344.5" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 获取store_id</text>
</g>
<!-- TiKVServer_init_servers&#45;&gt;Node_try_bootstrap_store -->
<g id="edge13" class="edge">
<title>TiKVServer_init_servers&#45;&gt;Node_try_bootstrap_store</title>
<path fill="none" stroke="#666666" d="M271.22,-436.16C287.7,-433.19 307.33,-429.65 326.5,-426.19"/>
<polygon fill="#666666" stroke="#666666" points="327.25,-429.61 336.47,-424.4 326.01,-422.72 327.25,-429.61"/>
</g>
<!-- Node_start -->
<g id="node13" class="node">
<title>Node_start</title>
<path fill="none" stroke="#1c2123" d="M319,-256C319,-256 499,-256 499,-256 505,-256 511,-262 511,-268 511,-268 511,-335 511,-335 511,-341 505,-347 499,-347 499,-347 319,-347 319,-347 313,-347 307,-341 307,-335 307,-335 307,-268 307,-268 307,-262 313,-256 319,-256"/>
<text text-anchor="middle" x="409" y="-331.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Node_start</text>
<polyline fill="none" stroke="#1c2123" points="307,-324 511,-324 "/>
<text text-anchor="start" x="315" y="-308.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">扫描KVEngine的CRAFT familly</text>
<text text-anchor="start" x="315" y="-293.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 创建初始化PeerFsm/ApplyFsm</text>
<text text-anchor="start" x="315" y="-278.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 开启RaftPoller</text>
<text text-anchor="start" x="315" y="-263.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 和ApplyPoller线程池</text>
</g>
<!-- TiKVServer_init_servers&#45;&gt;Node_start -->
<g id="edge14" class="edge">
<title>TiKVServer_init_servers&#45;&gt;Node_start</title>
<path fill="none" stroke="#666666" d="M244.1,-424.45C258.26,-405.55 281.86,-376.59 307,-356.5 308.39,-355.39 309.81,-354.28 311.26,-353.19"/>
<polygon fill="#666666" stroke="#666666" points="313.68,-355.76 319.74,-347.07 309.58,-350.09 313.68,-355.76"/>
</g>
<!-- Node_new&#45;&gt;RaftBatchSystem -->
<g id="edge26" class="edge">
<title>Node_new:system&#45;&gt;RaftBatchSystem</title>
<path fill="none" stroke="#666666" d="M822,-437.5C984.38,-437.5 1028.18,-419.69 1187,-453.5 1201.75,-456.64 1216.81,-460.69 1231.76,-465.32"/>
<polygon fill="#666666" stroke="#666666" points="1230.97,-468.74 1241.56,-468.44 1233.09,-462.07 1230.97,-468.74"/>
</g>
<!-- Node_start_store -->
<g id="node14" class="node">
<title>Node_start_store</title>
<path fill="none" stroke="#1c2123" d="M658,-282.5C658,-282.5 711,-282.5 711,-282.5 717,-282.5 723,-288.5 723,-294.5 723,-294.5 723,-308.5 723,-308.5 723,-314.5 717,-320.5 711,-320.5 711,-320.5 658,-320.5 658,-320.5 652,-320.5 646,-314.5 646,-308.5 646,-308.5 646,-294.5 646,-294.5 646,-288.5 652,-282.5 658,-282.5"/>
<text text-anchor="middle" x="684.5" y="-305.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Node</text>
<text text-anchor="middle" x="684.5" y="-290.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> start_store</text>
</g>
<!-- Node_start&#45;&gt;Node_start_store -->
<g id="edge15" class="edge">
<title>Node_start&#45;&gt;Node_start_store</title>
<path fill="none" stroke="#666666" d="M511.06,-301.5C553.68,-301.5 601.26,-301.5 635.63,-301.5"/>
<polygon fill="#666666" stroke="#666666" points="635.85,-305 645.85,-301.5 635.85,-298 635.85,-305"/>
</g>
<!-- RaftBatchSystem_spawn -->
<g id="node15" class="node">
<title>RaftBatchSystem_spawn</title>
<path fill="none" stroke="#1c2123" d="M970.5,-260C970.5,-260 1074.5,-260 1074.5,-260 1080.5,-260 1086.5,-266 1086.5,-272 1086.5,-272 1086.5,-331 1086.5,-331 1086.5,-337 1080.5,-343 1074.5,-343 1074.5,-343 970.5,-343 970.5,-343 964.5,-343 958.5,-337 958.5,-331 958.5,-331 958.5,-272 958.5,-272 958.5,-266 964.5,-260 970.5,-260"/>
<text text-anchor="middle" x="1022.5" y="-327.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftBatchSystem</text>
<text text-anchor="start" x="966.5" y="-312.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> spawn</text>
<text text-anchor="start" x="966.5" y="-297.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 启动RaftPoller</text>
<text text-anchor="start" x="966.5" y="-282.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ApplyPoller线程池</text>
<text text-anchor="start" x="966.5" y="-267.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 启动一些worker</text>
</g>
<!-- Node_start_store&#45;&gt;RaftBatchSystem_spawn -->
<g id="edge16" class="edge">
<title>Node_start_store&#45;&gt;RaftBatchSystem_spawn</title>
<path fill="none" stroke="#666666" d="M723.07,-301.5C777.31,-301.5 878.65,-301.5 948.06,-301.5"/>
<polygon fill="#666666" stroke="#666666" points="948.49,-305 958.49,-301.5 948.49,-298 948.49,-305"/>
</g>
<!-- RaftPollerBuilder_init -->
<g id="node16" class="node">
<title>RaftPollerBuilder_init</title>
<path fill="none" stroke="#1c2123" d="M1351.5,-163.5C1351.5,-163.5 1450.5,-163.5 1450.5,-163.5 1456.5,-163.5 1462.5,-169.5 1462.5,-175.5 1462.5,-175.5 1462.5,-257.5 1462.5,-257.5 1462.5,-263.5 1456.5,-269.5 1450.5,-269.5 1450.5,-269.5 1351.5,-269.5 1351.5,-269.5 1345.5,-269.5 1339.5,-263.5 1339.5,-257.5 1339.5,-257.5 1339.5,-175.5 1339.5,-175.5 1339.5,-169.5 1345.5,-163.5 1351.5,-163.5"/>
<text text-anchor="middle" x="1401" y="-254.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftPollerBuilder</text>
<text text-anchor="middle" x="1401" y="-239.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> init</text>
<polyline fill="none" stroke="#1c2123" points="1339.5,-231.5 1462.5,-231.5 "/>
<text text-anchor="start" x="1347.5" y="-216.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">扫描kv engine</text>
<text text-anchor="start" x="1347.5" y="-201.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 创建PeerFsm</text>
<text text-anchor="start" x="1347.5" y="-186.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 初始化RaftRouter</text>
<text text-anchor="start" x="1347.5" y="-171.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> normals</text>
</g>
<!-- RaftBatchSystem_spawn&#45;&gt;RaftPollerBuilder_init -->
<g id="edge17" class="edge">
<title>RaftBatchSystem_spawn&#45;&gt;RaftPollerBuilder_init</title>
<path fill="none" stroke="#666666" d="M1086.52,-287.27C1153.56,-272.14 1259.38,-248.25 1329.24,-232.48"/>
<polygon fill="#666666" stroke="#666666" points="1330.29,-235.83 1339.27,-230.21 1328.75,-229 1330.29,-235.83"/>
</g>
<!-- RaftBatchSystem_start_system -->
<g id="node17" class="node">
<title>RaftBatchSystem_start_system</title>
<path fill="none" stroke="#1c2123" d="M1357,-106.5C1357,-106.5 1445,-106.5 1445,-106.5 1451,-106.5 1457,-112.5 1457,-118.5 1457,-118.5 1457,-132.5 1457,-132.5 1457,-138.5 1451,-144.5 1445,-144.5 1445,-144.5 1357,-144.5 1357,-144.5 1351,-144.5 1345,-138.5 1345,-132.5 1345,-132.5 1345,-118.5 1345,-118.5 1345,-112.5 1351,-106.5 1357,-106.5"/>
<text text-anchor="middle" x="1401" y="-129.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftBatchSystem</text>
<text text-anchor="middle" x="1401" y="-114.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> start_system</text>
</g>
<!-- RaftBatchSystem_spawn&#45;&gt;RaftBatchSystem_start_system -->
<g id="edge18" class="edge">
<title>RaftBatchSystem_spawn&#45;&gt;RaftBatchSystem_start_system</title>
<path fill="none" stroke="#666666" d="M1066.35,-259.96C1104.34,-225.67 1162.96,-178.71 1223,-153.5 1258.09,-138.76 1300.07,-131.72 1334.34,-128.38"/>
<polygon fill="#666666" stroke="#666666" points="1335.06,-131.83 1344.71,-127.45 1334.44,-124.85 1335.06,-131.83"/>
</g>
<!-- snapshot_worker -->
<g id="node18" class="node">
<title>snapshot_worker</title>
<path fill="none" stroke="#1c2123" d="M1443.5,-87.5C1443.5,-87.5 1358.5,-87.5 1358.5,-87.5 1352.5,-87.5 1346.5,-81.5 1346.5,-75.5 1346.5,-75.5 1346.5,-63.5 1346.5,-63.5 1346.5,-57.5 1352.5,-51.5 1358.5,-51.5 1358.5,-51.5 1443.5,-51.5 1443.5,-51.5 1449.5,-51.5 1455.5,-57.5 1455.5,-63.5 1455.5,-63.5 1455.5,-75.5 1455.5,-75.5 1455.5,-81.5 1449.5,-87.5 1443.5,-87.5"/>
<text text-anchor="middle" x="1401" y="-65.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">snapshot_worker</text>
</g>
<!-- RaftBatchSystem_spawn&#45;&gt;snapshot_worker -->
<g id="edge19" class="edge">
<title>RaftBatchSystem_spawn&#45;&gt;snapshot_worker</title>
<path fill="none" stroke="#666666" d="M1051.1,-259.87C1085.33,-211.94 1148.37,-134.9 1223,-96.5 1257.72,-78.64 1300.97,-71.8 1336.04,-69.48"/>
<polygon fill="#666666" stroke="#666666" points="1336.37,-72.96 1346.16,-68.91 1335.98,-65.97 1336.37,-72.96"/>
</g>
<!-- raft_gc_worker -->
<g id="node19" class="node">
<title>raft_gc_worker</title>
<path fill="none" stroke="#1c2123" d="M1439,-432.5C1439,-432.5 1363,-432.5 1363,-432.5 1357,-432.5 1351,-426.5 1351,-420.5 1351,-420.5 1351,-408.5 1351,-408.5 1351,-402.5 1357,-396.5 1363,-396.5 1363,-396.5 1439,-396.5 1439,-396.5 1445,-396.5 1451,-402.5 1451,-408.5 1451,-408.5 1451,-420.5 1451,-420.5 1451,-426.5 1445,-432.5 1439,-432.5"/>
<text text-anchor="middle" x="1401" y="-410.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_gc_worker</text>
</g>
<!-- RaftBatchSystem_spawn&#45;&gt;raft_gc_worker -->
<g id="edge20" class="edge">
<title>RaftBatchSystem_spawn&#45;&gt;raft_gc_worker</title>
<path fill="none" stroke="#666666" d="M1086.66,-333.67C1125.16,-352.02 1175.87,-373.99 1223,-387.5 1261.48,-398.53 1306.04,-405.3 1340.82,-409.3"/>
<polygon fill="#666666" stroke="#666666" points="1340.5,-412.78 1350.82,-410.4 1341.27,-405.82 1340.5,-412.78"/>
</g>
<!-- cleanup_worker -->
<g id="node20" class="node">
<title>cleanup_worker</title>
<path fill="none" stroke="#1c2123" d="M1441,-378.5C1441,-378.5 1361,-378.5 1361,-378.5 1355,-378.5 1349,-372.5 1349,-366.5 1349,-366.5 1349,-354.5 1349,-354.5 1349,-348.5 1355,-342.5 1361,-342.5 1361,-342.5 1441,-342.5 1441,-342.5 1447,-342.5 1453,-348.5 1453,-354.5 1453,-354.5 1453,-366.5 1453,-366.5 1453,-372.5 1447,-378.5 1441,-378.5"/>
<text text-anchor="middle" x="1401" y="-356.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">cleanup_worker</text>
</g>
<!-- RaftBatchSystem_spawn&#45;&gt;cleanup_worker -->
<g id="edge21" class="edge">
<title>RaftBatchSystem_spawn&#45;&gt;cleanup_worker</title>
<path fill="none" stroke="#666666" d="M1086.82,-311.78C1126.03,-318.12 1177.43,-326.37 1223,-333.5 1261.41,-339.51 1304.53,-346.09 1338.6,-351.25"/>
<polygon fill="#666666" stroke="#666666" points="1338.45,-354.77 1348.86,-352.81 1339.5,-347.85 1338.45,-354.77"/>
</g>
<!-- consistency_check_worker -->
<g id="node21" class="node">
<title>consistency_check_worker</title>
<path fill="none" stroke="#1c2123" d="M1470.5,-324.5C1470.5,-324.5 1331.5,-324.5 1331.5,-324.5 1325.5,-324.5 1319.5,-318.5 1319.5,-312.5 1319.5,-312.5 1319.5,-300.5 1319.5,-300.5 1319.5,-294.5 1325.5,-288.5 1331.5,-288.5 1331.5,-288.5 1470.5,-288.5 1470.5,-288.5 1476.5,-288.5 1482.5,-294.5 1482.5,-300.5 1482.5,-300.5 1482.5,-312.5 1482.5,-312.5 1482.5,-318.5 1476.5,-324.5 1470.5,-324.5"/>
<text text-anchor="middle" x="1401" y="-302.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">consistency_check_worker</text>
</g>
<!-- RaftBatchSystem_spawn&#45;&gt;consistency_check_worker -->
<g id="edge22" class="edge">
<title>RaftBatchSystem_spawn&#45;&gt;consistency_check_worker</title>
<path fill="none" stroke="#666666" d="M1086.52,-302.34C1147.35,-303.14 1240.1,-304.38 1308.96,-305.29"/>
<polygon fill="#666666" stroke="#666666" points="1309.32,-308.8 1319.36,-305.43 1309.41,-301.8 1309.32,-308.8"/>
</g>
<!-- ApplyPollerBuilder_new -->
<g id="node22" class="node">
<title>ApplyPollerBuilder_new</title>
<path fill="none" stroke="#1c2123" d="M1644.5,-182.5C1644.5,-182.5 1743.5,-182.5 1743.5,-182.5 1749.5,-182.5 1755.5,-188.5 1755.5,-194.5 1755.5,-194.5 1755.5,-208.5 1755.5,-208.5 1755.5,-214.5 1749.5,-220.5 1743.5,-220.5 1743.5,-220.5 1644.5,-220.5 1644.5,-220.5 1638.5,-220.5 1632.5,-214.5 1632.5,-208.5 1632.5,-208.5 1632.5,-194.5 1632.5,-194.5 1632.5,-188.5 1638.5,-182.5 1644.5,-182.5"/>
<text text-anchor="middle" x="1694" y="-205.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ApplyPollerBuilder</text>
<text text-anchor="middle" x="1694" y="-190.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> new</text>
</g>
<!-- RaftBatchSystem_start_system&#45;&gt;ApplyPollerBuilder_new -->
<g id="edge23" class="edge">
<title>RaftBatchSystem_start_system&#45;&gt;ApplyPollerBuilder_new</title>
<path fill="none" stroke="#666666" d="M1457.33,-129.55C1492.8,-133.28 1539.44,-140.34 1579,-153.5 1596.17,-159.21 1598.49,-165.11 1615,-172.5 1619.66,-174.59 1624.52,-176.65 1629.44,-178.65"/>
<polygon fill="#666666" stroke="#666666" points="1628.34,-181.98 1638.92,-182.43 1630.93,-175.48 1628.34,-181.98"/>
</g>
<!-- BatchSystem_spawn -->
<g id="node23" class="node">
<title>BatchSystem_spawn</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M1634.5,-87.5C1634.5,-87.5 1753.5,-87.5 1753.5,-87.5 1759.5,-87.5 1765.5,-93.5 1765.5,-99.5 1765.5,-99.5 1765.5,-151.5 1765.5,-151.5 1765.5,-157.5 1759.5,-163.5 1753.5,-163.5 1753.5,-163.5 1634.5,-163.5 1634.5,-163.5 1628.5,-163.5 1622.5,-157.5 1622.5,-151.5 1622.5,-151.5 1622.5,-99.5 1622.5,-99.5 1622.5,-93.5 1628.5,-87.5 1634.5,-87.5"/>
<text text-anchor="middle" x="1694" y="-148.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">BatchSystem</text>
<text text-anchor="middle" x="1694" y="-133.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> spawn</text>
<polyline fill="none" stroke="#8a8898" points="1622.5,-125.5 1765.5,-125.5 "/>
<text text-anchor="start" x="1630.5" y="-110.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">启动RaftPoller线程池</text>
<text text-anchor="start" x="1630.5" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 开始poll PeerFsm</text>
</g>
<!-- RaftBatchSystem_start_system&#45;&gt;BatchSystem_spawn -->
<g id="edge24" class="edge">
<title>RaftBatchSystem_start_system&#45;&gt;BatchSystem_spawn</title>
<path fill="none" stroke="#666666" d="M1457.08,-125.5C1500.93,-125.5 1562.95,-125.5 1612.39,-125.5"/>
<polygon fill="#666666" stroke="#666666" points="1612.42,-129 1622.42,-125.5 1612.42,-122 1612.42,-129"/>
</g>
<!-- ApplyBatchSystem_spawn -->
<g id="node24" class="node">
<title>ApplyBatchSystem_spawn</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M1627,-0.5C1627,-0.5 1761,-0.5 1761,-0.5 1767,-0.5 1773,-6.5 1773,-12.5 1773,-12.5 1773,-56.5 1773,-56.5 1773,-62.5 1767,-68.5 1761,-68.5 1761,-68.5 1627,-68.5 1627,-68.5 1621,-68.5 1615,-62.5 1615,-56.5 1615,-56.5 1615,-12.5 1615,-12.5 1615,-6.5 1621,-0.5 1627,-0.5"/>
<text text-anchor="middle" x="1694" y="-53.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ApplyBatchSystem</text>
<text text-anchor="middle" x="1694" y="-38.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> spawn</text>
<text text-anchor="start" x="1623" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 启动ApplyPoller线程池</text>
<text text-anchor="start" x="1623" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 开始poll ApplyFsm</text>
</g>
<!-- RaftBatchSystem_start_system&#45;&gt;ApplyBatchSystem_spawn -->
<g id="edge25" class="edge">
<title>RaftBatchSystem_start_system&#45;&gt;ApplyBatchSystem_spawn</title>
<path fill="none" stroke="#666666" d="M1457.39,-121.24C1492.88,-117.34 1539.53,-110.03 1579,-96.5 1580.39,-96.02 1599.52,-85.67 1621.73,-73.55"/>
<polygon fill="#666666" stroke="#666666" points="1623.6,-76.52 1630.7,-68.66 1620.25,-70.38 1623.6,-76.52"/>
</g>
</g>
</svg>
