<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: call_write_peer_state Pages: 1 -->
<svg width="1341pt" height="654pt"
 viewBox="0.00 0.00 1341.00 654.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 650)">
<title>call_write_peer_state</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-650 1337,-650 1337,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_PeerStorage</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M663,-124C663,-124 1290.5,-124 1290.5,-124 1296.5,-124 1302.5,-130 1302.5,-136 1302.5,-136 1302.5,-194 1302.5,-194 1302.5,-200 1296.5,-206 1290.5,-206 1290.5,-206 663,-206 663,-206 657,-206 651,-200 651,-194 651,-194 651,-136 651,-136 651,-130 657,-124 663,-124"/>
<text text-anchor="middle" x="976.75" y="-186" font-family="Times,serif" font-size="20.00">PeerStorage</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ApplyDelegate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-218C20,-218 1313,-218 1313,-218 1319,-218 1325,-224 1325,-230 1325,-230 1325,-626 1325,-626 1325,-632 1319,-638 1313,-638 1313,-638 20,-638 20,-638 14,-638 8,-632 8,-626 8,-626 8,-230 8,-230 8,-224 14,-218 20,-218"/>
<text text-anchor="middle" x="666.5" y="-618" font-family="Times,serif" font-size="20.00">ApplyDelegate</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_PeerFsmDelgate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M913,-8C913,-8 1099,-8 1099,-8 1105,-8 1111,-14 1111,-20 1111,-20 1111,-104 1111,-104 1111,-110 1105,-116 1099,-116 1099,-116 913,-116 913,-116 907,-116 901,-110 901,-104 901,-104 901,-20 901,-20 901,-14 907,-8 913,-8"/>
<text text-anchor="middle" x="1006" y="-96" font-family="Times,serif" font-size="20.00">PeerFsmDelgate</text>
</g>
<!-- apply_snapshot -->
<g id="node1" class="node">
<title>apply_snapshot</title>
<path fill="none" stroke="#1c2123" d="M1044.5,-168C1044.5,-168 967.5,-168 967.5,-168 961.5,-168 955.5,-162 955.5,-156 955.5,-156 955.5,-144 955.5,-144 955.5,-138 961.5,-132 967.5,-132 967.5,-132 1044.5,-132 1044.5,-132 1050.5,-132 1056.5,-138 1056.5,-144 1056.5,-144 1056.5,-156 1056.5,-156 1056.5,-162 1050.5,-168 1044.5,-168"/>
<text text-anchor="middle" x="1006" y="-146.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_snapshot</text>
</g>
<!-- write_peer_state -->
<g id="node2" class="node">
<title>write_peer_state</title>
<path fill="none" stroke="#1c2123" d="M1282.5,-168C1282.5,-168 1200.5,-168 1200.5,-168 1194.5,-168 1188.5,-162 1188.5,-156 1188.5,-156 1188.5,-144 1188.5,-144 1188.5,-138 1194.5,-132 1200.5,-132 1200.5,-132 1282.5,-132 1282.5,-132 1288.5,-132 1294.5,-138 1294.5,-144 1294.5,-144 1294.5,-156 1294.5,-156 1294.5,-162 1288.5,-168 1282.5,-168"/>
<text text-anchor="middle" x="1241.5" y="-146.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_peer_state</text>
</g>
<!-- apply_snapshot&#45;&gt;write_peer_state -->
<g id="edge1" class="edge">
<title>apply_snapshot&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M1056.52,-150C1091.88,-150 1139.73,-150 1177.77,-150"/>
<polygon fill="#666666" stroke="#666666" points="1178.22,-153.5 1188.22,-150 1178.22,-146.5 1178.22,-153.5"/>
</g>
<!-- handle_raft_ready -->
<g id="node3" class="node">
<title>handle_raft_ready</title>
<path fill="none" stroke="#1c2123" d="M762,-168C762,-168 671,-168 671,-168 665,-168 659,-162 659,-156 659,-156 659,-144 659,-144 659,-138 665,-132 671,-132 671,-132 762,-132 762,-132 768,-132 774,-138 774,-144 774,-144 774,-156 774,-156 774,-162 768,-168 762,-168"/>
<text text-anchor="middle" x="716.5" y="-146.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_ready</text>
</g>
<!-- handle_raft_ready&#45;&gt;apply_snapshot -->
<g id="edge2" class="edge">
<title>handle_raft_ready&#45;&gt;apply_snapshot</title>
<path fill="none" stroke="#666666" d="M774.3,-150C823.6,-150 894.75,-150 944.97,-150"/>
<polygon fill="#666666" stroke="#666666" points="945.04,-153.5 955.04,-150 945.04,-146.5 945.04,-153.5"/>
</g>
<!-- apply_raft_cmd -->
<g id="node4" class="node">
<title>apply_raft_cmd</title>
<path fill="none" stroke="#1c2123" d="M28,-453C28,-453 194,-453 194,-453 200,-453 206,-459 206,-465 206,-465 206,-487 206,-487 206,-493 200,-499 194,-499 194,-499 28,-499 28,-499 22,-499 16,-493 16,-487 16,-487 16,-465 16,-465 16,-459 22,-453 28,-453"/>
<text text-anchor="middle" x="111" y="-483.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_raft_cmd</text>
<polyline fill="none" stroke="#1c2123" points="16,-476 206,-476 "/>
<text text-anchor="start" x="24" y="-460.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.region = exec_result.region</text>
</g>
<!-- region -->
<g id="node5" class="node">
<title>region</title>
<path fill="#feed9b" stroke="#f7e495" d="M254,-423C254,-423 390,-423 390,-423 396,-423 402,-429 402,-435 402,-435 402,-457 402,-457 402,-463 396,-469 390,-469 390,-469 254,-469 254,-469 248,-469 242,-463 242,-457 242,-457 242,-435 242,-435 242,-429 248,-423 254,-423"/>
<text text-anchor="middle" x="322" y="-453.8" font-family="Times,serif" font-size="14.00" fill="#40575d">region</text>
<polyline fill="none" stroke="#f7e495" points="242,-446 402,-446 "/>
<text text-anchor="start" x="250" y="-430.8" font-family="Times,serif" font-size="14.00" fill="#40575d">更新内存中的self.region</text>
</g>
<!-- apply_raft_cmd&#45;&gt;region -->
<g id="edge3" class="edge">
<title>apply_raft_cmd&#45;&gt;region</title>
<path fill="none" stroke="#666666" d="M206.11,-462.49C214.67,-461.26 223.33,-460.02 231.85,-458.8"/>
<polygon fill="#666666" stroke="#666666" points="232.38,-462.26 241.78,-457.37 231.38,-455.33 232.38,-462.26"/>
</g>
<!-- exec_raft_cmd -->
<g id="node6" class="node">
<title>exec_raft_cmd</title>
<path fill="none" stroke="#1c2123" d="M359,-524C359,-524 285,-524 285,-524 279,-524 273,-518 273,-512 273,-512 273,-500 273,-500 273,-494 279,-488 285,-488 285,-488 359,-488 359,-488 365,-488 371,-494 371,-500 371,-500 371,-512 371,-512 371,-518 365,-524 359,-524"/>
<text text-anchor="middle" x="322" y="-502.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_raft_cmd</text>
</g>
<!-- apply_raft_cmd&#45;&gt;exec_raft_cmd -->
<g id="edge4" class="edge">
<title>apply_raft_cmd&#45;&gt;exec_raft_cmd</title>
<path fill="none" stroke="#666666" d="M206.11,-489.51C225.4,-492.28 245.17,-495.11 262.75,-497.64"/>
<polygon fill="#666666" stroke="#666666" points="262.43,-501.13 272.83,-499.09 263.43,-494.2 262.43,-501.13"/>
</g>
<!-- exec_admin_cmd -->
<g id="node7" class="node">
<title>exec_admin_cmd</title>
<path fill="none" stroke="#1c2123" d="M539,-524C539,-524 450,-524 450,-524 444,-524 438,-518 438,-512 438,-512 438,-500 438,-500 438,-494 444,-488 450,-488 450,-488 539,-488 539,-488 545,-488 551,-494 551,-500 551,-500 551,-512 551,-512 551,-518 545,-524 539,-524"/>
<text text-anchor="middle" x="494.5" y="-502.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_admin_cmd</text>
</g>
<!-- exec_raft_cmd&#45;&gt;exec_admin_cmd -->
<g id="edge5" class="edge">
<title>exec_raft_cmd&#45;&gt;exec_admin_cmd</title>
<path fill="none" stroke="#666666" d="M371.4,-506C388.85,-506 408.84,-506 427.53,-506"/>
<polygon fill="#666666" stroke="#666666" points="427.75,-509.5 437.75,-506 427.75,-502.5 427.75,-509.5"/>
</g>
<!-- exec_change_peer -->
<g id="node8" class="node">
<title>exec_change_peer</title>
<path fill="none" stroke="#1c2123" d="M599,-360.5C599,-360.5 834,-360.5 834,-360.5 840,-360.5 846,-366.5 846,-372.5 846,-372.5 846,-439.5 846,-439.5 846,-445.5 840,-451.5 834,-451.5 834,-451.5 599,-451.5 599,-451.5 593,-451.5 587,-445.5 587,-439.5 587,-439.5 587,-372.5 587,-372.5 587,-366.5 593,-360.5 599,-360.5"/>
<text text-anchor="middle" x="716.5" y="-436.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_change_peer</text>
<polyline fill="none" stroke="#1c2123" points="587,-428.5 846,-428.5 "/>
<text text-anchor="start" x="595" y="-413.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">写入新的Region conf_ver和peers</text>
<text text-anchor="start" x="595" y="-398.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 1.region.conf_ver +1</text>
<text text-anchor="start" x="595" y="-383.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.根据change type AddNode/RemoveNode</text>
<text text-anchor="start" x="595" y="-368.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 更改region中的 peers和role</text>
</g>
<!-- exec_admin_cmd&#45;&gt;exec_change_peer -->
<g id="edge6" class="edge">
<title>exec_admin_cmd&#45;&gt;exec_change_peer</title>
<path fill="none" stroke="#666666" d="M531.36,-487.82C548.16,-479.44 568.5,-469.5 587,-461 590.78,-459.26 594.64,-457.51 598.53,-455.75"/>
<polygon fill="#666666" stroke="#666666" points="600,-458.93 607.69,-451.65 597.13,-452.54 600,-458.93"/>
</g>
<!-- exec_rollback_merge -->
<g id="node9" class="node">
<title>exec_rollback_merge</title>
<path fill="none" stroke="#1c2123" d="M951,-338.5C951,-338.5 1061,-338.5 1061,-338.5 1067,-338.5 1073,-344.5 1073,-350.5 1073,-350.5 1073,-387.5 1073,-387.5 1073,-393.5 1067,-399.5 1061,-399.5 1061,-399.5 951,-399.5 951,-399.5 945,-399.5 939,-393.5 939,-387.5 939,-387.5 939,-350.5 939,-350.5 939,-344.5 945,-338.5 951,-338.5"/>
<text text-anchor="middle" x="1006" y="-384.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_rollback_merge</text>
<polyline fill="none" stroke="#1c2123" points="939,-376.5 1073,-376.5 "/>
<text text-anchor="start" x="947" y="-361.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">region_epoch += 1</text>
<text text-anchor="start" x="947" y="-346.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> PeerState::Normal</text>
</g>
<!-- exec_admin_cmd&#45;&gt;exec_rollback_merge -->
<g id="edge7" class="edge">
<title>exec_admin_cmd&#45;&gt;exec_rollback_merge</title>
<path fill="none" stroke="#666666" d="M551.08,-512.35C562.92,-513.45 575.36,-514.43 587,-515 615.74,-516.41 822.58,-531.73 846,-515 886.14,-486.33 846.97,-444.73 882,-410 894.95,-397.16 912.02,-388.34 929.3,-382.29"/>
<polygon fill="#666666" stroke="#666666" points="930.45,-385.59 938.9,-379.2 928.31,-378.93 930.45,-385.59"/>
</g>
<!-- exec_prepare_merge -->
<g id="node10" class="node">
<title>exec_prepare_merge</title>
<path fill="none" stroke="#1c2123" d="M639,-227C639,-227 794,-227 794,-227 800,-227 806,-233 806,-239 806,-239 806,-329 806,-329 806,-335 800,-341 794,-341 794,-341 639,-341 639,-341 633,-341 627,-335 627,-329 627,-329 627,-239 627,-239 627,-233 633,-227 639,-227"/>
<text text-anchor="middle" x="716.5" y="-325.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_prepare_merge</text>
<polyline fill="none" stroke="#1c2123" points="627,-318 806,-318 "/>
<text text-anchor="start" x="635" y="-302.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">更改version，并将PeerState</text>
<text text-anchor="start" x="635" y="-287.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 设置为Merging</text>
<polyline fill="none" stroke="#1c2123" points="627,-280 806,-280 "/>
<text text-anchor="start" x="635" y="-264.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">region_epoch +=1</text>
<text text-anchor="start" x="635" y="-249.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> conf_ver + =1</text>
<text text-anchor="start" x="635" y="-234.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> PeerState::Merging</text>
</g>
<!-- exec_admin_cmd&#45;&gt;exec_prepare_merge -->
<g id="edge8" class="edge">
<title>exec_admin_cmd&#45;&gt;exec_prepare_merge</title>
<path fill="none" stroke="#666666" d="M502.42,-487.56C515.01,-456.07 544.38,-391.43 587,-351 596.31,-342.17 607.01,-334.2 618.18,-327.09"/>
<polygon fill="#666666" stroke="#666666" points="620.08,-330.03 626.79,-321.83 616.43,-324.06 620.08,-330.03"/>
</g>
<!-- exec_batch_split -->
<g id="node11" class="node">
<title>exec_batch_split</title>
<path fill="none" stroke="#1c2123" d="M894,-419C894,-419 1118,-419 1118,-419 1124,-419 1130,-425 1130,-431 1130,-431 1130,-453 1130,-453 1130,-459 1124,-465 1118,-465 1118,-465 894,-465 894,-465 888,-465 882,-459 882,-453 882,-453 882,-431 882,-431 882,-425 888,-419 894,-419"/>
<text text-anchor="middle" x="1006" y="-449.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_batch_split</text>
<polyline fill="none" stroke="#1c2123" points="882,-442 1130,-442 "/>
<text text-anchor="start" x="890" y="-426.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">derived_region_epoch += new_region_cnt</text>
</g>
<!-- exec_admin_cmd&#45;&gt;exec_batch_split -->
<g id="edge9" class="edge">
<title>exec_admin_cmd&#45;&gt;exec_batch_split</title>
<path fill="none" stroke="#666666" d="M551.18,-523.03C562.9,-525.93 575.27,-528.49 587,-530 644.08,-537.36 795.37,-557.37 846,-530 871.7,-516.11 858.34,-492.13 882,-475 884.39,-473.27 886.87,-471.63 889.42,-470.07"/>
<polygon fill="#666666" stroke="#666666" points="891.29,-473.03 898.33,-465.11 887.89,-466.92 891.29,-473.03"/>
</g>
<!-- exec_split -->
<g id="node12" class="node">
<title>exec_split</title>
<path fill="none" stroke="#1c2123" d="M740,-506C740,-506 693,-506 693,-506 687,-506 681,-500 681,-494 681,-494 681,-482 681,-482 681,-476 687,-470 693,-470 693,-470 740,-470 740,-470 746,-470 752,-476 752,-482 752,-482 752,-494 752,-494 752,-500 746,-506 740,-506"/>
<text text-anchor="middle" x="716.5" y="-484.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_split</text>
</g>
<!-- exec_admin_cmd&#45;&gt;exec_split -->
<g id="edge10" class="edge">
<title>exec_admin_cmd&#45;&gt;exec_split</title>
<path fill="none" stroke="#666666" d="M551.02,-501.46C588.05,-498.43 636.1,-494.5 670.69,-491.67"/>
<polygon fill="#666666" stroke="#666666" points="671.28,-495.13 680.97,-490.83 670.71,-488.15 671.28,-495.13"/>
</g>
<!-- exec_change_peer_v2 -->
<g id="node13" class="node">
<title>exec_change_peer_v2</title>
<path fill="none" stroke="#1c2123" d="M773,-600C773,-600 660,-600 660,-600 654,-600 648,-594 648,-588 648,-588 648,-576 648,-576 648,-570 654,-564 660,-564 660,-564 773,-564 773,-564 779,-564 785,-570 785,-576 785,-576 785,-588 785,-588 785,-594 779,-600 773,-600"/>
<text text-anchor="middle" x="716.5" y="-578.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">exec_change_peer_v2</text>
</g>
<!-- exec_admin_cmd&#45;&gt;exec_change_peer_v2 -->
<g id="edge11" class="edge">
<title>exec_admin_cmd&#45;&gt;exec_change_peer_v2</title>
<path fill="none" stroke="#666666" d="M529.11,-524.2C546.11,-532.88 567.27,-542.88 587,-550 603.18,-555.84 620.88,-560.99 637.83,-565.37"/>
<polygon fill="#666666" stroke="#666666" points="637.15,-568.81 647.7,-567.86 638.86,-562.02 637.15,-568.81"/>
</g>
<!-- exec_change_peer&#45;&gt;write_peer_state -->
<g id="edge12" class="edge">
<title>exec_change_peer&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M835.75,-360.39C839.36,-357.44 842.8,-354.32 846,-351 876.79,-319.11 847.89,-286.3 882,-258 968.28,-186.43 1024.59,-250.16 1130,-212 1156.6,-202.37 1184.37,-186.76 1205.41,-173.62"/>
<polygon fill="#666666" stroke="#666666" points="1207.44,-176.48 1214,-168.16 1203.68,-170.57 1207.44,-176.48"/>
</g>
<!-- exec_rollback_merge&#45;&gt;write_peer_state -->
<g id="edge13" class="edge">
<title>exec_rollback_merge&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M1073.31,-356.64C1093.74,-349.95 1114.83,-339.7 1130,-324 1165.74,-287.01 1137.44,-256.78 1166,-214 1176.11,-198.85 1190.76,-185.2 1204.4,-174.44"/>
<polygon fill="#666666" stroke="#666666" points="1206.86,-176.96 1212.7,-168.12 1202.63,-171.38 1206.86,-176.96"/>
</g>
<!-- exec_prepare_merge&#45;&gt;write_peer_state -->
<g id="edge14" class="edge">
<title>exec_prepare_merge&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M806.05,-245.83C830.34,-236.38 856.91,-226.98 882,-220 989.77,-190.02 1020.49,-199.85 1130,-177 1145.7,-173.72 1162.56,-169.81 1178.26,-165.99"/>
<polygon fill="#666666" stroke="#666666" points="1179.51,-169.29 1188.39,-163.5 1177.84,-162.49 1179.51,-169.29"/>
</g>
<!-- exec_batch_split&#45;&gt;write_peer_state -->
<g id="edge15" class="edge">
<title>exec_batch_split&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M1118.89,-418.84C1122.89,-415.92 1126.63,-412.65 1130,-409 1189.79,-344.25 1122.07,-290.4 1166,-214 1174.94,-198.45 1189.11,-184.88 1202.7,-174.28"/>
<polygon fill="#666666" stroke="#666666" points="1205.1,-176.85 1211.04,-168.07 1200.92,-171.24 1205.1,-176.85"/>
</g>
<!-- write_initial_apply_state -->
<g id="node14" class="node">
<title>write_initial_apply_state</title>
<path fill="none" stroke="#1c2123" d="M1305,-460C1305,-460 1178,-460 1178,-460 1172,-460 1166,-454 1166,-448 1166,-448 1166,-436 1166,-436 1166,-430 1172,-424 1178,-424 1178,-424 1305,-424 1305,-424 1311,-424 1317,-430 1317,-436 1317,-436 1317,-448 1317,-448 1317,-454 1311,-460 1305,-460"/>
<text text-anchor="middle" x="1241.5" y="-438.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_initial_apply_state</text>
</g>
<!-- exec_batch_split&#45;&gt;write_initial_apply_state -->
<g id="edge19" class="edge">
<title>exec_batch_split&#45;&gt;write_initial_apply_state</title>
<path fill="none" stroke="#666666" d="M1130.25,-442C1138.9,-442 1147.5,-442 1155.87,-442"/>
<polygon fill="#666666" stroke="#666666" points="1155.94,-445.5 1165.94,-442 1155.94,-438.5 1155.94,-445.5"/>
</g>
<!-- exec_split&#45;&gt;write_peer_state -->
<g id="edge16" class="edge">
<title>exec_split&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M752,-490.34C780.98,-490.32 821.49,-485.33 846,-461 899.28,-408.13 828.2,-348.34 882,-296 962.41,-217.77 1030.46,-300.74 1130,-249 1149.8,-238.71 1149.53,-229.06 1166,-214 1180.52,-200.73 1197.08,-186.42 1210.9,-174.71"/>
<polygon fill="#666666" stroke="#666666" points="1213.29,-177.26 1218.68,-168.14 1208.78,-171.92 1213.29,-177.26"/>
</g>
<!-- exec_split&#45;&gt;exec_batch_split -->
<g id="edge18" class="edge">
<title>exec_split&#45;&gt;exec_batch_split</title>
<path fill="none" stroke="#666666" d="M752.18,-482.45C782.24,-477.64 827.74,-470.36 871.89,-463.3"/>
<polygon fill="#666666" stroke="#666666" points="872.55,-466.74 881.88,-461.7 871.45,-459.82 872.55,-466.74"/>
</g>
<!-- exec_change_peer_v2&#45;&gt;write_peer_state -->
<g id="edge17" class="edge">
<title>exec_change_peer_v2&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M777.08,-563.97C801.98,-553.52 829.01,-537.79 846,-515 896.33,-447.5 821.88,-387.96 882,-329 961.87,-250.67 1040.23,-352.75 1130,-286 1158.71,-264.65 1144,-242.21 1166,-214 1177.57,-199.16 1193.01,-185.23 1206.83,-174.17"/>
<polygon fill="#666666" stroke="#666666" points="1209,-176.92 1214.74,-168.01 1204.7,-171.39 1209,-176.92"/>
</g>
<!-- apply_leave_joint -->
<g id="node15" class="node">
<title>apply_leave_joint</title>
<path fill="none" stroke="#1c2123" d="M1050.5,-520C1050.5,-520 961.5,-520 961.5,-520 955.5,-520 949.5,-514 949.5,-508 949.5,-508 949.5,-496 949.5,-496 949.5,-490 955.5,-484 961.5,-484 961.5,-484 1050.5,-484 1050.5,-484 1056.5,-484 1062.5,-490 1062.5,-496 1062.5,-496 1062.5,-508 1062.5,-508 1062.5,-514 1056.5,-520 1050.5,-520"/>
<text text-anchor="middle" x="1006" y="-498.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_leave_joint</text>
</g>
<!-- exec_change_peer_v2&#45;&gt;apply_leave_joint -->
<g id="edge20" class="edge">
<title>exec_change_peer_v2&#45;&gt;apply_leave_joint</title>
<path fill="none" stroke="#666666" d="M785.01,-568.99C805.02,-564.13 826.73,-557.83 846,-550 863.16,-543.03 864.74,-535.73 882,-529 900.13,-521.93 920.52,-516.51 939.41,-512.45"/>
<polygon fill="#666666" stroke="#666666" points="940.33,-515.83 949.42,-510.39 938.92,-508.97 940.33,-515.83"/>
</g>
<!-- apply_conf_change -->
<g id="node16" class="node">
<title>apply_conf_change</title>
<path fill="none" stroke="#1c2123" d="M934.5,-538.5C934.5,-538.5 1077.5,-538.5 1077.5,-538.5 1083.5,-538.5 1089.5,-544.5 1089.5,-550.5 1089.5,-550.5 1089.5,-587.5 1089.5,-587.5 1089.5,-593.5 1083.5,-599.5 1077.5,-599.5 1077.5,-599.5 934.5,-599.5 934.5,-599.5 928.5,-599.5 922.5,-593.5 922.5,-587.5 922.5,-587.5 922.5,-550.5 922.5,-550.5 922.5,-544.5 928.5,-538.5 934.5,-538.5"/>
<text text-anchor="middle" x="1006" y="-584.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_conf_change</text>
<polyline fill="none" stroke="#1c2123" points="922.5,-576.5 1089.5,-576.5 "/>
<text text-anchor="start" x="930.5" y="-561.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">1. conf_ver += changes.len</text>
<text text-anchor="start" x="930.5" y="-546.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2. 更改peer的role</text>
</g>
<!-- exec_change_peer_v2&#45;&gt;apply_conf_change -->
<g id="edge21" class="edge">
<title>exec_change_peer_v2&#45;&gt;apply_conf_change</title>
<path fill="none" stroke="#666666" d="M785.27,-578.94C823.15,-577.22 870.91,-575.06 912.22,-573.2"/>
<polygon fill="#666666" stroke="#666666" points="912.47,-576.69 922.3,-572.74 912.15,-569.69 912.47,-576.69"/>
</g>
<!-- destroy -->
<g id="node17" class="node">
<title>destroy</title>
<path fill="none" stroke="#1c2123" d="M921,-16.5C921,-16.5 1091,-16.5 1091,-16.5 1097,-16.5 1103,-22.5 1103,-28.5 1103,-28.5 1103,-65.5 1103,-65.5 1103,-71.5 1097,-77.5 1091,-77.5 1091,-77.5 921,-77.5 921,-77.5 915,-77.5 909,-71.5 909,-65.5 909,-65.5 909,-28.5 909,-28.5 909,-22.5 915,-16.5 921,-16.5"/>
<text text-anchor="middle" x="1006" y="-62.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">destroy</text>
<polyline fill="none" stroke="#1c2123" points="909,-54.5 1103,-54.5 "/>
<text text-anchor="start" x="917" y="-39.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">写入PeerState::Tombstone</text>
<text text-anchor="start" x="917" y="-24.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 和自己的pending_merge_state</text>
</g>
<!-- destroy&#45;&gt;write_peer_state -->
<g id="edge22" class="edge">
<title>destroy&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M1076.43,-77.62C1112.89,-93.71 1156.76,-113.06 1189.96,-127.71"/>
<polygon fill="#666666" stroke="#666666" points="1188.9,-131.07 1199.47,-131.9 1191.73,-124.66 1188.9,-131.07"/>
</g>
</g>
</svg>
