<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: catchup_logs Pages: 1 -->
<svg width="1065pt" height="310pt"
 viewBox="0.00 0.00 1065.00 310.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 306.47)">
<title>catchup_logs</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-306.47 1061,-306.47 1061,4 -4,4"/>
<!-- PeerFsmDelegate__on_catch_up_logs_for_merge -->
<g id="node1" class="node">
<title>PeerFsmDelegate__on_catch_up_logs_for_merge</title>
<path fill="none" stroke="#1c2123" d="M42,-147.28C42,-147.28 200,-147.28 200,-147.28 206,-147.28 212,-153.28 212,-159.28 212,-159.28 212,-211.28 212,-211.28 212,-217.28 206,-223.28 200,-223.28 200,-223.28 42,-223.28 42,-223.28 36,-223.28 30,-217.28 30,-211.28 30,-211.28 30,-159.28 30,-159.28 30,-153.28 36,-147.28 42,-147.28"/>
<text text-anchor="start" x="38" y="-208.08" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="start" x="38" y="-193.08" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_catch_up_logs_for_merge</text>
<polyline fill="none" stroke="#1c2123" points="30,-185.28 212,-185.28 "/>
<text text-anchor="start" x="38" y="-170.08" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理target region</text>
<text text-anchor="start" x="38" y="-155.08" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发来的CatchUpLogs</text>
</g>
<!-- Peer__maybe_append_merge_entries -->
<g id="node2" class="node">
<title>Peer__maybe_append_merge_entries</title>
<path fill="none" stroke="#1c2123" d="M290,-135.78C290,-135.78 453,-135.78 453,-135.78 459,-135.78 465,-141.78 465,-147.78 465,-147.78 465,-214.78 465,-214.78 465,-220.78 459,-226.78 453,-226.78 453,-226.78 290,-226.78 290,-226.78 284,-226.78 278,-220.78 278,-214.78 278,-214.78 278,-147.78 278,-147.78 278,-141.78 284,-135.78 290,-135.78"/>
<text text-anchor="start" x="286" y="-211.58" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="286" y="-196.58" font-family="Times,serif" font-size="14.00" fill="#2f3638"> maybe_append_merge_entries</text>
<polyline fill="none" stroke="#1c2123" points="278,-188.78 465,-188.78 "/>
<text text-anchor="start" x="286" y="-173.58" font-family="Times,serif" font-size="14.00" fill="#2f3638">Directly append thes logs </text>
<text text-anchor="start" x="286" y="-158.58" font-family="Times,serif" font-size="14.00" fill="#2f3638"> to raft log and then commit</text>
<text text-anchor="start" x="286" y="-143.58" font-family="Times,serif" font-size="14.00" fill="#2f3638"> them</text>
</g>
<!-- PeerFsmDelegate__on_catch_up_logs_for_merge&#45;&gt;Peer__maybe_append_merge_entries -->
<g id="edge1" class="edge">
<title>PeerFsmDelegate__on_catch_up_logs_for_merge&#45;&gt;Peer__maybe_append_merge_entries</title>
<path fill="none" stroke="#666666" d="M212.07,-183.83C230.11,-183.54 249.21,-183.23 267.65,-182.93"/>
<polygon fill="#666666" stroke="#666666" points="267.87,-186.43 277.82,-182.77 267.76,-179.43 267.87,-186.43"/>
</g>
<!-- Peer__catch_up_logs -->
<g id="node3" class="node">
<title>Peer__catch_up_logs</title>
<path fill="#feed9b" stroke="#f7e495" d="M951.5,-207.28C951.5,-207.28 1025.5,-207.28 1025.5,-207.28 1031.5,-207.28 1037.5,-213.28 1037.5,-219.28 1037.5,-219.28 1037.5,-233.28 1037.5,-233.28 1037.5,-239.28 1031.5,-245.28 1025.5,-245.28 1025.5,-245.28 951.5,-245.28 951.5,-245.28 945.5,-245.28 939.5,-239.28 939.5,-233.28 939.5,-233.28 939.5,-219.28 939.5,-219.28 939.5,-213.28 945.5,-207.28 951.5,-207.28"/>
<text text-anchor="start" x="947.5" y="-230.08" font-family="Times,serif" font-size="14.00" fill="#40575d">Peer</text>
<text text-anchor="start" x="947.5" y="-215.08" font-family="Times,serif" font-size="14.00" fill="#40575d"> catch_up_logs</text>
</g>
<!-- PeerFsmDelegate__on_catch_up_logs_for_merge&#45;&gt;Peer__catch_up_logs -->
<g id="edge2" class="edge">
<title>PeerFsmDelegate__on_catch_up_logs_for_merge&#45;&gt;Peer__catch_up_logs</title>
<path fill="none" stroke="#666666" d="M212.05,-215.69C233.59,-222.69 256.55,-229.94 278,-236.28 454.97,-288.57 505.65,-316.19 689,-295.28 774.1,-285.57 870.25,-260.77 929.88,-243.71"/>
<polygon fill="#666666" stroke="#666666" points="930.85,-247.07 939.49,-240.94 928.91,-240.35 930.85,-247.07"/>
</g>
<!-- Peer__pending_merge_state -->
<g id="node4" class="node">
<title>Peer__pending_merge_state</title>
<path fill="#feed9b" stroke="#f7e495" d="M932,-111.28C932,-111.28 1045,-111.28 1045,-111.28 1051,-111.28 1057,-117.28 1057,-123.28 1057,-123.28 1057,-137.28 1057,-137.28 1057,-143.28 1051,-149.28 1045,-149.28 1045,-149.28 932,-149.28 932,-149.28 926,-149.28 920,-143.28 920,-137.28 920,-137.28 920,-123.28 920,-123.28 920,-117.28 926,-111.28 932,-111.28"/>
<text text-anchor="start" x="928" y="-134.08" font-family="Times,serif" font-size="14.00" fill="#40575d">Peer</text>
<text text-anchor="start" x="928" y="-119.08" font-family="Times,serif" font-size="14.00" fill="#40575d"> pending_merge_state</text>
</g>
<!-- PeerFsmDelegate__on_catch_up_logs_for_merge&#45;&gt;Peer__pending_merge_state -->
<g id="edge3" class="edge">
<title>PeerFsmDelegate__on_catch_up_logs_for_merge&#45;&gt;Peer__pending_merge_state</title>
<path fill="none" stroke="#666666" d="M212.08,-158.95C222.95,-153.28 233.27,-146.47 242,-138.28 269.55,-112.43 246.13,-81.56 278,-61.28 491.99,74.9 818.09,-51.19 939.64,-106.89"/>
<polygon fill="#666666" stroke="#666666" points="938.51,-110.23 949.06,-111.26 941.46,-103.88 938.51,-110.23"/>
</g>
<!-- RaftLog__maybe_append -->
<g id="node5" class="node">
<title>RaftLog__maybe_append</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M517.5,-125.28C517.5,-125.28 672.5,-125.28 672.5,-125.28 678.5,-125.28 684.5,-131.28 684.5,-137.28 684.5,-137.28 684.5,-219.28 684.5,-219.28 684.5,-225.28 678.5,-231.28 672.5,-231.28 672.5,-231.28 517.5,-231.28 517.5,-231.28 511.5,-231.28 505.5,-225.28 505.5,-219.28 505.5,-219.28 505.5,-137.28 505.5,-137.28 505.5,-131.28 511.5,-125.28 517.5,-125.28"/>
<text text-anchor="start" x="513.5" y="-216.08" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftLog</text>
<text text-anchor="start" x="513.5" y="-201.08" font-family="Times,serif" font-size="14.00" fill="#5d6179"> maybe_append</text>
<text text-anchor="start" x="513.5" y="-186.08" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 用CommitMerge中的log</text>
<text text-anchor="start" x="513.5" y="-171.08" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 补齐raft log</text>
<polyline fill="none" stroke="#8a8898" points="505.5,-163.28 684.5,-163.28 "/>
<text text-anchor="start" x="513.5" y="-148.08" font-family="Times,serif" font-size="14.00" fill="#5d6179">并设置committed 为</text>
<text text-anchor="start" x="513.5" y="-133.08" font-family="Times,serif" font-size="14.00" fill="#5d6179"> CommitMerge中的comitted</text>
</g>
<!-- Peer__maybe_append_merge_entries&#45;&gt;RaftLog__maybe_append -->
<g id="edge4" class="edge">
<title>Peer__maybe_append_merge_entries&#45;&gt;RaftLog__maybe_append</title>
<path fill="none" stroke="#666666" d="M465.15,-180.02C475.01,-179.89 485.06,-179.75 494.98,-179.62"/>
<polygon fill="#666666" stroke="#666666" points="495.31,-183.11 505.26,-179.48 495.22,-176.11 495.31,-183.11"/>
</g>
<!-- RaftLog__commit_to -->
<g id="node6" class="node">
<title>RaftLog__commit_to</title>
<path fill="none" stroke="#1c2123" d="M650.5,-286.28C650.5,-286.28 539.5,-286.28 539.5,-286.28 533.5,-286.28 527.5,-280.28 527.5,-274.28 527.5,-274.28 527.5,-262.28 527.5,-262.28 527.5,-256.28 533.5,-250.28 539.5,-250.28 539.5,-250.28 650.5,-250.28 650.5,-250.28 656.5,-250.28 662.5,-256.28 662.5,-262.28 662.5,-262.28 662.5,-274.28 662.5,-274.28 662.5,-280.28 656.5,-286.28 650.5,-286.28"/>
<text text-anchor="middle" x="595" y="-264.58" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__commit_to</text>
</g>
<!-- Peer__maybe_append_merge_entries&#45;&gt;RaftLog__commit_to -->
<g id="edge5" class="edge">
<title>Peer__maybe_append_merge_entries&#45;&gt;RaftLog__commit_to</title>
<path fill="none" stroke="#666666" d="M465.12,-226.58C477.08,-231.82 489.25,-236.86 501,-241.28 506.21,-243.24 511.63,-245.14 517.12,-246.97"/>
<polygon fill="#666666" stroke="#666666" points="516.45,-250.43 527.04,-250.19 518.61,-243.78 516.45,-250.43"/>
</g>
<!-- merge__get_entries__is_empty -->
<g id="node7" class="node">
<title>merge__get_entries__is_empty</title>
<path fill="none" stroke="#1c2123" d="M677,-106.28C677,-106.28 513,-106.28 513,-106.28 507,-106.28 501,-100.28 501,-94.28 501,-94.28 501,-82.28 501,-82.28 501,-76.28 507,-70.28 513,-70.28 513,-70.28 677,-70.28 677,-70.28 683,-70.28 689,-76.28 689,-82.28 689,-82.28 689,-94.28 689,-94.28 689,-100.28 683,-106.28 677,-106.28"/>
<text text-anchor="middle" x="595" y="-84.58" font-family="Times,serif" font-size="14.00" fill="#2f3638">merge__get_entries__is_empty</text>
</g>
<!-- Peer__maybe_append_merge_entries&#45;&gt;merge__get_entries__is_empty -->
<g id="edge6" class="edge">
<title>Peer__maybe_append_merge_entries&#45;&gt;merge__get_entries__is_empty</title>
<path fill="none" stroke="#666666" d="M457.59,-135.61C471.89,-128.7 486.72,-121.99 501,-116.28 506.75,-113.98 512.77,-111.76 518.86,-109.65"/>
<polygon fill="#666666" stroke="#666666" points="520.09,-112.93 528.46,-106.42 517.86,-106.29 520.09,-112.93"/>
</g>
<!-- PeerFsmDelegate__on_ready_prepare_merge -->
<g id="node10" class="node">
<title>PeerFsmDelegate__on_ready_prepare_merge</title>
<path fill="none" stroke="#1c2123" d="M737,-147.78C737,-147.78 872,-147.78 872,-147.78 878,-147.78 884,-153.78 884,-159.78 884,-159.78 884,-196.78 884,-196.78 884,-202.78 878,-208.78 872,-208.78 872,-208.78 737,-208.78 737,-208.78 731,-208.78 725,-202.78 725,-196.78 725,-196.78 725,-159.78 725,-159.78 725,-153.78 731,-147.78 737,-147.78"/>
<text text-anchor="start" x="733" y="-193.58" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="start" x="733" y="-178.58" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_ready_prepare_merge</text>
<polyline fill="none" stroke="#1c2123" points="725,-170.78 884,-170.78 "/>
<text text-anchor="middle" x="804.5" y="-155.58" font-family="Times,serif" font-size="14.00" fill="#2f3638"> </text>
</g>
<!-- RaftLog__maybe_append&#45;&gt;PeerFsmDelegate__on_ready_prepare_merge -->
<g id="edge12" class="edge">
<title>RaftLog__maybe_append&#45;&gt;PeerFsmDelegate__on_ready_prepare_merge</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M684.6,-178.28C694.49,-178.28 704.57,-178.28 714.47,-178.28"/>
<polygon fill="green" stroke="green" points="714.7,-181.78 724.7,-178.28 714.7,-174.78 714.7,-181.78"/>
</g>
<!-- CatchUpLogs -->
<g id="node8" class="node">
<title>CatchUpLogs</title>
<path fill="none" stroke="#1c2123" d="M12,-36.28C12,-36.28 230,-36.28 230,-36.28 236,-36.28 242,-42.28 242,-48.28 242,-48.28 242,-116.28 242,-116.28 242,-122.28 236,-128.28 230,-128.28 230,-128.28 12,-128.28 12,-128.28 6,-128.28 0,-122.28 0,-116.28 0,-116.28 0,-48.28 0,-48.28 0,-42.28 6,-36.28 12,-36.28"/>
<text text-anchor="middle" x="121" y="-113.08" font-family="Times,serif" font-size="14.00" fill="#2f3638">CatchUpLogs</text>
<polyline fill="none" stroke="#1c2123" points="0,-105.28 242,-105.28 "/>
<text text-anchor="start" x="8" y="-90.08" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub target_region_id: u64,</text>
<polyline fill="none" stroke="#1c2123" points="0,-82.28 242,-82.28 "/>
<text text-anchor="start" x="8" y="-67.08" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub merge: CommitMergeRequest,</text>
<polyline fill="none" stroke="#1c2123" points="0,-59.28 242,-59.28 "/>
<text text-anchor="start" x="8" y="-44.08" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub logs_up_to_date: Arc&lt;AtomicU64&gt;,</text>
</g>
<!-- CommitMergeRequest -->
<g id="node9" class="node">
<title>CommitMergeRequest</title>
<path fill="none" stroke="#1c2123" d="M312.5,-71.28C312.5,-71.28 430.5,-71.28 430.5,-71.28 436.5,-71.28 442.5,-77.28 442.5,-83.28 442.5,-83.28 442.5,-95.28 442.5,-95.28 442.5,-101.28 436.5,-107.28 430.5,-107.28 430.5,-107.28 312.5,-107.28 312.5,-107.28 306.5,-107.28 300.5,-101.28 300.5,-95.28 300.5,-95.28 300.5,-83.28 300.5,-83.28 300.5,-77.28 306.5,-71.28 312.5,-71.28"/>
<text text-anchor="middle" x="371.5" y="-85.58" font-family="Times,serif" font-size="14.00" fill="#2f3638">CommitMergeRequest</text>
</g>
<!-- CatchUpLogs&#45;&gt;CommitMergeRequest -->
<g id="edge7" class="edge">
<title>CatchUpLogs&#45;&gt;CommitMergeRequest</title>
<path fill="none" stroke="#666666" d="M242.25,-85.66C258.45,-86.12 274.75,-86.58 290.03,-87.01"/>
<polygon fill="#666666" stroke="#666666" points="290.34,-90.52 300.44,-87.3 290.54,-83.52 290.34,-90.52"/>
</g>
<!-- CommitMergeRequest&#45;&gt;RaftLog__maybe_append -->
<g id="edge8" class="edge">
<title>CommitMergeRequest&#45;&gt;RaftLog__maybe_append</title>
<path fill="none" stroke="#666666" d="M417.68,-107.32C432.73,-113.34 449.59,-120.09 465,-126.28 474.95,-130.27 485.33,-134.45 495.69,-138.62"/>
<polygon fill="#666666" stroke="#666666" points="494.6,-141.95 505.19,-142.44 497.22,-135.46 494.6,-141.95"/>
</g>
<!-- CommitMergeRequest&#45;&gt;merge__get_entries__is_empty -->
<g id="edge9" class="edge">
<title>CommitMergeRequest&#45;&gt;merge__get_entries__is_empty</title>
<path fill="none" stroke="#666666" d="M442.58,-88.96C457.91,-88.89 474.44,-88.82 490.75,-88.74"/>
<polygon fill="#666666" stroke="#666666" points="490.88,-92.24 500.87,-88.7 490.85,-85.24 490.88,-92.24"/>
</g>
<!-- PeerFsmDelegate__on_ready_prepare_merge&#45;&gt;Peer__catch_up_logs -->
<g id="edge10" class="edge">
<title>PeerFsmDelegate__on_ready_prepare_merge&#45;&gt;Peer__catch_up_logs</title>
<path fill="none" stroke="#666666" d="M884,-198.98C899.33,-203.02 915.13,-207.19 929.63,-211.01"/>
<polygon fill="#666666" stroke="#666666" points="928.88,-214.44 939.44,-213.6 930.66,-207.67 928.88,-214.44"/>
</g>
<!-- PeerFsmDelegate__on_ready_prepare_merge&#45;&gt;Peer__pending_merge_state -->
<g id="edge11" class="edge">
<title>PeerFsmDelegate__on_ready_prepare_merge&#45;&gt;Peer__pending_merge_state</title>
<path fill="none" stroke="#666666" d="M884,-157.57C892.67,-155.29 901.49,-152.96 910.15,-150.68"/>
<polygon fill="#666666" stroke="#666666" points="911.05,-154.06 919.83,-148.12 909.27,-147.29 911.05,-154.06"/>
</g>
</g>
</svg>
