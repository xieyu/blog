<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: Fsm Pages: 1 -->
<svg width="1387pt" height="878pt"
 viewBox="0.00 0.00 1387.00 878.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 874)">
<title>Fsm</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-874 1383,-874 1383,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_RaftPoller</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M183,-447C183,-447 505,-447 505,-447 511,-447 517,-453 517,-459 517,-459 517,-724 517,-724 517,-730 511,-736 505,-736 505,-736 183,-736 183,-736 177,-736 171,-730 171,-724 171,-724 171,-459 171,-459 171,-453 177,-447 183,-447"/>
<text text-anchor="middle" x="344" y="-716" font-family="Times,serif" font-size="20.00">RaftPoller</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ApplyPollder</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M192,-219C192,-219 496,-219 496,-219 502,-219 508,-225 508,-231 508,-231 508,-427 508,-427 508,-433 502,-439 496,-439 496,-439 192,-439 192,-439 186,-439 180,-433 180,-427 180,-427 180,-231 180,-231 180,-225 186,-219 192,-219"/>
<text text-anchor="middle" x="344" y="-419" font-family="Times,serif" font-size="20.00">ApplyPollder</text>
</g>
<!-- PeerFsm -->
<g id="node1" class="node">
<title>PeerFsm</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M191,-567C191,-567 497,-567 497,-567 503,-567 509,-573 509,-579 509,-579 509,-685 509,-685 509,-691 503,-697 497,-697 497,-697 191,-697 191,-697 185,-697 179,-691 179,-685 179,-685 179,-579 179,-579 179,-573 185,-567 191,-567"/>
<text text-anchor="middle" x="344" y="-681.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">PeerFsm</text>
<polyline fill="none" stroke="#60b5ac" points="179,-674 509,-674 "/>
<text text-anchor="start" x="187" y="-658.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">normal类型状态机</text>
<polyline fill="none" stroke="#60b5ac" points="179,-651 509,-651 "/>
<text text-anchor="start" x="187" y="-635.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub peer: Peer&lt;EK, ER&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="179,-628 509,-628 "/>
<text text-anchor="start" x="187" y="-612.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">mailbox: Option&lt;BasicMailbox&lt;PeerFsm&lt;EK, ER&gt;&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="179,-605 509,-605 "/>
<text text-anchor="start" x="187" y="-589.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub receiver: Receiver&lt;PeerMsg&lt;EK&gt;&gt;,</text>
<text text-anchor="start" x="187" y="-574.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> batch_req_builder: BatchRaftCmdRequestBuilder&lt;EK&gt;,</text>
</g>
<!-- Receiver -->
<g id="node6" class="node">
<title>Receiver</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M559,-396.5C559,-396.5 729,-396.5 729,-396.5 735,-396.5 741,-402.5 741,-408.5 741,-408.5 741,-453.5 741,-453.5 741,-459.5 735,-465.5 729,-465.5 729,-465.5 559,-465.5 559,-465.5 553,-465.5 547,-459.5 547,-453.5 547,-453.5 547,-408.5 547,-408.5 547,-402.5 553,-396.5 559,-396.5"/>
<text text-anchor="middle" x="644" y="-450.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Receiver</text>
<polyline fill="none" stroke="#60b5ac" points="547,-442.5 741,-442.5 "/>
<text text-anchor="start" x="555" y="-427.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">receiver: channel::Receiver&lt;T&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="547,-419.5 741,-419.5 "/>
<text text-anchor="start" x="555" y="-404.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">state: Arc&lt;State&gt;,</text>
</g>
<!-- PeerFsm&#45;&gt;Receiver -->
<g id="edge12" class="edge">
<title>PeerFsm&#45;&gt;Receiver</title>
<path fill="none" stroke="#666666" d="M507.97,-566.95C511.12,-564.09 514.14,-561.11 517,-558 543.39,-529.38 518.83,-503.83 545,-475 545.75,-474.17 546.52,-473.36 547.31,-472.56"/>
<polygon fill="#666666" stroke="#666666" points="549.77,-475.05 554.83,-465.75 545.07,-469.86 549.77,-475.05"/>
</g>
<!-- KvEngine -->
<g id="node10" class="node">
<title>KvEngine</title>
<path fill="#feed9b" stroke="#f7e495" d="M1100,-505.5C1100,-505.5 1224,-505.5 1224,-505.5 1230,-505.5 1236,-511.5 1236,-517.5 1236,-517.5 1236,-562.5 1236,-562.5 1236,-568.5 1230,-574.5 1224,-574.5 1224,-574.5 1100,-574.5 1100,-574.5 1094,-574.5 1088,-568.5 1088,-562.5 1088,-562.5 1088,-517.5 1088,-517.5 1088,-511.5 1094,-505.5 1100,-505.5"/>
<text text-anchor="middle" x="1162" y="-559.3" font-family="Times,serif" font-size="14.00" fill="#40575d">KvEngine</text>
<polyline fill="none" stroke="#f7e495" points="1088,-551.5 1236,-551.5 "/>
<text text-anchor="start" x="1096" y="-536.3" font-family="Times,serif" font-size="14.00" fill="#40575d">trait KvEngine</text>
<polyline fill="none" stroke="#f7e495" points="1088,-528.5 1236,-528.5 "/>
<text text-anchor="start" x="1096" y="-513.3" font-family="Times,serif" font-size="14.00" fill="#40575d">A TiKV key&#45;value store</text>
</g>
<!-- PeerFsm&#45;&gt;KvEngine -->
<g id="edge13" class="edge">
<title>PeerFsm&#45;&gt;KvEngine</title>
<path fill="none" stroke="#666666" d="M509.24,-599.72C590.16,-585 689.37,-568.73 779,-559 881.5,-547.87 1000.2,-543.25 1077.73,-541.34"/>
<polygon fill="#666666" stroke="#666666" points="1078.01,-544.83 1087.92,-541.1 1077.84,-537.84 1078.01,-544.83"/>
</g>
<!-- RaftEngine -->
<g id="node11" class="node">
<title>RaftEngine</title>
<path fill="#feed9b" stroke="#f7e495" d="M1093,-593.5C1093,-593.5 1231,-593.5 1231,-593.5 1237,-593.5 1243,-599.5 1243,-605.5 1243,-605.5 1243,-642.5 1243,-642.5 1243,-648.5 1237,-654.5 1231,-654.5 1231,-654.5 1093,-654.5 1093,-654.5 1087,-654.5 1081,-648.5 1081,-642.5 1081,-642.5 1081,-605.5 1081,-605.5 1081,-599.5 1087,-593.5 1093,-593.5"/>
<text text-anchor="middle" x="1162" y="-639.3" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftEngine</text>
<polyline fill="none" stroke="#f7e495" points="1081,-631.5 1243,-631.5 "/>
<text text-anchor="start" x="1089" y="-616.3" font-family="Times,serif" font-size="14.00" fill="#40575d">trait RaftEngine</text>
<text text-anchor="middle" x="1162" y="-601.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 处理Raft日志和raft状态</text>
</g>
<!-- PeerFsm&#45;&gt;RaftEngine -->
<g id="edge14" class="edge">
<title>PeerFsm&#45;&gt;RaftEngine</title>
<path fill="none" stroke="#666666" d="M449.71,-697.03C591.72,-776.18 850.02,-887.55 1045,-787 1094.66,-761.39 1127.71,-703.6 1145.42,-664.19"/>
<polygon fill="#666666" stroke="#666666" points="1148.82,-665.16 1149.59,-654.6 1142.4,-662.37 1148.82,-665.16"/>
</g>
<!-- Peer -->
<g id="node16" class="node">
<title>Peer</title>
<path fill="none" stroke="#1c2123" d="M659,-658C659,-658 629,-658 629,-658 623,-658 617,-652 617,-646 617,-646 617,-634 617,-634 617,-628 623,-622 629,-622 629,-622 659,-622 659,-622 665,-622 671,-628 671,-634 671,-634 671,-646 671,-646 671,-652 665,-658 659,-658"/>
<text text-anchor="middle" x="644" y="-636.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
</g>
<!-- PeerFsm&#45;&gt;Peer -->
<g id="edge15" class="edge">
<title>PeerFsm&#45;&gt;Peer</title>
<path fill="none" stroke="#666666" d="M509.25,-636.41C546.09,-637.4 581.67,-638.35 606.86,-639.03"/>
<polygon fill="#666666" stroke="#666666" points="606.9,-642.53 616.99,-639.3 607.09,-635.53 606.9,-642.53"/>
</g>
<!-- BatchRaftCmdRequestBuilder -->
<g id="node17" class="node">
<title>BatchRaftCmdRequestBuilder</title>
<path fill="none" stroke="#1c2123" d="M723,-870C723,-870 565,-870 565,-870 559,-870 553,-864 553,-858 553,-858 553,-846 553,-846 553,-840 559,-834 565,-834 565,-834 723,-834 723,-834 729,-834 735,-840 735,-846 735,-846 735,-858 735,-858 735,-864 729,-870 723,-870"/>
<text text-anchor="middle" x="644" y="-848.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">BatchRaftCmdRequestBuilder</text>
</g>
<!-- PeerFsm&#45;&gt;BatchRaftCmdRequestBuilder -->
<g id="edge16" class="edge">
<title>PeerFsm&#45;&gt;BatchRaftCmdRequestBuilder</title>
<path fill="none" stroke="#666666" d="M400.55,-697.21C437.85,-737.46 490.07,-787.44 545,-820 551.3,-823.73 558.09,-827.09 565.05,-830.1"/>
<polygon fill="#666666" stroke="#666666" points="564.03,-833.46 574.61,-833.98 566.66,-826.98 564.03,-833.46"/>
</g>
<!-- StoreFsm -->
<g id="node2" class="node">
<title>StoreFsm</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M244,-456C244,-456 444,-456 444,-456 450,-456 456,-462 456,-468 456,-468 456,-536 456,-536 456,-542 450,-548 444,-548 444,-548 244,-548 244,-548 238,-548 232,-542 232,-536 232,-536 232,-468 232,-468 232,-462 238,-456 244,-456"/>
<text text-anchor="middle" x="344" y="-532.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">StoreFsm</text>
<polyline fill="none" stroke="#60b5ac" points="232,-525 456,-525 "/>
<text text-anchor="start" x="240" y="-509.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">control类型状态机</text>
<polyline fill="none" stroke="#60b5ac" points="232,-502 456,-502 "/>
<text text-anchor="start" x="240" y="-486.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">store: Store,</text>
<polyline fill="none" stroke="#60b5ac" points="232,-479 456,-479 "/>
<text text-anchor="start" x="240" y="-463.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">receiver: Receiver&lt;StoreMsg&lt;EK&gt;&gt;,</text>
</g>
<!-- StoreFsm&#45;&gt;Receiver -->
<g id="edge10" class="edge">
<title>StoreFsm&#45;&gt;Receiver</title>
<path fill="none" stroke="#666666" d="M456.39,-475.46C482.77,-469.17 510.84,-462.49 536.98,-456.26"/>
<polygon fill="#666666" stroke="#666666" points="537.98,-459.62 546.9,-453.9 536.36,-452.81 537.98,-459.62"/>
</g>
<!-- Store -->
<g id="node15" class="node">
<title>Store</title>
<path fill="none" stroke="#1c2123" d="M659,-520C659,-520 629,-520 629,-520 623,-520 617,-514 617,-508 617,-508 617,-496 617,-496 617,-490 623,-484 629,-484 629,-484 659,-484 659,-484 665,-484 671,-490 671,-496 671,-496 671,-508 671,-508 671,-514 665,-520 659,-520"/>
<text text-anchor="middle" x="644" y="-498.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Store</text>
</g>
<!-- StoreFsm&#45;&gt;Store -->
<g id="edge11" class="edge">
<title>StoreFsm&#45;&gt;Store</title>
<path fill="none" stroke="#666666" d="M456.39,-502C509.35,-502 569.1,-502 606.4,-502"/>
<polygon fill="#666666" stroke="#666666" points="606.77,-505.5 616.77,-502 606.77,-498.5 606.77,-505.5"/>
</g>
<!-- ControlFsm -->
<g id="node3" class="node">
<title>ControlFsm</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M284.5,-339.5C284.5,-339.5 403.5,-339.5 403.5,-339.5 409.5,-339.5 415.5,-345.5 415.5,-351.5 415.5,-351.5 415.5,-388.5 415.5,-388.5 415.5,-394.5 409.5,-400.5 403.5,-400.5 403.5,-400.5 284.5,-400.5 284.5,-400.5 278.5,-400.5 272.5,-394.5 272.5,-388.5 272.5,-388.5 272.5,-351.5 272.5,-351.5 272.5,-345.5 278.5,-339.5 284.5,-339.5"/>
<text text-anchor="middle" x="344" y="-385.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ControlFsm</text>
<polyline fill="none" stroke="#60b5ac" points="272.5,-377.5 415.5,-377.5 "/>
<text text-anchor="start" x="280.5" y="-362.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub struct ControlFsm;</text>
<text text-anchor="start" x="280.5" y="-347.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 空的Fsm，占位用</text>
</g>
<!-- ApplyFsm -->
<g id="node4" class="node">
<title>ApplyFsm</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M200,-228C200,-228 488,-228 488,-228 494,-228 500,-234 500,-240 500,-240 500,-308 500,-308 500,-314 494,-320 488,-320 488,-320 200,-320 200,-320 194,-320 188,-314 188,-308 188,-308 188,-240 188,-240 188,-234 194,-228 200,-228"/>
<text text-anchor="middle" x="344" y="-304.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ApplyFsm</text>
<polyline fill="none" stroke="#60b5ac" points="188,-297 500,-297 "/>
<text text-anchor="start" x="196" y="-281.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">delegate: ApplyDelegate&lt;EK&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="188,-274 500,-274 "/>
<text text-anchor="start" x="196" y="-258.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">receiver: Receiver&lt;Msg&lt;EK&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="188,-251 500,-251 "/>
<text text-anchor="start" x="196" y="-235.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">mailbox: Option&lt;BasicMailbox&lt;ApplyFsm&lt;EK&gt;&gt;&gt;,</text>
</g>
<!-- ApplyFsm&#45;&gt;Receiver -->
<g id="edge7" class="edge">
<title>ApplyFsm&#45;&gt;Receiver</title>
<path fill="none" stroke="#666666" d="M500.12,-317.73C506.04,-321.49 511.7,-325.57 517,-330 537.15,-346.83 526.16,-363.72 545,-382 547.91,-384.82 551.02,-387.52 554.27,-390.09"/>
<polygon fill="#666666" stroke="#666666" points="552.47,-393.11 562.61,-396.2 556.61,-387.46 552.47,-393.11"/>
</g>
<!-- ApplyFsm&#45;&gt;KvEngine -->
<g id="edge8" class="edge">
<title>ApplyFsm&#45;&gt;KvEngine</title>
<path fill="none" stroke="#666666" d="M494.62,-320.09C502.27,-323.26 509.77,-326.57 517,-330 530.37,-336.34 530.98,-343.28 545,-348 756.26,-419.09 849.39,-280.14 1045,-387 1089.17,-411.13 1121.6,-460.03 1140.76,-496.08"/>
<polygon fill="#666666" stroke="#666666" points="1137.88,-498.13 1145.58,-505.41 1144.1,-494.92 1137.88,-498.13"/>
</g>
<!-- ApplyDelegate -->
<g id="node13" class="node">
<title>ApplyDelegate</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M559.5,-179C559.5,-179 728.5,-179 728.5,-179 734.5,-179 740.5,-185 740.5,-191 740.5,-191 740.5,-327 740.5,-327 740.5,-333 734.5,-339 728.5,-339 728.5,-339 559.5,-339 559.5,-339 553.5,-339 547.5,-333 547.5,-327 547.5,-327 547.5,-191 547.5,-191 547.5,-185 553.5,-179 559.5,-179"/>
<text text-anchor="middle" x="644" y="-323.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ApplyDelegate</text>
<polyline fill="none" stroke="#60b5ac" points="547.5,-316 740.5,-316 "/>
<text text-anchor="start" x="555.5" y="-300.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">The apply delegate of a Region</text>
<text text-anchor="start" x="555.5" y="-285.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> which is responsible for</text>
<text text-anchor="start" x="555.5" y="-270.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> endsnippet handling committed</text>
<text text-anchor="start" x="555.5" y="-255.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> raft log entries of a Region.</text>
<polyline fill="none" stroke="#60b5ac" points="547.5,-248 740.5,-248 "/>
<text text-anchor="start" x="555.5" y="-232.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">id: u64,</text>
<polyline fill="none" stroke="#60b5ac" points="547.5,-225 740.5,-225 "/>
<text text-anchor="start" x="555.5" y="-209.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">term: u64,</text>
<polyline fill="none" stroke="#60b5ac" points="547.5,-202 740.5,-202 "/>
<text text-anchor="start" x="555.5" y="-186.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">region: Region,</text>
</g>
<!-- ApplyFsm&#45;&gt;ApplyDelegate -->
<g id="edge9" class="edge">
<title>ApplyFsm&#45;&gt;ApplyDelegate</title>
<path fill="none" stroke="#666666" d="M500.11,-266.19C512.71,-265.56 525.24,-264.93 537.36,-264.32"/>
<polygon fill="#666666" stroke="#666666" points="537.62,-267.81 547.43,-263.81 537.27,-260.82 537.62,-267.81"/>
</g>
<!-- Fsm -->
<g id="node5" class="node">
<title>Fsm</title>
<path fill="#feed9b" stroke="#f7e495" d="M12,-282.5C12,-282.5 131,-282.5 131,-282.5 137,-282.5 143,-288.5 143,-294.5 143,-294.5 143,-445.5 143,-445.5 143,-451.5 137,-457.5 131,-457.5 131,-457.5 12,-457.5 12,-457.5 6,-457.5 0,-451.5 0,-445.5 0,-445.5 0,-294.5 0,-294.5 0,-288.5 6,-282.5 12,-282.5"/>
<text text-anchor="middle" x="71.5" y="-442.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Fsm</text>
<polyline fill="none" stroke="#f7e495" points="0,-434.5 143,-434.5 "/>
<text text-anchor="start" x="8" y="-419.3" font-family="Times,serif" font-size="14.00" fill="#40575d">A Fsm is a finite</text>
<text text-anchor="start" x="8" y="-404.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> state machine.</text>
<polyline fill="none" stroke="#f7e495" points="0,-396.5 143,-396.5 "/>
<text text-anchor="start" x="8" y="-381.3" font-family="Times,serif" font-size="14.00" fill="#40575d">fn is_stopped</text>
<polyline fill="none" stroke="#f7e495" points="0,-373.5 143,-373.5 "/>
<text text-anchor="start" x="8" y="-358.3" font-family="Times,serif" font-size="14.00" fill="#40575d">fn set_mailbox</text>
<text text-anchor="start" x="8" y="-343.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 设置mailbox</text>
<text text-anchor="start" x="8" y="-328.3" font-family="Times,serif" font-size="14.00" fill="#40575d">,后面通过</text>
<text text-anchor="middle" x="71.5" y="-313.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> mailbox发消息给fsm</text>
<polyline fill="none" stroke="#f7e495" points="0,-305.5 143,-305.5 "/>
<text text-anchor="start" x="8" y="-290.3" font-family="Times,serif" font-size="14.00" fill="#40575d">fn take_mailbox</text>
</g>
<!-- Fsm&#45;&gt;PeerFsm -->
<g id="edge1" class="edge">
<title>Fsm&#45;&gt;PeerFsm</title>
<path fill="none" stroke="#666666" d="M103.49,-457.78C119.31,-492.57 141.54,-530.7 171,-558 171.83,-558.77 172.68,-559.54 173.53,-560.3"/>
<polygon fill="#666666" stroke="#666666" points="171.53,-563.18 181.44,-566.93 176.03,-557.82 171.53,-563.18"/>
</g>
<!-- Fsm&#45;&gt;StoreFsm -->
<g id="edge2" class="edge">
<title>Fsm&#45;&gt;StoreFsm</title>
<path fill="none" stroke="#666666" d="M143.17,-426.3C152.27,-432.36 161.67,-438.1 171,-443 187.03,-451.43 204.52,-459.05 222,-465.79"/>
<polygon fill="#666666" stroke="#666666" points="221.11,-469.19 231.7,-469.44 223.58,-462.64 221.11,-469.19"/>
</g>
<!-- Fsm&#45;&gt;ControlFsm -->
<g id="edge3" class="edge">
<title>Fsm&#45;&gt;ControlFsm</title>
<path fill="none" stroke="#666666" d="M143.22,-370C179.56,-370 224.02,-370 261.77,-370"/>
<polygon fill="#666666" stroke="#666666" points="262.23,-373.5 272.23,-370 262.23,-366.5 262.23,-373.5"/>
</g>
<!-- Fsm&#45;&gt;ApplyFsm -->
<g id="edge4" class="edge">
<title>Fsm&#45;&gt;ApplyFsm</title>
<path fill="none" stroke="#666666" d="M143.02,-340.66C152.39,-336.97 161.9,-333.32 171,-330 176.9,-327.84 182.94,-325.68 189.04,-323.53"/>
<polygon fill="#666666" stroke="#666666" points="190.4,-326.76 198.68,-320.15 188.09,-320.15 190.4,-326.76"/>
</g>
<!-- BasicMailbox -->
<g id="node8" class="node">
<title>BasicMailbox</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M192,-90.5C192,-90.5 496,-90.5 496,-90.5 502,-90.5 508,-96.5 508,-102.5 508,-102.5 508,-147.5 508,-147.5 508,-153.5 502,-159.5 496,-159.5 496,-159.5 192,-159.5 192,-159.5 186,-159.5 180,-153.5 180,-147.5 180,-147.5 180,-102.5 180,-102.5 180,-96.5 186,-90.5 192,-90.5"/>
<text text-anchor="middle" x="344" y="-144.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">BasicMailbox</text>
<polyline fill="none" stroke="#60b5ac" points="180,-136.5 508,-136.5 "/>
<text text-anchor="start" x="188" y="-121.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">sender: mpsc::LooseBoundedSender&lt;Owner::Message&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="180,-113.5 508,-113.5 "/>
<text text-anchor="start" x="188" y="-98.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">state: Arc&lt;FsmState&lt;Owner&gt;&gt;,</text>
</g>
<!-- Fsm&#45;&gt;BasicMailbox -->
<g id="edge5" class="edge">
<title>Fsm&#45;&gt;BasicMailbox</title>
<path fill="none" stroke="#666666" d="M117.14,-282.29C132.04,-258.51 150.23,-234.1 171,-215 192.97,-194.8 220.33,-177.81 246.71,-164.22"/>
<polygon fill="#666666" stroke="#666666" points="248.63,-167.17 255.99,-159.55 245.48,-160.92 248.63,-167.17"/>
</g>
<!-- State -->
<g id="node7" class="node">
<title>State</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M848,-396.5C848,-396.5 976,-396.5 976,-396.5 982,-396.5 988,-402.5 988,-408.5 988,-408.5 988,-453.5 988,-453.5 988,-459.5 982,-465.5 976,-465.5 976,-465.5 848,-465.5 848,-465.5 842,-465.5 836,-459.5 836,-453.5 836,-453.5 836,-408.5 836,-408.5 836,-402.5 842,-396.5 848,-396.5"/>
<text text-anchor="middle" x="912" y="-450.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">State</text>
<polyline fill="none" stroke="#60b5ac" points="836,-442.5 988,-442.5 "/>
<text text-anchor="start" x="844" y="-427.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">sender_cnt: AtomicIsize,</text>
<polyline fill="none" stroke="#60b5ac" points="836,-419.5 988,-419.5 "/>
<text text-anchor="start" x="844" y="-404.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">connected: AtomicBool,</text>
</g>
<!-- Receiver&#45;&gt;State -->
<g id="edge23" class="edge">
<title>Receiver&#45;&gt;State</title>
<path fill="none" stroke="#666666" d="M741.03,-431C768.74,-431 798.78,-431 825.78,-431"/>
<polygon fill="#666666" stroke="#666666" points="825.97,-434.5 835.97,-431 825.97,-427.5 825.97,-434.5"/>
</g>
<!-- FsmState -->
<g id="node9" class="node">
<title>FsmState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M589.5,-90.5C589.5,-90.5 698.5,-90.5 698.5,-90.5 704.5,-90.5 710.5,-96.5 710.5,-102.5 710.5,-102.5 710.5,-147.5 710.5,-147.5 710.5,-153.5 704.5,-159.5 698.5,-159.5 698.5,-159.5 589.5,-159.5 589.5,-159.5 583.5,-159.5 577.5,-153.5 577.5,-147.5 577.5,-147.5 577.5,-102.5 577.5,-102.5 577.5,-96.5 583.5,-90.5 589.5,-90.5"/>
<text text-anchor="middle" x="644" y="-144.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">FsmState</text>
<polyline fill="none" stroke="#60b5ac" points="577.5,-136.5 710.5,-136.5 "/>
<text text-anchor="start" x="585.5" y="-121.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">status: AtomicUsize,</text>
<polyline fill="none" stroke="#60b5ac" points="577.5,-113.5 710.5,-113.5 "/>
<text text-anchor="start" x="585.5" y="-98.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">data: AtomicPtr&lt;N&gt;,</text>
</g>
<!-- BasicMailbox&#45;&gt;FsmState -->
<g id="edge6" class="edge">
<title>BasicMailbox&#45;&gt;FsmState</title>
<path fill="none" stroke="#666666" d="M508.39,-125C528.88,-125 549.01,-125 567.2,-125"/>
<polygon fill="#666666" stroke="#666666" points="567.38,-128.5 577.38,-125 567.38,-121.5 567.38,-128.5"/>
</g>
<!-- FsmScheduler -->
<g id="node14" class="node">
<title>FsmScheduler</title>
<path fill="#feed9b" stroke="#f7e495" d="M557,-25C557,-25 731,-25 731,-25 737,-25 743,-31 743,-37 743,-37 743,-59 743,-59 743,-65 737,-71 731,-71 731,-71 557,-71 557,-71 551,-71 545,-65 545,-59 545,-59 545,-37 545,-37 545,-31 551,-25 557,-25"/>
<text text-anchor="middle" x="644" y="-55.8" font-family="Times,serif" font-size="14.00" fill="#40575d">FsmScheduler</text>
<polyline fill="none" stroke="#f7e495" points="545,-48 743,-48 "/>
<text text-anchor="start" x="553" y="-32.8" font-family="Times,serif" font-size="14.00" fill="#40575d">schedulers Fsm for later handlers</text>
</g>
<!-- BasicMailbox&#45;&gt;FsmScheduler -->
<g id="edge27" class="edge">
<title>BasicMailbox&#45;&gt;FsmScheduler</title>
<path fill="none" stroke="#666666" d="M478.75,-90.44C500.65,-84.78 523,-79.01 543.88,-73.61"/>
<polygon fill="#666666" stroke="#666666" points="544.87,-76.97 553.68,-71.08 543.12,-70.19 544.87,-76.97"/>
</g>
<!-- RocksEngine -->
<g id="node21" class="node">
<title>RocksEngine</title>
<path fill="none" stroke="#1c2123" d="M1361.5,-573C1361.5,-573 1296.5,-573 1296.5,-573 1290.5,-573 1284.5,-567 1284.5,-561 1284.5,-561 1284.5,-549 1284.5,-549 1284.5,-543 1290.5,-537 1296.5,-537 1296.5,-537 1361.5,-537 1361.5,-537 1367.5,-537 1373.5,-543 1373.5,-549 1373.5,-549 1373.5,-561 1373.5,-561 1373.5,-567 1367.5,-573 1361.5,-573"/>
<text text-anchor="middle" x="1329" y="-551.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RocksEngine</text>
</g>
<!-- KvEngine&#45;&gt;RocksEngine -->
<g id="edge24" class="edge">
<title>KvEngine&#45;&gt;RocksEngine</title>
<path fill="none" stroke="#666666" d="M1236.33,-546.67C1248.98,-547.82 1261.92,-548.99 1273.94,-550.09"/>
<polygon fill="#666666" stroke="#666666" points="1273.96,-553.6 1284.24,-551.02 1274.6,-546.63 1273.96,-553.6"/>
</g>
<!-- RaftEngine&#45;&gt;RocksEngine -->
<g id="edge25" class="edge">
<title>RaftEngine&#45;&gt;RocksEngine</title>
<path fill="none" stroke="#666666" d="M1236.33,-593.33C1249.5,-587.83 1262.98,-582.19 1275.42,-576.99"/>
<polygon fill="#666666" stroke="#666666" points="1276.83,-580.19 1284.7,-573.11 1274.13,-573.74 1276.83,-580.19"/>
</g>
<!-- RaftLogEngine -->
<g id="node22" class="node">
<title>RaftLogEngine</title>
<path fill="none" stroke="#1c2123" d="M1367,-642C1367,-642 1291,-642 1291,-642 1285,-642 1279,-636 1279,-630 1279,-630 1279,-618 1279,-618 1279,-612 1285,-606 1291,-606 1291,-606 1367,-606 1367,-606 1373,-606 1379,-612 1379,-618 1379,-618 1379,-630 1379,-630 1379,-636 1373,-642 1367,-642"/>
<text text-anchor="middle" x="1329" y="-620.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLogEngine</text>
</g>
<!-- RaftEngine&#45;&gt;RaftLogEngine -->
<g id="edge26" class="edge">
<title>RaftEngine&#45;&gt;RaftLogEngine</title>
<path fill="none" stroke="#666666" d="M1243.08,-624C1251.63,-624 1260.21,-624 1268.45,-624"/>
<polygon fill="#666666" stroke="#666666" points="1268.69,-627.5 1278.69,-624 1268.69,-620.5 1268.69,-627.5"/>
</g>
<!-- RawNode -->
<g id="node12" class="node">
<title>RawNode</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M863,-677C863,-677 961,-677 961,-677 967,-677 973,-683 973,-689 973,-689 973,-711 973,-711 973,-717 967,-723 961,-723 961,-723 863,-723 863,-723 857,-723 851,-717 851,-711 851,-711 851,-689 851,-689 851,-683 857,-677 863,-677"/>
<text text-anchor="middle" x="912" y="-707.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RawNode</text>
<polyline fill="none" stroke="#60b5ac" points="851,-700 973,-700 "/>
<text text-anchor="start" x="859" y="-684.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">raft.RawNode模块</text>
</g>
<!-- NormalScheduler -->
<g id="node23" class="node">
<title>NormalScheduler</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M791,-55C791,-55 1033,-55 1033,-55 1039,-55 1045,-61 1045,-67 1045,-67 1045,-89 1045,-89 1045,-95 1039,-101 1033,-101 1033,-101 791,-101 791,-101 785,-101 779,-95 779,-89 779,-89 779,-67 779,-67 779,-61 785,-55 791,-55"/>
<text text-anchor="middle" x="912" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">NormalScheduler</text>
<polyline fill="none" stroke="#60b5ac" points="779,-78 1045,-78 "/>
<text text-anchor="start" x="787" y="-62.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">sender: channel::Sender&lt;FsmTypes&lt;N, C&gt;&gt;,</text>
</g>
<!-- FsmScheduler&#45;&gt;NormalScheduler -->
<g id="edge28" class="edge">
<title>FsmScheduler&#45;&gt;NormalScheduler</title>
<path fill="none" stroke="#666666" d="M743.29,-59.09C751.59,-60.02 760.08,-60.98 768.62,-61.94"/>
<polygon fill="#666666" stroke="#666666" points="768.34,-65.43 778.67,-63.08 769.12,-58.48 768.34,-65.43"/>
</g>
<!-- ControlScheduler -->
<g id="node24" class="node">
<title>ControlScheduler</title>
<path fill="none" stroke="#1c2123" d="M956,-36C956,-36 868,-36 868,-36 862,-36 856,-30 856,-24 856,-24 856,-12 856,-12 856,-6 862,0 868,0 868,0 956,0 956,0 962,0 968,-6 968,-12 968,-12 968,-24 968,-24 968,-30 962,-36 956,-36"/>
<text text-anchor="middle" x="912" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ControlScheduler</text>
</g>
<!-- FsmScheduler&#45;&gt;ControlScheduler -->
<g id="edge29" class="edge">
<title>FsmScheduler&#45;&gt;ControlScheduler</title>
<path fill="none" stroke="#666666" d="M743.29,-36.91C777.46,-33.06 814.92,-28.84 845.75,-25.36"/>
<polygon fill="#666666" stroke="#666666" points="846.4,-28.81 855.94,-24.21 845.61,-21.85 846.4,-28.81"/>
</g>
<!-- Peer&#45;&gt;RawNode -->
<g id="edge17" class="edge">
<title>Peer&#45;&gt;RawNode</title>
<path fill="none" stroke="#666666" d="M671.48,-645.97C710.65,-654.81 785.4,-671.67 841.03,-684.22"/>
<polygon fill="#666666" stroke="#666666" points="840.3,-687.64 850.83,-686.43 841.84,-680.81 840.3,-687.64"/>
</g>
<!-- ProposalQueue -->
<g id="node18" class="node">
<title>ProposalQueue</title>
<path fill="none" stroke="#1c2123" d="M949.5,-658C949.5,-658 874.5,-658 874.5,-658 868.5,-658 862.5,-652 862.5,-646 862.5,-646 862.5,-634 862.5,-634 862.5,-628 868.5,-622 874.5,-622 874.5,-622 949.5,-622 949.5,-622 955.5,-622 961.5,-628 961.5,-634 961.5,-634 961.5,-646 961.5,-646 961.5,-652 955.5,-658 949.5,-658"/>
<text text-anchor="middle" x="912" y="-636.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ProposalQueue</text>
</g>
<!-- Peer&#45;&gt;ProposalQueue -->
<g id="edge18" class="edge">
<title>Peer&#45;&gt;ProposalQueue</title>
<path fill="none" stroke="#666666" d="M671.48,-640C713.29,-640 795.64,-640 852,-640"/>
<polygon fill="#666666" stroke="#666666" points="852.2,-643.5 862.2,-640 852.2,-636.5 852.2,-643.5"/>
</g>
<!-- ReadIndexQueue -->
<g id="node19" class="node">
<title>ReadIndexQueue</title>
<path fill="none" stroke="#1c2123" d="M955,-778C955,-778 869,-778 869,-778 863,-778 857,-772 857,-766 857,-766 857,-754 857,-754 857,-748 863,-742 869,-742 869,-742 955,-742 955,-742 961,-742 967,-748 967,-754 967,-754 967,-766 967,-766 967,-772 961,-778 955,-778"/>
<text text-anchor="middle" x="912" y="-756.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexQueue</text>
</g>
<!-- Peer&#45;&gt;ReadIndexQueue -->
<g id="edge19" class="edge">
<title>Peer&#45;&gt;ReadIndexQueue</title>
<path fill="none" stroke="#666666" d="M665.22,-658.02C690.17,-679.27 734.74,-714.07 779,-733 800.26,-742.1 824.79,-748.19 846.88,-752.25"/>
<polygon fill="#666666" stroke="#666666" points="846.39,-755.72 856.84,-753.97 847.59,-748.82 846.39,-755.72"/>
</g>
<!-- PeerStorage -->
<g id="node20" class="node">
<title>PeerStorage</title>
<path fill="none" stroke="#1c2123" d="M941,-604C941,-604 883,-604 883,-604 877,-604 871,-598 871,-592 871,-592 871,-580 871,-580 871,-574 877,-568 883,-568 883,-568 941,-568 941,-568 947,-568 953,-574 953,-580 953,-580 953,-592 953,-592 953,-598 947,-604 941,-604"/>
<text text-anchor="middle" x="912" y="-582.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerStorage</text>
</g>
<!-- Peer&#45;&gt;PeerStorage -->
<g id="edge20" class="edge">
<title>Peer&#45;&gt;PeerStorage</title>
<path fill="none" stroke="#666666" d="M671.48,-634.62C715.52,-625.68 804.53,-607.61 860.77,-596.2"/>
<polygon fill="#666666" stroke="#666666" points="861.77,-599.57 870.87,-594.15 860.37,-592.71 861.77,-599.57"/>
</g>
<!-- PeerStorage&#45;&gt;KvEngine -->
<g id="edge21" class="edge">
<title>PeerStorage&#45;&gt;KvEngine</title>
<path fill="none" stroke="#666666" d="M953.12,-578.56C986.75,-572.32 1035.88,-563.21 1077.94,-555.41"/>
<polygon fill="#666666" stroke="#666666" points="1078.71,-558.82 1087.9,-553.56 1077.43,-551.94 1078.71,-558.82"/>
</g>
<!-- PeerStorage&#45;&gt;RaftEngine -->
<g id="edge22" class="edge">
<title>PeerStorage&#45;&gt;RaftEngine</title>
<path fill="none" stroke="#666666" d="M953.12,-592.15C984.84,-597.01 1030.35,-603.98 1070.7,-610.16"/>
<polygon fill="#666666" stroke="#666666" points="1070.43,-613.66 1080.84,-611.72 1071.49,-606.74 1070.43,-613.66"/>
</g>
</g>
</svg>
