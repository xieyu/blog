<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: local_reader_read_id Pages: 1 -->
<svg width="1248pt" height="164pt"
 viewBox="0.00 0.00 1248.00 163.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 159.5)">
<title>local_reader_read_id</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-159.5 1244,-159.5 1244,4 -4,4"/>
<!-- RaftKV__async_snapshot -->
<g id="node1" class="node">
<title>RaftKV__async_snapshot</title>
<path fill="none" stroke="#1c2123" d="M146,-117C146,-117 12,-117 12,-117 6,-117 0,-111 0,-105 0,-105 0,-93 0,-93 0,-87 6,-81 12,-81 12,-81 146,-81 146,-81 152,-81 158,-87 158,-93 158,-93 158,-105 158,-105 158,-111 152,-117 146,-117"/>
<text text-anchor="middle" x="79" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftKV__async_snapshot</text>
</g>
<!-- LocalReader__read -->
<g id="node2" class="node">
<title>LocalReader__read</title>
<path fill="none" stroke="#1c2123" d="M304,-117C304,-117 206,-117 206,-117 200,-117 194,-111 194,-105 194,-105 194,-93 194,-93 194,-87 200,-81 206,-81 206,-81 304,-81 304,-81 310,-81 316,-87 316,-93 316,-93 316,-105 316,-105 316,-111 310,-117 304,-117"/>
<text text-anchor="middle" x="255" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LocalReader__read</text>
</g>
<!-- RaftKV__async_snapshot&#45;&gt;LocalReader__read -->
<g id="edge1" class="edge">
<title>RaftKV__async_snapshot&#45;&gt;LocalReader__read</title>
<path fill="none" stroke="#666666" d="M158.09,-99C166.64,-99 175.29,-99 183.73,-99"/>
<polygon fill="#666666" stroke="#666666" points="183.9,-102.5 193.9,-99 183.9,-95.5 183.9,-102.5"/>
</g>
<!-- LocalReader__propose_raft_command -->
<g id="node3" class="node">
<title>LocalReader__propose_raft_command</title>
<path fill="none" stroke="#1c2123" d="M569,-117C569,-117 364,-117 364,-117 358,-117 352,-111 352,-105 352,-105 352,-93 352,-93 352,-87 358,-81 364,-81 364,-81 569,-81 569,-81 575,-81 581,-87 581,-93 581,-93 581,-105 581,-105 581,-111 575,-117 569,-117"/>
<text text-anchor="middle" x="466.5" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LocalReader__propose_raft_command</text>
</g>
<!-- LocalReader__read&#45;&gt;LocalReader__propose_raft_command -->
<g id="edge2" class="edge">
<title>LocalReader__read&#45;&gt;LocalReader__propose_raft_command</title>
<path fill="none" stroke="#666666" d="M316.03,-99C324.2,-99 332.82,-99 341.62,-99"/>
<polygon fill="#666666" stroke="#666666" points="341.63,-102.5 351.63,-99 341.63,-95.5 341.63,-102.5"/>
</g>
<!-- LocalReader__execute -->
<g id="node4" class="node">
<title>LocalReader__execute</title>
<path fill="none" stroke="#1c2123" d="M745,-117C745,-117 629,-117 629,-117 623,-117 617,-111 617,-105 617,-105 617,-93 617,-93 617,-87 623,-81 629,-81 629,-81 745,-81 745,-81 751,-81 757,-87 757,-93 757,-93 757,-105 757,-105 757,-111 751,-117 745,-117"/>
<text text-anchor="middle" x="687" y="-95.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LocalReader__execute</text>
</g>
<!-- LocalReader__propose_raft_command&#45;&gt;LocalReader__execute -->
<g id="edge3" class="edge">
<title>LocalReader__propose_raft_command&#45;&gt;LocalReader__execute</title>
<path fill="none" stroke="#666666" d="M581.23,-99C589.86,-99 598.44,-99 606.78,-99"/>
<polygon fill="#666666" stroke="#666666" points="606.81,-102.5 616.81,-99 606.81,-95.5 606.81,-102.5"/>
</g>
<!-- LocalReader__get_snapshot -->
<g id="node5" class="node">
<title>LocalReader__get_snapshot</title>
<path fill="none" stroke="#1c2123" d="M805,-26.5C805,-26.5 1013,-26.5 1013,-26.5 1019,-26.5 1025,-32.5 1025,-38.5 1025,-38.5 1025,-105.5 1025,-105.5 1025,-111.5 1019,-117.5 1013,-117.5 1013,-117.5 805,-117.5 805,-117.5 799,-117.5 793,-111.5 793,-105.5 793,-105.5 793,-38.5 793,-38.5 793,-32.5 799,-26.5 805,-26.5"/>
<text text-anchor="middle" x="909" y="-102.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LocalReader__get_snapshot</text>
<polyline fill="none" stroke="#1c2123" points="793,-94.5 1025,-94.5 "/>
<text text-anchor="start" x="801" y="-79.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果read_id == cache_read_id</text>
<text text-anchor="start" x="801" y="-64.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 就返回snap_cache</text>
<text text-anchor="start" x="801" y="-49.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 否则调用kv_engine::snapshot</text>
<text text-anchor="middle" x="909" y="-34.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后更新cache_read_id和snap_cache</text>
</g>
<!-- LocalReader__execute&#45;&gt;LocalReader__get_snapshot -->
<g id="edge4" class="edge">
<title>LocalReader__execute&#45;&gt;LocalReader__get_snapshot</title>
<path fill="none" stroke="#666666" d="M757.01,-90.53C765.34,-89.51 774.04,-88.44 782.87,-87.36"/>
<polygon fill="#666666" stroke="#666666" points="783.38,-90.82 792.88,-86.13 782.53,-83.87 783.38,-90.82"/>
</g>
<!-- LocalReader__cache_read_id -->
<g id="node6" class="node">
<title>LocalReader__cache_read_id</title>
<path fill="#feed9b" stroke="#f7e495" d="M1073,-109C1073,-109 1228,-109 1228,-109 1234,-109 1240,-115 1240,-121 1240,-121 1240,-143 1240,-143 1240,-149 1234,-155 1228,-155 1228,-155 1073,-155 1073,-155 1067,-155 1061,-149 1061,-143 1061,-143 1061,-121 1061,-121 1061,-115 1067,-109 1073,-109"/>
<text text-anchor="start" x="1069" y="-139.8" font-family="Times,serif" font-size="14.00" fill="#40575d">LocalReader__cache_read_id</text>
<polyline fill="none" stroke="#f7e495" points="1061,-132 1240,-132 "/>
<text text-anchor="start" x="1069" y="-116.8" font-family="Times,serif" font-size="14.00" fill="#40575d">cache_read_id: ThreadReadId</text>
</g>
<!-- LocalReader__get_snapshot&#45;&gt;LocalReader__cache_read_id -->
<g id="edge5" class="edge">
<title>LocalReader__get_snapshot&#45;&gt;LocalReader__cache_read_id</title>
<path fill="none" stroke="#666666" d="M1025.19,-100.86C1033.8,-103.02 1042.45,-105.18 1050.95,-107.31"/>
<polygon fill="#666666" stroke="#666666" points="1050.29,-110.75 1060.84,-109.79 1051.99,-103.96 1050.29,-110.75"/>
</g>
<!-- LocalReader__snap_cache -->
<g id="node7" class="node">
<title>LocalReader__snap_cache</title>
<path fill="none" stroke="#1c2123" d="M1219,-90C1219,-90 1082,-90 1082,-90 1076,-90 1070,-84 1070,-78 1070,-78 1070,-66 1070,-66 1070,-60 1076,-54 1082,-54 1082,-54 1219,-54 1219,-54 1225,-54 1231,-60 1231,-66 1231,-66 1231,-78 1231,-78 1231,-84 1225,-90 1219,-90"/>
<text text-anchor="middle" x="1150.5" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LocalReader__snap_cache</text>
</g>
<!-- LocalReader__get_snapshot&#45;&gt;LocalReader__snap_cache -->
<g id="edge6" class="edge">
<title>LocalReader__get_snapshot&#45;&gt;LocalReader__snap_cache</title>
<path fill="none" stroke="#666666" d="M1025.19,-72C1036.75,-72 1048.37,-72 1059.61,-72"/>
<polygon fill="#666666" stroke="#666666" points="1059.82,-75.5 1069.82,-72 1059.82,-68.5 1059.82,-75.5"/>
</g>
<!-- kv_engine__snapshot -->
<g id="node8" class="node">
<title>kv_engine__snapshot</title>
<path fill="none" stroke="#1c2123" d="M1205.5,-36C1205.5,-36 1095.5,-36 1095.5,-36 1089.5,-36 1083.5,-30 1083.5,-24 1083.5,-24 1083.5,-12 1083.5,-12 1083.5,-6 1089.5,0 1095.5,0 1095.5,0 1205.5,0 1205.5,0 1211.5,0 1217.5,-6 1217.5,-12 1217.5,-12 1217.5,-24 1217.5,-24 1217.5,-30 1211.5,-36 1205.5,-36"/>
<text text-anchor="middle" x="1150.5" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">kv_engine__snapshot</text>
</g>
<!-- LocalReader__get_snapshot&#45;&gt;kv_engine__snapshot -->
<g id="edge7" class="edge">
<title>LocalReader__get_snapshot&#45;&gt;kv_engine__snapshot</title>
<path fill="none" stroke="#666666" d="M1025.19,-46.03C1041.61,-42.33 1058.14,-38.6 1073.55,-35.13"/>
<polygon fill="#666666" stroke="#666666" points="1074.51,-38.5 1083.5,-32.88 1072.97,-31.67 1074.51,-38.5"/>
</g>
<!-- read_id -->
<g id="node9" class="node">
<title>read_id</title>
<path fill="none" stroke="#1c2123" d="M703.5,-63C703.5,-63 670.5,-63 670.5,-63 664.5,-63 658.5,-57 658.5,-51 658.5,-51 658.5,-39 658.5,-39 658.5,-33 664.5,-27 670.5,-27 670.5,-27 703.5,-27 703.5,-27 709.5,-27 715.5,-33 715.5,-39 715.5,-39 715.5,-51 715.5,-51 715.5,-57 709.5,-63 703.5,-63"/>
<text text-anchor="middle" x="687" y="-41.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_id</text>
</g>
<!-- read_id&#45;&gt;LocalReader__get_snapshot -->
<g id="edge8" class="edge">
<title>read_id&#45;&gt;LocalReader__get_snapshot</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M715.86,-48.42C733.47,-50.58 757.6,-53.54 782.82,-56.64"/>
<polygon fill="green" stroke="green" points="782.55,-60.13 792.9,-57.87 783.41,-53.18 782.55,-60.13"/>
</g>
</g>
</svg>
