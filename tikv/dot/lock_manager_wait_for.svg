<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: lock_manager_wait_for Pages: 1 -->
<svg width="1158pt" height="345pt"
 viewBox="0.00 0.00 1158.00 345.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 341)">
<title>lock_manager_wait_for</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-341 1154,-341 1154,4 -4,4"/>
<g id="clust2" class="cluster">
<title>cluster_FutureScheduler</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M739,-78.5C739,-78.5 948,-78.5 948,-78.5 954,-78.5 960,-84.5 960,-90.5 960,-90.5 960,-182.5 960,-182.5 960,-188.5 954,-194.5 948,-194.5 948,-194.5 739,-194.5 739,-194.5 733,-194.5 727,-188.5 727,-182.5 727,-182.5 727,-90.5 727,-90.5 727,-84.5 733,-78.5 739,-78.5"/>
<text text-anchor="middle" x="843.5" y="-174.5" font-family="Times,serif" font-size="20.00">worker/future.rs/Scheduler</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_WaitManagerScheduler</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M176,-94.5C176,-94.5 555.5,-94.5 555.5,-94.5 561.5,-94.5 567.5,-100.5 567.5,-106.5 567.5,-106.5 567.5,-166.5 567.5,-166.5 567.5,-172.5 561.5,-178.5 555.5,-178.5 555.5,-178.5 176,-178.5 176,-178.5 170,-178.5 164,-172.5 164,-166.5 164,-166.5 164,-106.5 164,-106.5 164,-100.5 170,-94.5 176,-94.5"/>
<text text-anchor="middle" x="365.75" y="-158.5" font-family="Times,serif" font-size="20.00">wait_manager.rs/Scheduler</text>
</g>
<!-- LockManager_wait_for -->
<g id="node1" class="node">
<title>LockManager_wait_for</title>
<path fill="none" stroke="#1c2123" d="M12,-142.5C12,-142.5 81,-142.5 81,-142.5 87,-142.5 93,-148.5 93,-154.5 93,-154.5 93,-176.5 93,-176.5 93,-182.5 87,-188.5 81,-188.5 81,-188.5 12,-188.5 12,-188.5 6,-188.5 0,-182.5 0,-176.5 0,-176.5 0,-154.5 0,-154.5 0,-148.5 6,-142.5 12,-142.5"/>
<text text-anchor="start" x="8" y="-173.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LockManager</text>
<polyline fill="none" stroke="#1c2123" points="0,-165.5 93,-165.5 "/>
<text text-anchor="start" x="8" y="-150.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">wait_for</text>
</g>
<!-- StorageCallback_execute -->
<g id="node2" class="node">
<title>StorageCallback_execute</title>
<path fill="none" stroke="#1c2123" d="M144,-252.5C144,-252.5 262,-252.5 262,-252.5 268,-252.5 274,-258.5 274,-264.5 274,-264.5 274,-324.5 274,-324.5 274,-330.5 268,-336.5 262,-336.5 262,-336.5 144,-336.5 144,-336.5 138,-336.5 132,-330.5 132,-324.5 132,-324.5 132,-264.5 132,-264.5 132,-258.5 138,-252.5 144,-252.5"/>
<text text-anchor="start" x="140" y="-321.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">StorageCallback</text>
<polyline fill="none" stroke="#1c2123" points="132,-313.5 274,-313.5 "/>
<text text-anchor="start" x="140" y="-298.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">execute</text>
<polyline fill="none" stroke="#1c2123" points="132,-290.5 274,-290.5 "/>
<text text-anchor="start" x="140" y="-275.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">timeout已经为none了</text>
<text text-anchor="start" x="140" y="-260.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 直接执行cb</text>
</g>
<!-- LockManager_wait_for&#45;&gt;StorageCallback_execute -->
<g id="edge2" class="edge">
<title>LockManager_wait_for&#45;&gt;StorageCallback_execute</title>
<path fill="none" stroke="#666666" d="M69.82,-188.67C85.73,-204.73 107.95,-226.24 129,-243.5 130.01,-244.33 131.03,-245.15 132.06,-245.98"/>
<polygon fill="#666666" stroke="#666666" points="130.13,-248.91 140.16,-252.31 134.44,-243.4 130.13,-248.91"/>
</g>
<!-- deadlock_Scheduler_detect -->
<g id="node3" class="node">
<title>deadlock_Scheduler_detect</title>
<path fill="none" stroke="#1c2123" d="M153.5,-187.5C153.5,-187.5 252.5,-187.5 252.5,-187.5 258.5,-187.5 264.5,-193.5 264.5,-199.5 264.5,-199.5 264.5,-221.5 264.5,-221.5 264.5,-227.5 258.5,-233.5 252.5,-233.5 252.5,-233.5 153.5,-233.5 153.5,-233.5 147.5,-233.5 141.5,-227.5 141.5,-221.5 141.5,-221.5 141.5,-199.5 141.5,-199.5 141.5,-193.5 147.5,-187.5 153.5,-187.5"/>
<text text-anchor="start" x="149.5" y="-218.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">deadlock/Scheduler</text>
<polyline fill="none" stroke="#1c2123" points="141.5,-210.5 264.5,-210.5 "/>
<text text-anchor="middle" x="203" y="-195.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">detect</text>
</g>
<!-- LockManager_wait_for&#45;&gt;deadlock_Scheduler_detect -->
<g id="edge3" class="edge">
<title>LockManager_wait_for&#45;&gt;deadlock_Scheduler_detect</title>
<path fill="none" stroke="#666666" d="M93.02,-178.76C105.08,-182.27 118.38,-186.15 131.43,-189.95"/>
<polygon fill="#666666" stroke="#666666" points="130.76,-193.4 141.34,-192.83 132.72,-186.68 130.76,-193.4"/>
</g>
<!-- add_to_detected -->
<g id="node4" class="node">
<title>add_to_detected</title>
<path fill="none" stroke="#1c2123" d="M141,-0.5C141,-0.5 265,-0.5 265,-0.5 271,-0.5 277,-6.5 277,-12.5 277,-12.5 277,-72.5 277,-72.5 277,-78.5 271,-84.5 265,-84.5 265,-84.5 141,-84.5 141,-84.5 135,-84.5 129,-78.5 129,-72.5 129,-72.5 129,-12.5 129,-12.5 129,-6.5 135,-0.5 141,-0.5"/>
<text text-anchor="start" x="137" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LockManager</text>
<polyline fill="none" stroke="#1c2123" points="129,-61.5 277,-61.5 "/>
<text text-anchor="start" x="137" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">add_to_detected</text>
<polyline fill="none" stroke="#1c2123" points="129,-38.5 277,-38.5 "/>
<text text-anchor="start" x="137" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">记录已经发送请求到</text>
<text text-anchor="start" x="137" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> detect deadlock的事务</text>
</g>
<!-- LockManager_wait_for&#45;&gt;add_to_detected -->
<g id="edge4" class="edge">
<title>LockManager_wait_for&#45;&gt;add_to_detected</title>
<path fill="none" stroke="#666666" d="M70.5,-142.46C84.8,-128.55 104.02,-110.63 128.58,-91.05"/>
<polygon fill="#666666" stroke="#666666" points="131.04,-93.56 136.74,-84.63 126.72,-88.06 131.04,-93.56"/>
</g>
<!-- wait_manager_Scheduler_wait_for -->
<g id="node6" class="node">
<title>wait_manager_Scheduler_wait_for</title>
<path fill="none" stroke="#1c2123" d="M184,-103.5C184,-103.5 222,-103.5 222,-103.5 228,-103.5 234,-109.5 234,-115.5 234,-115.5 234,-127.5 234,-127.5 234,-133.5 228,-139.5 222,-139.5 222,-139.5 184,-139.5 184,-139.5 178,-139.5 172,-133.5 172,-127.5 172,-127.5 172,-115.5 172,-115.5 172,-109.5 178,-103.5 184,-103.5"/>
<text text-anchor="start" x="180" y="-117.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">wait_for</text>
</g>
<!-- LockManager_wait_for&#45;&gt;wait_manager_Scheduler_wait_for -->
<g id="edge5" class="edge">
<title>LockManager_wait_for&#45;&gt;wait_manager_Scheduler_wait_for</title>
<path fill="none" stroke="#666666" d="M93.02,-152.54C115,-146.28 141.12,-138.84 162.28,-132.81"/>
<polygon fill="#666666" stroke="#666666" points="163.27,-136.17 171.92,-130.07 161.35,-129.44 163.27,-136.17"/>
</g>
<!-- detected -->
<g id="node5" class="node">
<title>detected</title>
<path fill="#feed9b" stroke="#f7e495" d="M325,-19.5C325,-19.5 687,-19.5 687,-19.5 693,-19.5 699,-25.5 699,-31.5 699,-31.5 699,-53.5 699,-53.5 699,-59.5 693,-65.5 687,-65.5 687,-65.5 325,-65.5 325,-65.5 319,-65.5 313,-59.5 313,-53.5 313,-53.5 313,-31.5 313,-31.5 313,-25.5 319,-19.5 325,-19.5"/>
<text text-anchor="start" x="321" y="-50.3" font-family="Times,serif" font-size="14.00" fill="#40575d">LockManager</text>
<polyline fill="none" stroke="#f7e495" points="313,-42.5 699,-42.5 "/>
<text text-anchor="start" x="321" y="-27.3" font-family="Times,serif" font-size="14.00" fill="#40575d">detected: Arc&lt;[CachePadded&lt;Mutex&lt;HashSet&lt;TimeStamp&gt;&gt;&gt;]&gt;,</text>
</g>
<!-- add_to_detected&#45;&gt;detected -->
<g id="edge1" class="edge">
<title>add_to_detected&#45;&gt;detected</title>
<path fill="none" stroke="#666666" d="M277.25,-42.5C285.4,-42.5 293.97,-42.5 302.81,-42.5"/>
<polygon fill="#666666" stroke="#666666" points="302.9,-46 312.9,-42.5 302.9,-39 302.9,-46"/>
</g>
<!-- wait_manager_Scheduler_notify_scheduler -->
<g id="node10" class="node">
<title>wait_manager_Scheduler_notify_scheduler</title>
<path fill="none" stroke="#1c2123" d="M464.5,-103.5C464.5,-103.5 547.5,-103.5 547.5,-103.5 553.5,-103.5 559.5,-109.5 559.5,-115.5 559.5,-115.5 559.5,-127.5 559.5,-127.5 559.5,-133.5 553.5,-139.5 547.5,-139.5 547.5,-139.5 464.5,-139.5 464.5,-139.5 458.5,-139.5 452.5,-133.5 452.5,-127.5 452.5,-127.5 452.5,-115.5 452.5,-115.5 452.5,-109.5 458.5,-103.5 464.5,-103.5"/>
<text text-anchor="start" x="460.5" y="-117.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">notify_scheduler</text>
</g>
<!-- wait_manager_Scheduler_wait_for&#45;&gt;wait_manager_Scheduler_notify_scheduler -->
<g id="edge8" class="edge">
<title>wait_manager_Scheduler_wait_for&#45;&gt;wait_manager_Scheduler_notify_scheduler</title>
<path fill="none" stroke="#666666" d="M234.24,-121.5C282.61,-121.5 378.4,-121.5 442.09,-121.5"/>
<polygon fill="#666666" stroke="#666666" points="442.41,-125 452.41,-121.5 442.41,-118 442.41,-125"/>
</g>
<!-- FutureScheduler_schedule -->
<g id="node7" class="node">
<title>FutureScheduler_schedule</title>
<path fill="none" stroke="#1c2123" d="M747,-103.5C747,-103.5 787,-103.5 787,-103.5 793,-103.5 799,-109.5 799,-115.5 799,-115.5 799,-127.5 799,-127.5 799,-133.5 793,-139.5 787,-139.5 787,-139.5 747,-139.5 747,-139.5 741,-139.5 735,-133.5 735,-127.5 735,-127.5 735,-115.5 735,-115.5 735,-109.5 741,-103.5 747,-103.5"/>
<text text-anchor="middle" x="767" y="-117.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">schedule</text>
</g>
<!-- UnboundedSender_send -->
<g id="node8" class="node">
<title>UnboundedSender_send</title>
<path fill="none" stroke="#1c2123" d="M847,-87C847,-87 940,-87 940,-87 946,-87 952,-93 952,-99 952,-99 952,-144 952,-144 952,-150 946,-156 940,-156 940,-156 847,-156 847,-156 841,-156 835,-150 835,-144 835,-144 835,-99 835,-99 835,-93 841,-87 847,-87"/>
<text text-anchor="start" x="843" y="-140.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">UnboundedSender</text>
<polyline fill="none" stroke="#1c2123" points="835,-133 952,-133 "/>
<text text-anchor="middle" x="893.5" y="-117.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">send</text>
<polyline fill="none" stroke="#1c2123" points="835,-110 952,-110 "/>
<text text-anchor="middle" x="893.5" y="-94.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">发送到channel中</text>
</g>
<!-- FutureScheduler_schedule&#45;&gt;UnboundedSender_send -->
<g id="edge6" class="edge">
<title>FutureScheduler_schedule&#45;&gt;UnboundedSender_send</title>
<path fill="none" stroke="#666666" d="M799.1,-121.5C806.94,-121.5 815.68,-121.5 824.58,-121.5"/>
<polygon fill="#666666" stroke="#666666" points="824.65,-125 834.65,-121.5 824.65,-118 824.65,-125"/>
</g>
<!-- WaiterManager_run -->
<g id="node9" class="node">
<title>WaiterManager_run</title>
<path fill="none" stroke="#1c2123" d="M1000,-98.5C1000,-98.5 1138,-98.5 1138,-98.5 1144,-98.5 1150,-104.5 1150,-110.5 1150,-110.5 1150,-132.5 1150,-132.5 1150,-138.5 1144,-144.5 1138,-144.5 1138,-144.5 1000,-144.5 1000,-144.5 994,-144.5 988,-138.5 988,-132.5 988,-132.5 988,-110.5 988,-110.5 988,-104.5 994,-98.5 1000,-98.5"/>
<text text-anchor="middle" x="1069" y="-129.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">WaiterManager::run</text>
<polyline fill="none" stroke="#1c2123" points="988,-121.5 1150,-121.5 "/>
<text text-anchor="start" x="996" y="-106.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">从channel 去消息并处理</text>
</g>
<!-- UnboundedSender_send&#45;&gt;WaiterManager_run -->
<g id="edge7" class="edge">
<title>UnboundedSender_send&#45;&gt;WaiterManager_run</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M952.27,-121.5C960.49,-121.5 969.1,-121.5 977.76,-121.5"/>
<polygon fill="green" stroke="green" points="977.92,-125 987.92,-121.5 977.92,-118 977.92,-125"/>
</g>
<!-- wait_manager_Scheduler_notify_scheduler&#45;&gt;FutureScheduler_schedule -->
<g id="edge9" class="edge">
<title>wait_manager_Scheduler_notify_scheduler&#45;&gt;FutureScheduler_schedule</title>
<path fill="none" stroke="#666666" d="M559.72,-121.5C608.47,-121.5 679.93,-121.5 724.67,-121.5"/>
<polygon fill="#666666" stroke="#666666" points="724.89,-125 734.89,-121.5 724.89,-118 724.89,-125"/>
</g>
</g>
</svg>
