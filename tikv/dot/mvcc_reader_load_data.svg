<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: load_data Pages: 1 -->
<svg width="910pt" height="264pt"
 viewBox="0.00 0.00 910.00 263.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 259.5)">
<title>load_data</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-259.5 906,-259.5 906,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Snapshot</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M647,-80.5C647,-80.5 808,-80.5 808,-80.5 814,-80.5 820,-86.5 820,-92.5 820,-92.5 820,-176.5 820,-176.5 820,-182.5 814,-188.5 808,-188.5 808,-188.5 647,-188.5 647,-188.5 641,-188.5 635,-182.5 635,-176.5 635,-176.5 635,-92.5 635,-92.5 635,-86.5 641,-80.5 647,-80.5"/>
<text text-anchor="middle" x="727.5" y="-168.5" font-family="Times,serif" font-size="20.00">Snapshot</text>
</g>
<!-- get -->
<g id="node1" class="node">
<title>get</title>
<path fill="none" stroke="#1c2123" d="M655,-89C655,-89 800,-89 800,-89 806,-89 812,-95 812,-101 812,-101 812,-138 812,-138 812,-144 806,-150 800,-150 800,-150 655,-150 655,-150 649,-150 643,-144 643,-138 643,-138 643,-101 643,-101 643,-95 649,-89 655,-89"/>
<text text-anchor="middle" x="727.5" y="-134.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">get</text>
<polyline fill="none" stroke="#1c2123" points="643,-127 812,-127 "/>
<text text-anchor="start" x="651" y="-111.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">从Snapshot CF_DEFAULT</text>
<text text-anchor="start" x="651" y="-96.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 中获取value</text>
</g>
<!-- val -->
<g id="node8" class="node">
<title>val</title>
<path fill="none" stroke="#1c2123" d="M890,-137.5C890,-137.5 860,-137.5 860,-137.5 854,-137.5 848,-131.5 848,-125.5 848,-125.5 848,-113.5 848,-113.5 848,-107.5 854,-101.5 860,-101.5 860,-101.5 890,-101.5 890,-101.5 896,-101.5 902,-107.5 902,-113.5 902,-113.5 902,-125.5 902,-125.5 902,-131.5 896,-137.5 890,-137.5"/>
<text text-anchor="middle" x="875" y="-115.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">val</text>
</g>
<!-- get&#45;&gt;val -->
<g id="edge7" class="edge">
<title>get&#45;&gt;val</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M812.29,-119.5C821.15,-119.5 829.79,-119.5 837.66,-119.5"/>
<polygon fill="green" stroke="green" points="837.87,-123 847.87,-119.5 837.87,-116 837.87,-123"/>
</g>
<!-- Write -->
<g id="node2" class="node">
<title>Write</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M241,-148C241,-148 417,-148 417,-148 423,-148 429,-154 429,-160 429,-160 429,-243 429,-243 429,-249 423,-255 417,-255 417,-255 241,-255 241,-255 235,-255 229,-249 229,-243 229,-243 229,-160 229,-160 229,-154 235,-148 241,-148"/>
<text text-anchor="middle" x="329" y="-239.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Write</text>
<polyline fill="none" stroke="#60b5ac" points="229,-232 429,-232 "/>
<text text-anchor="start" x="237" y="-216.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub write_type: WriteType,</text>
<polyline fill="none" stroke="#60b5ac" points="229,-209 429,-209 "/>
<text text-anchor="start" x="237" y="-193.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub start_ts: TimeStamp,</text>
<polyline fill="none" stroke="#60b5ac" points="229,-186 429,-186 "/>
<text text-anchor="start" x="237" y="-170.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub short_value: Option&lt;Value&gt;,</text>
<text text-anchor="middle" x="329" y="-155.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> ...</text>
</g>
<!-- key -->
<g id="node4" class="node">
<title>key</title>
<path fill="none" stroke="#1c2123" d="M477,-148.5C477,-148.5 595,-148.5 595,-148.5 601,-148.5 607,-154.5 607,-160.5 607,-160.5 607,-220.5 607,-220.5 607,-226.5 601,-232.5 595,-232.5 595,-232.5 477,-232.5 477,-232.5 471,-232.5 465,-226.5 465,-220.5 465,-220.5 465,-160.5 465,-160.5 465,-154.5 471,-148.5 477,-148.5"/>
<text text-anchor="middle" x="536" y="-217.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">key</text>
<polyline fill="none" stroke="#1c2123" points="465,-209.5 607,-209.5 "/>
<text text-anchor="start" x="473" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">key.append_ts(start_ts)</text>
<polyline fill="none" stroke="#1c2123" points="465,-186.5 607,-186.5 "/>
<text text-anchor="start" x="473" y="-171.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将write的start_ts</text>
<text text-anchor="start" x="473" y="-156.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> append到key上</text>
</g>
<!-- Write&#45;&gt;key -->
<g id="edge3" class="edge">
<title>Write:start_ts&#45;&gt;key</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M429,-197.5C437.35,-197.5 446.06,-197.28 454.75,-196.92"/>
<polygon fill="green" stroke="green" points="455.09,-200.41 464.91,-196.44 454.76,-193.42 455.09,-200.41"/>
</g>
<!-- Write&#45;&gt;val -->
<g id="edge8" class="edge">
<title>Write&#45;&gt;val</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M429.14,-235.2C441.11,-238.2 453.25,-240.75 465,-242.5 527.43,-251.77 544.31,-249.76 607,-242.5 703.59,-231.31 738.78,-245.97 820,-192.5 837.28,-181.12 851.04,-162.23 860.34,-146.51"/>
<polygon fill="green" stroke="green" points="863.44,-148.13 865.29,-137.7 857.34,-144.7 863.44,-148.13"/>
</g>
<!-- load_data -->
<g id="node3" class="node">
<title>load_data</title>
<path fill="none" stroke="#1c2123" d="M12,-122.5C12,-122.5 181,-122.5 181,-122.5 187,-122.5 193,-128.5 193,-134.5 193,-134.5 193,-186.5 193,-186.5 193,-192.5 187,-198.5 181,-198.5 181,-198.5 12,-198.5 12,-198.5 6,-198.5 0,-192.5 0,-186.5 0,-186.5 0,-134.5 0,-134.5 0,-128.5 6,-122.5 12,-122.5"/>
<text text-anchor="middle" x="96.5" y="-183.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">load_data</text>
<polyline fill="none" stroke="#1c2123" points="0,-175.5 193,-175.5 "/>
<text text-anchor="start" x="8" y="-160.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果write中包含了short_value</text>
<text text-anchor="start" x="8" y="-145.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 则直接返回short value</text>
<text text-anchor="start" x="8" y="-130.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 此处是对short value的优化</text>
</g>
<!-- load_data&#45;&gt;get -->
<g id="edge1" class="edge">
<title>load_data&#45;&gt;get</title>
<path fill="none" stroke="#666666" d="M193.19,-143.03C205.21,-141.27 217.37,-139.69 229,-138.5 369.07,-124.17 532.33,-120.38 632.55,-119.52"/>
<polygon fill="#666666" stroke="#666666" points="632.68,-123.02 642.65,-119.45 632.62,-116.02 632.68,-123.02"/>
</g>
<!-- load_data&#45;&gt;Write -->
<g id="edge2" class="edge">
<title>load_data&#45;&gt;Write</title>
<path fill="none" stroke="#666666" d="M193.25,-177.53C201.7,-179.03 210.29,-180.56 218.83,-182.08"/>
<polygon fill="#666666" stroke="#666666" points="218.37,-185.55 228.83,-183.86 219.6,-178.66 218.37,-185.55"/>
</g>
<!-- key&#45;&gt;get -->
<g id="edge4" class="edge">
<title>key&#45;&gt;get</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M607.02,-164.26C616.28,-160.8 625.87,-157.2 635.41,-153.63"/>
<polygon fill="green" stroke="green" points="636.78,-156.85 644.92,-150.07 634.32,-150.3 636.78,-156.85"/>
</g>
<!-- scan_mode -->
<g id="node5" class="node">
<title>scan_mode</title>
<path fill="#feed9b" stroke="#f7e495" d="M262,-0.5C262,-0.5 396,-0.5 396,-0.5 402,-0.5 408,-6.5 408,-12.5 408,-12.5 408,-72.5 408,-72.5 408,-78.5 402,-84.5 396,-84.5 396,-84.5 262,-84.5 262,-84.5 256,-84.5 250,-78.5 250,-72.5 250,-72.5 250,-12.5 250,-12.5 250,-6.5 256,-0.5 262,-0.5"/>
<text text-anchor="middle" x="329" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#40575d">scan_mode</text>
<polyline fill="none" stroke="#f7e495" points="250,-61.5 408,-61.5 "/>
<text text-anchor="start" x="258" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#40575d">if scam_mode.is_some</text>
<text text-anchor="start" x="258" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 就创建curosr</text>
<polyline fill="none" stroke="#f7e495" points="250,-23.5 408,-23.5 "/>
<text text-anchor="start" x="258" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#40575d">否则直接用Snapshot.get</text>
</g>
<!-- scan_mode&#45;&gt;get -->
<g id="edge5" class="edge">
<title>scan_mode&#45;&gt;get</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M408.34,-57.71C472.87,-70.24 564.55,-88.05 632.94,-101.33"/>
<polygon fill="green" stroke="green" points="632.37,-104.78 642.85,-103.26 633.7,-97.91 632.37,-104.78"/>
</g>
<!-- create_data_cursor -->
<g id="node6" class="node">
<title>create_data_cursor</title>
<path fill="none" stroke="#1c2123" d="M583.5,-53.5C583.5,-53.5 488.5,-53.5 488.5,-53.5 482.5,-53.5 476.5,-47.5 476.5,-41.5 476.5,-41.5 476.5,-29.5 476.5,-29.5 476.5,-23.5 482.5,-17.5 488.5,-17.5 488.5,-17.5 583.5,-17.5 583.5,-17.5 589.5,-17.5 595.5,-23.5 595.5,-29.5 595.5,-29.5 595.5,-41.5 595.5,-41.5 595.5,-47.5 589.5,-53.5 583.5,-53.5"/>
<text text-anchor="middle" x="536" y="-31.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_data_cursor</text>
</g>
<!-- scan_mode&#45;&gt;create_data_cursor -->
<g id="edge6" class="edge">
<title>scan_mode&#45;&gt;create_data_cursor</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M408.09,-39.83C427.18,-39.18 447.47,-38.49 466.1,-37.85"/>
<polygon fill="green" stroke="green" points="466.39,-41.34 476.26,-37.51 466.15,-34.35 466.39,-41.34"/>
</g>
<!-- cursor_get -->
<g id="node7" class="node">
<title>cursor_get</title>
<path fill="none" stroke="#1c2123" d="M752.5,-62.5C752.5,-62.5 702.5,-62.5 702.5,-62.5 696.5,-62.5 690.5,-56.5 690.5,-50.5 690.5,-50.5 690.5,-38.5 690.5,-38.5 690.5,-32.5 696.5,-26.5 702.5,-26.5 702.5,-26.5 752.5,-26.5 752.5,-26.5 758.5,-26.5 764.5,-32.5 764.5,-38.5 764.5,-38.5 764.5,-50.5 764.5,-50.5 764.5,-56.5 758.5,-62.5 752.5,-62.5"/>
<text text-anchor="middle" x="727.5" y="-40.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">cursor_get</text>
</g>
<!-- create_data_cursor&#45;&gt;cursor_get -->
<g id="edge10" class="edge">
<title>create_data_cursor&#45;&gt;cursor_get</title>
<path fill="none" stroke="#666666" d="M595.66,-38.29C622.89,-39.58 654.79,-41.09 680.28,-42.3"/>
<polygon fill="#666666" stroke="#666666" points="680.26,-45.81 690.42,-42.79 680.6,-38.82 680.26,-45.81"/>
</g>
<!-- cursor_get&#45;&gt;val -->
<g id="edge9" class="edge">
<title>cursor_get&#45;&gt;val</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M764.89,-54.14C782.17,-59.48 802.76,-66.98 820,-76.5 829.28,-81.63 838.6,-88.35 846.82,-94.95"/>
<polygon fill="green" stroke="green" points="844.71,-97.74 854.63,-101.44 849.18,-92.36 844.71,-97.74"/>
</g>
</g>
</svg>
