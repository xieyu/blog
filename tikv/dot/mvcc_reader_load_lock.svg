<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: mvcc_reader_load_lock Pages: 1 -->
<svg width="872pt" height="391pt"
 viewBox="0.00 0.00 872.00 391.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 387)">
<title>mvcc_reader_load_lock</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-387 868,-387 868,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Lock</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M431,-51C431,-51 844,-51 844,-51 850,-51 856,-57 856,-63 856,-63 856,-363 856,-363 856,-369 850,-375 844,-375 844,-375 431,-375 431,-375 425,-375 419,-369 419,-363 419,-363 419,-63 419,-63 419,-57 425,-51 431,-51"/>
<text text-anchor="middle" x="637.5" y="-355" font-family="Times,serif" font-size="20.00">Lock</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Cursor</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M264.5,-218C264.5,-218 311.5,-218 311.5,-218 317.5,-218 323.5,-224 323.5,-230 323.5,-230 323.5,-288 323.5,-288 323.5,-294 317.5,-300 311.5,-300 311.5,-300 264.5,-300 264.5,-300 258.5,-300 252.5,-294 252.5,-288 252.5,-288 252.5,-230 252.5,-230 252.5,-224 258.5,-218 264.5,-218"/>
<text text-anchor="middle" x="288" y="-280" font-family="Times,serif" font-size="20.00">Cursor</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_Snapshot</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M188,-72C188,-72 387,-72 387,-72 393,-72 399,-78 399,-84 399,-84 399,-168 399,-168 399,-174 393,-180 387,-180 387,-180 188,-180 188,-180 182,-180 176,-174 176,-168 176,-168 176,-84 176,-84 176,-78 182,-72 188,-72"/>
<text text-anchor="middle" x="287.5" y="-160" font-family="Times,serif" font-size="20.00">Snapshot</text>
</g>
<!-- parse -->
<g id="node1" class="node">
<title>parse</title>
<path fill="none" stroke="#1c2123" d="M469,-216C469,-216 439,-216 439,-216 433,-216 427,-210 427,-204 427,-204 427,-192 427,-192 427,-186 433,-180 439,-180 439,-180 469,-180 469,-180 475,-180 481,-186 481,-192 481,-192 481,-204 481,-204 481,-210 475,-216 469,-216"/>
<text text-anchor="middle" x="454" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">parse</text>
</g>
<!-- Lock -->
<g id="node2" class="node">
<title>Lock</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M529,-60C529,-60 718,-60 718,-60 724,-60 730,-66 730,-72 730,-72 730,-324 730,-324 730,-330 724,-336 718,-336 718,-336 529,-336 529,-336 523,-336 517,-330 517,-324 517,-324 517,-72 517,-72 517,-66 523,-60 529,-60"/>
<text text-anchor="middle" x="623.5" y="-320.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Lock</text>
<polyline fill="none" stroke="#60b5ac" points="517,-313 730,-313 "/>
<text text-anchor="start" x="525" y="-297.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub lock_type: LockType,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-290 730,-290 "/>
<text text-anchor="start" x="525" y="-274.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub primary: Vec&lt;u8&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-267 730,-267 "/>
<text text-anchor="start" x="525" y="-251.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub ts: TimeStamp,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-244 730,-244 "/>
<text text-anchor="start" x="525" y="-228.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub ttl: u64,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-221 730,-221 "/>
<text text-anchor="start" x="525" y="-205.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub short_value: Option&lt;Value&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-198 730,-198 "/>
<text text-anchor="start" x="525" y="-182.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub for_update_ts: TimeStamp,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-175 730,-175 "/>
<text text-anchor="start" x="525" y="-159.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub txn_size: u64,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-152 730,-152 "/>
<text text-anchor="start" x="525" y="-136.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub min_commit_ts: TimeStamp,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-129 730,-129 "/>
<text text-anchor="start" x="525" y="-113.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub use_async_commit: bool,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-106 730,-106 "/>
<text text-anchor="start" x="525" y="-90.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub secondaries: Vec&lt;Vec&lt;u8&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="517,-83 730,-83 "/>
<text text-anchor="start" x="525" y="-67.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub rollback_ts: Vec&lt;TimeStamp&gt;,</text>
</g>
<!-- parse&#45;&gt;Lock -->
<g id="edge1" class="edge">
<title>parse&#45;&gt;Lock</title>
<path fill="none" stroke="#666666" d="M481.17,-198C488.6,-198 497.21,-198 506.43,-198"/>
<polygon fill="#666666" stroke="#666666" points="506.66,-201.5 516.66,-198 506.66,-194.5 506.66,-201.5"/>
</g>
<!-- LockType -->
<g id="node3" class="node">
<title>LockType</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M778,-140.5C778,-140.5 836,-140.5 836,-140.5 842,-140.5 848,-146.5 848,-152.5 848,-152.5 848,-243.5 848,-243.5 848,-249.5 842,-255.5 836,-255.5 836,-255.5 778,-255.5 778,-255.5 772,-255.5 766,-249.5 766,-243.5 766,-243.5 766,-152.5 766,-152.5 766,-146.5 772,-140.5 778,-140.5"/>
<text text-anchor="middle" x="807" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">LockType</text>
<polyline fill="none" stroke="#60b5ac" points="766,-232.5 848,-232.5 "/>
<text text-anchor="start" x="774" y="-217.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Put,</text>
<polyline fill="none" stroke="#60b5ac" points="766,-209.5 848,-209.5 "/>
<text text-anchor="start" x="774" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Delete,</text>
<polyline fill="none" stroke="#60b5ac" points="766,-186.5 848,-186.5 "/>
<text text-anchor="start" x="774" y="-171.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Lock,</text>
<polyline fill="none" stroke="#60b5ac" points="766,-163.5 848,-163.5 "/>
<text text-anchor="start" x="774" y="-148.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Pessimistic,</text>
</g>
<!-- Lock&#45;&gt;LockType -->
<g id="edge2" class="edge">
<title>Lock&#45;&gt;LockType</title>
<path fill="none" stroke="#666666" d="M730.08,-198C738.86,-198 747.46,-198 755.52,-198"/>
<polygon fill="#666666" stroke="#666666" points="755.78,-201.5 765.78,-198 755.78,-194.5 755.78,-201.5"/>
</g>
<!-- get -->
<g id="node4" class="node">
<title>get</title>
<path fill="none" stroke="#1c2123" d="M302.5,-262C302.5,-262 272.5,-262 272.5,-262 266.5,-262 260.5,-256 260.5,-250 260.5,-250 260.5,-238 260.5,-238 260.5,-232 266.5,-226 272.5,-226 272.5,-226 302.5,-226 302.5,-226 308.5,-226 314.5,-232 314.5,-238 314.5,-238 314.5,-250 314.5,-250 314.5,-256 308.5,-262 302.5,-262"/>
<text text-anchor="middle" x="287.5" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">get</text>
</g>
<!-- get&#45;&gt;parse -->
<g id="edge9" class="edge">
<title>get&#45;&gt;parse</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M314.57,-236.71C342.16,-229 385.91,-216.76 416.83,-208.11"/>
<polygon fill="green" stroke="green" points="418.1,-211.39 426.78,-205.33 416.21,-204.65 418.1,-211.39"/>
</g>
<!-- get_cf -->
<g id="node5" class="node">
<title>get_cf</title>
<path fill="none" stroke="#1c2123" d="M196,-80.5C196,-80.5 379,-80.5 379,-80.5 385,-80.5 391,-86.5 391,-92.5 391,-92.5 391,-129.5 391,-129.5 391,-135.5 385,-141.5 379,-141.5 379,-141.5 196,-141.5 196,-141.5 190,-141.5 184,-135.5 184,-129.5 184,-129.5 184,-92.5 184,-92.5 184,-86.5 190,-80.5 196,-80.5"/>
<text text-anchor="middle" x="287.5" y="-126.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_cf</text>
<polyline fill="none" stroke="#1c2123" points="184,-118.5 391,-118.5 "/>
<text text-anchor="start" x="192" y="-103.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果self.lock_cursor为none</text>
<text text-anchor="start" x="192" y="-88.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> snapshot.get_cf(CF_LOCK, key)?</text>
</g>
<!-- get_cf&#45;&gt;parse -->
<g id="edge10" class="edge">
<title>get_cf&#45;&gt;parse</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M346.5,-141.67C370.24,-154.23 396.95,-168.35 417.68,-179.32"/>
<polygon fill="green" stroke="green" points="416.27,-182.53 426.75,-184.12 419.54,-176.35 416.27,-182.53"/>
</g>
<!-- create_lock_cursor -->
<g id="node6" class="node">
<title>create_lock_cursor</title>
<path fill="none" stroke="#1c2123" d="M210,-0.5C210,-0.5 365,-0.5 365,-0.5 371,-0.5 377,-6.5 377,-12.5 377,-12.5 377,-49.5 377,-49.5 377,-55.5 371,-61.5 365,-61.5 365,-61.5 210,-61.5 210,-61.5 204,-61.5 198,-55.5 198,-49.5 198,-49.5 198,-12.5 198,-12.5 198,-6.5 204,-0.5 210,-0.5"/>
<text text-anchor="middle" x="287.5" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_lock_cursor</text>
<polyline fill="none" stroke="#1c2123" points="198,-38.5 377,-38.5 "/>
<text text-anchor="start" x="206" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">CursorBuilder::new</text>
<text text-anchor="start" x="206" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> (&amp;self.snapshot, CF_LOCK)</text>
</g>
<!-- scan_mode -->
<g id="node7" class="node">
<title>scan_mode</title>
<path fill="none" stroke="#1c2123" d="M12,-43.5C12,-43.5 136,-43.5 136,-43.5 142,-43.5 148,-49.5 148,-55.5 148,-55.5 148,-92.5 148,-92.5 148,-98.5 142,-104.5 136,-104.5 136,-104.5 12,-104.5 12,-104.5 6,-104.5 0,-98.5 0,-92.5 0,-92.5 0,-55.5 0,-55.5 0,-49.5 6,-43.5 12,-43.5"/>
<text text-anchor="middle" x="74" y="-89.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">scan_mode</text>
<polyline fill="none" stroke="#1c2123" points="0,-81.5 148,-81.5 "/>
<text text-anchor="start" x="8" y="-66.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">if scan_mode.is_some()</text>
<text text-anchor="start" x="8" y="-51.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 就创建cursor</text>
</g>
<!-- scan_mode&#45;&gt;get_cf -->
<g id="edge3" class="edge">
<title>scan_mode&#45;&gt;get_cf</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M148.08,-86.79C156.5,-88.26 165.22,-89.78 174,-91.32"/>
<polygon fill="green" stroke="green" points="173.48,-94.78 183.93,-93.06 174.68,-87.89 173.48,-94.78"/>
</g>
<!-- scan_mode&#45;&gt;create_lock_cursor -->
<g id="edge4" class="edge">
<title>scan_mode&#45;&gt;create_lock_cursor</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M148.08,-59.14C160.83,-56.55 174.28,-53.81 187.59,-51.11"/>
<polygon fill="green" stroke="green" points="188.62,-54.47 197.73,-49.05 187.23,-47.61 188.62,-54.47"/>
</g>
<!-- load_lock -->
<g id="node8" class="node">
<title>load_lock</title>
<path fill="none" stroke="#1c2123" d="M97,-165C97,-165 51,-165 51,-165 45,-165 39,-159 39,-153 39,-153 39,-141 39,-141 39,-135 45,-129 51,-129 51,-129 97,-129 97,-129 103,-129 109,-135 109,-141 109,-141 109,-153 109,-153 109,-159 103,-165 97,-165"/>
<text text-anchor="middle" x="74" y="-143.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">load_lock</text>
</g>
<!-- load_lock&#45;&gt;parse -->
<g id="edge5" class="edge">
<title>load_lock&#45;&gt;parse</title>
<path fill="none" stroke="#666666" d="M109.31,-162.49C128.51,-170.41 153.13,-179.34 176,-184 260.75,-201.25 362.95,-201.19 416.38,-199.61"/>
<polygon fill="#666666" stroke="#666666" points="416.83,-203.1 426.7,-199.27 416.59,-196.1 416.83,-203.1"/>
</g>
<!-- load_lock&#45;&gt;get -->
<g id="edge6" class="edge">
<title>load_lock&#45;&gt;get</title>
<path fill="none" stroke="#666666" d="M98.76,-165.12C118.54,-179.49 147.91,-199.22 176,-212 199.86,-222.85 228.29,-230.98 250.34,-236.34"/>
<polygon fill="#666666" stroke="#666666" points="249.75,-239.8 260.29,-238.67 251.35,-232.98 249.75,-239.8"/>
</g>
<!-- load_lock&#45;&gt;get_cf -->
<g id="edge7" class="edge">
<title>load_lock&#45;&gt;get_cf</title>
<path fill="none" stroke="#666666" d="M109.45,-141.14C127.38,-138.09 150.41,-134.16 173.91,-130.17"/>
<polygon fill="#666666" stroke="#666666" points="174.72,-133.58 183.99,-128.45 173.54,-126.68 174.72,-133.58"/>
</g>
<!-- load_lock&#45;&gt;create_lock_cursor -->
<g id="edge8" class="edge">
<title>load_lock&#45;&gt;create_lock_cursor</title>
<path fill="none" stroke="#666666" d="M109.07,-136.5C122.27,-131.24 136.85,-123.86 148,-114 165.93,-98.14 157.29,-82.93 176,-68 180.05,-64.77 184.39,-61.82 188.93,-59.12"/>
<polygon fill="#666666" stroke="#666666" points="190.77,-62.1 197.87,-54.23 187.42,-55.95 190.77,-62.1"/>
</g>
</g>
</svg>
