<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: txn_modifiers Pages: 1 -->
<svg width="1794pt" height="420pt"
 viewBox="0.00 0.00 1794.00 419.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 415.5)">
<title>txn_modifiers</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-415.5 1790,-415.5 1790,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_scheduler_process_write</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M656,-179.5C656,-179.5 1254,-179.5 1254,-179.5 1260,-179.5 1266,-185.5 1266,-191.5 1266,-191.5 1266,-391.5 1266,-391.5 1266,-397.5 1260,-403.5 1254,-403.5 1254,-403.5 656,-403.5 656,-403.5 650,-403.5 644,-397.5 644,-391.5 644,-391.5 644,-191.5 644,-191.5 644,-185.5 650,-179.5 656,-179.5"/>
<text text-anchor="middle" x="955" y="-383.5" font-family="Times,serif" font-size="20.00">scheduler::process_write</text>
</g>
<!-- modifies -->
<g id="node1" class="node">
<title>modifies</title>
<path fill="#feed9b" stroke="#f7e495" d="M12,-245.5C12,-245.5 89,-245.5 89,-245.5 95,-245.5 101,-251.5 101,-257.5 101,-257.5 101,-279.5 101,-279.5 101,-285.5 95,-291.5 89,-291.5 89,-291.5 12,-291.5 12,-291.5 6,-291.5 0,-285.5 0,-279.5 0,-279.5 0,-257.5 0,-257.5 0,-251.5 6,-245.5 12,-245.5"/>
<text text-anchor="middle" x="50.5" y="-276.3" font-family="Times,serif" font-size="14.00" fill="#40575d">modifies</text>
<polyline fill="none" stroke="#f7e495" points="0,-268.5 101,-268.5 "/>
<text text-anchor="start" x="8" y="-253.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Vec&lt;Modifier&gt;</text>
</g>
<!-- WriteData -->
<g id="node3" class="node">
<title>WriteData</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M149,-234C149,-234 302,-234 302,-234 308,-234 314,-240 314,-246 314,-246 314,-291 314,-291 314,-297 308,-303 302,-303 302,-303 149,-303 149,-303 143,-303 137,-297 137,-291 137,-291 137,-246 137,-246 137,-240 143,-234 149,-234"/>
<text text-anchor="middle" x="225.5" y="-287.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">WriteData</text>
<polyline fill="none" stroke="#60b5ac" points="137,-280 314,-280 "/>
<text text-anchor="start" x="145" y="-264.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub modifies: Vec&lt;Modify&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="137,-257 314,-257 "/>
<text text-anchor="start" x="145" y="-241.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub extra: TxnExtra,</text>
</g>
<!-- modifies&#45;&gt;WriteData -->
<g id="edge10" class="edge">
<title>modifies&#45;&gt;WriteData</title>
<path fill="none" stroke="#666666" d="M101.07,-268.5C109.2,-268.5 117.86,-268.5 126.68,-268.5"/>
<polygon fill="#666666" stroke="#666666" points="126.69,-272 136.69,-268.5 126.69,-265 126.69,-272"/>
</g>
<!-- guards -->
<g id="node2" class="node">
<title>guards</title>
<path fill="#feed9b" stroke="#f7e495" d="M163,-105.5C163,-105.5 288,-105.5 288,-105.5 294,-105.5 300,-111.5 300,-117.5 300,-117.5 300,-139.5 300,-139.5 300,-145.5 294,-151.5 288,-151.5 288,-151.5 163,-151.5 163,-151.5 157,-151.5 151,-145.5 151,-139.5 151,-139.5 151,-117.5 151,-117.5 151,-111.5 157,-105.5 163,-105.5"/>
<text text-anchor="middle" x="225.5" y="-136.3" font-family="Times,serif" font-size="14.00" fill="#40575d">guards</text>
<polyline fill="none" stroke="#f7e495" points="151,-128.5 300,-128.5 "/>
<text text-anchor="start" x="159" y="-113.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Vec&lt;KeyHandleGuard&gt;</text>
</g>
<!-- WriteResult -->
<g id="node4" class="node">
<title>WriteResult</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M362,-127C362,-127 604,-127 604,-127 610,-127 616,-133 616,-139 616,-139 616,-314 616,-314 616,-320 610,-326 604,-326 604,-326 362,-326 362,-326 356,-326 350,-320 350,-314 350,-314 350,-139 350,-139 350,-133 356,-127 362,-127"/>
<text text-anchor="middle" x="483" y="-310.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">WriteResult</text>
<polyline fill="none" stroke="#60b5ac" points="350,-303 616,-303 "/>
<text text-anchor="start" x="358" y="-287.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub ctx: Context,</text>
<polyline fill="none" stroke="#60b5ac" points="350,-280 616,-280 "/>
<text text-anchor="start" x="358" y="-264.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub to_be_write: WriteData,</text>
<polyline fill="none" stroke="#60b5ac" points="350,-257 616,-257 "/>
<text text-anchor="start" x="358" y="-241.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub rows: usize,</text>
<polyline fill="none" stroke="#60b5ac" points="350,-234 616,-234 "/>
<text text-anchor="start" x="358" y="-218.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pr: ProcessResult,</text>
<polyline fill="none" stroke="#60b5ac" points="350,-211 616,-211 "/>
<text text-anchor="start" x="358" y="-195.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub lock_info: Option&lt;(lock_manager::Lock,</text>
<text text-anchor="start" x="358" y="-180.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> bool, Option&lt;WaitTimeout&gt;)&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="350,-173 616,-173 "/>
<text text-anchor="start" x="358" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub lock_guards: Vec&lt;KeyHandleGuard&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="350,-150 616,-150 "/>
<text text-anchor="start" x="358" y="-134.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub response_policy: ResponsePolicy,</text>
</g>
<!-- guards&#45;&gt;WriteResult -->
<g id="edge1" class="edge">
<title>guards&#45;&gt;WriteResult</title>
<path fill="none" stroke="#666666" d="M286.73,-151.6C303.07,-157.87 321.48,-164.93 340.31,-172.15"/>
<polygon fill="#666666" stroke="#666666" points="339.28,-175.51 349.87,-175.82 341.79,-168.97 339.28,-175.51"/>
</g>
<!-- KeyHandleGuard -->
<g id="node12" class="node">
<title>KeyHandleGuard</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M392,-23.5C392,-23.5 574,-23.5 574,-23.5 580,-23.5 586,-29.5 586,-35.5 586,-35.5 586,-95.5 586,-95.5 586,-101.5 580,-107.5 574,-107.5 574,-107.5 392,-107.5 392,-107.5 386,-107.5 380,-101.5 380,-95.5 380,-95.5 380,-35.5 380,-35.5 380,-29.5 386,-23.5 392,-23.5"/>
<text text-anchor="middle" x="483" y="-92.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">KeyHandleGuard</text>
<polyline fill="none" stroke="#60b5ac" points="380,-84.5 586,-84.5 "/>
<text text-anchor="start" x="388" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">_mutex_guard: AsyncMutexGuard</text>
<text text-anchor="start" x="388" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> &lt;&#39;static, ()&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="380,-46.5 586,-46.5 "/>
<text text-anchor="start" x="388" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">handle: Arc&lt;KeyHandle&gt;,</text>
</g>
<!-- guards&#45;&gt;KeyHandleGuard -->
<g id="edge7" class="edge">
<title>guards&#45;&gt;KeyHandleGuard</title>
<path fill="none" stroke="#666666" d="M300.06,-110.36C321.96,-104.96 346.46,-98.92 370.22,-93.06"/>
<polygon fill="#666666" stroke="#666666" points="371.11,-96.45 379.98,-90.65 369.44,-89.65 371.11,-96.45"/>
</g>
<!-- WriteData&#45;&gt;WriteResult -->
<g id="edge11" class="edge">
<title>WriteData&#45;&gt;WriteResult:to_be_write</title>
<path fill="none" stroke="#666666" d="M314.21,-268.5C322.76,-268.5 331.39,-268.5 339.83,-268.5"/>
<polygon fill="#666666" stroke="#666666" points="340,-272 350,-268.5 340,-265 340,-272"/>
</g>
<!-- async_write_ext -->
<g id="node5" class="node">
<title>async_write_ext</title>
<path fill="none" stroke="#1c2123" d="M664,-188.5C664,-188.5 789,-188.5 789,-188.5 795,-188.5 801,-194.5 801,-200.5 801,-200.5 801,-352.5 801,-352.5 801,-358.5 795,-364.5 789,-364.5 789,-364.5 664,-364.5 664,-364.5 658,-364.5 652,-358.5 652,-352.5 652,-352.5 652,-200.5 652,-200.5 652,-194.5 658,-188.5 664,-188.5"/>
<text text-anchor="middle" x="726.5" y="-349.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">async_write_ext</text>
<polyline fill="none" stroke="#1c2123" points="652,-341.5 801,-341.5 "/>
<text text-anchor="start" x="660" y="-326.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">engine.async_write_ext(</text>
<polyline fill="none" stroke="#1c2123" points="652,-318.5 801,-318.5 "/>
<text text-anchor="start" x="660" y="-303.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">&amp;ctx,</text>
<polyline fill="none" stroke="#1c2123" points="652,-295.5 801,-295.5 "/>
<text text-anchor="start" x="660" y="-280.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">to_be_write,</text>
<polyline fill="none" stroke="#1c2123" points="652,-272.5 801,-272.5 "/>
<text text-anchor="start" x="660" y="-257.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">engine_cb,</text>
<polyline fill="none" stroke="#1c2123" points="652,-249.5 801,-249.5 "/>
<text text-anchor="start" x="660" y="-234.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">proposed_cb,</text>
<polyline fill="none" stroke="#1c2123" points="652,-226.5 801,-226.5 "/>
<text text-anchor="start" x="660" y="-211.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">committed_cb,</text>
<text text-anchor="start" x="660" y="-196.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> )</text>
</g>
<!-- WriteResult&#45;&gt;async_write_ext -->
<g id="edge12" class="edge">
<title>WriteResult:to_be_write&#45;&gt;async_write_ext</title>
<path fill="none" stroke="#666666" d="M616,-268.5C624.36,-268.5 633.06,-268.73 641.75,-269.12"/>
<polygon fill="#666666" stroke="#666666" points="641.76,-272.63 651.93,-269.65 642.12,-265.64 641.76,-272.63"/>
</g>
<!-- on_write_finished -->
<g id="node7" class="node">
<title>on_write_finished</title>
<path fill="none" stroke="#1c2123" d="M1103,-188C1103,-188 1246,-188 1246,-188 1252,-188 1258,-194 1258,-200 1258,-200 1258,-237 1258,-237 1258,-243 1252,-249 1246,-249 1246,-249 1103,-249 1103,-249 1097,-249 1091,-243 1091,-237 1091,-237 1091,-200 1091,-200 1091,-194 1097,-188 1103,-188"/>
<text text-anchor="middle" x="1174.5" y="-233.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_write_finished</text>
<polyline fill="none" stroke="#1c2123" points="1091,-226 1258,-226 "/>
<text text-anchor="start" x="1099" y="-210.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">在修改都写到engine之后</text>
<text text-anchor="start" x="1099" y="-195.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 释放掉lock guards</text>
</g>
<!-- WriteResult&#45;&gt;on_write_finished -->
<g id="edge13" class="edge">
<title>WriteResult:lock_guards&#45;&gt;on_write_finished</title>
<path fill="none" stroke="#666666" d="M616,-161.5C780.16,-161.5 970.12,-186.26 1080.55,-203.14"/>
<polygon fill="#666666" stroke="#666666" points="1080.24,-206.64 1090.65,-204.7 1081.3,-199.72 1080.24,-206.64"/>
</g>
<!-- engine_cb -->
<g id="node6" class="node">
<title>engine_cb</title>
<path fill="none" stroke="#1c2123" d="M866.5,-224.5C866.5,-224.5 1025.5,-224.5 1025.5,-224.5 1031.5,-224.5 1037.5,-230.5 1037.5,-236.5 1037.5,-236.5 1037.5,-258.5 1037.5,-258.5 1037.5,-264.5 1031.5,-270.5 1025.5,-270.5 1025.5,-270.5 866.5,-270.5 866.5,-270.5 860.5,-270.5 854.5,-264.5 854.5,-258.5 854.5,-258.5 854.5,-236.5 854.5,-236.5 854.5,-230.5 860.5,-224.5 866.5,-224.5"/>
<text text-anchor="middle" x="946" y="-255.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">engine_cb</text>
<polyline fill="none" stroke="#1c2123" points="854.5,-247.5 1037.5,-247.5 "/>
<text text-anchor="start" x="862.5" y="-232.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">在engine写完之后的callback</text>
</g>
<!-- async_write_ext&#45;&gt;engine_cb -->
<g id="edge2" class="edge">
<title>async_write_ext&#45;&gt;engine_cb</title>
<path fill="none" stroke="#666666" d="M801.14,-266.68C815.05,-264.83 829.83,-262.86 844.41,-260.91"/>
<polygon fill="#666666" stroke="#666666" points="845.01,-264.36 854.46,-259.57 844.09,-257.42 845.01,-264.36"/>
</g>
<!-- engine_cb&#45;&gt;on_write_finished -->
<g id="edge3" class="edge">
<title>engine_cb&#45;&gt;on_write_finished</title>
<path fill="none" stroke="#666666" d="M1037.82,-235.87C1051.88,-234.07 1066.43,-232.21 1080.54,-230.4"/>
<polygon fill="#666666" stroke="#666666" points="1081.25,-233.84 1090.72,-229.1 1080.36,-226.9 1081.25,-233.84"/>
</g>
<!-- drop -->
<g id="node8" class="node">
<title>drop</title>
<path fill="none" stroke="#1c2123" d="M1306,-183.5C1306,-183.5 1398,-183.5 1398,-183.5 1404,-183.5 1410,-189.5 1410,-195.5 1410,-195.5 1410,-217.5 1410,-217.5 1410,-223.5 1404,-229.5 1398,-229.5 1398,-229.5 1306,-229.5 1306,-229.5 1300,-229.5 1294,-223.5 1294,-217.5 1294,-217.5 1294,-195.5 1294,-195.5 1294,-189.5 1300,-183.5 1306,-183.5"/>
<text text-anchor="middle" x="1352" y="-214.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">drop</text>
<polyline fill="none" stroke="#1c2123" points="1294,-206.5 1410,-206.5 "/>
<text text-anchor="middle" x="1352" y="-191.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">drop(lock_guards)</text>
</g>
<!-- on_write_finished&#45;&gt;drop -->
<g id="edge4" class="edge">
<title>on_write_finished&#45;&gt;drop</title>
<path fill="none" stroke="#666666" d="M1258.11,-212.85C1266.71,-212.26 1275.37,-211.67 1283.77,-211.1"/>
<polygon fill="#666666" stroke="#666666" points="1284.12,-214.58 1293.85,-210.41 1283.64,-207.6 1284.12,-214.58"/>
</g>
<!-- KeyHandleGuard_drop -->
<g id="node9" class="node">
<title>KeyHandleGuard_drop</title>
<path fill="none" stroke="#1c2123" d="M1458,-164C1458,-164 1665,-164 1665,-164 1671,-164 1677,-170 1677,-176 1677,-176 1677,-213 1677,-213 1677,-219 1671,-225 1665,-225 1665,-225 1458,-225 1458,-225 1452,-225 1446,-219 1446,-213 1446,-213 1446,-176 1446,-176 1446,-170 1452,-164 1458,-164"/>
<text text-anchor="middle" x="1561.5" y="-209.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">KeyHandleGuard::drop</text>
<polyline fill="none" stroke="#1c2123" points="1446,-202 1677,-202 "/>
<text text-anchor="start" x="1454" y="-186.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">release lock in memory</text>
<text text-anchor="start" x="1454" y="-171.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> *self.handle.lock_store.lock() = None;</text>
</g>
<!-- drop&#45;&gt;KeyHandleGuard_drop -->
<g id="edge5" class="edge">
<title>drop&#45;&gt;KeyHandleGuard_drop</title>
<path fill="none" stroke="#666666" d="M1410.25,-203.19C1418.36,-202.72 1426.94,-202.22 1435.73,-201.72"/>
<polygon fill="#666666" stroke="#666666" points="1435.95,-205.21 1445.73,-201.14 1435.55,-198.22 1435.95,-205.21"/>
</g>
<!-- lock_store -->
<g id="node10" class="node">
<title>lock_store</title>
<path fill="none" stroke="#1c2123" d="M1774,-159.5C1774,-159.5 1725,-159.5 1725,-159.5 1719,-159.5 1713,-153.5 1713,-147.5 1713,-147.5 1713,-135.5 1713,-135.5 1713,-129.5 1719,-123.5 1725,-123.5 1725,-123.5 1774,-123.5 1774,-123.5 1780,-123.5 1786,-129.5 1786,-135.5 1786,-135.5 1786,-147.5 1786,-147.5 1786,-153.5 1780,-159.5 1774,-159.5"/>
<text text-anchor="middle" x="1749.5" y="-137.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">lock_store</text>
</g>
<!-- KeyHandleGuard_drop&#45;&gt;lock_store -->
<g id="edge6" class="edge">
<title>KeyHandleGuard_drop&#45;&gt;lock_store</title>
<path fill="none" stroke="#666666" d="M1669.62,-163.98C1681.25,-160.66 1692.58,-157.44 1702.85,-154.51"/>
<polygon fill="#666666" stroke="#666666" points="1704.09,-157.79 1712.75,-151.69 1702.17,-151.06 1704.09,-157.79"/>
</g>
<!-- KeyHandle -->
<g id="node11" class="node">
<title>KeyHandle</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M849,-0.5C849,-0.5 1043,-0.5 1043,-0.5 1049,-0.5 1055,-6.5 1055,-12.5 1055,-12.5 1055,-118.5 1055,-118.5 1055,-124.5 1049,-130.5 1043,-130.5 1043,-130.5 849,-130.5 849,-130.5 843,-130.5 837,-124.5 837,-118.5 837,-118.5 837,-12.5 837,-12.5 837,-6.5 843,-0.5 849,-0.5"/>
<text text-anchor="middle" x="946" y="-115.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">KeyHandle</text>
<polyline fill="none" stroke="#60b5ac" points="837,-107.5 1055,-107.5 "/>
<text text-anchor="start" x="845" y="-92.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub key: Key,</text>
<polyline fill="none" stroke="#60b5ac" points="837,-84.5 1055,-84.5 "/>
<text text-anchor="start" x="845" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">table: UnsafeCell&lt;</text>
<text text-anchor="start" x="845" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> Option&lt;LockTable&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="837,-46.5 1055,-46.5 "/>
<text text-anchor="start" x="845" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">mutex: AsyncMutex&lt;()&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="837,-23.5 1055,-23.5 "/>
<text text-anchor="start" x="845" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">lock_store: Mutex&lt;Option&lt;Lock&gt;&gt;,</text>
</g>
<!-- KeyHandle&#45;&gt;lock_store -->
<g id="edge9" class="edge">
<title>KeyHandle&#45;&gt;lock_store</title>
<path fill="none" stroke="#666666" d="M1055.09,-75.75C1232.59,-92.58 1578.5,-125.38 1702.71,-137.16"/>
<polygon fill="#666666" stroke="#666666" points="1702.71,-140.67 1713,-138.13 1703.38,-133.71 1702.71,-140.67"/>
</g>
<!-- KeyHandleGuard&#45;&gt;KeyHandle -->
<g id="edge8" class="edge">
<title>KeyHandleGuard&#45;&gt;KeyHandle</title>
<path fill="none" stroke="#666666" d="M586.02,-65.5C657.07,-65.5 752.05,-65.5 826.47,-65.5"/>
<polygon fill="#666666" stroke="#666666" points="826.83,-69 836.83,-65.5 826.83,-62 826.83,-69"/>
</g>
</g>
</svg>
