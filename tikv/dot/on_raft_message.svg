<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: on_raft_message Pages: 1 -->
<svg width="829pt" height="620pt"
 viewBox="0.00 0.00 829.00 620.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 616)">
<title>on_raft_message</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-616 825,-616 825,4 -4,4"/>
<!-- PeerFsmDelegate_on_raft_msg -->
<g id="node1" class="node">
<title>PeerFsmDelegate_on_raft_msg</title>
<path fill="none" stroke="#1c2123" d="M12,-324.5C12,-324.5 101,-324.5 101,-324.5 107,-324.5 113,-330.5 113,-336.5 113,-336.5 113,-350.5 113,-350.5 113,-356.5 107,-362.5 101,-362.5 101,-362.5 12,-362.5 12,-362.5 6,-362.5 0,-356.5 0,-350.5 0,-350.5 0,-336.5 0,-336.5 0,-330.5 6,-324.5 12,-324.5"/>
<text text-anchor="middle" x="56.5" y="-347.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="56.5" y="-332.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_raft_msg</text>
</g>
<!-- Peer_step -->
<g id="node2" class="node">
<title>Peer_step</title>
<path fill="none" stroke="#1c2123" d="M166,-527C166,-527 281,-527 281,-527 287,-527 293,-533 293,-539 293,-539 293,-576 293,-576 293,-582 287,-588 281,-588 281,-588 166,-588 166,-588 160,-588 154,-582 154,-576 154,-576 154,-539 154,-539 154,-533 160,-527 166,-527"/>
<text text-anchor="middle" x="223.5" y="-572.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="middle" x="223.5" y="-557.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> step</text>
<polyline fill="none" stroke="#1c2123" points="154,-550 293,-550 "/>
<text text-anchor="start" x="162" y="-534.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Steps the raft message</text>
</g>
<!-- PeerFsmDelegate_on_raft_msg&#45;&gt;Peer_step -->
<g id="edge1" class="edge">
<title>PeerFsmDelegate_on_raft_msg&#45;&gt;Peer_step</title>
<path fill="none" stroke="#666666" d="M63.44,-362.75C74.97,-397.45 103.35,-471.2 149,-517.5 149.92,-518.43 150.86,-519.35 151.83,-520.25"/>
<polygon fill="#666666" stroke="#666666" points="149.75,-523.07 159.65,-526.82 154.25,-517.71 149.75,-523.07"/>
</g>
<!-- Peer_heartbeat_pd -->
<g id="node3" class="node">
<title>Peer_heartbeat_pd</title>
<path fill="none" stroke="#1c2123" d="M176,-417C176,-417 271,-417 271,-417 277,-417 283,-423 283,-429 283,-429 283,-496 283,-496 283,-502 277,-508 271,-508 271,-508 176,-508 176,-508 170,-508 164,-502 164,-496 164,-496 164,-429 164,-429 164,-423 170,-417 176,-417"/>
<text text-anchor="middle" x="223.5" y="-492.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="middle" x="223.5" y="-477.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> heartbeat_pd</text>
<polyline fill="none" stroke="#1c2123" points="164,-470 283,-470 "/>
<text text-anchor="start" x="172" y="-454.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">通过Pd_scheduler</text>
<text text-anchor="start" x="172" y="-439.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 让pd worker发送</text>
<text text-anchor="start" x="172" y="-424.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Hearbeat消息</text>
</g>
<!-- PeerFsmDelegate_on_raft_msg&#45;&gt;Peer_heartbeat_pd -->
<g id="edge2" class="edge">
<title>PeerFsmDelegate_on_raft_msg&#45;&gt;Peer_heartbeat_pd</title>
<path fill="none" stroke="#666666" d="M84.01,-362.62C103.33,-376.55 130.39,-396.07 155.48,-414.17"/>
<polygon fill="#666666" stroke="#666666" points="153.74,-417.23 163.9,-420.24 157.84,-411.55 153.74,-417.23"/>
</g>
<!-- Peer_any_new_per_catch_up -->
<g id="node4" class="node">
<title>Peer_any_new_per_catch_up</title>
<path fill="none" stroke="#1c2123" d="M161,-359.5C161,-359.5 286,-359.5 286,-359.5 292,-359.5 298,-365.5 298,-371.5 298,-371.5 298,-385.5 298,-385.5 298,-391.5 292,-397.5 286,-397.5 286,-397.5 161,-397.5 161,-397.5 155,-397.5 149,-391.5 149,-385.5 149,-385.5 149,-371.5 149,-371.5 149,-365.5 155,-359.5 161,-359.5"/>
<text text-anchor="middle" x="223.5" y="-382.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="middle" x="223.5" y="-367.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> any_new_per_catch_up</text>
</g>
<!-- PeerFsmDelegate_on_raft_msg&#45;&gt;Peer_any_new_per_catch_up -->
<g id="edge3" class="edge">
<title>PeerFsmDelegate_on_raft_msg&#45;&gt;Peer_any_new_per_catch_up</title>
<path fill="none" stroke="#666666" d="M113.36,-355.35C121.65,-357.11 130.34,-358.95 139.04,-360.8"/>
<polygon fill="#666666" stroke="#666666" points="138.34,-364.23 148.85,-362.88 139.8,-357.38 138.34,-364.23"/>
</g>
<!-- PeerFsmDelegate_handle_gc_peer_msg -->
<g id="node5" class="node">
<title>PeerFsmDelegate_handle_gc_peer_msg</title>
<path fill="none" stroke="#1c2123" d="M167.5,-279C167.5,-279 279.5,-279 279.5,-279 285.5,-279 291.5,-285 291.5,-291 291.5,-291 291.5,-328 291.5,-328 291.5,-334 285.5,-340 279.5,-340 279.5,-340 167.5,-340 167.5,-340 161.5,-340 155.5,-334 155.5,-328 155.5,-328 155.5,-291 155.5,-291 155.5,-285 161.5,-279 167.5,-279"/>
<text text-anchor="middle" x="223.5" y="-324.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="223.5" y="-309.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_gc_peer_msg</text>
<polyline fill="none" stroke="#1c2123" points="155.5,-302 291.5,-302 "/>
<text text-anchor="middle" x="223.5" y="-286.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理tombstone消息</text>
</g>
<!-- PeerFsmDelegate_on_raft_msg&#45;&gt;PeerFsmDelegate_handle_gc_peer_msg -->
<g id="edge4" class="edge">
<title>PeerFsmDelegate_on_raft_msg&#45;&gt;PeerFsmDelegate_handle_gc_peer_msg</title>
<path fill="none" stroke="#666666" d="M113.36,-331.99C123.67,-329.87 134.6,-327.61 145.4,-325.39"/>
<polygon fill="#666666" stroke="#666666" points="146.18,-328.8 155.27,-323.35 144.77,-321.94 146.18,-328.8"/>
</g>
<!-- PeerFsmDelegate_check_msg -->
<g id="node6" class="node">
<title>PeerFsmDelegate_check_msg</title>
<path fill="none" stroke="#1c2123" d="M170,-183.5C170,-183.5 277,-183.5 277,-183.5 283,-183.5 289,-189.5 289,-195.5 289,-195.5 289,-247.5 289,-247.5 289,-253.5 283,-259.5 277,-259.5 277,-259.5 170,-259.5 170,-259.5 164,-259.5 158,-253.5 158,-247.5 158,-247.5 158,-195.5 158,-195.5 158,-189.5 164,-183.5 170,-183.5"/>
<text text-anchor="middle" x="223.5" y="-244.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="223.5" y="-229.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> check_msg</text>
<polyline fill="none" stroke="#1c2123" points="158,-221.5 289,-221.5 "/>
<text text-anchor="start" x="166" y="-206.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">检查消息是否发送</text>
<text text-anchor="start" x="166" y="-191.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 给正确的peer了</text>
</g>
<!-- PeerFsmDelegate_on_raft_msg&#45;&gt;PeerFsmDelegate_check_msg -->
<g id="edge5" class="edge">
<title>PeerFsmDelegate_on_raft_msg&#45;&gt;PeerFsmDelegate_check_msg</title>
<path fill="none" stroke="#666666" d="M79.93,-324.29C98.15,-308.95 124.72,-287.18 149,-269.5 150.8,-268.19 152.64,-266.87 154.5,-265.55"/>
<polygon fill="#666666" stroke="#666666" points="156.59,-268.36 162.78,-259.76 152.58,-262.62 156.59,-268.36"/>
</g>
<!-- PeerFsmDelegate_on_extra_msg -->
<g id="node7" class="node">
<title>PeerFsmDelegate_on_extra_msg</title>
<path fill="none" stroke="#1c2123" d="M174.5,-103C174.5,-103 272.5,-103 272.5,-103 278.5,-103 284.5,-109 284.5,-115 284.5,-115 284.5,-152 284.5,-152 284.5,-158 278.5,-164 272.5,-164 272.5,-164 174.5,-164 174.5,-164 168.5,-164 162.5,-158 162.5,-152 162.5,-152 162.5,-115 162.5,-115 162.5,-109 168.5,-103 174.5,-103"/>
<text text-anchor="middle" x="223.5" y="-148.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="223.5" y="-133.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_extra_msg</text>
<polyline fill="none" stroke="#1c2123" points="162.5,-126 284.5,-126 "/>
<text text-anchor="middle" x="223.5" y="-110.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理ExtraMessage</text>
</g>
<!-- PeerFsmDelegate_on_raft_msg&#45;&gt;PeerFsmDelegate_on_extra_msg -->
<g id="edge6" class="edge">
<title>PeerFsmDelegate_on_raft_msg&#45;&gt;PeerFsmDelegate_on_extra_msg</title>
<path fill="none" stroke="#666666" d="M63.82,-324.32C75.78,-290.48 104.57,-219.49 149,-174.5 150.63,-172.85 152.33,-171.25 154.1,-169.7"/>
<polygon fill="#666666" stroke="#666666" points="156.61,-172.18 162.23,-163.2 152.23,-166.71 156.61,-172.18"/>
</g>
<!-- Peer_peer_heartbeats -->
<g id="node16" class="node">
<title>Peer_peer_heartbeats</title>
<path fill="#feed9b" stroke="#f7e495" d="M413,-573.5C413,-573.5 494,-573.5 494,-573.5 500,-573.5 506,-579.5 506,-585.5 506,-585.5 506,-599.5 506,-599.5 506,-605.5 500,-611.5 494,-611.5 494,-611.5 413,-611.5 413,-611.5 407,-611.5 401,-605.5 401,-599.5 401,-599.5 401,-585.5 401,-585.5 401,-579.5 407,-573.5 413,-573.5"/>
<text text-anchor="middle" x="453.5" y="-596.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Peer</text>
<text text-anchor="middle" x="453.5" y="-581.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> peer_heartbeats</text>
</g>
<!-- Peer_step&#45;&gt;Peer_peer_heartbeats -->
<g id="edge15" class="edge">
<title>Peer_step&#45;&gt;Peer_peer_heartbeats</title>
<path fill="none" stroke="#666666" d="M293.22,-568.05C324.32,-572.82 360.79,-578.42 390.97,-583.06"/>
<polygon fill="#666666" stroke="#666666" points="390.54,-586.53 400.95,-584.59 391.6,-579.61 390.54,-586.53"/>
</g>
<!-- RawNode_step -->
<g id="node17" class="node">
<title>RawNode_step</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M415.5,-493C415.5,-493 491.5,-493 491.5,-493 497.5,-493 503.5,-499 503.5,-505 503.5,-505 503.5,-542 503.5,-542 503.5,-548 497.5,-554 491.5,-554 491.5,-554 415.5,-554 415.5,-554 409.5,-554 403.5,-548 403.5,-542 403.5,-542 403.5,-505 403.5,-505 403.5,-499 409.5,-493 415.5,-493"/>
<text text-anchor="middle" x="453.5" y="-538.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RawNode</text>
<text text-anchor="middle" x="453.5" y="-523.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> step</text>
<polyline fill="none" stroke="#8a8898" points="403.5,-516 503.5,-516 "/>
<text text-anchor="start" x="411.5" y="-500.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">step raf状态机</text>
</g>
<!-- Peer_step&#45;&gt;RawNode_step -->
<g id="edge16" class="edge">
<title>Peer_step&#45;&gt;RawNode_step</title>
<path fill="none" stroke="#666666" d="M293.22,-547.25C325.14,-542.49 362.72,-536.89 393.36,-532.32"/>
<polygon fill="#666666" stroke="#666666" points="394.09,-535.75 403.47,-530.81 393.06,-528.82 394.09,-535.75"/>
</g>
<!-- Peer_maybe_destroy -->
<g id="node13" class="node">
<title>Peer_maybe_destroy</title>
<path fill="none" stroke="#1c2123" d="M404.5,-353.5C404.5,-353.5 502.5,-353.5 502.5,-353.5 508.5,-353.5 514.5,-359.5 514.5,-365.5 514.5,-365.5 514.5,-417.5 514.5,-417.5 514.5,-423.5 508.5,-429.5 502.5,-429.5 502.5,-429.5 404.5,-429.5 404.5,-429.5 398.5,-429.5 392.5,-423.5 392.5,-417.5 392.5,-417.5 392.5,-365.5 392.5,-365.5 392.5,-359.5 398.5,-353.5 404.5,-353.5"/>
<text text-anchor="middle" x="453.5" y="-414.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="middle" x="453.5" y="-399.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> maybe_destroy</text>
<polyline fill="none" stroke="#1c2123" points="392.5,-391.5 514.5,-391.5 "/>
<text text-anchor="start" x="400.5" y="-376.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将pending_remove</text>
<text text-anchor="middle" x="453.5" y="-361.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 设置为true</text>
</g>
<!-- PeerFsmDelegate_handle_gc_peer_msg&#45;&gt;Peer_maybe_destroy -->
<g id="edge12" class="edge">
<title>PeerFsmDelegate_handle_gc_peer_msg&#45;&gt;Peer_maybe_destroy</title>
<path fill="none" stroke="#666666" d="M291.67,-333.66C320.35,-343.97 353.81,-356.01 382.77,-366.42"/>
<polygon fill="#666666" stroke="#666666" points="381.81,-369.79 392.4,-369.89 384.17,-363.21 381.81,-369.79"/>
</g>
<!-- PeerFsmDelegate_handle_destroy_peer -->
<g id="node14" class="node">
<title>PeerFsmDelegate_handle_destroy_peer</title>
<path fill="none" stroke="#1c2123" d="M399,-288.5C399,-288.5 508,-288.5 508,-288.5 514,-288.5 520,-294.5 520,-300.5 520,-300.5 520,-314.5 520,-314.5 520,-320.5 514,-326.5 508,-326.5 508,-326.5 399,-326.5 399,-326.5 393,-326.5 387,-320.5 387,-314.5 387,-314.5 387,-300.5 387,-300.5 387,-294.5 393,-288.5 399,-288.5"/>
<text text-anchor="middle" x="453.5" y="-311.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="453.5" y="-296.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_destroy_peer</text>
</g>
<!-- PeerFsmDelegate_handle_gc_peer_msg&#45;&gt;PeerFsmDelegate_handle_destroy_peer -->
<g id="edge13" class="edge">
<title>PeerFsmDelegate_handle_gc_peer_msg&#45;&gt;PeerFsmDelegate_handle_destroy_peer</title>
<path fill="none" stroke="#666666" d="M291.67,-308.91C318.35,-308.68 349.16,-308.41 376.63,-308.17"/>
<polygon fill="#666666" stroke="#666666" points="377.01,-311.66 386.98,-308.07 376.95,-304.66 377.01,-311.66"/>
</g>
<!-- RawNode_Raft_ping -->
<g id="node8" class="node">
<title>RawNode_Raft_ping</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M430,-228.5C430,-228.5 477,-228.5 477,-228.5 483,-228.5 489,-234.5 489,-240.5 489,-240.5 489,-254.5 489,-254.5 489,-260.5 483,-266.5 477,-266.5 477,-266.5 430,-266.5 430,-266.5 424,-266.5 418,-260.5 418,-254.5 418,-254.5 418,-240.5 418,-240.5 418,-234.5 424,-228.5 430,-228.5"/>
<text text-anchor="middle" x="453.5" y="-251.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">RawNode</text>
<text text-anchor="middle" x="453.5" y="-236.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> Raft.ping</text>
</g>
<!-- PeerFsmDelegate_on_extra_msg&#45;&gt;RawNode_Raft_ping -->
<g id="edge7" class="edge">
<title>PeerFsmDelegate_on_extra_msg&#45;&gt;RawNode_Raft_ping</title>
<path fill="none" stroke="#666666" d="M284.4,-164.25C289.16,-167.49 293.76,-170.91 298,-174.5 317.55,-191.05 312.35,-205.81 334,-219.5 356.02,-233.43 384.31,-240.44 407.72,-243.96"/>
<polygon fill="#666666" stroke="#666666" points="407.38,-247.44 417.76,-245.3 408.31,-240.51 407.38,-247.44"/>
</g>
<!-- Peer_maybe_add_want_rollback_merge_peer -->
<g id="node9" class="node">
<title>Peer_maybe_add_want_rollback_merge_peer</title>
<path fill="none" stroke="#1c2123" d="M346,-171.5C346,-171.5 561,-171.5 561,-171.5 567,-171.5 573,-177.5 573,-183.5 573,-183.5 573,-197.5 573,-197.5 573,-203.5 567,-209.5 561,-209.5 561,-209.5 346,-209.5 346,-209.5 340,-209.5 334,-203.5 334,-197.5 334,-197.5 334,-183.5 334,-183.5 334,-177.5 340,-171.5 346,-171.5"/>
<text text-anchor="middle" x="453.5" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="middle" x="453.5" y="-179.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> maybe_add_want_rollback_merge_peer</text>
</g>
<!-- PeerFsmDelegate_on_extra_msg&#45;&gt;Peer_maybe_add_want_rollback_merge_peer -->
<g id="edge8" class="edge">
<title>PeerFsmDelegate_on_extra_msg&#45;&gt;Peer_maybe_add_want_rollback_merge_peer</title>
<path fill="none" stroke="#666666" d="M284.71,-149.02C300.72,-153.11 318.01,-157.5 334,-161.5 343.81,-163.95 354.08,-166.5 364.3,-169.02"/>
<polygon fill="#666666" stroke="#666666" points="363.52,-172.44 374.07,-171.43 365.2,-165.64 363.52,-172.44"/>
</g>
<!-- Peer_on_check_stale_peer_response -->
<g id="node10" class="node">
<title>Peer_on_check_stale_peer_response</title>
<path fill="none" stroke="#1c2123" d="M371.5,-114.5C371.5,-114.5 535.5,-114.5 535.5,-114.5 541.5,-114.5 547.5,-120.5 547.5,-126.5 547.5,-126.5 547.5,-140.5 547.5,-140.5 547.5,-146.5 541.5,-152.5 535.5,-152.5 535.5,-152.5 371.5,-152.5 371.5,-152.5 365.5,-152.5 359.5,-146.5 359.5,-140.5 359.5,-140.5 359.5,-126.5 359.5,-126.5 359.5,-120.5 365.5,-114.5 371.5,-114.5"/>
<text text-anchor="middle" x="453.5" y="-137.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="middle" x="453.5" y="-122.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_check_stale_peer_response</text>
</g>
<!-- PeerFsmDelegate_on_extra_msg&#45;&gt;Peer_on_check_stale_peer_response -->
<g id="edge9" class="edge">
<title>PeerFsmDelegate_on_extra_msg&#45;&gt;Peer_on_check_stale_peer_response</title>
<path fill="none" stroke="#666666" d="M284.7,-133.5C304.5,-133.5 327.1,-133.5 349.16,-133.5"/>
<polygon fill="#666666" stroke="#666666" points="349.25,-137 359.25,-133.5 349.25,-130 349.25,-137"/>
</g>
<!-- PeerFsmDelegate_on_hibernate_request -->
<g id="node11" class="node">
<title>PeerFsmDelegate_on_hibernate_request</title>
<path fill="none" stroke="#1c2123" d="M397,-57.5C397,-57.5 510,-57.5 510,-57.5 516,-57.5 522,-63.5 522,-69.5 522,-69.5 522,-83.5 522,-83.5 522,-89.5 516,-95.5 510,-95.5 510,-95.5 397,-95.5 397,-95.5 391,-95.5 385,-89.5 385,-83.5 385,-83.5 385,-69.5 385,-69.5 385,-63.5 391,-57.5 397,-57.5"/>
<text text-anchor="middle" x="453.5" y="-80.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="453.5" y="-65.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_hibernate_request</text>
</g>
<!-- PeerFsmDelegate_on_extra_msg&#45;&gt;PeerFsmDelegate_on_hibernate_request -->
<g id="edge10" class="edge">
<title>PeerFsmDelegate_on_extra_msg&#45;&gt;PeerFsmDelegate_on_hibernate_request</title>
<path fill="none" stroke="#666666" d="M284.67,-117.25C300.68,-113.02 317.98,-108.51 334,-104.5 347.2,-101.19 361.26,-97.78 374.9,-94.52"/>
<polygon fill="#666666" stroke="#666666" points="375.83,-97.9 384.75,-92.18 374.21,-91.09 375.83,-97.9"/>
</g>
<!-- PeerFsmDelegate_on_hibernate_response -->
<g id="node12" class="node">
<title>PeerFsmDelegate_on_hibernate_response</title>
<path fill="none" stroke="#1c2123" d="M393,-0.5C393,-0.5 514,-0.5 514,-0.5 520,-0.5 526,-6.5 526,-12.5 526,-12.5 526,-26.5 526,-26.5 526,-32.5 520,-38.5 514,-38.5 514,-38.5 393,-38.5 393,-38.5 387,-38.5 381,-32.5 381,-26.5 381,-26.5 381,-12.5 381,-12.5 381,-6.5 387,-0.5 393,-0.5"/>
<text text-anchor="middle" x="453.5" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="453.5" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> on_hibernate_response</text>
</g>
<!-- PeerFsmDelegate_on_extra_msg&#45;&gt;PeerFsmDelegate_on_hibernate_response -->
<g id="edge11" class="edge">
<title>PeerFsmDelegate_on_extra_msg&#45;&gt;PeerFsmDelegate_on_hibernate_response</title>
<path fill="none" stroke="#666666" d="M255.98,-102.68C276.61,-84.12 305.04,-61.45 334,-47.5 345.61,-41.91 358.41,-37.39 371.18,-33.75"/>
<polygon fill="#666666" stroke="#666666" points="372.16,-37.11 380.91,-31.14 370.34,-30.35 372.16,-37.11"/>
</g>
<!-- Peer_pending_remove -->
<g id="node15" class="node">
<title>Peer_pending_remove</title>
<path fill="#feed9b" stroke="#f7e495" d="M671,-379.5C671,-379.5 759,-379.5 759,-379.5 765,-379.5 771,-385.5 771,-391.5 771,-391.5 771,-405.5 771,-405.5 771,-411.5 765,-417.5 759,-417.5 759,-417.5 671,-417.5 671,-417.5 665,-417.5 659,-411.5 659,-405.5 659,-405.5 659,-391.5 659,-391.5 659,-385.5 665,-379.5 671,-379.5"/>
<text text-anchor="middle" x="715" y="-402.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Peer</text>
<text text-anchor="middle" x="715" y="-387.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> pending_remove</text>
</g>
<!-- Peer_maybe_destroy&#45;&gt;Peer_pending_remove -->
<g id="edge14" class="edge">
<title>Peer_maybe_destroy&#45;&gt;Peer_pending_remove</title>
<path fill="none" stroke="#666666" d="M514.69,-393.12C554.71,-394.2 607.28,-395.62 648.38,-396.73"/>
<polygon fill="#666666" stroke="#666666" points="648.48,-400.23 658.57,-397 648.67,-393.24 648.48,-400.23"/>
</g>
<!-- PeerFsmDelegate_destroy_peer -->
<g id="node18" class="node">
<title>PeerFsmDelegate_destroy_peer</title>
<path fill="none" stroke="#1c2123" d="M632,-254.5C632,-254.5 798,-254.5 798,-254.5 804,-254.5 810,-260.5 810,-266.5 810,-266.5 810,-348.5 810,-348.5 810,-354.5 804,-360.5 798,-360.5 798,-360.5 632,-360.5 632,-360.5 626,-360.5 620,-354.5 620,-348.5 620,-348.5 620,-266.5 620,-266.5 620,-260.5 626,-254.5 632,-254.5"/>
<text text-anchor="middle" x="715" y="-345.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerFsmDelegate</text>
<text text-anchor="middle" x="715" y="-330.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> destroy_peer</text>
<polyline fill="none" stroke="#1c2123" points="620,-322.5 810,-322.5 "/>
<text text-anchor="start" x="628" y="-307.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">向pd发送DestoryPeer消息</text>
<text text-anchor="start" x="628" y="-292.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 触发on_region_changed</text>
<text text-anchor="start" x="628" y="-277.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 关闭该region_id对应的router</text>
<text text-anchor="start" x="628" y="-262.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 停止peerFsm</text>
</g>
<!-- PeerFsmDelegate_handle_destroy_peer&#45;&gt;PeerFsmDelegate_destroy_peer -->
<g id="edge17" class="edge">
<title>PeerFsmDelegate_handle_destroy_peer&#45;&gt;PeerFsmDelegate_destroy_peer</title>
<path fill="none" stroke="#666666" d="M520.32,-307.5C547.43,-307.5 579.52,-307.5 609.69,-307.5"/>
<polygon fill="#666666" stroke="#666666" points="609.84,-311 619.84,-307.5 609.84,-304 609.84,-311"/>
</g>
<!-- ApplyRouter_schedule_task_ApplyTask_destroy -->
<g id="node19" class="node">
<title>ApplyRouter_schedule_task_ApplyTask_destroy</title>
<path fill="none" stroke="#1c2123" d="M621,-144C621,-144 809,-144 809,-144 815,-144 821,-150 821,-156 821,-156 821,-223 821,-223 821,-229 815,-235 809,-235 809,-235 621,-235 621,-235 615,-235 609,-229 609,-223 609,-223 609,-156 609,-156 609,-150 615,-144 621,-144"/>
<text text-anchor="middle" x="715" y="-219.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ApplyRouter</text>
<text text-anchor="middle" x="715" y="-204.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> schedule_task(ApplyTask::destroy)</text>
<polyline fill="none" stroke="#1c2123" points="609,-197 821,-197 "/>
<text text-anchor="start" x="617" y="-181.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果有apply fsm，</text>
<text text-anchor="start" x="617" y="-166.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 先发消息给AppyFsm</text>
<text text-anchor="start" x="617" y="-151.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> destory apply fsm</text>
</g>
<!-- PeerFsmDelegate_handle_destroy_peer&#45;&gt;ApplyRouter_schedule_task_ApplyTask_destroy -->
<g id="edge18" class="edge">
<title>PeerFsmDelegate_handle_destroy_peer&#45;&gt;ApplyRouter_schedule_task_ApplyTask_destroy</title>
<path fill="none" stroke="#666666" d="M520.14,-295.97C537.9,-291.36 556.71,-285.05 573,-276.5 591.7,-266.69 591.58,-257.43 609,-245.5 611.52,-243.78 614.1,-242.06 616.72,-240.37"/>
<polygon fill="#666666" stroke="#666666" points="618.62,-243.31 625.22,-235.02 614.89,-237.38 618.62,-243.31"/>
</g>
</g>
</svg>
