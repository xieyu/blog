<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: on_ready_commit_merge Pages: 1 -->
<svg width="991pt" height="782pt"
 viewBox="0.00 0.00 991.00 781.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 777.95)">
<title>on_ready_commit_merge</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-777.95 987,-777.95 987,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_StoreMeta</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M223,-561.95C223,-561.95 963,-561.95 963,-561.95 969,-561.95 975,-567.95 975,-573.95 975,-573.95 975,-753.95 975,-753.95 975,-759.95 969,-765.95 963,-765.95 963,-765.95 223,-765.95 223,-765.95 217,-765.95 211,-759.95 211,-753.95 211,-753.95 211,-573.95 211,-573.95 211,-567.95 217,-561.95 223,-561.95"/>
<text text-anchor="middle" x="593" y="-745.95" font-family="Times,serif" font-size="20.00">StoreMeta</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_PdTask</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M462,-15.95C462,-15.95 893.5,-15.95 893.5,-15.95 899.5,-15.95 905.5,-21.95 905.5,-27.95 905.5,-27.95 905.5,-195.95 905.5,-195.95 905.5,-201.95 899.5,-207.95 893.5,-207.95 893.5,-207.95 462,-207.95 462,-207.95 456,-207.95 450,-201.95 450,-195.95 450,-195.95 450,-27.95 450,-27.95 450,-21.95 456,-15.95 462,-15.95"/>
<text text-anchor="middle" x="677.75" y="-187.95" font-family="Times,serif" font-size="20.00">PdTask</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_PeerFsm</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M267.5,-30.95C267.5,-30.95 364.5,-30.95 364.5,-30.95 370.5,-30.95 376.5,-36.95 376.5,-42.95 376.5,-42.95 376.5,-126.95 376.5,-126.95 376.5,-132.95 370.5,-138.95 364.5,-138.95 364.5,-138.95 267.5,-138.95 267.5,-138.95 261.5,-138.95 255.5,-132.95 255.5,-126.95 255.5,-126.95 255.5,-42.95 255.5,-42.95 255.5,-36.95 261.5,-30.95 267.5,-30.95"/>
<text text-anchor="middle" x="316" y="-118.95" font-family="Times,serif" font-size="20.00">PeerFsm</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_PeerFsmDelegate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-215.95C20,-215.95 604.5,-215.95 604.5,-215.95 610.5,-215.95 616.5,-221.95 616.5,-227.95 616.5,-227.95 616.5,-541.95 616.5,-541.95 616.5,-547.95 610.5,-553.95 604.5,-553.95 604.5,-553.95 20,-553.95 20,-553.95 14,-553.95 8,-547.95 8,-541.95 8,-541.95 8,-227.95 8,-227.95 8,-221.95 14,-215.95 20,-215.95"/>
<text text-anchor="middle" x="312.25" y="-533.95" font-family="Times,serif" font-size="20.00">PeerFsmDelegate</text>
</g>
<!-- region_ranges -->
<g id="node1" class="node">
<title>region_ranges</title>
<path fill="#feed9b" stroke="#f7e495" d="M697,-616.45C697,-616.45 955,-616.45 955,-616.45 961,-616.45 967,-622.45 967,-628.45 967,-628.45 967,-673.45 967,-673.45 967,-679.45 961,-685.45 955,-685.45 955,-685.45 697,-685.45 697,-685.45 691,-685.45 685,-679.45 685,-673.45 685,-673.45 685,-628.45 685,-628.45 685,-622.45 691,-616.45 697,-616.45"/>
<text text-anchor="middle" x="826" y="-670.25" font-family="Times,serif" font-size="14.00" fill="#40575d">region_ranges</text>
<polyline fill="none" stroke="#f7e495" points="685,-662.45 967,-662.45 "/>
<text text-anchor="start" x="693" y="-647.25" font-family="Times,serif" font-size="14.00" fill="#40575d">pub region_ranges: BTreeMap&lt;Vec&lt;u8&gt;, u64&gt;,</text>
<polyline fill="none" stroke="#f7e495" points="685,-639.45 967,-639.45 "/>
<text text-anchor="start" x="693" y="-624.25" font-family="Times,serif" font-size="14.00" fill="#40575d">region_end_key &#45;&gt; region_id</text>
</g>
<!-- meta_region_ranges_remove -->
<g id="node2" class="node">
<title>meta_region_ranges_remove</title>
<path fill="none" stroke="#1c2123" d="M506,-666.45C506,-666.45 601,-666.45 601,-666.45 607,-666.45 613,-672.45 613,-678.45 613,-678.45 613,-715.45 613,-715.45 613,-721.45 607,-727.45 601,-727.45 601,-727.45 506,-727.45 506,-727.45 500,-727.45 494,-721.45 494,-715.45 494,-715.45 494,-678.45 494,-678.45 494,-672.45 500,-666.45 506,-666.45"/>
<text text-anchor="middle" x="553.5" y="-712.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">remove</text>
<polyline fill="none" stroke="#1c2123" points="494,-704.45 613,-704.45 "/>
<text text-anchor="start" x="502" y="-689.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">删除source region</text>
<text text-anchor="start" x="502" y="-674.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 对应的ranges</text>
</g>
<!-- meta_region_ranges_remove&#45;&gt;region_ranges -->
<g id="edge1" class="edge">
<title>meta_region_ranges_remove&#45;&gt;region_ranges</title>
<path fill="none" stroke="#666666" d="M613.19,-686.96C631.65,-683.82 652.95,-680.2 674.78,-676.49"/>
<polygon fill="#666666" stroke="#666666" points="675.56,-679.91 684.83,-674.78 674.39,-673.01 675.56,-679.91"/>
</g>
<!-- insert -->
<g id="node3" class="node">
<title>insert</title>
<path fill="none" stroke="#1c2123" d="M473,-570.95C473,-570.95 634,-570.95 634,-570.95 640,-570.95 646,-576.95 646,-582.95 646,-582.95 646,-634.95 646,-634.95 646,-640.95 640,-646.95 634,-646.95 634,-646.95 473,-646.95 473,-646.95 467,-646.95 461,-640.95 461,-634.95 461,-634.95 461,-582.95 461,-582.95 461,-576.95 467,-570.95 473,-570.95"/>
<text text-anchor="middle" x="553.5" y="-631.75" font-family="Times,serif" font-size="14.00" fill="#2f3638">insert</text>
<polyline fill="none" stroke="#1c2123" points="461,-623.95 646,-623.95 "/>
<text text-anchor="start" x="469" y="-608.75" font-family="Times,serif" font-size="14.00" fill="#2f3638">插入target region 的ranges</text>
<text text-anchor="start" x="469" y="-593.75" font-family="Times,serif" font-size="14.00" fill="#2f3638"> insert(enc_end_key(&amp;region),</text>
<text text-anchor="start" x="469" y="-578.75" font-family="Times,serif" font-size="14.00" fill="#2f3638"> region.get_id());</text>
</g>
<!-- insert&#45;&gt;region_ranges -->
<g id="edge2" class="edge">
<title>insert&#45;&gt;region_ranges</title>
<path fill="none" stroke="#666666" d="M646.08,-623.16C655.41,-624.61 665.05,-626.11 674.79,-627.62"/>
<polygon fill="#666666" stroke="#666666" points="674.55,-631.13 684.97,-629.2 675.63,-624.21 674.55,-631.13"/>
</g>
<!-- store_meta_lock -->
<g id="node4" class="node">
<title>store_meta_lock</title>
<path fill="none" stroke="#1c2123" d="M231,-570.95C231,-570.95 401,-570.95 401,-570.95 407,-570.95 413,-576.95 413,-582.95 413,-582.95 413,-634.95 413,-634.95 413,-640.95 407,-646.95 401,-646.95 401,-646.95 231,-646.95 231,-646.95 225,-646.95 219,-640.95 219,-634.95 219,-634.95 219,-582.95 219,-582.95 219,-576.95 225,-570.95 231,-570.95"/>
<text text-anchor="middle" x="316" y="-631.75" font-family="Times,serif" font-size="14.00" fill="#2f3638">store_meta_lock</text>
<polyline fill="none" stroke="#1c2123" points="219,-623.95 413,-623.95 "/>
<text text-anchor="start" x="227" y="-608.75" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.ctx.store_meta.lock()</text>
<text text-anchor="start" x="227" y="-593.75" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 获取store_meta的Lock</text>
<text text-anchor="middle" x="316" y="-578.75" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 下面会对该store_meta做更改</text>
</g>
<!-- store_meta_lock&#45;&gt;meta_region_ranges_remove -->
<g id="edge3" class="edge">
<title>store_meta_lock&#45;&gt;meta_region_ranges_remove</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M413.13,-644.87C436.95,-653.77 461.99,-663.12 484.17,-671.41"/>
<polygon fill="green" stroke="green" points="483.23,-674.8 493.82,-675.02 485.68,-668.24 483.23,-674.8"/>
</g>
<!-- store_meta_lock&#45;&gt;insert -->
<g id="edge4" class="edge">
<title>store_meta_lock&#45;&gt;insert</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M413.13,-608.95C425.45,-608.95 438.1,-608.95 450.51,-608.95"/>
<polygon fill="green" stroke="green" points="450.86,-612.45 460.86,-608.95 450.86,-605.45 450.86,-612.45"/>
</g>
<!-- drop_meta -->
<g id="node11" class="node">
<title>drop_meta</title>
<path fill="none" stroke="#1c2123" d="M510.5,-431.95C510.5,-431.95 596.5,-431.95 596.5,-431.95 602.5,-431.95 608.5,-437.95 608.5,-443.95 608.5,-443.95 608.5,-465.95 608.5,-465.95 608.5,-471.95 602.5,-477.95 596.5,-477.95 596.5,-477.95 510.5,-477.95 510.5,-477.95 504.5,-477.95 498.5,-471.95 498.5,-465.95 498.5,-465.95 498.5,-443.95 498.5,-443.95 498.5,-437.95 504.5,-431.95 510.5,-431.95"/>
<text text-anchor="middle" x="553.5" y="-462.75" font-family="Times,serif" font-size="14.00" fill="#2f3638">drop_meta</text>
<polyline fill="none" stroke="#1c2123" points="498.5,-454.95 608.5,-454.95 "/>
<text text-anchor="middle" x="553.5" y="-439.75" font-family="Times,serif" font-size="14.00" fill="#2f3638">释放meta的lock</text>
</g>
<!-- store_meta_lock&#45;&gt;drop_meta -->
<g id="edge17" class="edge">
<title>store_meta_lock&#45;&gt;drop_meta</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M399.61,-570.94C407.3,-566.77 414.88,-562.41 422,-557.95 456.86,-536.08 493.37,-506.62 518.88,-484.81"/>
<polygon fill="green" stroke="green" points="521.47,-487.2 526.75,-478.02 516.9,-481.9 521.47,-487.2"/>
</g>
<!-- PdTask_UpdateMaxTimestamp -->
<g id="node5" class="node">
<title>PdTask_UpdateMaxTimestamp</title>
<path fill="none" stroke="#1c2123" d="M637,-169.95C637,-169.95 470,-169.95 470,-169.95 464,-169.95 458,-163.95 458,-157.95 458,-157.95 458,-145.95 458,-145.95 458,-139.95 464,-133.95 470,-133.95 470,-133.95 637,-133.95 637,-133.95 643,-133.95 649,-139.95 649,-145.95 649,-145.95 649,-157.95 649,-157.95 649,-163.95 643,-169.95 637,-169.95"/>
<text text-anchor="middle" x="553.5" y="-148.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">PdTask_UpdateMaxTimestamp</text>
</g>
<!-- pd_scheduler_schedule -->
<g id="node7" class="node">
<title>pd_scheduler_schedule</title>
<path fill="none" stroke="#1c2123" d="M885.5,-128.95C885.5,-128.95 766.5,-128.95 766.5,-128.95 760.5,-128.95 754.5,-122.95 754.5,-116.95 754.5,-116.95 754.5,-104.95 754.5,-104.95 754.5,-98.95 760.5,-92.95 766.5,-92.95 766.5,-92.95 885.5,-92.95 885.5,-92.95 891.5,-92.95 897.5,-98.95 897.5,-104.95 897.5,-104.95 897.5,-116.95 897.5,-116.95 897.5,-122.95 891.5,-128.95 885.5,-128.95"/>
<text text-anchor="middle" x="826" y="-107.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">pd_scheduler_schedule</text>
</g>
<!-- PdTask_UpdateMaxTimestamp&#45;&gt;pd_scheduler_schedule -->
<g id="edge5" class="edge">
<title>PdTask_UpdateMaxTimestamp&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M649.11,-137.61C680.18,-132.9 714.41,-127.71 744.34,-123.17"/>
<polygon fill="#666666" stroke="#666666" points="744.96,-126.62 754.32,-121.66 743.91,-119.7 744.96,-126.62"/>
</g>
<!-- PdTask_HeartBeat -->
<g id="node6" class="node">
<title>PdTask_HeartBeat</title>
<path fill="#feed9b" stroke="#f7e495" d="M494.5,-24.45C494.5,-24.45 612.5,-24.45 612.5,-24.45 618.5,-24.45 624.5,-30.45 624.5,-36.45 624.5,-36.45 624.5,-103.45 624.5,-103.45 624.5,-109.45 618.5,-115.45 612.5,-115.45 612.5,-115.45 494.5,-115.45 494.5,-115.45 488.5,-115.45 482.5,-109.45 482.5,-103.45 482.5,-103.45 482.5,-36.45 482.5,-36.45 482.5,-30.45 488.5,-24.45 494.5,-24.45"/>
<text text-anchor="middle" x="553.5" y="-100.25" font-family="Times,serif" font-size="14.00" fill="#40575d">PdTask::HeartBeat</text>
<polyline fill="none" stroke="#f7e495" points="482.5,-92.45 624.5,-92.45 "/>
<text text-anchor="start" x="490.5" y="-77.25" font-family="Times,serif" font-size="14.00" fill="#40575d">向pd发送region信息</text>
<text text-anchor="start" x="490.5" y="-62.25" font-family="Times,serif" font-size="14.00" fill="#40575d"> 包含term, region, </text>
<text text-anchor="start" x="490.5" y="-47.25" font-family="Times,serif" font-size="14.00" fill="#40575d"> peer, down_peers,</text>
<text text-anchor="start" x="490.5" y="-32.25" font-family="Times,serif" font-size="14.00" fill="#40575d"> pending_peers等信息</text>
</g>
<!-- PdTask_HeartBeat&#45;&gt;pd_scheduler_schedule -->
<g id="edge6" class="edge">
<title>PdTask_HeartBeat&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M624.51,-80.56C661.16,-86.11 706.2,-92.94 744.3,-98.71"/>
<polygon fill="#666666" stroke="#666666" points="743.93,-102.2 754.34,-100.24 744.98,-95.28 743.93,-102.2"/>
</g>
<!-- heartbeat_pd -->
<g id="node8" class="node">
<title>heartbeat_pd</title>
<path fill="none" stroke="#1c2123" d="M275.5,-39.45C275.5,-39.45 356.5,-39.45 356.5,-39.45 362.5,-39.45 368.5,-45.45 368.5,-51.45 368.5,-51.45 368.5,-88.45 368.5,-88.45 368.5,-94.45 362.5,-100.45 356.5,-100.45 356.5,-100.45 275.5,-100.45 275.5,-100.45 269.5,-100.45 263.5,-94.45 263.5,-88.45 263.5,-88.45 263.5,-51.45 263.5,-51.45 263.5,-45.45 269.5,-39.45 275.5,-39.45"/>
<text text-anchor="middle" x="316" y="-85.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">heartbeat_pd</text>
<polyline fill="none" stroke="#1c2123" points="263.5,-77.45 368.5,-77.45 "/>
<text text-anchor="start" x="271.5" y="-62.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果是leader</text>
<text text-anchor="start" x="271.5" y="-47.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 向pd发送心跳</text>
</g>
<!-- heartbeat_pd&#45;&gt;PdTask_HeartBeat -->
<g id="edge7" class="edge">
<title>heartbeat_pd&#45;&gt;PdTask_HeartBeat</title>
<path fill="none" stroke="#666666" d="M368.68,-69.95C398.87,-69.95 437.62,-69.95 471.75,-69.95"/>
<polygon fill="#666666" stroke="#666666" points="472.18,-73.45 482.18,-69.95 472.18,-66.45 472.18,-73.45"/>
</g>
<!-- heartbeat_pd&#45;&gt;pd_scheduler_schedule -->
<g id="edge8" class="edge">
<title>heartbeat_pd&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M368.58,-43.07C392.63,-32.01 422.06,-20.49 450,-14.95 536.75,2.28 563.3,6.91 649,-14.95 703.33,-28.8 758.98,-63.24 792.78,-86.86"/>
<polygon fill="#666666" stroke="#666666" points="791.11,-89.98 801.29,-92.91 795.17,-84.27 791.11,-89.98"/>
</g>
<!-- on_ready_commit_merge -->
<g id="node9" class="node">
<title>on_ready_commit_merge</title>
<path fill="none" stroke="#1c2123" d="M162,-465.95C162,-465.95 28,-465.95 28,-465.95 22,-465.95 16,-459.95 16,-453.95 16,-453.95 16,-441.95 16,-441.95 16,-435.95 22,-429.95 28,-429.95 28,-429.95 162,-429.95 162,-429.95 168,-429.95 174,-435.95 174,-441.95 174,-441.95 174,-453.95 174,-453.95 174,-459.95 168,-465.95 162,-465.95"/>
<text text-anchor="middle" x="95" y="-444.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_ready_commit_merge</text>
</g>
<!-- on_ready_commit_merge&#45;&gt;meta_region_ranges_remove -->
<g id="edge9" class="edge">
<title>on_ready_commit_merge&#45;&gt;meta_region_ranges_remove</title>
<path fill="none" stroke="#666666" d="M98.51,-466.14C105.92,-511.95 132.24,-632 210,-682.95 291.77,-736.52 409.63,-727.1 483.59,-713.48"/>
<polygon fill="#666666" stroke="#666666" points="484.57,-716.85 493.73,-711.53 483.25,-709.98 484.57,-716.85"/>
</g>
<!-- on_ready_commit_merge&#45;&gt;insert -->
<g id="edge10" class="edge">
<title>on_ready_commit_merge&#45;&gt;insert</title>
<path fill="none" stroke="#666666" d="M99.49,-466.23C108.73,-508.84 138.21,-614.33 210,-656.95 287.08,-702.7 390.75,-678.77 463.77,-650.86"/>
<polygon fill="#666666" stroke="#666666" points="465.38,-653.99 473.42,-647.08 462.83,-647.47 465.38,-653.99"/>
</g>
<!-- on_ready_commit_merge&#45;&gt;store_meta_lock -->
<g id="edge11" class="edge">
<title>on_ready_commit_merge&#45;&gt;store_meta_lock</title>
<path fill="none" stroke="#666666" d="M111.52,-466.14C132.2,-489.57 170.77,-530.54 210,-557.95 213.75,-560.56 217.65,-563.11 221.64,-565.59"/>
<polygon fill="#666666" stroke="#666666" points="220.15,-568.78 230.53,-570.89 223.74,-562.76 220.15,-568.78"/>
</g>
<!-- on_ready_commit_merge&#45;&gt;heartbeat_pd -->
<g id="edge12" class="edge">
<title>on_ready_commit_merge&#45;&gt;heartbeat_pd</title>
<path fill="none" stroke="#666666" d="M103.35,-429.89C120.05,-389.57 163.07,-289.65 210,-211.95 232.15,-175.28 261.39,-136.34 283.39,-108.53"/>
<polygon fill="#666666" stroke="#666666" points="286.19,-110.64 289.68,-100.63 280.72,-106.28 286.19,-110.64"/>
</g>
<!-- register_split_region_check_tick -->
<g id="node10" class="node">
<title>register_split_region_check_tick</title>
<path fill="none" stroke="#1c2123" d="M401,-259.95C401,-259.95 231,-259.95 231,-259.95 225,-259.95 219,-253.95 219,-247.95 219,-247.95 219,-235.95 219,-235.95 219,-229.95 225,-223.95 231,-223.95 231,-223.95 401,-223.95 401,-223.95 407,-223.95 413,-229.95 413,-235.95 413,-235.95 413,-247.95 413,-247.95 413,-253.95 407,-259.95 401,-259.95"/>
<text text-anchor="middle" x="316" y="-238.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">register_split_region_check_tick</text>
</g>
<!-- on_ready_commit_merge&#45;&gt;register_split_region_check_tick -->
<g id="edge13" class="edge">
<title>on_ready_commit_merge&#45;&gt;register_split_region_check_tick</title>
<path fill="none" stroke="#666666" d="M102.32,-429.77C115.96,-393.33 151.7,-311.25 210,-268.95 211.89,-267.58 213.84,-266.28 215.84,-265.04"/>
<polygon fill="#666666" stroke="#666666" points="217.86,-267.93 224.93,-260.04 214.48,-261.79 217.86,-267.93"/>
</g>
<!-- on_ready_commit_merge&#45;&gt;drop_meta -->
<g id="edge14" class="edge">
<title>on_ready_commit_merge&#45;&gt;drop_meta</title>
<path fill="none" stroke="#666666" d="M174.3,-433.93C186.23,-432.28 198.41,-430.85 210,-429.95 303.93,-422.57 328.2,-421.04 422,-429.95 443.71,-432.01 467.18,-435.95 488.15,-440.11"/>
<polygon fill="#666666" stroke="#666666" points="487.73,-443.6 498.23,-442.17 489.13,-436.74 487.73,-443.6"/>
</g>
<!-- require_updating_max_ts -->
<g id="node12" class="node">
<title>require_updating_max_ts</title>
<path fill="none" stroke="#1c2123" d="M234,-278.45C234,-278.45 398,-278.45 398,-278.45 404,-278.45 410,-284.45 410,-290.45 410,-290.45 410,-387.45 410,-387.45 410,-393.45 404,-399.45 398,-399.45 398,-399.45 234,-399.45 234,-399.45 228,-399.45 222,-393.45 222,-387.45 222,-387.45 222,-290.45 222,-290.45 222,-284.45 228,-278.45 234,-278.45"/>
<text text-anchor="middle" x="316" y="-384.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">require_updating_max_ts</text>
<polyline fill="none" stroke="#1c2123" points="222,-376.45 410,-376.45 "/>
<text text-anchor="start" x="230" y="-361.25" font-family="Times,serif" font-size="14.00" fill="#2f3638">If a follower merges into</text>
<text text-anchor="start" x="230" y="-346.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> a leader, a more recent</text>
<text text-anchor="start" x="230" y="-331.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> read may happen on the leader</text>
<text text-anchor="start" x="230" y="-316.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> of the follower. So max ts</text>
<text text-anchor="start" x="230" y="-301.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> should be updated after</text>
<text text-anchor="start" x="230" y="-286.25" font-family="Times,serif" font-size="14.00" fill="#2f3638"> a region merge.</text>
</g>
<!-- on_ready_commit_merge&#45;&gt;require_updating_max_ts -->
<g id="edge15" class="edge">
<title>on_ready_commit_merge&#45;&gt;require_updating_max_ts</title>
<path fill="none" stroke="#666666" d="M132.66,-429.7C154.74,-418.71 184.06,-404.12 212.72,-389.85"/>
<polygon fill="#666666" stroke="#666666" points="214.6,-392.83 221.99,-385.24 211.48,-386.56 214.6,-392.83"/>
</g>
<!-- SignificantMsg_MergeResult -->
<g id="node13" class="node">
<title>SignificantMsg_MergeResult</title>
<path fill="#feed9b" stroke="#f7e495" d="M222,-438.95C222,-438.95 410,-438.95 410,-438.95 416,-438.95 422,-444.95 422,-450.95 422,-450.95 422,-502.95 422,-502.95 422,-508.95 416,-514.95 410,-514.95 410,-514.95 222,-514.95 222,-514.95 216,-514.95 210,-508.95 210,-502.95 210,-502.95 210,-450.95 210,-450.95 210,-444.95 216,-438.95 222,-438.95"/>
<text text-anchor="middle" x="316" y="-499.75" font-family="Times,serif" font-size="14.00" fill="#40575d">SignificantMsg::MergeResult</text>
<polyline fill="none" stroke="#f7e495" points="210,-491.95 422,-491.95 "/>
<text text-anchor="start" x="218" y="-476.75" font-family="Times,serif" font-size="14.00" fill="#40575d">向source region PeerFsm</text>
<text text-anchor="start" x="218" y="-461.75" font-family="Times,serif" font-size="14.00" fill="#40575d"> 发送MergeResult消息</text>
<text text-anchor="start" x="218" y="-446.75" font-family="Times,serif" font-size="14.00" fill="#40575d"> MergeResultKind::FromTargetLog</text>
</g>
<!-- on_ready_commit_merge&#45;&gt;SignificantMsg_MergeResult -->
<g id="edge16" class="edge">
<title>on_ready_commit_merge&#45;&gt;SignificantMsg_MergeResult</title>
<path fill="none" stroke="#666666" d="M174.14,-458.29C182.44,-459.39 191,-460.52 199.61,-461.66"/>
<polygon fill="#666666" stroke="#666666" points="199.35,-465.16 209.73,-463 200.27,-458.22 199.35,-465.16"/>
</g>
<!-- require_updating_max_ts&#45;&gt;PdTask_UpdateMaxTimestamp -->
<g id="edge18" class="edge">
<title>require_updating_max_ts&#45;&gt;PdTask_UpdateMaxTimestamp</title>
<path fill="none" stroke="#666666" d="M410.37,-280.88C414.48,-277.05 418.39,-273.06 422,-268.95 440.6,-247.72 430.78,-232.62 450,-211.95 464.05,-196.83 482.77,-184.37 500.37,-174.79"/>
<polygon fill="#666666" stroke="#666666" points="502.2,-177.78 509.44,-170.05 498.96,-171.58 502.2,-177.78"/>
</g>
<!-- require_updating_max_ts&#45;&gt;pd_scheduler_schedule -->
<g id="edge19" class="edge">
<title>require_updating_max_ts&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M410.18,-297.13C517.74,-248.85 690.67,-171.23 775.22,-133.29"/>
<polygon fill="#666666" stroke="#666666" points="776.9,-136.37 784.59,-129.08 774.04,-129.98 776.9,-136.37"/>
</g>
</g>
</svg>
