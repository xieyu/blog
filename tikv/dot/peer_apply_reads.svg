<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: Peer__apply_reads Pages: 1 -->
<svg width="1338pt" height="663pt"
 viewBox="0.00 0.00 1338.00 662.92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 658.92)">
<title>Peer__apply_reads</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-658.92 1334,-658.92 1334,4 -4,4"/>
<!-- Peer__apply_reads -->
<g id="node1" class="node">
<title>Peer__apply_reads</title>
<path fill="none" stroke="#1c2123" d="M65,-284.92C65,-284.92 127,-284.92 127,-284.92 133,-284.92 139,-290.92 139,-296.92 139,-296.92 139,-310.92 139,-310.92 139,-316.92 133,-322.92 127,-322.92 127,-322.92 65,-322.92 65,-322.92 59,-322.92 53,-316.92 53,-310.92 53,-310.92 53,-296.92 53,-296.92 53,-290.92 59,-284.92 65,-284.92"/>
<text text-anchor="start" x="61" y="-307.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="61" y="-292.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> apply_reads</text>
</g>
<!-- ReadIndexQueue__advance_leader_reads -->
<g id="node2" class="node">
<title>ReadIndexQueue__advance_leader_reads</title>
<path fill="none" stroke="#1c2123" d="M493,-467.92C493,-467.92 621,-467.92 621,-467.92 627,-467.92 633,-473.92 633,-479.92 633,-479.92 633,-561.92 633,-561.92 633,-567.92 627,-573.92 621,-573.92 621,-573.92 493,-573.92 493,-573.92 487,-573.92 481,-567.92 481,-561.92 481,-561.92 481,-479.92 481,-479.92 481,-473.92 487,-467.92 493,-467.92"/>
<text text-anchor="start" x="489" y="-558.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexQueue</text>
<text text-anchor="start" x="489" y="-543.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> advance_leader_reads</text>
<polyline fill="none" stroke="#1c2123" points="481,-535.92 633,-535.92 "/>
<text text-anchor="start" x="489" y="-520.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历read states</text>
<text text-anchor="start" x="489" y="-505.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 对于每个read state</text>
<text text-anchor="start" x="489" y="-490.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 设置reads的read_index</text>
<text text-anchor="start" x="489" y="-475.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 增加ready_cnt</text>
</g>
<!-- Peer__apply_reads&#45;&gt;ReadIndexQueue__advance_leader_reads -->
<g id="edge1" class="edge">
<title>Peer__apply_reads&#45;&gt;ReadIndexQueue__advance_leader_reads</title>
<path fill="none" stroke="#666666" d="M102.5,-323.14C115.84,-365.79 154.39,-467.88 228,-509.92 301.8,-552.07 400.95,-548.84 470.86,-538.79"/>
<polygon fill="#666666" stroke="#666666" points="471.59,-542.22 480.96,-537.27 470.55,-535.3 471.59,-542.22"/>
</g>
<!-- ReadIndexQueue__clear_uncomitted_on_role_change -->
<g id="node3" class="node">
<title>ReadIndexQueue__clear_uncomitted_on_role_change</title>
<path fill="none" stroke="#1c2123" d="M240,-576.92C240,-576.92 424,-576.92 424,-576.92 430,-576.92 436,-582.92 436,-588.92 436,-588.92 436,-640.92 436,-640.92 436,-646.92 430,-652.92 424,-652.92 424,-652.92 240,-652.92 240,-652.92 234,-652.92 228,-646.92 228,-640.92 228,-640.92 228,-588.92 228,-588.92 228,-582.92 234,-576.92 240,-576.92"/>
<text text-anchor="start" x="236" y="-637.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexQueue</text>
<text text-anchor="start" x="236" y="-622.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> clear_uncomitted_on_role_change</text>
<polyline fill="none" stroke="#1c2123" points="228,-614.92 436,-614.92 "/>
<text text-anchor="start" x="236" y="-599.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果ready.ss.is_some()</text>
<text text-anchor="start" x="236" y="-584.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 通知回调stale_req;</text>
</g>
<!-- Peer__apply_reads&#45;&gt;ReadIndexQueue__clear_uncomitted_on_role_change -->
<g id="edge2" class="edge">
<title>Peer__apply_reads&#45;&gt;ReadIndexQueue__clear_uncomitted_on_role_change</title>
<path fill="none" stroke="#666666" d="M103.94,-323.22C120.24,-366.58 164.44,-473.39 228,-543.92 236.69,-553.56 246.94,-562.57 257.54,-570.72"/>
<polygon fill="#666666" stroke="#666666" points="255.58,-573.62 265.7,-576.78 259.75,-568 255.58,-573.62"/>
</g>
<!-- Peer__maybe_renew_leader_lease -->
<g id="node4" class="node">
<title>Peer__maybe_renew_leader_lease</title>
<path fill="none" stroke="#1c2123" d="M484,-307.42C484,-307.42 630,-307.42 630,-307.42 636,-307.42 642,-313.42 642,-319.42 642,-319.42 642,-356.42 642,-356.42 642,-362.42 636,-368.42 630,-368.42 630,-368.42 484,-368.42 484,-368.42 478,-368.42 472,-362.42 472,-356.42 472,-356.42 472,-319.42 472,-319.42 472,-313.42 478,-307.42 484,-307.42"/>
<text text-anchor="start" x="480" y="-353.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="480" y="-338.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> maybe_renew_leader_lease</text>
<polyline fill="none" stroke="#1c2123" points="472,-330.42 642,-330.42 "/>
<text text-anchor="start" x="480" y="-315.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">更新leader lease</text>
</g>
<!-- Peer__apply_reads&#45;&gt;Peer__maybe_renew_leader_lease -->
<g id="edge3" class="edge">
<title>Peer__apply_reads&#45;&gt;Peer__maybe_renew_leader_lease</title>
<path fill="none" stroke="#666666" d="M139.21,-296C203.8,-285.27 330.73,-269.65 436,-289.92 451.69,-292.94 467.94,-298 483.22,-303.72"/>
<polygon fill="#666666" stroke="#666666" points="482.01,-307 492.6,-307.36 484.54,-300.48 482.01,-307"/>
</g>
<!-- Peer__pending_reads__last_ready -->
<g id="node5" class="node">
<title>Peer__pending_reads__last_ready</title>
<path fill="none" stroke="#1c2123" d="M277.5,-394.92C277.5,-394.92 386.5,-394.92 386.5,-394.92 392.5,-394.92 398.5,-400.92 398.5,-406.92 398.5,-406.92 398.5,-488.92 398.5,-488.92 398.5,-494.92 392.5,-500.92 386.5,-500.92 386.5,-500.92 277.5,-500.92 277.5,-500.92 271.5,-500.92 265.5,-494.92 265.5,-488.92 265.5,-488.92 265.5,-406.92 265.5,-406.92 265.5,-400.92 271.5,-394.92 277.5,-394.92"/>
<text text-anchor="start" x="273.5" y="-485.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="273.5" y="-470.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> pending_reads</text>
<text text-anchor="start" x="273.5" y="-455.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> last_ready</text>
<polyline fill="none" stroke="#1c2123" points="265.5,-447.92 398.5,-447.92 "/>
<text text-anchor="start" x="273.5" y="-432.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用last ready</text>
<text text-anchor="start" x="273.5" y="-417.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 的renew_lease_time</text>
<text text-anchor="start" x="273.5" y="-402.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 更新leader lease</text>
</g>
<!-- Peer__apply_reads&#45;&gt;Peer__pending_reads__last_ready -->
<g id="edge4" class="edge">
<title>Peer__apply_reads&#45;&gt;Peer__pending_reads__last_ready</title>
<path fill="none" stroke="#666666" d="M127.68,-322.95C154.21,-339.39 193.61,-363.77 228,-384.92 237.23,-390.59 246.93,-396.54 256.53,-402.43"/>
<polygon fill="#666666" stroke="#666666" points="254.95,-405.57 265.31,-407.8 258.61,-399.6 254.95,-405.57"/>
</g>
<!-- Lease__inspect -->
<g id="node6" class="node">
<title>Lease__inspect</title>
<path fill="none" stroke="#1c2123" d="M254.5,-299.92C254.5,-299.92 409.5,-299.92 409.5,-299.92 415.5,-299.92 421.5,-305.92 421.5,-311.92 421.5,-311.92 421.5,-363.92 421.5,-363.92 421.5,-369.92 415.5,-375.92 409.5,-375.92 409.5,-375.92 254.5,-375.92 254.5,-375.92 248.5,-375.92 242.5,-369.92 242.5,-363.92 242.5,-363.92 242.5,-311.92 242.5,-311.92 242.5,-305.92 248.5,-299.92 254.5,-299.92"/>
<text text-anchor="start" x="250.5" y="-360.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">Lease</text>
<text text-anchor="start" x="250.5" y="-345.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> inspect</text>
<polyline fill="none" stroke="#1c2123" points="242.5,-337.92 421.5,-337.92 "/>
<text text-anchor="start" x="250.5" y="-322.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果inspect为Lease::Suspect</text>
<text text-anchor="start" x="250.5" y="-307.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 则不用renew leader lease</text>
</g>
<!-- Peer__apply_reads&#45;&gt;Lease__inspect -->
<g id="edge5" class="edge">
<title>Peer__apply_reads&#45;&gt;Lease__inspect</title>
<path fill="none" stroke="#666666" d="M139.1,-310.04C165.1,-313.81 199.61,-318.83 232.18,-323.56"/>
<polygon fill="#666666" stroke="#666666" points="231.82,-327.04 242.22,-325.02 232.83,-320.12 231.82,-327.04"/>
</g>
<!-- Peer__ready_to_handle_read -->
<g id="node7" class="node">
<title>Peer__ready_to_handle_read</title>
<path fill="none" stroke="#1c2123" d="M260,-21.92C260,-21.92 404,-21.92 404,-21.92 410,-21.92 416,-27.92 416,-33.92 416,-33.92 416,-115.92 416,-115.92 416,-121.92 410,-127.92 404,-127.92 404,-127.92 260,-127.92 260,-127.92 254,-127.92 248,-121.92 248,-115.92 248,-115.92 248,-33.92 248,-33.92 248,-27.92 254,-21.92 260,-21.92"/>
<text text-anchor="start" x="256" y="-112.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="256" y="-97.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ready_to_handle_read</text>
<polyline fill="none" stroke="#1c2123" points="248,-89.92 416,-89.92 "/>
<text text-anchor="start" x="256" y="-74.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果没有在spitting</text>
<text text-anchor="start" x="256" y="-59.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 或者merging</text>
<text text-anchor="start" x="256" y="-44.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 并且leader当前的term 的</text>
<text text-anchor="start" x="256" y="-29.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> log entry 已经被applied</text>
</g>
<!-- Peer__apply_reads&#45;&gt;Peer__ready_to_handle_read -->
<g id="edge6" class="edge">
<title>Peer__apply_reads&#45;&gt;Peer__ready_to_handle_read</title>
<path fill="none" stroke="#666666" d="M116.55,-284.79C149.74,-252.31 218.44,-185.08 269.18,-135.42"/>
<polygon fill="#666666" stroke="#666666" points="271.83,-137.72 276.53,-128.23 266.93,-132.72 271.83,-137.72"/>
</g>
<!-- Peer__response_read -->
<g id="node8" class="node">
<title>Peer__response_read</title>
<path fill="none" stroke="#1c2123" d="M712,-70.42C712,-70.42 786,-70.42 786,-70.42 792,-70.42 798,-76.42 798,-82.42 798,-82.42 798,-119.42 798,-119.42 798,-125.42 792,-131.42 786,-131.42 786,-131.42 712,-131.42 712,-131.42 706,-131.42 700,-125.42 700,-119.42 700,-119.42 700,-82.42 700,-82.42 700,-76.42 706,-70.42 712,-70.42"/>
<text text-anchor="start" x="708" y="-116.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="708" y="-101.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> response_read</text>
<polyline fill="none" stroke="#1c2123" points="700,-93.42 798,-93.42 "/>
<text text-anchor="middle" x="749" y="-78.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用cb</text>
</g>
<!-- Peer__apply_reads&#45;&gt;Peer__response_read -->
<g id="edge7" class="edge">
<title>Peer__apply_reads&#45;&gt;Peer__response_read</title>
<path fill="none" stroke="#666666" d="M136.85,-284.88C162.52,-273.05 196.81,-258.03 228,-246.92 392.66,-188.29 593.23,-137.63 690.11,-114.42"/>
<polygon fill="#666666" stroke="#666666" points="691.08,-117.79 700,-112.06 689.46,-110.98 691.08,-117.79"/>
</g>
<!-- ReadIndexQueue__pop_front -->
<g id="node9" class="node">
<title>ReadIndexQueue__pop_front</title>
<path fill="none" stroke="#1c2123" d="M508,-192.42C508,-192.42 606,-192.42 606,-192.42 612,-192.42 618,-198.42 618,-204.42 618,-204.42 618,-271.42 618,-271.42 618,-277.42 612,-283.42 606,-283.42 606,-283.42 508,-283.42 508,-283.42 502,-283.42 496,-277.42 496,-271.42 496,-271.42 496,-204.42 496,-204.42 496,-198.42 502,-192.42 508,-192.42"/>
<text text-anchor="start" x="504" y="-268.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexQueue</text>
<text text-anchor="start" x="504" y="-253.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> pop_front</text>
<polyline fill="none" stroke="#1c2123" points="496,-245.42 618,-245.42 "/>
<text text-anchor="start" x="504" y="-230.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">pop出ready的</text>
<text text-anchor="start" x="504" y="-215.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ReadIndexRequest</text>
<text text-anchor="start" x="504" y="-200.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用read callback</text>
</g>
<!-- Peer__apply_reads&#45;&gt;ReadIndexQueue__pop_front -->
<g id="edge8" class="edge">
<title>Peer__apply_reads&#45;&gt;ReadIndexQueue__pop_front</title>
<path fill="none" stroke="#666666" d="M139.01,-294.31C164.63,-288.69 198.09,-281.77 228,-276.92 316.57,-262.55 419.4,-251.18 485.98,-244.51"/>
<polygon fill="#666666" stroke="#666666" points="486.33,-247.99 495.93,-243.52 485.64,-241.02 486.33,-247.99"/>
</g>
<!-- ReadIndexQueue__reads -->
<g id="node10" class="node">
<title>ReadIndexQueue__reads</title>
<path fill="#feed9b" stroke="#f7e495" d="M868,-408.42C868,-408.42 1062,-408.42 1062,-408.42 1068,-408.42 1074,-414.42 1074,-420.42 1074,-420.42 1074,-457.42 1074,-457.42 1074,-463.42 1068,-469.42 1062,-469.42 1062,-469.42 868,-469.42 868,-469.42 862,-469.42 856,-463.42 856,-457.42 856,-457.42 856,-420.42 856,-420.42 856,-414.42 862,-408.42 868,-408.42"/>
<text text-anchor="start" x="864" y="-454.22" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadIndexQueue</text>
<text text-anchor="start" x="864" y="-439.22" font-family="Times,serif" font-size="14.00" fill="#40575d"> reads</text>
<polyline fill="none" stroke="#f7e495" points="856,-431.42 1074,-431.42 "/>
<text text-anchor="start" x="864" y="-416.22" font-family="Times,serif" font-size="14.00" fill="#40575d">VecDeque&lt;ReadIndexRequest&lt;S&gt;&gt;,</text>
</g>
<!-- ReadIndexQueue__advance_leader_reads&#45;&gt;ReadIndexQueue__reads -->
<g id="edge18" class="edge">
<title>ReadIndexQueue__advance_leader_reads&#45;&gt;ReadIndexQueue__reads</title>
<path fill="none" stroke="#666666" d="M633.41,-505.69C692.97,-493.66 777.18,-476.65 845.7,-462.81"/>
<polygon fill="#666666" stroke="#666666" points="846.58,-466.21 855.69,-460.79 845.19,-459.34 846.58,-466.21"/>
</g>
<!-- ReadIndexQueue__ready_cnt -->
<g id="node12" class="node">
<title>ReadIndexQueue__ready_cnt</title>
<path fill="#feed9b" stroke="#f7e495" d="M700,-341.92C700,-341.92 798,-341.92 798,-341.92 804,-341.92 810,-347.92 810,-353.92 810,-353.92 810,-397.92 810,-397.92 810,-403.92 804,-409.92 798,-409.92 798,-409.92 700,-409.92 700,-409.92 694,-409.92 688,-403.92 688,-397.92 688,-397.92 688,-353.92 688,-353.92 688,-347.92 694,-341.92 700,-341.92"/>
<text text-anchor="start" x="696" y="-394.72" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadIndexQueue</text>
<text text-anchor="start" x="696" y="-379.72" font-family="Times,serif" font-size="14.00" fill="#40575d"> ready_cnt</text>
<text text-anchor="start" x="696" y="-364.72" font-family="Times,serif" font-size="14.00" fill="#40575d"> 当前队列中ready</text>
<text text-anchor="start" x="696" y="-349.72" font-family="Times,serif" font-size="14.00" fill="#40575d"> 的个数</text>
</g>
<!-- ReadIndexQueue__advance_leader_reads&#45;&gt;ReadIndexQueue__ready_cnt -->
<g id="edge19" class="edge">
<title>ReadIndexQueue__advance_leader_reads&#45;&gt;ReadIndexQueue__ready_cnt</title>
<path fill="none" stroke="#666666" d="M627.67,-467.75C650.02,-450.7 674.38,-432.1 695.3,-416.13"/>
<polygon fill="#666666" stroke="#666666" points="697.61,-418.77 703.44,-409.92 693.37,-413.21 697.61,-418.77"/>
</g>
<!-- notify_stale_req -->
<g id="node19" class="node">
<title>notify_stale_req</title>
<path fill="none" stroke="#1c2123" d="M498.5,-593.42C498.5,-593.42 615.5,-593.42 615.5,-593.42 621.5,-593.42 627.5,-599.42 627.5,-605.42 627.5,-605.42 627.5,-642.42 627.5,-642.42 627.5,-648.42 621.5,-654.42 615.5,-654.42 615.5,-654.42 498.5,-654.42 498.5,-654.42 492.5,-654.42 486.5,-648.42 486.5,-642.42 486.5,-642.42 486.5,-605.42 486.5,-605.42 486.5,-599.42 492.5,-593.42 498.5,-593.42"/>
<text text-anchor="middle" x="557" y="-639.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">notify_stale_req</text>
<polyline fill="none" stroke="#1c2123" points="486.5,-631.42 627.5,-631.42 "/>
<text text-anchor="start" x="494.5" y="-616.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用回调</text>
<text text-anchor="start" x="494.5" y="-601.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Error::StaleCommand</text>
</g>
<!-- ReadIndexQueue__clear_uncomitted_on_role_change&#45;&gt;notify_stale_req -->
<g id="edge26" class="edge">
<title>ReadIndexQueue__clear_uncomitted_on_role_change&#45;&gt;notify_stale_req</title>
<path fill="none" stroke="#666666" d="M436.01,-619.08C449.43,-619.62 463.01,-620.17 475.98,-620.69"/>
<polygon fill="#666666" stroke="#666666" points="476.09,-624.2 486.23,-621.1 476.38,-617.2 476.09,-624.2"/>
</g>
<!-- Peer__pending_reads__last_ready&#45;&gt;Peer__maybe_renew_leader_lease -->
<g id="edge9" class="edge">
<title>Peer__pending_reads__last_ready&#45;&gt;Peer__maybe_renew_leader_lease</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M398.7,-415.51C425.71,-402.19 457.06,-386.72 484.63,-373.12"/>
<polygon fill="green" stroke="green" points="486.41,-376.15 493.83,-368.59 483.31,-369.87 486.41,-376.15"/>
</g>
<!-- Peer__pending_reads__last_ready&#45;&gt;ReadIndexQueue__reads -->
<g id="edge10" class="edge">
<title>Peer__pending_reads__last_ready&#45;&gt;ReadIndexQueue__reads</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M398.74,-446.98C504.42,-445.47 713.57,-442.49 845.69,-440.61"/>
<polygon fill="green" stroke="green" points="845.91,-444.1 855.86,-440.46 845.81,-437.1 845.91,-444.1"/>
</g>
<!-- Lease__inspect&#45;&gt;Peer__maybe_renew_leader_lease -->
<g id="edge28" class="edge">
<title>Lease__inspect&#45;&gt;Peer__maybe_renew_leader_lease</title>
<path fill="none" stroke="#666666" d="M421.78,-337.92C434.94,-337.92 448.54,-337.92 461.81,-337.92"/>
<polygon fill="#666666" stroke="#666666" points="461.88,-341.42 471.88,-337.92 461.88,-334.42 461.88,-341.42"/>
</g>
<!-- Peer__ready_to_handle_read&#45;&gt;Peer__response_read -->
<g id="edge12" class="edge">
<title>Peer__ready_to_handle_read&#45;&gt;Peer__response_read</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M416.48,-80.15C497.58,-85.23 618.61,-92.81 689.8,-97.27"/>
<polygon fill="green" stroke="green" points="689.74,-100.77 699.93,-97.91 690.17,-93.79 689.74,-100.77"/>
</g>
<!-- Peer__ready_to_handle_read&#45;&gt;ReadIndexQueue__pop_front -->
<g id="edge13" class="edge">
<title>Peer__ready_to_handle_read&#45;&gt;ReadIndexQueue__pop_front</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M414.97,-128.1C422.13,-133.03 429.23,-138.02 436,-142.92 454.57,-156.36 474.26,-171.54 492.19,-185.75"/>
<polygon fill="green" stroke="green" points="490.3,-188.71 500.3,-192.2 494.66,-183.23 490.3,-188.71"/>
</g>
<!-- Callback__invoke_read -->
<g id="node14" class="node">
<title>Callback__invoke_read</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M1125,-53.92C1125,-53.92 1188,-53.92 1188,-53.92 1194,-53.92 1200,-59.92 1200,-65.92 1200,-65.92 1200,-79.92 1200,-79.92 1200,-85.92 1194,-91.92 1188,-91.92 1188,-91.92 1125,-91.92 1125,-91.92 1119,-91.92 1113,-85.92 1113,-79.92 1113,-79.92 1113,-65.92 1113,-65.92 1113,-59.92 1119,-53.92 1125,-53.92"/>
<text text-anchor="start" x="1121" y="-76.72" font-family="Times,serif" font-size="14.00" fill="#5d6179">Callback</text>
<text text-anchor="start" x="1121" y="-61.72" font-family="Times,serif" font-size="14.00" fill="#5d6179"> invoke_read</text>
</g>
<!-- Peer__response_read&#45;&gt;Callback__invoke_read -->
<g id="edge20" class="edge">
<title>Peer__response_read&#45;&gt;Callback__invoke_read</title>
<path fill="none" stroke="#666666" d="M798.25,-96.02C816.35,-94.27 837.11,-92.38 856,-90.92 942.23,-84.26 1042.59,-78.67 1102.48,-75.56"/>
<polygon fill="#666666" stroke="#666666" points="1103.01,-79.04 1112.82,-75.03 1102.65,-72.05 1103.01,-79.04"/>
</g>
<!-- Peer__handle_read -->
<g id="node15" class="node">
<title>Peer__handle_read</title>
<path fill="none" stroke="#1c2123" d="M918,-100.42C918,-100.42 1012,-100.42 1012,-100.42 1018,-100.42 1024,-106.42 1024,-112.42 1024,-112.42 1024,-149.42 1024,-149.42 1024,-155.42 1018,-161.42 1012,-161.42 1012,-161.42 918,-161.42 918,-161.42 912,-161.42 906,-155.42 906,-149.42 906,-149.42 906,-112.42 906,-112.42 906,-106.42 912,-100.42 918,-100.42"/>
<text text-anchor="start" x="914" y="-146.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="914" y="-131.22" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_read</text>
<polyline fill="none" stroke="#1c2123" points="906,-123.42 1024,-123.42 "/>
<text text-anchor="start" x="914" y="-108.22" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理ready request</text>
</g>
<!-- Peer__response_read&#45;&gt;Peer__handle_read -->
<g id="edge21" class="edge">
<title>Peer__response_read&#45;&gt;Peer__handle_read</title>
<path fill="none" stroke="#666666" d="M798.03,-107.65C826.83,-111.69 863.92,-116.89 895.73,-121.35"/>
<polygon fill="#666666" stroke="#666666" points="895.46,-124.84 905.85,-122.77 896.43,-117.91 895.46,-124.84"/>
</g>
<!-- ReadIndexQueue__pop_front&#45;&gt;Peer__response_read -->
<g id="edge14" class="edge">
<title>ReadIndexQueue__pop_front&#45;&gt;Peer__response_read</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M618.15,-195.04C626.18,-189.29 634.29,-183.47 642,-177.92 660.16,-164.84 680.02,-150.44 697.59,-137.66"/>
<polygon fill="green" stroke="green" points="699.99,-140.25 706.01,-131.53 695.87,-134.59 699.99,-140.25"/>
</g>
<!-- ReadIndexQueue__reads_pop_front -->
<g id="node11" class="node">
<title>ReadIndexQueue__reads_pop_front</title>
<path fill="none" stroke="#1c2123" d="M698,-246.92C698,-246.92 800,-246.92 800,-246.92 806,-246.92 812,-252.92 812,-258.92 812,-258.92 812,-310.92 812,-310.92 812,-316.92 806,-322.92 800,-322.92 800,-322.92 698,-322.92 698,-322.92 692,-322.92 686,-316.92 686,-310.92 686,-310.92 686,-258.92 686,-258.92 686,-252.92 692,-246.92 698,-246.92"/>
<text text-anchor="start" x="694" y="-307.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexQueue</text>
<text text-anchor="start" x="694" y="-292.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> reads</text>
<text text-anchor="start" x="694" y="-277.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> pop_front</text>
<polyline fill="none" stroke="#1c2123" points="686,-269.92 812,-269.92 "/>
<text text-anchor="start" x="694" y="-254.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">从reads 数组中pop</text>
</g>
<!-- ReadIndexQueue__pop_front&#45;&gt;ReadIndexQueue__reads_pop_front -->
<g id="edge15" class="edge">
<title>ReadIndexQueue__pop_front&#45;&gt;ReadIndexQueue__reads_pop_front</title>
<path fill="none" stroke="#666666" d="M618.12,-252.79C636.54,-257.35 657,-262.41 676.12,-267.14"/>
<polygon fill="#666666" stroke="#666666" points="675.44,-270.57 685.98,-269.58 677.12,-263.78 675.44,-270.57"/>
</g>
<!-- ReadIndexQueue__pop_front&#45;&gt;ReadIndexQueue__ready_cnt -->
<g id="edge16" class="edge">
<title>ReadIndexQueue__pop_front&#45;&gt;ReadIndexQueue__ready_cnt</title>
<path fill="none" stroke="#666666" d="M618.41,-279.55C626.47,-285.54 634.53,-291.77 642,-297.92 658.99,-311.9 660.6,-318.44 678,-331.92 679.75,-333.28 681.55,-334.63 683.37,-335.97"/>
<polygon fill="#666666" stroke="#666666" points="681.38,-338.85 691.55,-341.81 685.44,-333.15 681.38,-338.85"/>
</g>
<!-- ReadIndexQueue__handled_cnt -->
<g id="node13" class="node">
<title>ReadIndexQueue__handled_cnt</title>
<path fill="#feed9b" stroke="#f7e495" d="M706,-166.42C706,-166.42 792,-166.42 792,-166.42 798,-166.42 804,-172.42 804,-178.42 804,-178.42 804,-215.42 804,-215.42 804,-221.42 798,-227.42 792,-227.42 792,-227.42 706,-227.42 706,-227.42 700,-227.42 694,-221.42 694,-215.42 694,-215.42 694,-178.42 694,-178.42 694,-172.42 700,-166.42 706,-166.42"/>
<text text-anchor="start" x="702" y="-212.22" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadIndexQueue</text>
<text text-anchor="start" x="702" y="-197.22" font-family="Times,serif" font-size="14.00" fill="#40575d"> handled_cnt</text>
<polyline fill="none" stroke="#f7e495" points="694,-189.42 804,-189.42 "/>
<text text-anchor="middle" x="749" y="-174.22" font-family="Times,serif" font-size="14.00" fill="#40575d">已处理的个数</text>
</g>
<!-- ReadIndexQueue__pop_front&#45;&gt;ReadIndexQueue__handled_cnt -->
<g id="edge17" class="edge">
<title>ReadIndexQueue__pop_front&#45;&gt;ReadIndexQueue__handled_cnt</title>
<path fill="none" stroke="#666666" d="M618.12,-224.95C639.05,-220.43 662.6,-215.35 683.84,-210.76"/>
<polygon fill="#666666" stroke="#666666" points="684.71,-214.16 693.74,-208.63 683.23,-207.31 684.71,-214.16"/>
</g>
<!-- ReadIndexQueue__reads_pop_front&#45;&gt;ReadIndexQueue__reads -->
<g id="edge11" class="edge">
<title>ReadIndexQueue__reads_pop_front&#45;&gt;ReadIndexQueue__reads</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M807.45,-323.17C811.72,-326.11 815.94,-329.05 820,-331.92 852.16,-354.64 887.67,-381.02 915.38,-401.89"/>
<polygon fill="green" stroke="green" points="913.63,-404.96 923.72,-408.19 917.85,-399.37 913.63,-404.96"/>
</g>
<!-- Peer__handle_read&#45;&gt;Callback__invoke_read -->
<g id="edge25" class="edge">
<title>Peer__handle_read&#45;&gt;Callback__invoke_read</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1024.14,-113.12C1049.29,-105.43 1078.51,-96.48 1102.99,-88.99"/>
<polygon fill="green" stroke="green" points="1104.28,-92.26 1112.82,-85.98 1102.23,-85.56 1104.28,-92.26"/>
</g>
<!-- ReadExecutor__execute -->
<g id="node16" class="node">
<title>ReadExecutor__execute</title>
<path fill="none" stroke="#1c2123" d="M1122,-111.92C1122,-111.92 1191,-111.92 1191,-111.92 1197,-111.92 1203,-117.92 1203,-123.92 1203,-123.92 1203,-137.92 1203,-137.92 1203,-143.92 1197,-149.92 1191,-149.92 1191,-149.92 1122,-149.92 1122,-149.92 1116,-149.92 1110,-143.92 1110,-137.92 1110,-137.92 1110,-123.92 1110,-123.92 1110,-117.92 1116,-111.92 1122,-111.92"/>
<text text-anchor="start" x="1118" y="-134.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadExecutor</text>
<text text-anchor="start" x="1118" y="-119.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> execute</text>
</g>
<!-- Peer__handle_read&#45;&gt;ReadExecutor__execute -->
<g id="edge22" class="edge">
<title>Peer__handle_read&#45;&gt;ReadExecutor__execute</title>
<path fill="none" stroke="#666666" d="M1024.14,-130.92C1048.12,-130.92 1075.8,-130.92 1099.54,-130.92"/>
<polygon fill="#666666" stroke="#666666" points="1099.8,-134.42 1109.8,-130.92 1099.8,-127.42 1099.8,-134.42"/>
</g>
<!-- PollContext__get_engine -->
<g id="node17" class="node">
<title>PollContext__get_engine</title>
<path fill="none" stroke="#1c2123" d="M1256,-139.92C1256,-139.92 1313,-139.92 1313,-139.92 1319,-139.92 1325,-145.92 1325,-151.92 1325,-151.92 1325,-165.92 1325,-165.92 1325,-171.92 1319,-177.92 1313,-177.92 1313,-177.92 1256,-177.92 1256,-177.92 1250,-177.92 1244,-171.92 1244,-165.92 1244,-165.92 1244,-151.92 1244,-151.92 1244,-145.92 1250,-139.92 1256,-139.92"/>
<text text-anchor="start" x="1252" y="-162.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">PollContext</text>
<text text-anchor="start" x="1252" y="-147.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> get_engine</text>
</g>
<!-- ReadExecutor__execute&#45;&gt;PollContext__get_engine -->
<g id="edge23" class="edge">
<title>ReadExecutor__execute&#45;&gt;PollContext__get_engine</title>
<path fill="none" stroke="#666666" d="M1203.35,-141.11C1213.27,-143.31 1223.8,-145.65 1233.86,-147.89"/>
<polygon fill="#666666" stroke="#666666" points="1233.2,-151.33 1243.72,-150.08 1234.72,-144.49 1233.2,-151.33"/>
</g>
<!-- PollContext__get_snapshot -->
<g id="node18" class="node">
<title>PollContext__get_snapshot</title>
<path fill="none" stroke="#1c2123" d="M1251,-82.92C1251,-82.92 1318,-82.92 1318,-82.92 1324,-82.92 1330,-88.92 1330,-94.92 1330,-94.92 1330,-108.92 1330,-108.92 1330,-114.92 1324,-120.92 1318,-120.92 1318,-120.92 1251,-120.92 1251,-120.92 1245,-120.92 1239,-114.92 1239,-108.92 1239,-108.92 1239,-94.92 1239,-94.92 1239,-88.92 1245,-82.92 1251,-82.92"/>
<text text-anchor="start" x="1247" y="-105.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">PollContext</text>
<text text-anchor="start" x="1247" y="-90.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> get_snapshot</text>
</g>
<!-- ReadExecutor__execute&#45;&gt;PollContext__get_snapshot -->
<g id="edge24" class="edge">
<title>ReadExecutor__execute&#45;&gt;PollContext__get_snapshot</title>
<path fill="none" stroke="#666666" d="M1203.35,-120.37C1211.64,-118.46 1220.36,-116.45 1228.88,-114.49"/>
<polygon fill="#666666" stroke="#666666" points="1229.78,-117.87 1238.74,-112.22 1228.21,-111.05 1229.78,-117.87"/>
</g>
<!-- Callback__invoke_with_response -->
<g id="node20" class="node">
<title>Callback__invoke_with_response</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M690,-604.92C690,-604.92 808,-604.92 808,-604.92 814,-604.92 820,-610.92 820,-616.92 820,-616.92 820,-630.92 820,-630.92 820,-636.92 814,-642.92 808,-642.92 808,-642.92 690,-642.92 690,-642.92 684,-642.92 678,-636.92 678,-630.92 678,-630.92 678,-616.92 678,-616.92 678,-610.92 684,-604.92 690,-604.92"/>
<text text-anchor="start" x="686" y="-627.72" font-family="Times,serif" font-size="14.00" fill="#5d6179">Callback</text>
<text text-anchor="start" x="686" y="-612.72" font-family="Times,serif" font-size="14.00" fill="#5d6179"> invoke_with_response</text>
</g>
<!-- notify_stale_req&#45;&gt;Callback__invoke_with_response -->
<g id="edge27" class="edge">
<title>notify_stale_req&#45;&gt;Callback__invoke_with_response</title>
<path fill="none" stroke="#666666" d="M627.67,-623.92C640.67,-623.92 654.35,-623.92 667.63,-623.92"/>
<polygon fill="#666666" stroke="#666666" points="667.7,-627.42 677.7,-623.92 667.7,-620.42 667.7,-627.42"/>
</g>
<!-- Peer__post_apply -->
<g id="node21" class="node">
<title>Peer__post_apply</title>
<path fill="none" stroke="#1c2123" d="M12,-36.92C12,-36.92 180,-36.92 180,-36.92 186,-36.92 192,-42.92 192,-48.92 192,-48.92 192,-100.92 192,-100.92 192,-106.92 186,-112.92 180,-112.92 180,-112.92 12,-112.92 12,-112.92 6,-112.92 0,-106.92 0,-100.92 0,-100.92 0,-48.92 0,-48.92 0,-42.92 6,-36.92 12,-36.92"/>
<text text-anchor="start" x="8" y="-97.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">Peer</text>
<text text-anchor="start" x="8" y="-82.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> post_apply</text>
<polyline fill="none" stroke="#1c2123" points="0,-74.92 192,-74.92 "/>
<text text-anchor="start" x="8" y="-59.72" font-family="Times,serif" font-size="14.00" fill="#2f3638">一批committed log entry</text>
<text text-anchor="start" x="8" y="-44.72" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 已经被applied到state machine</text>
</g>
<!-- Peer__post_apply&#45;&gt;Peer__ready_to_handle_read -->
<g id="edge29" class="edge">
<title>Peer__post_apply&#45;&gt;Peer__ready_to_handle_read</title>
<path fill="none" stroke="#666666" d="M192.18,-74.92C207.19,-74.92 222.69,-74.92 237.66,-74.92"/>
<polygon fill="#666666" stroke="#666666" points="237.92,-78.42 247.92,-74.92 237.92,-71.42 237.92,-78.42"/>
</g>
<!-- Peer__post_apply&#45;&gt;Peer__response_read -->
<g id="edge30" class="edge">
<title>Peer__post_apply&#45;&gt;Peer__response_read</title>
<path fill="none" stroke="#666666" d="M161.53,-36.83C182.08,-26.67 205.36,-17.08 228,-11.92 394.41,26.02 594.09,-38.44 690.42,-76.32"/>
<polygon fill="#666666" stroke="#666666" points="689.39,-79.67 699.98,-80.12 691.98,-73.17 689.39,-79.67"/>
</g>
<!-- Peer__post_apply&#45;&gt;ReadIndexQueue__pop_front -->
<g id="edge31" class="edge">
<title>Peer__post_apply&#45;&gt;ReadIndexQueue__pop_front</title>
<path fill="none" stroke="#666666" d="M172.74,-113.02C190.64,-121.39 209.82,-129.86 228,-136.92 315.17,-170.77 418.74,-201.07 485.83,-219.46"/>
<polygon fill="#666666" stroke="#666666" points="485.3,-222.94 495.87,-222.19 487.14,-216.19 485.3,-222.94"/>
</g>
</g>
</svg>
