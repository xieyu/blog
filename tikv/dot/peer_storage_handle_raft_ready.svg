<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: handle_raft_ready Pages: 1 -->
<svg width="1544pt" height="935pt"
 viewBox="0.00 0.00 1544.00 935.42" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 931.42)">
<title>handle_raft_ready</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-931.42 1540,-931.42 1540,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Ready</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-8C20,-8 160,-8 160,-8 166,-8 172,-14 172,-20 172,-20 172,-158 172,-158 172,-164 166,-170 160,-170 160,-170 20,-170 20,-170 14,-170 8,-164 8,-158 8,-158 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="90" y="-150" font-family="Times,serif" font-size="20.00">raft/Ready</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_PollContext</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1351,-757C1351,-757 1516,-757 1516,-757 1522,-757 1528,-763 1528,-769 1528,-769 1528,-885 1528,-885 1528,-891 1522,-897 1516,-897 1516,-897 1351,-897 1351,-897 1345,-897 1339,-891 1339,-885 1339,-885 1339,-769 1339,-769 1339,-763 1345,-757 1351,-757"/>
<text text-anchor="middle" x="1433.5" y="-877" font-family="Times,serif" font-size="20.00">PollContext</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_PeerStorage</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M36.5,-178C36.5,-178 1307,-178 1307,-178 1313,-178 1319,-184 1319,-190 1319,-190 1319,-792 1319,-792 1319,-798 1313,-804 1307,-804 1307,-804 36.5,-804 36.5,-804 30.5,-804 24.5,-798 24.5,-792 24.5,-792 24.5,-190 24.5,-190 24.5,-184 30.5,-178 36.5,-178"/>
<text text-anchor="middle" x="671.75" y="-784" font-family="Times,serif" font-size="20.00">PeerStorage</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_last_entry</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M456.5,-286C456.5,-286 561.5,-286 561.5,-286 567.5,-286 573.5,-292 573.5,-298 573.5,-298 573.5,-462 573.5,-462 573.5,-468 567.5,-474 561.5,-474 561.5,-474 456.5,-474 456.5,-474 450.5,-474 444.5,-468 444.5,-462 444.5,-462 444.5,-298 444.5,-298 444.5,-292 450.5,-286 456.5,-286"/>
<text text-anchor="middle" x="509" y="-454" font-family="Times,serif" font-size="20.00">last_entry</text>
</g>
<!-- HandleRaftReadyContext -->
<g id="node1" class="node">
<title>HandleRaftReadyContext</title>
<path fill="none" stroke="#1c2123" d="M1272.5,-853C1272.5,-853 1140.5,-853 1140.5,-853 1134.5,-853 1128.5,-847 1128.5,-841 1128.5,-841 1128.5,-829 1128.5,-829 1128.5,-823 1134.5,-817 1140.5,-817 1140.5,-817 1272.5,-817 1272.5,-817 1278.5,-817 1284.5,-823 1284.5,-829 1284.5,-829 1284.5,-841 1284.5,-841 1284.5,-847 1278.5,-853 1272.5,-853"/>
<text text-anchor="middle" x="1206.5" y="-831.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">HandleRaftReadyContext</text>
</g>
<!-- PollContext -->
<g id="node2" class="node">
<title>PollContext</title>
<path fill="none" stroke="#1c2123" d="M1359,-766C1359,-766 1508,-766 1508,-766 1514,-766 1520,-772 1520,-778 1520,-778 1520,-846 1520,-846 1520,-852 1514,-858 1508,-858 1508,-858 1359,-858 1359,-858 1353,-858 1347,-852 1347,-846 1347,-846 1347,-778 1347,-778 1347,-772 1353,-766 1359,-766"/>
<text text-anchor="middle" x="1433.5" y="-842.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PollContext</text>
<polyline fill="none" stroke="#1c2123" points="1347,-835 1520,-835 "/>
<text text-anchor="start" x="1355" y="-819.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub kv_wb: EK::WriteBatch</text>
<polyline fill="none" stroke="#1c2123" points="1347,-812 1520,-812 "/>
<text text-anchor="start" x="1355" y="-796.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub raft_wb: ER::LogBatch</text>
<polyline fill="none" stroke="#1c2123" points="1347,-789 1520,-789 "/>
<text text-anchor="middle" x="1433.5" y="-773.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">...</text>
</g>
<!-- HandleRaftReadyContext&#45;&gt;PollContext -->
<g id="edge1" class="edge">
<title>HandleRaftReadyContext&#45;&gt;PollContext</title>
<path fill="none" stroke="#666666" d="M1284.62,-827.12C1301.42,-825.4 1319.39,-823.56 1336.82,-821.78"/>
<polygon fill="#666666" stroke="#666666" points="1337.41,-825.24 1347,-820.74 1336.7,-818.28 1337.41,-825.24"/>
</g>
<!-- Ready -->
<g id="node3" class="node">
<title>Ready</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M28,-16.5C28,-16.5 152,-16.5 152,-16.5 158,-16.5 164,-22.5 164,-28.5 164,-28.5 164,-119.5 164,-119.5 164,-125.5 158,-131.5 152,-131.5 152,-131.5 28,-131.5 28,-131.5 22,-131.5 16,-125.5 16,-119.5 16,-119.5 16,-28.5 16,-28.5 16,-22.5 22,-16.5 28,-16.5"/>
<text text-anchor="middle" x="90" y="-116.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Ready</text>
<polyline fill="none" stroke="#60b5ac" points="16,-108.5 164,-108.5 "/>
<text text-anchor="start" x="24" y="-93.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ss: Option&lt;SoftState&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="16,-85.5 164,-85.5 "/>
<text text-anchor="start" x="24" y="-70.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">hs: Option&lt;HardState&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="16,-62.5 164,-62.5 "/>
<text text-anchor="start" x="24" y="-47.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">snapshot: Snapshot,</text>
<polyline fill="none" stroke="#60b5ac" points="16,-39.5 164,-39.5 "/>
<text text-anchor="start" x="24" y="-24.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">entries: Vec&lt;Entry&gt;,</text>
</g>
<!-- append -->
<g id="node6" class="node">
<title>append</title>
<path fill="none" stroke="#1c2123" d="M252,-334.5C252,-334.5 358,-334.5 358,-334.5 364,-334.5 370,-340.5 370,-346.5 370,-346.5 370,-383.5 370,-383.5 370,-389.5 364,-395.5 358,-395.5 358,-395.5 252,-395.5 252,-395.5 246,-395.5 240,-389.5 240,-383.5 240,-383.5 240,-346.5 240,-346.5 240,-340.5 246,-334.5 252,-334.5"/>
<text text-anchor="middle" x="305" y="-380.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">append</text>
<polyline fill="none" stroke="#1c2123" points="240,-372.5 370,-372.5 "/>
<text text-anchor="start" x="248" y="-357.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将Ready中的entries</text>
<text text-anchor="start" x="248" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入raft_wb中</text>
</g>
<!-- Ready&#45;&gt;append -->
<g id="edge11" class="edge">
<title>Ready&#45;&gt;append</title>
<path fill="none" stroke="#666666" d="M138.87,-131.58C149.95,-145.32 161.55,-160.05 172,-174 210.52,-225.44 252.26,-286.9 278.27,-325.94"/>
<polygon fill="#666666" stroke="#666666" points="275.44,-328 283.89,-334.39 281.27,-324.13 275.44,-328"/>
</g>
<!-- apply_snapshot -->
<g id="node7" class="node">
<title>apply_snapshot</title>
<path fill="none" stroke="#1c2123" d="M212,-620.5C212,-620.5 398,-620.5 398,-620.5 404,-620.5 410,-626.5 410,-632.5 410,-632.5 410,-669.5 410,-669.5 410,-675.5 404,-681.5 398,-681.5 398,-681.5 212,-681.5 212,-681.5 206,-681.5 200,-675.5 200,-669.5 200,-669.5 200,-632.5 200,-632.5 200,-626.5 206,-620.5 212,-620.5"/>
<text text-anchor="middle" x="305" y="-666.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_snapshot</text>
<polyline fill="none" stroke="#1c2123" points="200,-658.5 410,-658.5 "/>
<text text-anchor="start" x="208" y="-643.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果ready的snapshot不为空</text>
<text text-anchor="start" x="208" y="-628.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> apply the peer with given snapshot</text>
</g>
<!-- Ready&#45;&gt;apply_snapshot -->
<g id="edge10" class="edge">
<title>Ready:snapshot&#45;&gt;apply_snapshot</title>
<path fill="none" stroke="#666666" d="M164.19,-131.81C227.77,-236.24 168.48,-286.64 200,-405 220.14,-480.61 258.92,-563.43 283.01,-611.1"/>
<polygon fill="#666666" stroke="#666666" points="279.97,-612.83 287.62,-620.15 286.2,-609.66 279.97,-612.83"/>
</g>
<!-- save_snapshot_raft_state_to -->
<g id="node9" class="node">
<title>save_snapshot_raft_state_to</title>
<path fill="none" stroke="#1c2123" d="M1114,-481C1114,-481 1299,-481 1299,-481 1305,-481 1311,-487 1311,-493 1311,-493 1311,-545 1311,-545 1311,-551 1305,-557 1299,-557 1299,-557 1114,-557 1114,-557 1108,-557 1102,-551 1102,-545 1102,-545 1102,-493 1102,-493 1102,-487 1108,-481 1114,-481"/>
<text text-anchor="middle" x="1206.5" y="-541.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">save_snapshot_raft_state_to</text>
<polyline fill="none" stroke="#1c2123" points="1102,-534 1311,-534 "/>
<text text-anchor="start" x="1110" y="-518.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向kv_wb中写入snapshot raft state</text>
<text text-anchor="start" x="1110" y="-503.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 包含了RaftLocalState</text>
<text text-anchor="start" x="1110" y="-488.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 和snap shot index</text>
</g>
<!-- Ready&#45;&gt;save_snapshot_raft_state_to -->
<g id="edge28" class="edge">
<title>Ready:Snapshot&#45;&gt;save_snapshot_raft_state_to</title>
<path fill="none" stroke="#666666" d="M164.31,-80.56C247.83,-87.36 387.53,-97 508,-97 508,-97 508,-97 746.5,-97 966.03,-97 1125.79,-361.83 1182.71,-471.9"/>
<polygon fill="#666666" stroke="#666666" points="1179.6,-473.5 1187.27,-480.81 1185.83,-470.31 1179.6,-473.5"/>
</g>
<!-- RaftLocalState -->
<g id="node20" class="node">
<title>RaftLocalState</title>
<path fill="none" stroke="#1c2123" d="M955.5,-449.5C955.5,-449.5 1029.5,-449.5 1029.5,-449.5 1035.5,-449.5 1041.5,-455.5 1041.5,-461.5 1041.5,-461.5 1041.5,-506.5 1041.5,-506.5 1041.5,-512.5 1035.5,-518.5 1029.5,-518.5 1029.5,-518.5 955.5,-518.5 955.5,-518.5 949.5,-518.5 943.5,-512.5 943.5,-506.5 943.5,-506.5 943.5,-461.5 943.5,-461.5 943.5,-455.5 949.5,-449.5 955.5,-449.5"/>
<text text-anchor="middle" x="992.5" y="-503.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLocalState</text>
<polyline fill="none" stroke="#1c2123" points="943.5,-495.5 1041.5,-495.5 "/>
<text text-anchor="start" x="951.5" y="-480.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">HardState</text>
<polyline fill="none" stroke="#1c2123" points="943.5,-472.5 1041.5,-472.5 "/>
<text text-anchor="start" x="951.5" y="-457.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_index</text>
</g>
<!-- Ready&#45;&gt;RaftLocalState -->
<g id="edge24" class="edge">
<title>Ready:hs&#45;&gt;RaftLocalState</title>
<path fill="none" stroke="#666666" d="M164.1,-100.6C176.02,-104.39 188.29,-108.01 200,-111 506.01,-189.04 643.35,-101.32 883,-307 925.23,-343.25 955.99,-400.16 973.76,-439.63"/>
<polygon fill="#666666" stroke="#666666" points="970.76,-441.52 977.99,-449.26 977.17,-438.7 970.76,-441.52"/>
</g>
<!-- handle_raft_ready -->
<g id="node4" class="node">
<title>handle_raft_ready</title>
<path fill="none" stroke="#1c2123" d="M135.5,-696C135.5,-696 44.5,-696 44.5,-696 38.5,-696 32.5,-690 32.5,-684 32.5,-684 32.5,-672 32.5,-672 32.5,-666 38.5,-660 44.5,-660 44.5,-660 135.5,-660 135.5,-660 141.5,-660 147.5,-666 147.5,-672 147.5,-672 147.5,-684 147.5,-684 147.5,-690 141.5,-696 135.5,-696"/>
<text text-anchor="middle" x="90" y="-674.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_raft_ready</text>
</g>
<!-- InvokeContext -->
<g id="node5" class="node">
<title>InvokeContext</title>
<path fill="#feed9b" stroke="#f7e495" d="M620,-381C620,-381 871,-381 871,-381 877,-381 883,-387 883,-393 883,-393 883,-553 883,-553 883,-559 877,-565 871,-565 871,-565 620,-565 620,-565 614,-565 608,-559 608,-553 608,-553 608,-393 608,-393 608,-387 614,-381 620,-381"/>
<text text-anchor="middle" x="745.5" y="-549.8" font-family="Times,serif" font-size="14.00" fill="#40575d">InvokeContext</text>
<polyline fill="none" stroke="#f7e495" points="608,-542 883,-542 "/>
<text text-anchor="start" x="616" y="-526.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub region_id: u64,</text>
<polyline fill="none" stroke="#f7e495" points="608,-519 883,-519 "/>
<text text-anchor="start" x="616" y="-503.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub raft_state: RaftLocalState,</text>
<polyline fill="none" stroke="#f7e495" points="608,-496 883,-496 "/>
<text text-anchor="start" x="616" y="-480.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub apply_state: RaftApplyState,</text>
<polyline fill="none" stroke="#f7e495" points="608,-473 883,-473 "/>
<text text-anchor="start" x="616" y="-457.8" font-family="Times,serif" font-size="14.00" fill="#40575d">last_term: u64,</text>
<polyline fill="none" stroke="#f7e495" points="608,-450 883,-450 "/>
<text text-anchor="start" x="616" y="-434.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub has_new_entries: bool,</text>
<polyline fill="none" stroke="#f7e495" points="608,-427 883,-427 "/>
<text text-anchor="start" x="616" y="-411.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub snap_region: Option&lt;Region&gt;,</text>
<polyline fill="none" stroke="#f7e495" points="608,-404 883,-404 "/>
<text text-anchor="start" x="616" y="-388.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub destroyed_regions: Vec&lt;metapb::Region&gt;,</text>
</g>
<!-- handle_raft_ready&#45;&gt;InvokeContext -->
<g id="edge2" class="edge">
<title>handle_raft_ready&#45;&gt;InvokeContext</title>
<path fill="none" stroke="#666666" d="M113.23,-659.93C134.22,-644 167.27,-621.69 200,-611 279.15,-585.15 494.51,-607.33 573.5,-581 583.22,-577.76 592.94,-573.86 602.55,-569.48"/>
<polygon fill="#666666" stroke="#666666" points="604.17,-572.59 611.71,-565.15 601.17,-566.26 604.17,-572.59"/>
</g>
<!-- handle_raft_ready&#45;&gt;append -->
<g id="edge3" class="edge">
<title>handle_raft_ready&#45;&gt;append</title>
<path fill="none" stroke="#666666" d="M103.37,-659.82C137.09,-610.27 231.16,-472.03 277.51,-403.93"/>
<polygon fill="#666666" stroke="#666666" points="280.45,-405.82 283.19,-395.59 274.67,-401.88 280.45,-405.82"/>
</g>
<!-- handle_raft_ready&#45;&gt;apply_snapshot -->
<g id="edge4" class="edge">
<title>handle_raft_ready&#45;&gt;apply_snapshot</title>
<path fill="none" stroke="#666666" d="M147.52,-670.84C160.64,-669.17 175.07,-667.34 189.69,-665.49"/>
<polygon fill="#666666" stroke="#666666" points="190.35,-668.93 199.83,-664.2 189.47,-661.99 190.35,-668.93"/>
</g>
<!-- save_raft_state_to -->
<g id="node8" class="node">
<title>save_raft_state_to</title>
<path fill="none" stroke="#1c2123" d="M1120,-622C1120,-622 1293,-622 1293,-622 1299,-622 1305,-628 1305,-634 1305,-634 1305,-656 1305,-656 1305,-662 1299,-668 1293,-668 1293,-668 1120,-668 1120,-668 1114,-668 1108,-662 1108,-656 1108,-656 1108,-634 1108,-634 1108,-628 1114,-622 1120,-622"/>
<text text-anchor="middle" x="1206.5" y="-652.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">save_raft_state_to</text>
<polyline fill="none" stroke="#1c2123" points="1108,-645 1305,-645 "/>
<text text-anchor="start" x="1116" y="-629.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向raft_wb中写入RaftLocalState</text>
</g>
<!-- handle_raft_ready&#45;&gt;save_raft_state_to -->
<g id="edge5" class="edge">
<title>handle_raft_ready&#45;&gt;save_raft_state_to</title>
<path fill="none" stroke="#666666" d="M141.35,-696.04C159.58,-701.7 180.48,-707.19 200,-710 275.12,-720.8 816.09,-745.81 883,-710 908.43,-696.39 893.83,-670.1 919,-656 948.84,-639.28 1029.23,-637.35 1097.28,-639.14"/>
<polygon fill="#666666" stroke="#666666" points="1097.55,-642.65 1107.65,-639.44 1097.76,-635.65 1097.55,-642.65"/>
</g>
<!-- handle_raft_ready&#45;&gt;save_snapshot_raft_state_to -->
<g id="edge6" class="edge">
<title>handle_raft_ready&#45;&gt;save_snapshot_raft_state_to</title>
<path fill="none" stroke="#666666" d="M147.75,-685.95C164.54,-687.99 182.98,-689.9 200,-691 237.87,-693.44 850.05,-713.82 883,-695 910.34,-679.39 894.03,-653.17 919,-634 972.8,-592.69 1003.01,-618.15 1066,-593 1088.06,-584.19 1111.16,-572.87 1132.07,-561.75"/>
<polygon fill="#666666" stroke="#666666" points="1133.75,-564.83 1140.89,-557 1130.43,-558.66 1133.75,-564.83"/>
</g>
<!-- save_apply_state_to -->
<g id="node10" class="node">
<title>save_apply_state_to</title>
<path fill="none" stroke="#1c2123" d="M1043.5,-766C1043.5,-766 941.5,-766 941.5,-766 935.5,-766 929.5,-760 929.5,-754 929.5,-754 929.5,-742 929.5,-742 929.5,-736 935.5,-730 941.5,-730 941.5,-730 1043.5,-730 1043.5,-730 1049.5,-730 1055.5,-736 1055.5,-742 1055.5,-742 1055.5,-754 1055.5,-754 1055.5,-760 1049.5,-766 1043.5,-766"/>
<text text-anchor="middle" x="992.5" y="-744.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">save_apply_state_to</text>
</g>
<!-- handle_raft_ready&#45;&gt;save_apply_state_to -->
<g id="edge7" class="edge">
<title>handle_raft_ready&#45;&gt;save_apply_state_to</title>
<path fill="none" stroke="#666666" d="M120.27,-696.16C141.52,-708.28 171.45,-723.2 200,-730 458.6,-791.62 778.23,-770.41 919.07,-756.35"/>
<polygon fill="#666666" stroke="#666666" points="919.71,-759.8 929.3,-755.31 919,-752.84 919.71,-759.8"/>
</g>
<!-- InvokeContext&#45;&gt;RaftLocalState -->
<g id="edge25" class="edge">
<title>InvokeContext&#45;&gt;RaftLocalState</title>
<path fill="none" stroke="#666666" d="M883.33,-479.14C900.78,-479.93 917.84,-480.69 933.07,-481.38"/>
<polygon fill="#666666" stroke="#666666" points="933.15,-484.88 943.3,-481.84 933.46,-477.89 933.15,-484.88"/>
</g>
<!-- append&#45;&gt;PollContext -->
<g id="edge12" class="edge">
<title>append&#45;&gt;PollContext</title>
<path fill="none" stroke="#666666" d="M318.78,-395.6C350.8,-471.96 432.73,-665.5 444.5,-675 612.2,-810.38 705.58,-744.96 919,-775 997.04,-785.98 1211.24,-799.39 1336.97,-806.67"/>
<polygon fill="#666666" stroke="#666666" points="1336.8,-810.17 1346.98,-807.25 1337.2,-803.18 1336.8,-810.17"/>
</g>
<!-- cache_append -->
<g id="node11" class="node">
<title>cache_append</title>
<path fill="none" stroke="#1c2123" d="M543.5,-276C543.5,-276 474.5,-276 474.5,-276 468.5,-276 462.5,-270 462.5,-264 462.5,-264 462.5,-252 462.5,-252 462.5,-246 468.5,-240 474.5,-240 474.5,-240 543.5,-240 543.5,-240 549.5,-240 555.5,-246 555.5,-252 555.5,-252 555.5,-264 555.5,-264 555.5,-270 549.5,-276 543.5,-276"/>
<text text-anchor="middle" x="509" y="-254.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">cache_append</text>
</g>
<!-- append&#45;&gt;cache_append -->
<g id="edge13" class="edge">
<title>append&#45;&gt;cache_append</title>
<path fill="none" stroke="#666666" d="M352.28,-334.43C378.66,-317.73 412.71,-297.38 444.5,-282 447.27,-280.66 450.15,-279.34 453.06,-278.05"/>
<polygon fill="#666666" stroke="#666666" points="454.64,-281.19 462.48,-274.07 451.91,-274.74 454.64,-281.19"/>
</g>
<!-- set_last_index -->
<g id="node12" class="node">
<title>set_last_index</title>
<path fill="none" stroke="#1c2123" d="M544,-572C544,-572 474,-572 474,-572 468,-572 462,-566 462,-560 462,-560 462,-548 462,-548 462,-542 468,-536 474,-536 474,-536 544,-536 544,-536 550,-536 556,-542 556,-548 556,-548 556,-560 556,-560 556,-566 550,-572 544,-572"/>
<text text-anchor="middle" x="509" y="-550.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_last_index</text>
</g>
<!-- append&#45;&gt;set_last_index -->
<g id="edge14" class="edge">
<title>append&#45;&gt;set_last_index</title>
<path fill="none" stroke="#666666" d="M325.64,-395.6C349.87,-431.26 394.07,-490.02 444.5,-527 447.16,-528.95 449.98,-530.79 452.89,-532.52"/>
<polygon fill="#666666" stroke="#666666" points="451.4,-535.7 461.86,-537.41 454.75,-529.55 451.4,-535.7"/>
</g>
<!-- get_index -->
<g id="node13" class="node">
<title>get_index</title>
<path fill="none" stroke="#1c2123" d="M464.5,-294.5C464.5,-294.5 553.5,-294.5 553.5,-294.5 559.5,-294.5 565.5,-300.5 565.5,-306.5 565.5,-306.5 565.5,-343.5 565.5,-343.5 565.5,-349.5 559.5,-355.5 553.5,-355.5 553.5,-355.5 464.5,-355.5 464.5,-355.5 458.5,-355.5 452.5,-349.5 452.5,-343.5 452.5,-343.5 452.5,-306.5 452.5,-306.5 452.5,-300.5 458.5,-294.5 464.5,-294.5"/>
<text text-anchor="middle" x="509" y="-340.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_index</text>
<polyline fill="none" stroke="#1c2123" points="452.5,-332.5 565.5,-332.5 "/>
<text text-anchor="start" x="460.5" y="-317.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取最后一个</text>
<text text-anchor="start" x="460.5" y="-302.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> log entry的index</text>
</g>
<!-- append&#45;&gt;get_index -->
<g id="edge15" class="edge">
<title>append&#45;&gt;get_index</title>
<path fill="none" stroke="#666666" d="M370.19,-352.29C393.24,-347.73 419.24,-342.58 442.41,-337.99"/>
<polygon fill="#666666" stroke="#666666" points="443.35,-341.37 452.48,-335.99 441.99,-334.5 443.35,-341.37"/>
</g>
<!-- get_term -->
<g id="node14" class="node">
<title>get_term</title>
<path fill="none" stroke="#1c2123" d="M466.5,-374.5C466.5,-374.5 551.5,-374.5 551.5,-374.5 557.5,-374.5 563.5,-380.5 563.5,-386.5 563.5,-386.5 563.5,-423.5 563.5,-423.5 563.5,-429.5 557.5,-435.5 551.5,-435.5 551.5,-435.5 466.5,-435.5 466.5,-435.5 460.5,-435.5 454.5,-429.5 454.5,-423.5 454.5,-423.5 454.5,-386.5 454.5,-386.5 454.5,-380.5 460.5,-374.5 466.5,-374.5"/>
<text text-anchor="middle" x="509" y="-420.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_term</text>
<polyline fill="none" stroke="#1c2123" points="454.5,-412.5 563.5,-412.5 "/>
<text text-anchor="start" x="462.5" y="-397.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取最后一个</text>
<text text-anchor="start" x="462.5" y="-382.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> log entry的term</text>
</g>
<!-- append&#45;&gt;get_term -->
<g id="edge16" class="edge">
<title>append&#45;&gt;get_term</title>
<path fill="none" stroke="#666666" d="M370.19,-377.71C393.95,-382.42 420.85,-387.74 444.54,-392.43"/>
<polygon fill="#666666" stroke="#666666" points="443.99,-395.89 454.48,-394.4 445.35,-389.03 443.99,-395.89"/>
</g>
<!-- cut_logs -->
<g id="node15" class="node">
<title>cut_logs</title>
<path fill="none" stroke="#1c2123" d="M528,-222C528,-222 490,-222 490,-222 484,-222 478,-216 478,-210 478,-210 478,-198 478,-198 478,-192 484,-186 490,-186 490,-186 528,-186 528,-186 534,-186 540,-192 540,-198 540,-198 540,-210 540,-210 540,-216 534,-222 528,-222"/>
<text text-anchor="middle" x="509" y="-200.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">cut_logs</text>
</g>
<!-- append&#45;&gt;cut_logs -->
<g id="edge17" class="edge">
<title>append&#45;&gt;cut_logs</title>
<path fill="none" stroke="#666666" d="M331.73,-334.25C357.74,-304.69 400.3,-260.3 444.5,-231 451.82,-226.15 460.15,-221.86 468.32,-218.21"/>
<polygon fill="#666666" stroke="#666666" points="469.91,-221.34 477.77,-214.23 467.19,-214.89 469.91,-221.34"/>
</g>
<!-- apply_snapshot&#45;&gt;InvokeContext -->
<g id="edge29" class="edge">
<title>apply_snapshot&#45;&gt;InvokeContext</title>
<path fill="none" stroke="#666666" d="M410.31,-628.15C421.84,-625.7 433.41,-623.27 444.5,-621 501.71,-609.26 519.88,-619.14 573.5,-596 579.1,-593.58 593.42,-584.06 611.52,-571.3"/>
<polygon fill="#666666" stroke="#666666" points="613.95,-573.86 620.08,-565.22 609.9,-568.15 613.95,-573.86"/>
</g>
<!-- clear_meta -->
<g id="node21" class="node">
<title>clear_meta</title>
<path fill="none" stroke="#1c2123" d="M713,-639C713,-639 778,-639 778,-639 784,-639 790,-645 790,-651 790,-651 790,-673 790,-673 790,-679 784,-685 778,-685 778,-685 713,-685 713,-685 707,-685 701,-679 701,-673 701,-673 701,-651 701,-651 701,-645 707,-639 713,-639"/>
<text text-anchor="middle" x="745.5" y="-669.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">clear_meta</text>
<polyline fill="none" stroke="#1c2123" points="701,-662 790,-662 "/>
<text text-anchor="start" x="709" y="-646.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">清理old data</text>
</g>
<!-- apply_snapshot&#45;&gt;clear_meta -->
<g id="edge30" class="edge">
<title>apply_snapshot&#45;&gt;clear_meta</title>
<path fill="none" stroke="#666666" d="M410.11,-671.01C421.68,-672.65 433.32,-674.04 444.5,-675 530.55,-682.4 630.86,-674.78 690.94,-668.48"/>
<polygon fill="#666666" stroke="#666666" points="691.39,-671.95 700.95,-667.4 690.64,-664.99 691.39,-671.95"/>
</g>
<!-- is_initialized -->
<g id="node22" class="node">
<title>is_initialized</title>
<path fill="none" stroke="#1c2123" d="M540,-666C540,-666 478,-666 478,-666 472,-666 466,-660 466,-654 466,-654 466,-642 466,-642 466,-636 472,-630 478,-630 478,-630 540,-630 540,-630 546,-630 552,-636 552,-642 552,-642 552,-654 552,-654 552,-660 546,-666 540,-666"/>
<text text-anchor="middle" x="509" y="-644.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">is_initialized</text>
</g>
<!-- apply_snapshot&#45;&gt;is_initialized -->
<g id="edge31" class="edge">
<title>apply_snapshot&#45;&gt;is_initialized</title>
<path fill="none" stroke="#666666" d="M410.25,-649.45C425.94,-649.22 441.51,-648.99 455.47,-648.78"/>
<polygon fill="#666666" stroke="#666666" points="455.86,-652.27 465.81,-648.63 455.76,-645.28 455.86,-652.27"/>
</g>
<!-- write_peer_state -->
<g id="node23" class="node">
<title>write_peer_state</title>
<path fill="none" stroke="#1c2123" d="M931,-665C931,-665 1054,-665 1054,-665 1060,-665 1066,-671 1066,-677 1066,-677 1066,-699 1066,-699 1066,-705 1060,-711 1054,-711 1054,-711 931,-711 931,-711 925,-711 919,-705 919,-699 919,-699 919,-677 919,-677 919,-671 925,-665 931,-665"/>
<text text-anchor="middle" x="992.5" y="-695.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">write_peer_state</text>
<polyline fill="none" stroke="#1c2123" points="919,-688 1066,-688 "/>
<text text-anchor="start" x="927" y="-672.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向kv_wb写入PeerState</text>
</g>
<!-- apply_snapshot&#45;&gt;write_peer_state -->
<g id="edge32" class="edge">
<title>apply_snapshot&#45;&gt;write_peer_state</title>
<path fill="none" stroke="#666666" d="M410.1,-675.04C421.67,-677.27 433.31,-679.32 444.5,-681 607.58,-705.54 801.1,-700.01 908.73,-693.91"/>
<polygon fill="#666666" stroke="#666666" points="909.1,-697.4 918.88,-693.32 908.69,-690.41 909.1,-697.4"/>
</g>
<!-- save_raft_state_to&#45;&gt;PollContext -->
<g id="edge8" class="edge">
<title>save_raft_state_to&#45;&gt;PollContext:raft_wb</title>
<path fill="none" stroke="#666666" d="M1227.38,-668.21C1258.29,-704.18 1316.52,-771.53 1337.72,-793.14"/>
<polygon fill="#666666" stroke="#666666" points="1335.68,-796.01 1345.5,-800 1340.31,-790.76 1335.68,-796.01"/>
</g>
<!-- save_snapshot_raft_state_to&#45;&gt;PollContext -->
<g id="edge9" class="edge">
<title>save_snapshot_raft_state_to&#45;&gt;PollContext:kv_wb</title>
<path fill="none" stroke="#666666" d="M1267.39,-557.01C1286.7,-572.16 1306.36,-591.21 1319,-613 1351.8,-669.53 1311.13,-706.05 1341.08,-757.02"/>
<polygon fill="#666666" stroke="#666666" points="1338.35,-759.24 1346.76,-765.67 1344.2,-755.39 1338.35,-759.24"/>
</g>
<!-- save_apply_state_to&#45;&gt;PollContext -->
<g id="edge35" class="edge">
<title>save_apply_state_to&#45;&gt;PollContext:kv_wb</title>
<path fill="none" stroke="#666666" d="M1000.37,-766.08C1013.96,-798.95 1047.77,-867.63 1102,-895 1188.1,-938.46 1232.64,-937.95 1319,-895 1333.89,-887.6 1332.77,-876.78 1340,-865.85"/>
<polygon fill="#666666" stroke="#666666" points="1342.65,-868.13 1346.64,-858.31 1337.4,-863.51 1342.65,-868.13"/>
</g>
<!-- set_last_index&#45;&gt;InvokeContext -->
<g id="edge18" class="edge">
<title>set_last_index&#45;&gt;InvokeContext</title>
<path fill="none" stroke="#666666" d="M556.05,-538.09C568.75,-533.71 583.25,-528.7 598.43,-523.45"/>
<polygon fill="#666666" stroke="#666666" points="599.66,-526.73 607.97,-520.16 597.37,-520.12 599.66,-526.73"/>
</g>
<!-- last_index -->
<g id="node17" class="node">
<title>last_index</title>
<path fill="none" stroke="#1c2123" d="M769.5,-352C769.5,-352 721.5,-352 721.5,-352 715.5,-352 709.5,-346 709.5,-340 709.5,-340 709.5,-328 709.5,-328 709.5,-322 715.5,-316 721.5,-316 721.5,-316 769.5,-316 769.5,-316 775.5,-316 781.5,-322 781.5,-328 781.5,-328 781.5,-340 781.5,-340 781.5,-346 775.5,-352 769.5,-352"/>
<text text-anchor="middle" x="745.5" y="-330.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_index</text>
</g>
<!-- get_index&#45;&gt;last_index -->
<g id="edge21" class="edge">
<title>get_index&#45;&gt;last_index</title>
<path fill="none" stroke="#666666" d="M565.57,-327.13C606.3,-328.7 660.91,-330.79 699.05,-332.26"/>
<polygon fill="#666666" stroke="#666666" points="699.22,-335.76 709.34,-332.65 699.49,-328.77 699.22,-335.76"/>
</g>
<!-- get_term&#45;&gt;InvokeContext -->
<g id="edge20" class="edge">
<title>get_term&#45;&gt;InvokeContext:last_term</title>
<path fill="none" stroke="#666666" d="M563.79,-434.44C567.08,-436.3 570.34,-438.17 573.5,-440 585.51,-446.96 588.84,-455.72 598.04,-459.33"/>
<polygon fill="#666666" stroke="#666666" points="597.56,-462.79 608,-461 598.72,-455.89 597.56,-462.79"/>
</g>
<!-- InvokeContext_new -->
<g id="node16" class="node">
<title>InvokeContext_new</title>
<path fill="none" stroke="#1c2123" d="M560,-518C560,-518 458,-518 458,-518 452,-518 446,-512 446,-506 446,-506 446,-494 446,-494 446,-488 452,-482 458,-482 458,-482 560,-482 560,-482 566,-482 572,-488 572,-494 572,-494 572,-506 572,-506 572,-512 566,-518 560,-518"/>
<text text-anchor="middle" x="509" y="-496.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">InvokeContext_new</text>
</g>
<!-- InvokeContext_new&#45;&gt;InvokeContext -->
<g id="edge19" class="edge">
<title>InvokeContext_new&#45;&gt;InvokeContext</title>
<path fill="none" stroke="#666666" d="M572.23,-492.84C580.31,-491.9 588.85,-490.92 597.62,-489.91"/>
<polygon fill="#666666" stroke="#666666" points="598.08,-493.38 607.61,-488.76 597.28,-486.43 598.08,-493.38"/>
</g>
<!-- RaftLogBatch_cut_logs -->
<g id="node19" class="node">
<title>RaftLogBatch_cut_logs</title>
<path fill="none" stroke="#1c2123" d="M1053.5,-584C1053.5,-584 931.5,-584 931.5,-584 925.5,-584 919.5,-578 919.5,-572 919.5,-572 919.5,-560 919.5,-560 919.5,-554 925.5,-548 931.5,-548 931.5,-548 1053.5,-548 1053.5,-548 1059.5,-548 1065.5,-554 1065.5,-560 1065.5,-560 1065.5,-572 1065.5,-572 1065.5,-578 1059.5,-584 1053.5,-584"/>
<text text-anchor="middle" x="992.5" y="-562.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLogBatch_cut_logs</text>
</g>
<!-- last_index&#45;&gt;RaftLogBatch_cut_logs -->
<g id="edge22" class="edge">
<title>last_index&#45;&gt;RaftLogBatch_cut_logs</title>
<path fill="none" stroke="#666666" d="M781.77,-334.25C812.74,-336.43 856.82,-344.62 883,-372 932.18,-423.43 875.52,-471.67 919,-528 923.2,-533.44 928.4,-538.18 934.08,-542.3"/>
<polygon fill="#666666" stroke="#666666" points="932.38,-545.36 942.67,-547.88 936.19,-539.5 932.38,-545.36"/>
</g>
<!-- prev_last_index -->
<g id="node18" class="node">
<title>prev_last_index</title>
<path fill="none" stroke="#1c2123" d="M785,-620C785,-620 706,-620 706,-620 700,-620 694,-614 694,-608 694,-608 694,-596 694,-596 694,-590 700,-584 706,-584 706,-584 785,-584 785,-584 791,-584 797,-590 797,-596 797,-596 797,-608 797,-608 797,-614 791,-620 785,-620"/>
<text text-anchor="middle" x="745.5" y="-598.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">prev_last_index</text>
</g>
<!-- prev_last_index&#45;&gt;RaftLogBatch_cut_logs -->
<g id="edge23" class="edge">
<title>prev_last_index&#45;&gt;RaftLogBatch_cut_logs</title>
<path fill="none" stroke="#666666" d="M797.26,-594.54C829.55,-589.8 872.1,-583.54 909.14,-578.1"/>
<polygon fill="#666666" stroke="#666666" points="910.05,-581.51 919.43,-576.59 909.03,-574.58 910.05,-581.51"/>
</g>
<!-- RaftLocalState&#45;&gt;save_raft_state_to -->
<g id="edge26" class="edge">
<title>RaftLocalState&#45;&gt;save_raft_state_to</title>
<path fill="none" stroke="#666666" d="M1039.2,-518.54C1048.1,-525.3 1057.35,-532.36 1066,-539 1082.07,-551.35 1085.91,-554.68 1102,-567 1123.26,-583.28 1147.12,-601.28 1166.57,-615.88"/>
<polygon fill="#666666" stroke="#666666" points="1164.51,-618.71 1174.61,-621.91 1168.71,-613.11 1164.51,-618.71"/>
</g>
<!-- RaftLocalState&#45;&gt;save_snapshot_raft_state_to -->
<g id="edge27" class="edge">
<title>RaftLocalState&#45;&gt;save_snapshot_raft_state_to</title>
<path fill="none" stroke="#666666" d="M1041.61,-491.94C1056.62,-494.42 1073.86,-497.27 1091.41,-500.16"/>
<polygon fill="#666666" stroke="#666666" points="1091.32,-503.7 1101.76,-501.87 1092.46,-496.79 1091.32,-503.7"/>
</g>
<!-- is_initialized&#45;&gt;clear_meta -->
<g id="edge33" class="edge">
<title>is_initialized&#45;&gt;clear_meta</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M552.19,-650.52C590.93,-652.83 648.53,-656.27 690.59,-658.78"/>
<polygon fill="green" stroke="green" points="690.46,-662.28 700.66,-659.38 690.88,-655.29 690.46,-662.28"/>
</g>
<!-- write_peer_state&#45;&gt;PollContext -->
<g id="edge34" class="edge">
<title>write_peer_state&#45;&gt;PollContext:kv_wb</title>
<path fill="none" stroke="#666666" d="M1055.36,-711.02C1059.28,-713.97 1062.89,-717.29 1066,-721 1107.51,-770.6 1050.92,-822.32 1102,-862 1168.43,-913.6 1265.49,-891.01 1337.44,-861.55"/>
<polygon fill="#666666" stroke="#666666" points="1339.11,-864.64 1346.97,-857.54 1336.4,-858.19 1339.11,-864.64"/>
</g>
</g>
</svg>
