<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: on_casual_msg Pages: 1 -->
<svg width="771pt" height="640pt"
 viewBox="0.00 0.00 771.00 640.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 636)">
<title>on_casual_msg</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-636 767,-636 767,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pd_scheduler</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M371,-530C371,-530 743,-530 743,-530 749,-530 755,-536 755,-542 755,-542 755,-612 755,-612 755,-618 749,-624 743,-624 743,-624 371,-624 371,-624 365,-624 359,-618 359,-612 359,-612 359,-542 359,-542 359,-536 365,-530 371,-530"/>
<text text-anchor="middle" x="557" y="-604" font-family="Times,serif" font-size="20.00">pd_scheduler</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_PeerFsm</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M413.5,-8C413.5,-8 521.5,-8 521.5,-8 527.5,-8 533.5,-14 533.5,-20 533.5,-20 533.5,-132 533.5,-132 533.5,-138 527.5,-144 521.5,-144 521.5,-144 413.5,-144 413.5,-144 407.5,-144 401.5,-138 401.5,-132 401.5,-132 401.5,-20 401.5,-20 401.5,-14 407.5,-8 413.5,-8"/>
<text text-anchor="middle" x="467.5" y="-124" font-family="Times,serif" font-size="20.00">PeerFsm</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_PeerFsmDelegate</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-182C20,-182 560.5,-182 560.5,-182 566.5,-182 572.5,-188 572.5,-194 572.5,-194 572.5,-510 572.5,-510 572.5,-516 566.5,-522 560.5,-522 560.5,-522 20,-522 20,-522 14,-522 8,-516 8,-510 8,-510 8,-194 8,-194 8,-188 14,-182 20,-182"/>
<text text-anchor="middle" x="290.25" y="-502" font-family="Times,serif" font-size="20.00">PeerFsmDelegate</text>
</g>
<!-- pd_scheduler -->
<g id="node1" class="node">
<title>pd_scheduler</title>
<path fill="#feed9b" stroke="#f7e495" d="M379,-539C379,-539 556,-539 556,-539 562,-539 568,-545 568,-551 568,-551 568,-573 568,-573 568,-579 562,-585 556,-585 556,-585 379,-585 379,-585 373,-585 367,-579 367,-573 367,-573 367,-551 367,-551 367,-545 373,-539 379,-539"/>
<text text-anchor="middle" x="467.5" y="-569.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pd_scheduler</text>
<polyline fill="none" stroke="#f7e495" points="367,-562 568,-562 "/>
<text text-anchor="start" x="375" y="-546.8" font-family="Times,serif" font-size="14.00" fill="#40575d">FutureScheduler&lt;PdTask&lt;EK&gt;&gt;,</text>
</g>
<!-- pd_scheduler_schedule -->
<g id="node2" class="node">
<title>pd_scheduler_schedule</title>
<path fill="none" stroke="#1c2123" d="M735,-574C735,-574 616,-574 616,-574 610,-574 604,-568 604,-562 604,-562 604,-550 604,-550 604,-544 610,-538 616,-538 616,-538 735,-538 735,-538 741,-538 747,-544 747,-550 747,-550 747,-562 747,-562 747,-568 741,-574 735,-574"/>
<text text-anchor="middle" x="675.5" y="-552.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pd_scheduler_schedule</text>
</g>
<!-- pd_scheduler&#45;&gt;pd_scheduler_schedule -->
<g id="edge1" class="edge">
<title>pd_scheduler&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M568.18,-559.1C576.72,-558.85 585.3,-558.6 593.66,-558.35"/>
<polygon fill="#666666" stroke="#666666" points="593.86,-561.85 603.75,-558.06 593.66,-554.85 593.86,-561.85"/>
</g>
<!-- approximate_keys -->
<g id="node3" class="node">
<title>approximate_keys</title>
<path fill="none" stroke="#1c2123" d="M513.5,-106C513.5,-106 421.5,-106 421.5,-106 415.5,-106 409.5,-100 409.5,-94 409.5,-94 409.5,-82 409.5,-82 409.5,-76 415.5,-70 421.5,-70 421.5,-70 513.5,-70 513.5,-70 519.5,-70 525.5,-76 525.5,-82 525.5,-82 525.5,-94 525.5,-94 525.5,-100 519.5,-106 513.5,-106"/>
<text text-anchor="middle" x="467.5" y="-84.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">approximate_keys</text>
</g>
<!-- approximate_size -->
<g id="node4" class="node">
<title>approximate_size</title>
<path fill="none" stroke="#1c2123" d="M512,-52C512,-52 423,-52 423,-52 417,-52 411,-46 411,-40 411,-40 411,-28 411,-28 411,-22 417,-16 423,-16 423,-16 512,-16 512,-16 518,-16 524,-22 524,-28 524,-28 524,-40 524,-40 524,-46 518,-52 512,-52"/>
<text text-anchor="middle" x="467.5" y="-30.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">approximate_size</text>
</g>
<!-- on_casual_msg -->
<g id="node5" class="node">
<title>on_casual_msg</title>
<path fill="none" stroke="#1c2123" d="M105,-376C105,-376 28,-376 28,-376 22,-376 16,-370 16,-364 16,-364 16,-352 16,-352 16,-346 22,-340 28,-340 28,-340 105,-340 105,-340 111,-340 117,-346 117,-352 117,-352 117,-364 117,-364 117,-370 111,-376 105,-376"/>
<text text-anchor="middle" x="66.5" y="-354.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_casual_msg</text>
</g>
<!-- on_prepare_split_region -->
<g id="node6" class="node">
<title>on_prepare_split_region</title>
<path fill="none" stroke="#1c2123" d="M304.5,-322C304.5,-322 179.5,-322 179.5,-322 173.5,-322 167.5,-316 167.5,-310 167.5,-310 167.5,-298 167.5,-298 167.5,-292 173.5,-286 179.5,-286 179.5,-286 304.5,-286 304.5,-286 310.5,-286 316.5,-292 316.5,-298 316.5,-298 316.5,-310 316.5,-310 316.5,-316 310.5,-322 304.5,-322"/>
<text text-anchor="middle" x="242" y="-300.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_prepare_split_region</text>
</g>
<!-- on_casual_msg&#45;&gt;on_prepare_split_region -->
<g id="edge2" class="edge">
<title>on_casual_msg&#45;&gt;on_prepare_split_region</title>
<path fill="none" stroke="#666666" d="M117.21,-342.23C128.94,-338.53 141.41,-334.61 153,-331 159.11,-329.1 165.46,-327.13 171.82,-325.17"/>
<polygon fill="#666666" stroke="#666666" points="173.28,-328.38 181.81,-322.09 171.22,-321.69 173.28,-328.38"/>
</g>
<!-- on_approximate_region_keys -->
<g id="node7" class="node">
<title>on_approximate_region_keys</title>
<path fill="none" stroke="#1c2123" d="M319,-430C319,-430 165,-430 165,-430 159,-430 153,-424 153,-418 153,-418 153,-406 153,-406 153,-400 159,-394 165,-394 165,-394 319,-394 319,-394 325,-394 331,-400 331,-406 331,-406 331,-418 331,-418 331,-424 325,-430 319,-430"/>
<text text-anchor="middle" x="242" y="-408.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_approximate_region_keys</text>
</g>
<!-- on_casual_msg&#45;&gt;on_approximate_region_keys -->
<g id="edge3" class="edge">
<title>on_casual_msg&#45;&gt;on_approximate_region_keys</title>
<path fill="none" stroke="#666666" d="M117.21,-373.77C128.94,-377.47 141.41,-381.39 153,-385 159.11,-386.9 165.46,-388.87 171.82,-390.83"/>
<polygon fill="#666666" stroke="#666666" points="171.22,-394.31 181.81,-393.91 173.28,-387.62 171.22,-394.31"/>
</g>
<!-- on_approximate_region_size -->
<g id="node8" class="node">
<title>on_approximate_region_size</title>
<path fill="none" stroke="#1c2123" d="M317,-376C317,-376 167,-376 167,-376 161,-376 155,-370 155,-364 155,-364 155,-352 155,-352 155,-346 161,-340 167,-340 167,-340 317,-340 317,-340 323,-340 329,-346 329,-352 329,-352 329,-364 329,-364 329,-370 323,-376 317,-376"/>
<text text-anchor="middle" x="242" y="-354.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">on_approximate_region_size</text>
</g>
<!-- on_casual_msg&#45;&gt;on_approximate_region_size -->
<g id="edge4" class="edge">
<title>on_casual_msg&#45;&gt;on_approximate_region_size</title>
<path fill="none" stroke="#666666" d="M117.22,-358C125.9,-358 135.18,-358 144.62,-358"/>
<polygon fill="#666666" stroke="#666666" points="144.9,-361.5 154.9,-358 144.9,-354.5 144.9,-361.5"/>
</g>
<!-- on_prepare_split_region&#45;&gt;pd_scheduler_schedule -->
<g id="edge5" class="edge">
<title>on_prepare_split_region&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M253.35,-285.97C270.86,-257.54 309.31,-203.32 359,-182 402.6,-163.29 534.8,-153.2 572.5,-182 628.44,-224.72 661.06,-447.3 671.12,-527.31"/>
<polygon fill="#666666" stroke="#666666" points="667.7,-528.13 672.39,-537.62 674.64,-527.27 667.7,-528.13"/>
</g>
<!-- validate_split_region -->
<g id="node9" class="node">
<title>validate_split_region</title>
<path fill="none" stroke="#1c2123" d="M396,-191C396,-191 539,-191 539,-191 545,-191 551,-197 551,-203 551,-203 551,-255 551,-255 551,-261 545,-267 539,-267 539,-267 396,-267 396,-267 390,-267 384,-261 384,-255 384,-255 384,-203 384,-203 384,-197 390,-191 396,-191"/>
<text text-anchor="middle" x="467.5" y="-251.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">validate_split_region</text>
<polyline fill="none" stroke="#1c2123" points="384,-244 551,-244 "/>
<text text-anchor="start" x="392" y="-228.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">检查是否是leader</text>
<text text-anchor="start" x="392" y="-213.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> keys是否是空的</text>
<text text-anchor="start" x="392" y="-198.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> epoch是否发生了个改变</text>
</g>
<!-- on_prepare_split_region&#45;&gt;validate_split_region -->
<g id="edge6" class="edge">
<title>on_prepare_split_region&#45;&gt;validate_split_region</title>
<path fill="none" stroke="#666666" d="M296.82,-285.94C320.06,-278.14 347.91,-268.79 374.28,-259.95"/>
<polygon fill="#666666" stroke="#666666" points="375.54,-263.21 383.91,-256.72 373.31,-256.58 375.54,-263.21"/>
</g>
<!-- invoke_with_response -->
<g id="node10" class="node">
<title>invoke_with_response</title>
<path fill="none" stroke="#1c2123" d="M524.5,-322C524.5,-322 410.5,-322 410.5,-322 404.5,-322 398.5,-316 398.5,-310 398.5,-310 398.5,-298 398.5,-298 398.5,-292 404.5,-286 410.5,-286 410.5,-286 524.5,-286 524.5,-286 530.5,-286 536.5,-292 536.5,-298 536.5,-298 536.5,-310 536.5,-310 536.5,-316 530.5,-322 524.5,-322"/>
<text text-anchor="middle" x="467.5" y="-300.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">invoke_with_response</text>
</g>
<!-- on_prepare_split_region&#45;&gt;invoke_with_response -->
<g id="edge7" class="edge">
<title>on_prepare_split_region&#45;&gt;invoke_with_response</title>
<path fill="none" stroke="#666666" d="M316.8,-304C339.73,-304 365.07,-304 388.29,-304"/>
<polygon fill="#666666" stroke="#666666" points="388.44,-307.5 398.44,-304 388.44,-300.5 388.44,-307.5"/>
</g>
<!-- PdTask_AskBatchSplit -->
<g id="node11" class="node">
<title>PdTask_AskBatchSplit</title>
<path fill="none" stroke="#1c2123" d="M527,-376C527,-376 408,-376 408,-376 402,-376 396,-370 396,-364 396,-364 396,-352 396,-352 396,-346 402,-340 408,-340 408,-340 527,-340 527,-340 533,-340 539,-346 539,-352 539,-352 539,-364 539,-364 539,-370 533,-376 527,-376"/>
<text text-anchor="middle" x="467.5" y="-354.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PdTask_AskBatchSplit</text>
</g>
<!-- on_prepare_split_region&#45;&gt;PdTask_AskBatchSplit -->
<g id="edge8" class="edge">
<title>on_prepare_split_region&#45;&gt;PdTask_AskBatchSplit</title>
<path fill="none" stroke="#666666" d="M316.8,-321.83C338.95,-327.18 363.36,-333.08 385.93,-338.53"/>
<polygon fill="#666666" stroke="#666666" points="385.27,-341.97 395.81,-340.92 386.91,-335.17 385.27,-341.97"/>
</g>
<!-- on_approximate_region_keys&#45;&gt;approximate_keys -->
<g id="edge11" class="edge">
<title>on_approximate_region_keys&#45;&gt;approximate_keys</title>
<path fill="none" stroke="#666666" d="M321.57,-393.73C325.03,-391.19 328.21,-388.29 331,-385 391.08,-314.22 314.16,-259.29 359,-178 374.39,-150.1 402.16,-127.2 425.61,-111.48"/>
<polygon fill="#666666" stroke="#666666" points="427.55,-114.39 434.03,-106.01 423.74,-108.52 427.55,-114.39"/>
</g>
<!-- register_split_region_check_tick -->
<g id="node12" class="node">
<title>register_split_region_check_tick</title>
<path fill="none" stroke="#1c2123" d="M552.5,-484C552.5,-484 382.5,-484 382.5,-484 376.5,-484 370.5,-478 370.5,-472 370.5,-472 370.5,-460 370.5,-460 370.5,-454 376.5,-448 382.5,-448 382.5,-448 552.5,-448 552.5,-448 558.5,-448 564.5,-454 564.5,-460 564.5,-460 564.5,-472 564.5,-472 564.5,-478 558.5,-484 552.5,-484"/>
<text text-anchor="middle" x="467.5" y="-462.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">register_split_region_check_tick</text>
</g>
<!-- on_approximate_region_keys&#45;&gt;register_split_region_check_tick -->
<g id="edge12" class="edge">
<title>on_approximate_region_keys&#45;&gt;register_split_region_check_tick</title>
<path fill="none" stroke="#666666" d="M317.73,-430.06C338.33,-435.03 360.82,-440.47 381.92,-445.57"/>
<polygon fill="#666666" stroke="#666666" points="381.3,-449.01 391.84,-447.96 382.94,-442.21 381.3,-449.01"/>
</g>
<!-- register_pd_heartbeat_tick -->
<g id="node13" class="node">
<title>register_pd_heartbeat_tick</title>
<path fill="none" stroke="#1c2123" d="M536,-430C536,-430 399,-430 399,-430 393,-430 387,-424 387,-418 387,-418 387,-406 387,-406 387,-400 393,-394 399,-394 399,-394 536,-394 536,-394 542,-394 548,-400 548,-406 548,-406 548,-418 548,-418 548,-424 542,-430 536,-430"/>
<text text-anchor="middle" x="467.5" y="-408.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">register_pd_heartbeat_tick</text>
</g>
<!-- on_approximate_region_keys&#45;&gt;register_pd_heartbeat_tick -->
<g id="edge13" class="edge">
<title>on_approximate_region_keys&#45;&gt;register_pd_heartbeat_tick</title>
<path fill="none" stroke="#666666" d="M331.01,-412C346,-412 361.58,-412 376.62,-412"/>
<polygon fill="#666666" stroke="#666666" points="376.92,-415.5 386.92,-412 376.92,-408.5 376.92,-415.5"/>
</g>
<!-- on_approximate_region_size&#45;&gt;approximate_size -->
<g id="edge10" class="edge">
<title>on_approximate_region_size&#45;&gt;approximate_size</title>
<path fill="none" stroke="#666666" d="M321.69,-339.84C325.12,-337.26 328.26,-334.33 331,-331 407.63,-237.82 279.99,-152.17 359,-61 369.7,-48.66 385.12,-41.53 400.96,-37.52"/>
<polygon fill="#666666" stroke="#666666" points="401.79,-40.92 410.83,-35.4 400.32,-34.07 401.79,-40.92"/>
</g>
<!-- on_approximate_region_size&#45;&gt;register_split_region_check_tick -->
<g id="edge14" class="edge">
<title>on_approximate_region_size&#45;&gt;register_split_region_check_tick</title>
<path fill="none" stroke="#666666" d="M317.77,-376.08C322.48,-378.67 326.95,-381.62 331,-385 351.76,-402.31 337.8,-422.23 359,-439 360.61,-440.28 362.28,-441.49 363.99,-442.65"/>
<polygon fill="#666666" stroke="#666666" points="362.51,-445.85 372.89,-447.99 366.12,-439.85 362.51,-445.85"/>
</g>
<!-- on_approximate_region_size&#45;&gt;register_pd_heartbeat_tick -->
<g id="edge15" class="edge">
<title>on_approximate_region_size&#45;&gt;register_pd_heartbeat_tick</title>
<path fill="none" stroke="#666666" d="M317.73,-376.06C338.33,-381.03 360.82,-386.47 381.92,-391.57"/>
<polygon fill="#666666" stroke="#666666" points="381.3,-395.01 391.84,-393.96 382.94,-388.21 381.3,-395.01"/>
</g>
<!-- PdTask_AskBatchSplit&#45;&gt;pd_scheduler_schedule -->
<g id="edge9" class="edge">
<title>PdTask_AskBatchSplit&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M539.05,-368.33C550.97,-372.24 562.65,-377.61 572.5,-385 621.75,-421.94 651.84,-490.23 665.59,-528.39"/>
<polygon fill="green" stroke="green" points="662.29,-529.56 668.89,-537.85 668.9,-527.25 662.29,-529.56"/>
</g>
</g>
</svg>
