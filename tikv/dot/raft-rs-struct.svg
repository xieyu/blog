<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: raft_rs_struct Pages: 1 -->
<svg width="2860pt" height="1746pt"
 viewBox="0.00 0.00 2860.00 1745.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1741.5)">
<title>raft_rs_struct</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1741.5 2856,-1741.5 2856,4 -4,4"/>
<!-- RawNode -->
<g id="node1" class="node">
<title>RawNode</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M12,-325C12,-325 197,-325 197,-325 203,-325 209,-331 209,-337 209,-337 209,-489 209,-489 209,-495 203,-501 197,-501 197,-501 12,-501 12,-501 6,-501 0,-495 0,-489 0,-489 0,-337 0,-337 0,-331 6,-325 12,-325"/>
<text text-anchor="middle" x="104.5" y="-485.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RawNode</text>
<polyline fill="none" stroke="#60b5ac" points="0,-478 209,-478 "/>
<text text-anchor="start" x="8" y="-462.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub raft: Raft&lt;T&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="0,-455 209,-455 "/>
<text text-anchor="start" x="8" y="-439.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">prev_ss: SoftState</text>
<polyline fill="none" stroke="#60b5ac" points="0,-432 209,-432 "/>
<text text-anchor="start" x="8" y="-416.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">prev_hs: HardState</text>
<text text-anchor="start" x="8" y="-401.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> max_number: u64</text>
<polyline fill="none" stroke="#60b5ac" points="0,-394 209,-394 "/>
<text text-anchor="start" x="8" y="-378.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">records: VecDeque&lt;ReadyRecord&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="0,-371 209,-371 "/>
<text text-anchor="start" x="8" y="-355.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">commit_since_index: u64</text>
<polyline fill="none" stroke="#60b5ac" points="0,-348 209,-348 "/>
<text text-anchor="start" x="8" y="-332.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">messages: Vec&lt;Vec&lt;Message&gt;&gt;</text>
</g>
<!-- Raft -->
<g id="node2" class="node">
<title>Raft</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M270.5,-907C270.5,-907 407.5,-907 407.5,-907 413.5,-907 419.5,-913 419.5,-919 419.5,-919 419.5,-987 419.5,-987 419.5,-993 413.5,-999 407.5,-999 407.5,-999 270.5,-999 270.5,-999 264.5,-999 258.5,-993 258.5,-987 258.5,-987 258.5,-919 258.5,-919 258.5,-913 264.5,-907 270.5,-907"/>
<text text-anchor="middle" x="339" y="-983.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Raft</text>
<polyline fill="none" stroke="#60b5ac" points="258.5,-976 419.5,-976 "/>
<text text-anchor="start" x="266.5" y="-960.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">prs: ProgressTracker</text>
<polyline fill="none" stroke="#60b5ac" points="258.5,-953 419.5,-953 "/>
<text text-anchor="start" x="266.5" y="-937.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub msgs: Vec&lt;Message&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="258.5,-930 419.5,-930 "/>
<text text-anchor="start" x="266.5" y="-914.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub r: RaftCore&lt;T&gt;</text>
</g>
<!-- RawNode&#45;&gt;Raft -->
<g id="edge1" class="edge">
<title>RawNode&#45;&gt;Raft</title>
<path fill="none" stroke="#666666" d="M143.5,-501.26C191.8,-613.44 273.73,-803.72 314.08,-897.45"/>
<polygon fill="#666666" stroke="#666666" points="310.92,-898.96 318.09,-906.76 317.35,-896.19 310.92,-898.96"/>
</g>
<!-- Storage -->
<g id="node3" class="node">
<title>Storage</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1161,-1553C1161,-1553 1487,-1553 1487,-1553 1493,-1553 1499,-1559 1499,-1565 1499,-1565 1499,-1725 1499,-1725 1499,-1731 1493,-1737 1487,-1737 1487,-1737 1161,-1737 1161,-1737 1155,-1737 1149,-1731 1149,-1725 1149,-1725 1149,-1565 1149,-1565 1149,-1559 1155,-1553 1161,-1553"/>
<text text-anchor="middle" x="1324" y="-1721.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">trait Storage</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1714 1499,-1714 "/>
<text text-anchor="start" x="1157" y="-1698.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">需要实现的trait</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1691 1499,-1691 "/>
<text text-anchor="start" x="1157" y="-1675.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">fn initial_state(&amp;self) &#45;&gt; Result&lt;RaftState&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1668 1499,-1668 "/>
<text text-anchor="start" x="1157" y="-1652.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">fn entries(...) &#45;&gt; Result&lt;Vec&lt;Entry&gt;&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1645 1499,-1645 "/>
<text text-anchor="start" x="1157" y="-1629.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">fn term(&amp;self, idx: u64) &#45;&gt; Result&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1622 1499,-1622 "/>
<text text-anchor="start" x="1157" y="-1606.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">fn last_index(&amp;self) &#45;&gt; Result&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1599 1499,-1599 "/>
<text text-anchor="start" x="1157" y="-1583.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">fn last_index(&amp;self) &#45;&gt; Result&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1149,-1576 1499,-1576 "/>
<text text-anchor="start" x="1157" y="-1560.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">fn snapshot(&amp;self, request_index: u64) &#45;&gt; Result&lt;Snapshot&gt;</text>
</g>
<!-- RawNode&#45;&gt;Storage -->
<g id="edge2" class="edge">
<title>RawNode&#45;&gt;Storage</title>
<path fill="none" stroke="#666666" d="M105.84,-501.04C111.78,-712.27 158.3,-1250.05 469,-1517 653.89,-1675.85 948.41,-1684.56 1138.72,-1669.76"/>
<polygon fill="#666666" stroke="#666666" points="1139.15,-1673.24 1148.84,-1668.94 1138.59,-1666.26 1139.15,-1673.24"/>
</g>
<!-- SoftState -->
<g id="node4" class="node">
<title>SoftState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1260.5,-239.5C1260.5,-239.5 1387.5,-239.5 1387.5,-239.5 1393.5,-239.5 1399.5,-245.5 1399.5,-251.5 1399.5,-251.5 1399.5,-296.5 1399.5,-296.5 1399.5,-302.5 1393.5,-308.5 1387.5,-308.5 1387.5,-308.5 1260.5,-308.5 1260.5,-308.5 1254.5,-308.5 1248.5,-302.5 1248.5,-296.5 1248.5,-296.5 1248.5,-251.5 1248.5,-251.5 1248.5,-245.5 1254.5,-239.5 1260.5,-239.5"/>
<text text-anchor="middle" x="1324" y="-293.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">SoftState</text>
<polyline fill="none" stroke="#60b5ac" points="1248.5,-285.5 1399.5,-285.5 "/>
<text text-anchor="start" x="1256.5" y="-270.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub leader_id: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1248.5,-262.5 1399.5,-262.5 "/>
<text text-anchor="start" x="1256.5" y="-247.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub raft_state: StateRole</text>
</g>
<!-- RawNode&#45;&gt;SoftState -->
<g id="edge3" class="edge">
<title>RawNode&#45;&gt;SoftState</title>
<path fill="none" stroke="#666666" d="M209,-366.26C220.96,-362.2 233.12,-358.64 245,-356 622.05,-272.2 729.37,-357.92 1113,-313 1154.42,-308.15 1199.97,-300.04 1238.03,-292.46"/>
<polygon fill="#666666" stroke="#666666" points="1238.93,-295.85 1248.04,-290.45 1237.55,-288.99 1238.93,-295.85"/>
</g>
<!-- HardState -->
<g id="node5" class="node">
<title>HardState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M2625.5,-3.5C2625.5,-3.5 2828.5,-3.5 2828.5,-3.5 2834.5,-3.5 2840.5,-9.5 2840.5,-15.5 2840.5,-15.5 2840.5,-106.5 2840.5,-106.5 2840.5,-112.5 2834.5,-118.5 2828.5,-118.5 2828.5,-118.5 2625.5,-118.5 2625.5,-118.5 2619.5,-118.5 2613.5,-112.5 2613.5,-106.5 2613.5,-106.5 2613.5,-15.5 2613.5,-15.5 2613.5,-9.5 2619.5,-3.5 2625.5,-3.5"/>
<text text-anchor="middle" x="2727" y="-103.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">HardState</text>
<polyline fill="none" stroke="#60b5ac" points="2613.5,-95.5 2840.5,-95.5 "/>
<text text-anchor="start" x="2621.5" y="-80.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">HardState是需要持久化的状态吗？</text>
<polyline fill="none" stroke="#60b5ac" points="2613.5,-72.5 2840.5,-72.5 "/>
<text text-anchor="start" x="2621.5" y="-57.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub term: u64</text>
<polyline fill="none" stroke="#60b5ac" points="2613.5,-49.5 2840.5,-49.5 "/>
<text text-anchor="start" x="2621.5" y="-34.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub vote: u64</text>
<polyline fill="none" stroke="#60b5ac" points="2613.5,-26.5 2840.5,-26.5 "/>
<text text-anchor="start" x="2621.5" y="-11.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub commit: u64</text>
</g>
<!-- RawNode&#45;&gt;HardState -->
<g id="edge4" class="edge">
<title>RawNode&#45;&gt;HardState</title>
<path fill="none" stroke="#666666" d="M154.99,-324.91C230.41,-203.61 386.37,0 583.5,0 583.5,0 583.5,0 2066.5,0 2254.35,0 2471.02,-24.84 2603.23,-42.82"/>
<polygon fill="#666666" stroke="#666666" points="2603.01,-46.32 2613.39,-44.21 2603.96,-39.39 2603.01,-46.32"/>
</g>
<!-- ReadyRecord -->
<g id="node6" class="node">
<title>ReadyRecord</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M257,-398.5C257,-398.5 421,-398.5 421,-398.5 427,-398.5 433,-404.5 433,-410.5 433,-410.5 433,-501.5 433,-501.5 433,-507.5 427,-513.5 421,-513.5 421,-513.5 257,-513.5 257,-513.5 251,-513.5 245,-507.5 245,-501.5 245,-501.5 245,-410.5 245,-410.5 245,-404.5 251,-398.5 257,-398.5"/>
<text text-anchor="middle" x="339" y="-498.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadyRecord</text>
<polyline fill="none" stroke="#60b5ac" points="245,-490.5 433,-490.5 "/>
<text text-anchor="start" x="253" y="-475.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">number: u64</text>
<polyline fill="none" stroke="#60b5ac" points="245,-467.5 433,-467.5 "/>
<text text-anchor="start" x="253" y="-452.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">last_entry: Option&lt;(u64, u64)&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="245,-444.5 433,-444.5 "/>
<text text-anchor="start" x="253" y="-429.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">snapshot: Option&lt;(u64, u64)&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="245,-421.5 433,-421.5 "/>
<text text-anchor="start" x="253" y="-406.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">messages: Vec&lt;Message&gt;</text>
</g>
<!-- RawNode&#45;&gt;ReadyRecord -->
<g id="edge5" class="edge">
<title>RawNode&#45;&gt;ReadyRecord</title>
<path fill="none" stroke="#666666" d="M209.17,-432.17C217.7,-433.75 226.32,-435.35 234.85,-436.92"/>
<polygon fill="#666666" stroke="#666666" points="234.33,-440.39 244.8,-438.76 235.6,-433.5 234.33,-440.39"/>
</g>
<!-- Message -->
<g id="node7" class="node">
<title>Message</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1547,-300C1547,-300 1835,-300 1835,-300 1841,-300 1847,-306 1847,-312 1847,-312 1847,-656 1847,-656 1847,-662 1841,-668 1835,-668 1835,-668 1547,-668 1547,-668 1541,-668 1535,-662 1535,-656 1535,-656 1535,-312 1535,-312 1535,-306 1541,-300 1547,-300"/>
<text text-anchor="middle" x="1691" y="-652.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Message</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-645 1847,-645 "/>
<text text-anchor="start" x="1543" y="-629.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub msg_type: MessageType</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-622 1847,-622 "/>
<text text-anchor="start" x="1543" y="-606.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub to: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-599 1847,-599 "/>
<text text-anchor="start" x="1543" y="-583.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub from: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-576 1847,-576 "/>
<text text-anchor="start" x="1543" y="-560.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub term: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-553 1847,-553 "/>
<text text-anchor="start" x="1543" y="-537.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub log_term: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-530 1847,-530 "/>
<text text-anchor="start" x="1543" y="-514.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub index: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-507 1847,-507 "/>
<text text-anchor="start" x="1543" y="-491.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub entries: ::protobuf::RepeatedField&lt;Entry&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-484 1847,-484 "/>
<text text-anchor="start" x="1543" y="-468.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub commit: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-461 1847,-461 "/>
<text text-anchor="start" x="1543" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub commit_term: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-438 1847,-438 "/>
<text text-anchor="start" x="1543" y="-422.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub snapshot: ::protobuf::SingularPtrField&lt;Snapshot&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-415 1847,-415 "/>
<text text-anchor="start" x="1543" y="-399.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub request_snapshot: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-392 1847,-392 "/>
<text text-anchor="start" x="1543" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub reject: bool</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-369 1847,-369 "/>
<text text-anchor="start" x="1543" y="-353.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub reject_hint: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-346 1847,-346 "/>
<text text-anchor="start" x="1543" y="-330.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub context: ::std::vec::Vec&lt;u8&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1535,-323 1847,-323 "/>
<text text-anchor="start" x="1543" y="-307.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub priority: u64</text>
</g>
<!-- RawNode&#45;&gt;Message -->
<g id="edge6" class="edge">
<title>RawNode&#45;&gt;Message</title>
<path fill="none" stroke="#666666" d="M209.29,-393.8C221.31,-391.97 233.4,-390.32 245,-389 394.72,-371.98 432.82,-370 583.5,-370 583.5,-370 583.5,-370 925.5,-370 1180.67,-370 1250.98,-337.03 1499,-397 1507.71,-399.11 1516.52,-401.61 1525.31,-404.42"/>
<polygon fill="#666666" stroke="#666666" points="1524.25,-407.76 1534.84,-407.58 1526.45,-401.11 1524.25,-407.76"/>
</g>
<!-- Raft&#45;&gt;Storage -->
<g id="edge8" class="edge">
<title>Raft&#45;&gt;Storage</title>
<path fill="none" stroke="#666666" d="M345.06,-999.12C358.65,-1114.25 399.66,-1409.81 469,-1476 493.28,-1499.18 895.17,-1571.58 1138.86,-1613.72"/>
<polygon fill="#666666" stroke="#666666" points="1138.45,-1617.2 1148.9,-1615.46 1139.64,-1610.3 1138.45,-1617.2"/>
</g>
<!-- Raft&#45;&gt;Message -->
<g id="edge9" class="edge">
<title>Raft&#45;&gt;Message</title>
<path fill="none" stroke="#666666" d="M342.3,-906.87C348.81,-830.94 373.73,-680.99 469,-610 652.98,-472.9 1272.96,-577.42 1499,-538 1507.51,-536.52 1516.18,-534.8 1524.91,-532.93"/>
<polygon fill="#666666" stroke="#666666" points="1525.77,-536.32 1534.78,-530.73 1524.25,-529.49 1525.77,-536.32"/>
</g>
<!-- ProgressTracker -->
<g id="node9" class="node">
<title>ProgressTracker</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M507.5,-1305.5C507.5,-1305.5 661.5,-1305.5 661.5,-1305.5 667.5,-1305.5 673.5,-1311.5 673.5,-1317.5 673.5,-1317.5 673.5,-1454.5 673.5,-1454.5 673.5,-1460.5 667.5,-1466.5 661.5,-1466.5 661.5,-1466.5 507.5,-1466.5 507.5,-1466.5 501.5,-1466.5 495.5,-1460.5 495.5,-1454.5 495.5,-1454.5 495.5,-1317.5 495.5,-1317.5 495.5,-1311.5 501.5,-1305.5 507.5,-1305.5"/>
<text text-anchor="middle" x="584.5" y="-1451.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ProgressTracker</text>
<polyline fill="none" stroke="#60b5ac" points="495.5,-1443.5 673.5,-1443.5 "/>
<text text-anchor="start" x="503.5" y="-1428.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">progress: ProgressMap</text>
<polyline fill="none" stroke="#60b5ac" points="495.5,-1420.5 673.5,-1420.5 "/>
<text text-anchor="start" x="503.5" y="-1405.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">conf: Configuration</text>
<polyline fill="none" stroke="#60b5ac" points="495.5,-1397.5 673.5,-1397.5 "/>
<text text-anchor="start" x="503.5" y="-1382.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">votes: HashMap&lt;u64, bool&gt; </text>
<polyline fill="none" stroke="#60b5ac" points="495.5,-1374.5 673.5,-1374.5 "/>
<text text-anchor="start" x="503.5" y="-1359.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">max_inflight: usize</text>
<polyline fill="none" stroke="#60b5ac" points="495.5,-1351.5 673.5,-1351.5 "/>
<text text-anchor="start" x="503.5" y="-1336.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">group_commit: bool</text>
<polyline fill="none" stroke="#60b5ac" points="495.5,-1328.5 673.5,-1328.5 "/>
<text text-anchor="start" x="503.5" y="-1313.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) logger: Logger</text>
</g>
<!-- Raft&#45;&gt;ProgressTracker -->
<g id="edge10" class="edge">
<title>Raft&#45;&gt;ProgressTracker</title>
<path fill="none" stroke="#666666" d="M349.02,-999.28C364.34,-1069 400.67,-1202.72 469,-1296 474.6,-1303.64 481,-1310.97 487.87,-1317.92"/>
<polygon fill="#666666" stroke="#666666" points="485.87,-1320.85 495.48,-1325.31 490.74,-1315.83 485.87,-1320.85"/>
</g>
<!-- RaftCore -->
<g id="node10" class="node">
<title>RaftCore</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M481,-619.5C481,-619.5 688,-619.5 688,-619.5 694,-619.5 700,-625.5 700,-631.5 700,-631.5 700,-1274.5 700,-1274.5 700,-1280.5 694,-1286.5 688,-1286.5 688,-1286.5 481,-1286.5 481,-1286.5 475,-1286.5 469,-1280.5 469,-1274.5 469,-1274.5 469,-631.5 469,-631.5 469,-625.5 475,-619.5 481,-619.5"/>
<text text-anchor="middle" x="584.5" y="-1271.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftCore</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1263.5 700,-1263.5 "/>
<text text-anchor="start" x="477" y="-1248.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub term: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1240.5 700,-1240.5 "/>
<text text-anchor="start" x="477" y="-1225.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub vote: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1217.5 700,-1217.5 "/>
<text text-anchor="start" x="477" y="-1202.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub id: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1194.5 700,-1194.5 "/>
<text text-anchor="start" x="477" y="-1179.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub read_states: Vec&lt;ReadState&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1171.5 700,-1171.5 "/>
<text text-anchor="start" x="477" y="-1156.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub raft_log: RaftLog&lt;T&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1148.5 700,-1148.5 "/>
<text text-anchor="start" x="477" y="-1133.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub max_inflight: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1125.5 700,-1125.5 "/>
<text text-anchor="start" x="477" y="-1110.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub max_msg_size: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1102.5 700,-1102.5 "/>
<text text-anchor="start" x="477" y="-1087.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pending_request_snapshot: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1079.5 700,-1079.5 "/>
<text text-anchor="start" x="477" y="-1064.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub state: StateRole</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1056.5 700,-1056.5 "/>
<text text-anchor="start" x="477" y="-1041.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">promotable: bool</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1033.5 700,-1033.5 "/>
<text text-anchor="start" x="477" y="-1018.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub leader_id: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-1010.5 700,-1010.5 "/>
<text text-anchor="start" x="477" y="-995.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub lead_transferee: Option&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="469,-987.5 700,-987.5 "/>
<text text-anchor="start" x="477" y="-972.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pending_conf_index: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-964.5 700,-964.5 "/>
<text text-anchor="start" x="477" y="-949.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub read_only: ReadOnly</text>
<polyline fill="none" stroke="#60b5ac" points="469,-941.5 700,-941.5 "/>
<text text-anchor="start" x="477" y="-926.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub election_elapsed: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-918.5 700,-918.5 "/>
<text text-anchor="start" x="477" y="-903.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">heartbeat_elapsed: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-895.5 700,-895.5 "/>
<text text-anchor="start" x="477" y="-880.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub check_quorum: bool</text>
<polyline fill="none" stroke="#60b5ac" points="469,-872.5 700,-872.5 "/>
<text text-anchor="start" x="477" y="-857.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pre_vote: bool</text>
<polyline fill="none" stroke="#60b5ac" points="469,-849.5 700,-849.5 "/>
<text text-anchor="start" x="477" y="-834.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">skip_bcast_commit: bool</text>
<polyline fill="none" stroke="#60b5ac" points="469,-826.5 700,-826.5 "/>
<text text-anchor="start" x="477" y="-811.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">batch_append: bool</text>
<polyline fill="none" stroke="#60b5ac" points="469,-803.5 700,-803.5 "/>
<text text-anchor="start" x="477" y="-788.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">heartbeat_timeout: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-780.5 700,-780.5 "/>
<text text-anchor="start" x="477" y="-765.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">election_timeout: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-757.5 700,-757.5 "/>
<text text-anchor="start" x="477" y="-742.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">randomized_election_timeout: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-734.5 700,-734.5 "/>
<text text-anchor="start" x="477" y="-719.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">min_election_timeout: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-711.5 700,-711.5 "/>
<text text-anchor="start" x="477" y="-696.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">max_election_timeout: usize</text>
<polyline fill="none" stroke="#60b5ac" points="469,-688.5 700,-688.5 "/>
<text text-anchor="start" x="477" y="-673.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) logger: slog::Logger</text>
<polyline fill="none" stroke="#60b5ac" points="469,-665.5 700,-665.5 "/>
<text text-anchor="start" x="477" y="-650.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub priority: u64</text>
<polyline fill="none" stroke="#60b5ac" points="469,-642.5 700,-642.5 "/>
<text text-anchor="start" x="477" y="-627.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">uncommitted_state: UncommittedState</text>
</g>
<!-- Raft&#45;&gt;RaftCore -->
<g id="edge11" class="edge">
<title>Raft&#45;&gt;RaftCore</title>
<path fill="none" stroke="#666666" d="M419.73,-953C432.22,-953 445.38,-953 458.59,-953"/>
<polygon fill="#666666" stroke="#666666" points="458.7,-956.5 468.7,-953 458.7,-949.5 458.7,-956.5"/>
</g>
<!-- MemStorage -->
<g id="node8" class="node">
<title>MemStorage</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1581,-1581C1581,-1581 1801,-1581 1801,-1581 1807,-1581 1813,-1587 1813,-1593 1813,-1593 1813,-1615 1813,-1615 1813,-1621 1807,-1627 1801,-1627 1801,-1627 1581,-1627 1581,-1627 1575,-1627 1569,-1621 1569,-1615 1569,-1615 1569,-1593 1569,-1593 1569,-1587 1575,-1581 1581,-1581"/>
<text text-anchor="middle" x="1691" y="-1611.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MemStorage</text>
<polyline fill="none" stroke="#60b5ac" points="1569,-1604 1813,-1604 "/>
<text text-anchor="start" x="1577" y="-1588.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">core: Arc&lt;RwLock&lt;MemStorageCore&gt;&gt;</text>
</g>
<!-- Storage&#45;&gt;MemStorage -->
<g id="edge7" class="edge">
<title>Storage&#45;&gt;MemStorage</title>
<path fill="none" stroke="#666666" d="M1499.22,-1625.43C1519.29,-1623.18 1539.5,-1620.91 1558.87,-1618.73"/>
<polygon fill="#666666" stroke="#666666" points="1559.36,-1622.2 1568.91,-1617.6 1558.58,-1615.24 1559.36,-1622.2"/>
</g>
<!-- Snapshot -->
<g id="node18" class="node">
<title>Snapshot</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1895,-1105C1895,-1105 2236,-1105 2236,-1105 2242,-1105 2248,-1111 2248,-1117 2248,-1117 2248,-1185 2248,-1185 2248,-1191 2242,-1197 2236,-1197 2236,-1197 1895,-1197 1895,-1197 1889,-1197 1883,-1191 1883,-1185 1883,-1185 1883,-1117 1883,-1117 1883,-1111 1889,-1105 1895,-1105"/>
<text text-anchor="middle" x="2065.5" y="-1181.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Snapshot</text>
<polyline fill="none" stroke="#60b5ac" points="1883,-1174 2248,-1174 "/>
<text text-anchor="start" x="1891" y="-1158.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">对raftlog的压缩</text>
<polyline fill="none" stroke="#60b5ac" points="1883,-1151 2248,-1151 "/>
<text text-anchor="start" x="1891" y="-1135.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub data: ::std::vec::Vec&lt;u8&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1883,-1128 2248,-1128 "/>
<text text-anchor="start" x="1891" y="-1112.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub metadata: ::protobuf::SingularPtrField&lt;SnapshotMetadata&gt;</text>
</g>
<!-- Storage&#45;&gt;Snapshot -->
<g id="edge41" class="edge">
<title>Storage&#45;&gt;Snapshot</title>
<path fill="none" stroke="#666666" d="M1481.61,-1552.93C1507.14,-1538.51 1527.67,-1527.49 1535,-1525 1667.51,-1479.9 1728.64,-1556.73 1847,-1482 1950.29,-1416.78 2014.96,-1282.68 2044.88,-1206.71"/>
<polygon fill="#666666" stroke="#666666" points="2048.18,-1207.88 2048.52,-1197.29 2041.65,-1205.35 2048.18,-1207.88"/>
</g>
<!-- Entry -->
<g id="node19" class="node">
<title>Entry</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M2296,-883.5C2296,-883.5 2554,-883.5 2554,-883.5 2560,-883.5 2566,-889.5 2566,-895.5 2566,-895.5 2566,-1070.5 2566,-1070.5 2566,-1076.5 2560,-1082.5 2554,-1082.5 2554,-1082.5 2296,-1082.5 2296,-1082.5 2290,-1082.5 2284,-1076.5 2284,-1070.5 2284,-1070.5 2284,-895.5 2284,-895.5 2284,-889.5 2290,-883.5 2296,-883.5"/>
<text text-anchor="middle" x="2425" y="-1067.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Entry</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-1059.5 2566,-1059.5 "/>
<text text-anchor="start" x="2292" y="-1044.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub entry_type: EntryType</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-1036.5 2566,-1036.5 "/>
<text text-anchor="start" x="2292" y="-1021.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub term: u64</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-1013.5 2566,-1013.5 "/>
<text text-anchor="start" x="2292" y="-998.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub index: u64</text>
<text text-anchor="start" x="2292" y="-983.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> pub data: ::std::vec::Vec&lt;u8&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-975.5 2566,-975.5 "/>
<text text-anchor="start" x="2292" y="-960.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub context: ::std::vec::Vec&lt;u8&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-952.5 2566,-952.5 "/>
<text text-anchor="start" x="2292" y="-937.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub sync_log: bool</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-929.5 2566,-929.5 "/>
<text text-anchor="start" x="2292" y="-914.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub unknown_fields: ::protobuf::UnknownFields</text>
<polyline fill="none" stroke="#60b5ac" points="2284,-906.5 2566,-906.5 "/>
<text text-anchor="start" x="2292" y="-891.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub cached_size: ::protobuf::CachedSize</text>
</g>
<!-- Storage&#45;&gt;Entry -->
<g id="edge42" class="edge">
<title>Storage&#45;&gt;Entry</title>
<path fill="none" stroke="#666666" d="M1499.1,-1582.11C1511.18,-1578.47 1523.23,-1575.06 1535,-1572 1671.27,-1536.55 1718.22,-1573.94 1847,-1517 2053.03,-1425.91 2088.09,-1365.66 2248,-1207 2283.56,-1171.72 2318.54,-1129.28 2347.82,-1090.88"/>
<polygon fill="#666666" stroke="#666666" points="2350.73,-1092.84 2353.98,-1082.76 2345.15,-1088.61 2350.73,-1092.84"/>
</g>
<!-- RaftState -->
<g id="node33" class="node">
<title>RaftState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M2358,-1557.5C2358,-1557.5 2492,-1557.5 2492,-1557.5 2498,-1557.5 2504,-1563.5 2504,-1569.5 2504,-1569.5 2504,-1614.5 2504,-1614.5 2504,-1620.5 2498,-1626.5 2492,-1626.5 2492,-1626.5 2358,-1626.5 2358,-1626.5 2352,-1626.5 2346,-1620.5 2346,-1614.5 2346,-1614.5 2346,-1569.5 2346,-1569.5 2346,-1563.5 2352,-1557.5 2358,-1557.5"/>
<text text-anchor="middle" x="2425" y="-1611.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftState</text>
<polyline fill="none" stroke="#60b5ac" points="2346,-1603.5 2504,-1603.5 "/>
<text text-anchor="start" x="2354" y="-1588.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub hard_state: HardState</text>
<polyline fill="none" stroke="#60b5ac" points="2346,-1580.5 2504,-1580.5 "/>
<text text-anchor="start" x="2354" y="-1565.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub conf_state: ConfState</text>
</g>
<!-- Storage&#45;&gt;RaftState -->
<g id="edge43" class="edge">
<title>Storage&#45;&gt;RaftState</title>
<path fill="none" stroke="#666666" d="M1499.31,-1661.73C1685.81,-1675.88 1989.7,-1688.1 2248,-1648 2277.34,-1643.45 2308.47,-1634.86 2336.27,-1625.76"/>
<polygon fill="#666666" stroke="#666666" points="2337.58,-1629.01 2345.96,-1622.52 2335.36,-1622.37 2337.58,-1629.01"/>
</g>
<!-- StateRole -->
<g id="node13" class="node">
<title>StateRole</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1639,-165.5C1639,-165.5 1743,-165.5 1743,-165.5 1749,-165.5 1755,-171.5 1755,-177.5 1755,-177.5 1755,-268.5 1755,-268.5 1755,-274.5 1749,-280.5 1743,-280.5 1743,-280.5 1639,-280.5 1639,-280.5 1633,-280.5 1627,-274.5 1627,-268.5 1627,-268.5 1627,-177.5 1627,-177.5 1627,-171.5 1633,-165.5 1639,-165.5"/>
<text text-anchor="middle" x="1691" y="-265.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub enum StateRole</text>
<polyline fill="none" stroke="#60b5ac" points="1627,-257.5 1755,-257.5 "/>
<text text-anchor="start" x="1635" y="-242.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Follower</text>
<polyline fill="none" stroke="#60b5ac" points="1627,-234.5 1755,-234.5 "/>
<text text-anchor="start" x="1635" y="-219.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Candidate</text>
<polyline fill="none" stroke="#60b5ac" points="1627,-211.5 1755,-211.5 "/>
<text text-anchor="start" x="1635" y="-196.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Leader</text>
<polyline fill="none" stroke="#60b5ac" points="1627,-188.5 1755,-188.5 "/>
<text text-anchor="start" x="1635" y="-173.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">PreCandidate</text>
</g>
<!-- SoftState&#45;&gt;StateRole -->
<g id="edge36" class="edge">
<title>SoftState&#45;&gt;StateRole</title>
<path fill="none" stroke="#666666" d="M1399.74,-263.56C1463.16,-254.7 1553.63,-242.05 1616.65,-233.25"/>
<polygon fill="#666666" stroke="#666666" points="1617.49,-236.67 1626.91,-231.82 1616.52,-229.73 1617.49,-236.67"/>
</g>
<!-- ReadyRecord&#45;&gt;Message -->
<g id="edge37" class="edge">
<title>ReadyRecord&#45;&gt;Message</title>
<path fill="none" stroke="#666666" d="M433.03,-443.05C630.61,-417.89 1106.15,-369.63 1499,-427 1507.52,-428.24 1516.19,-429.79 1524.9,-431.55"/>
<polygon fill="#666666" stroke="#666666" points="1524.23,-434.99 1534.74,-433.64 1525.69,-428.14 1524.23,-434.99"/>
</g>
<!-- Message&#45;&gt;Snapshot -->
<g id="edge34" class="edge">
<title>Message&#45;&gt;Snapshot</title>
<path fill="none" stroke="#666666" d="M1847.12,-668.27C1888.28,-761.47 1843.68,-800.83 1883,-895 1915.4,-972.61 1976.97,-1048.53 2019.35,-1097.39"/>
<polygon fill="#666666" stroke="#666666" points="2016.77,-1099.76 2025.98,-1105 2022.04,-1095.16 2016.77,-1099.76"/>
</g>
<!-- Message&#45;&gt;Snapshot -->
<g id="edge51" class="edge">
<title>Message&#45;&gt;Snapshot</title>
<path fill="none" stroke="#666666" d="M1838.37,-668.13C1841.46,-674.04 1844.35,-680.01 1847,-686 1888.37,-779.4 1843.65,-818.74 1883,-913 1912.23,-983.01 1965.19,-1051.64 2006.39,-1097.17"/>
<polygon fill="#666666" stroke="#666666" points="2003.82,-1099.54 2013.15,-1104.55 2008.98,-1094.82 2003.82,-1099.54"/>
</g>
<!-- Message&#45;&gt;Entry -->
<g id="edge35" class="edge">
<title>Message&#45;&gt;Entry</title>
<path fill="none" stroke="#666666" d="M1839.93,-668.09C1842.31,-671.08 1844.66,-674.05 1847,-677 1863.13,-697.34 1862.77,-706.73 1883,-723 2000.98,-817.89 2159.3,-888.82 2274.17,-932.42"/>
<polygon fill="#666666" stroke="#666666" points="2273.16,-935.78 2283.75,-936.03 2275.63,-929.23 2273.16,-935.78"/>
</g>
<!-- MessageType -->
<g id="node36" class="node">
<title>MessageType</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1973,-254C1973,-254 2158,-254 2158,-254 2164,-254 2170,-260 2170,-266 2170,-266 2170,-702 2170,-702 2170,-708 2164,-714 2158,-714 2158,-714 1973,-714 1973,-714 1967,-714 1961,-708 1961,-702 1961,-702 1961,-266 1961,-266 1961,-260 1967,-254 1973,-254"/>
<text text-anchor="middle" x="2065.5" y="-698.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MessageType</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-691 2170,-691 "/>
<text text-anchor="start" x="1969" y="-675.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgHup = 0</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-668 2170,-668 "/>
<text text-anchor="start" x="1969" y="-652.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgBeat = 1</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-645 2170,-645 "/>
<text text-anchor="start" x="1969" y="-629.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgPropose = 2</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-622 2170,-622 "/>
<text text-anchor="start" x="1969" y="-606.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgAppend = 3</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-599 2170,-599 "/>
<text text-anchor="start" x="1969" y="-583.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgAppendResponse = 4</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-576 2170,-576 "/>
<text text-anchor="start" x="1969" y="-560.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgRequestVote = 5</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-553 2170,-553 "/>
<text text-anchor="start" x="1969" y="-537.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgRequestVoteResponse = 6</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-530 2170,-530 "/>
<text text-anchor="start" x="1969" y="-514.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgSnapshot = 7</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-507 2170,-507 "/>
<text text-anchor="start" x="1969" y="-491.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgHeartbeat = 8</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-484 2170,-484 "/>
<text text-anchor="start" x="1969" y="-468.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgHeartbeatResponse = 9</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-461 2170,-461 "/>
<text text-anchor="start" x="1969" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgUnreachable = 10</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-438 2170,-438 "/>
<text text-anchor="start" x="1969" y="-422.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgSnapStatus = 11</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-415 2170,-415 "/>
<text text-anchor="start" x="1969" y="-399.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgCheckQuorum = 12</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-392 2170,-392 "/>
<text text-anchor="start" x="1969" y="-376.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgTransferLeader = 13</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-369 2170,-369 "/>
<text text-anchor="start" x="1969" y="-353.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgTimeoutNow = 14</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-346 2170,-346 "/>
<text text-anchor="start" x="1969" y="-330.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgReadIndex = 15</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-323 2170,-323 "/>
<text text-anchor="start" x="1969" y="-307.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgReadIndexResp = 16</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-300 2170,-300 "/>
<text text-anchor="start" x="1969" y="-284.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgRequestPreVote = 17</text>
<polyline fill="none" stroke="#60b5ac" points="1961,-277 2170,-277 "/>
<text text-anchor="start" x="1969" y="-261.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MsgRequestPreVoteResponse = 18</text>
</g>
<!-- Message&#45;&gt;MessageType -->
<g id="edge52" class="edge">
<title>Message&#45;&gt;MessageType</title>
<path fill="none" stroke="#666666" d="M1847.01,-484C1881.76,-484 1918.02,-484 1950.73,-484"/>
<polygon fill="#666666" stroke="#666666" points="1950.77,-487.5 1960.77,-484 1950.77,-480.5 1950.77,-487.5"/>
</g>
<!-- MemStorageCore -->
<g id="node34" class="node">
<title>MemStorageCore</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1963.5,-1546C1963.5,-1546 2167.5,-1546 2167.5,-1546 2173.5,-1546 2179.5,-1552 2179.5,-1558 2179.5,-1558 2179.5,-1626 2179.5,-1626 2179.5,-1632 2173.5,-1638 2167.5,-1638 2167.5,-1638 1963.5,-1638 1963.5,-1638 1957.5,-1638 1951.5,-1632 1951.5,-1626 1951.5,-1626 1951.5,-1558 1951.5,-1558 1951.5,-1552 1957.5,-1546 1963.5,-1546"/>
<text text-anchor="middle" x="2065.5" y="-1622.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">MemStorageCore</text>
<polyline fill="none" stroke="#60b5ac" points="1951.5,-1615 2179.5,-1615 "/>
<text text-anchor="start" x="1959.5" y="-1599.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">raft_state: RaftState</text>
<polyline fill="none" stroke="#60b5ac" points="1951.5,-1592 2179.5,-1592 "/>
<polyline fill="none" stroke="#60b5ac" points="1951.5,-1592 2179.5,-1592 "/>
<text text-anchor="start" x="1959.5" y="-1576.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">snapshot_metadata: SnapshotMetadata</text>
<polyline fill="none" stroke="#60b5ac" points="1951.5,-1569 2179.5,-1569 "/>
<text text-anchor="start" x="1959.5" y="-1553.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">trigger_snap_unavailable: boo</text>
</g>
<!-- MemStorage&#45;&gt;MemStorageCore -->
<g id="edge44" class="edge">
<title>MemStorage&#45;&gt;MemStorageCore</title>
<path fill="none" stroke="#666666" d="M1813.2,-1600.1C1854.2,-1598.77 1900.02,-1597.3 1941.19,-1595.97"/>
<polygon fill="#666666" stroke="#666666" points="1941.39,-1599.47 1951.27,-1595.65 1941.16,-1592.47 1941.39,-1599.47"/>
</g>
<!-- ProgressMap -->
<g id="node24" class="node">
<title>ProgressMap</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M834.5,-1369C834.5,-1369 1014.5,-1369 1014.5,-1369 1020.5,-1369 1026.5,-1375 1026.5,-1381 1026.5,-1381 1026.5,-1441 1026.5,-1441 1026.5,-1447 1020.5,-1453 1014.5,-1453 1014.5,-1453 834.5,-1453 834.5,-1453 828.5,-1453 822.5,-1447 822.5,-1441 822.5,-1441 822.5,-1381 822.5,-1381 822.5,-1375 828.5,-1369 834.5,-1369"/>
<text text-anchor="middle" x="924.5" y="-1437.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ProgressMap</text>
<polyline fill="none" stroke="#60b5ac" points="822.5,-1430 1026.5,-1430 "/>
<text text-anchor="start" x="830.5" y="-1414.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">记录cluster中所有memeber信息</text>
<text text-anchor="start" x="830.5" y="-1399.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> key为peer id</text>
<polyline fill="none" stroke="#60b5ac" points="822.5,-1392 1026.5,-1392 "/>
<text text-anchor="start" x="830.5" y="-1376.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">HashMap&lt;u64, Progress&gt;</text>
</g>
<!-- ProgressTracker&#45;&gt;ProgressMap -->
<g id="edge27" class="edge">
<title>ProgressTracker&#45;&gt;ProgressMap</title>
<path fill="none" stroke="#666666" d="M673.86,-1392.54C716.14,-1395.66 767.22,-1399.44 812.12,-1402.76"/>
<polygon fill="#666666" stroke="#666666" points="811.97,-1406.26 822.2,-1403.51 812.49,-1399.28 811.97,-1406.26"/>
</g>
<!-- Configuration -->
<g id="node25" class="node">
<title>Configuration</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M817.5,-1166.5C817.5,-1166.5 1031.5,-1166.5 1031.5,-1166.5 1037.5,-1166.5 1043.5,-1172.5 1043.5,-1178.5 1043.5,-1178.5 1043.5,-1337.5 1043.5,-1337.5 1043.5,-1343.5 1037.5,-1349.5 1031.5,-1349.5 1031.5,-1349.5 817.5,-1349.5 817.5,-1349.5 811.5,-1349.5 805.5,-1343.5 805.5,-1337.5 805.5,-1337.5 805.5,-1178.5 805.5,-1178.5 805.5,-1172.5 811.5,-1166.5 817.5,-1166.5"/>
<text text-anchor="middle" x="924.5" y="-1334.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Configuration</text>
<polyline fill="none" stroke="#60b5ac" points="805.5,-1326.5 1043.5,-1326.5 "/>
<text text-anchor="start" x="813.5" y="-1311.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">记录raft中的成员信息</text>
<text text-anchor="start" x="813.5" y="-1296.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 其中最重要是voters用来</text>
<text text-anchor="start" x="813.5" y="-1281.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 统计voter_resutls</text>
<text text-anchor="start" x="813.5" y="-1266.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 和计算committed_index</text>
<polyline fill="none" stroke="#60b5ac" points="805.5,-1258.5 1043.5,-1258.5 "/>
<text text-anchor="start" x="813.5" y="-1243.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) voters: JointConfig</text>
<polyline fill="none" stroke="#60b5ac" points="805.5,-1235.5 1043.5,-1235.5 "/>
<text text-anchor="start" x="813.5" y="-1220.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) learners: HashSet&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="805.5,-1212.5 1043.5,-1212.5 "/>
<text text-anchor="start" x="813.5" y="-1197.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) learners_next: HashSet&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="805.5,-1189.5 1043.5,-1189.5 "/>
<text text-anchor="start" x="813.5" y="-1174.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) auto_leave: bool</text>
</g>
<!-- ProgressTracker&#45;&gt;Configuration -->
<g id="edge28" class="edge">
<title>ProgressTracker&#45;&gt;Configuration</title>
<path fill="none" stroke="#666666" d="M673.86,-1352.54C711.15,-1338.41 755.29,-1321.7 796,-1306.29"/>
<polygon fill="#666666" stroke="#666666" points="797.33,-1309.52 805.44,-1302.71 794.85,-1302.98 797.33,-1309.52"/>
</g>
<!-- ReadState -->
<g id="node11" class="node">
<title>ReadState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1255.5,-437C1255.5,-437 1392.5,-437 1392.5,-437 1398.5,-437 1404.5,-443 1404.5,-449 1404.5,-449 1404.5,-517 1404.5,-517 1404.5,-523 1398.5,-529 1392.5,-529 1392.5,-529 1255.5,-529 1255.5,-529 1249.5,-529 1243.5,-523 1243.5,-517 1243.5,-517 1243.5,-449 1243.5,-449 1243.5,-443 1249.5,-437 1255.5,-437"/>
<text text-anchor="middle" x="1324" y="-513.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadState</text>
<polyline fill="none" stroke="#60b5ac" points="1243.5,-506 1404.5,-506 "/>
<text text-anchor="start" x="1251.5" y="-490.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">用于readIndex</text>
<polyline fill="none" stroke="#60b5ac" points="1243.5,-483 1404.5,-483 "/>
<text text-anchor="start" x="1251.5" y="-467.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub index: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1243.5,-460 1404.5,-460 "/>
<text text-anchor="start" x="1251.5" y="-444.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub request_ctx: Vec&lt;u8&gt;</text>
</g>
<!-- RaftCore&#45;&gt;ReadState -->
<g id="edge12" class="edge">
<title>RaftCore&#45;&gt;ReadState</title>
<path fill="none" stroke="#666666" d="M669.51,-619.1C687.53,-590.51 709.42,-564.67 736,-544 880.22,-431.87 1108.29,-446.34 1233.45,-465.46"/>
<polygon fill="#666666" stroke="#666666" points="1232.97,-468.92 1243.39,-467.02 1234.05,-462.01 1232.97,-468.92"/>
</g>
<!-- RaftLog -->
<g id="node12" class="node">
<title>RaftLog</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M866,-1009C866,-1009 983,-1009 983,-1009 989,-1009 995,-1015 995,-1021 995,-1021 995,-1135 995,-1135 995,-1141 989,-1147 983,-1147 983,-1147 866,-1147 866,-1147 860,-1147 854,-1141 854,-1135 854,-1135 854,-1021 854,-1021 854,-1015 860,-1009 866,-1009"/>
<text text-anchor="middle" x="924.5" y="-1131.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftLog&lt;T: Storage&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="854,-1124 995,-1124 "/>
<text text-anchor="start" x="862" y="-1108.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub store: T</text>
<polyline fill="none" stroke="#60b5ac" points="854,-1101 995,-1101 "/>
<text text-anchor="start" x="862" y="-1085.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub unstable: Unstable</text>
<polyline fill="none" stroke="#60b5ac" points="854,-1078 995,-1078 "/>
<text text-anchor="start" x="862" y="-1062.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub committed: u64</text>
<polyline fill="none" stroke="#60b5ac" points="854,-1055 995,-1055 "/>
<text text-anchor="start" x="862" y="-1039.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub persisted: u64</text>
<polyline fill="none" stroke="#60b5ac" points="854,-1032 995,-1032 "/>
<text text-anchor="start" x="862" y="-1016.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub applied: u64</text>
</g>
<!-- RaftCore&#45;&gt;RaftLog -->
<g id="edge13" class="edge">
<title>RaftCore&#45;&gt;RaftLog</title>
<path fill="none" stroke="#666666" d="M700.4,-995.49C747.73,-1013 801.39,-1032.84 844.22,-1048.68"/>
<polygon fill="#666666" stroke="#666666" points="843.15,-1052.02 853.74,-1052.2 845.57,-1045.45 843.15,-1052.02"/>
</g>
<!-- RaftCore&#45;&gt;StateRole -->
<g id="edge14" class="edge">
<title>RaftCore&#45;&gt;StateRole</title>
<path fill="none" stroke="#666666" d="M700.18,-753.99C711.32,-742.55 723.26,-732.05 736,-723 890.2,-613.41 965.12,-664.47 1149,-620 1304.29,-582.45 1390.99,-655.72 1499,-538 1574.3,-455.93 1467.29,-378.43 1535,-290 1555.02,-263.85 1587.32,-247.75 1617.27,-237.91"/>
<polygon fill="#666666" stroke="#666666" points="1618.37,-241.24 1626.89,-234.93 1616.3,-234.55 1618.37,-241.24"/>
</g>
<!-- ReadOnly -->
<g id="node14" class="node">
<title>ReadOnly</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M748,-733C748,-733 1101,-733 1101,-733 1107,-733 1113,-739 1113,-745 1113,-745 1113,-813 1113,-813 1113,-819 1107,-825 1101,-825 1101,-825 748,-825 748,-825 742,-825 736,-819 736,-813 736,-813 736,-745 736,-745 736,-739 742,-733 748,-733"/>
<text text-anchor="middle" x="924.5" y="-809.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadOnly</text>
<polyline fill="none" stroke="#60b5ac" points="736,-802 1113,-802 "/>
<text text-anchor="start" x="744" y="-786.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub option: ReadOnlyOption</text>
<polyline fill="none" stroke="#60b5ac" points="736,-779 1113,-779 "/>
<text text-anchor="start" x="744" y="-763.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pending_read_index: HashMap&lt;Vec&lt;u8&gt;, ReadIndexStatus&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="736,-756 1113,-756 "/>
<text text-anchor="start" x="744" y="-740.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub read_index_queue: VecDeque&lt;Vec&lt;u8&gt;&gt;</text>
</g>
<!-- RaftCore&#45;&gt;ReadOnly -->
<g id="edge15" class="edge">
<title>RaftCore&#45;&gt;ReadOnly</title>
<path fill="none" stroke="#666666" d="M700,-875.25C711.98,-868.09 724.11,-861.2 736,-855 753.31,-845.96 771.95,-837.26 790.52,-829.18"/>
<polygon fill="#666666" stroke="#666666" points="792.12,-832.31 799.92,-825.14 789.35,-825.88 792.12,-832.31"/>
</g>
<!-- UncommittedState -->
<g id="node15" class="node">
<title>UncommittedState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M845,-898C845,-898 1004,-898 1004,-898 1010,-898 1016,-904 1016,-910 1016,-910 1016,-978 1016,-978 1016,-984 1010,-990 1004,-990 1004,-990 845,-990 845,-990 839,-990 833,-984 833,-978 833,-978 833,-910 833,-910 833,-904 839,-898 845,-898"/>
<text text-anchor="middle" x="924.5" y="-974.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">UncommittedState</text>
<polyline fill="none" stroke="#60b5ac" points="833,-967 1016,-967 "/>
<text text-anchor="start" x="841" y="-951.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">max_uncommitted_size: usize</text>
<polyline fill="none" stroke="#60b5ac" points="833,-944 1016,-944 "/>
<text text-anchor="start" x="841" y="-928.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">uncommitted_size: usize</text>
<polyline fill="none" stroke="#60b5ac" points="833,-921 1016,-921 "/>
<text text-anchor="start" x="841" y="-905.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">last_log_tail_index: u64</text>
</g>
<!-- RaftCore&#45;&gt;UncommittedState -->
<g id="edge16" class="edge">
<title>RaftCore&#45;&gt;UncommittedState</title>
<path fill="none" stroke="#666666" d="M700.4,-949.94C740.11,-948.88 784.26,-947.71 822.75,-946.68"/>
<polygon fill="#666666" stroke="#666666" points="823.02,-950.18 832.92,-946.41 822.83,-943.18 823.02,-950.18"/>
</g>
<!-- Logger -->
<g id="node16" class="node">
<title>Logger</title>
<path fill="none" stroke="#1c2123" d="M1707,-1048C1707,-1048 1675,-1048 1675,-1048 1669,-1048 1663,-1042 1663,-1036 1663,-1036 1663,-1024 1663,-1024 1663,-1018 1669,-1012 1675,-1012 1675,-1012 1707,-1012 1707,-1012 1713,-1012 1719,-1018 1719,-1024 1719,-1024 1719,-1036 1719,-1036 1719,-1042 1713,-1048 1707,-1048"/>
<text text-anchor="middle" x="1691" y="-1026.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Logger</text>
</g>
<!-- RaftCore&#45;&gt;Logger -->
<g id="edge17" class="edge">
<title>RaftCore&#45;&gt;Logger</title>
<path fill="none" stroke="#666666" d="M700.22,-897.89C712.09,-893.88 724.15,-890.45 736,-888 902.25,-853.63 1360.42,-827.94 1499,-926 1529.84,-947.82 1504.99,-980.05 1535,-1003 1568.82,-1028.87 1618.92,-1033.24 1652.94,-1032.71"/>
<polygon fill="#666666" stroke="#666666" points="1653.05,-1036.21 1662.94,-1032.41 1652.84,-1029.21 1653.05,-1036.21"/>
</g>
<!-- RaftLog&#45;&gt;Storage -->
<g id="edge18" class="edge">
<title>RaftLog&#45;&gt;Storage</title>
<path fill="none" stroke="#666666" d="M995.46,-1089.18C1036.45,-1099.56 1085.44,-1119.39 1113,-1157 1214.86,-1295.97 1056.49,-1397.64 1149,-1543 1149.34,-1543.53 1149.68,-1544.06 1150.02,-1544.59"/>
<polygon fill="#666666" stroke="#666666" points="1147.29,-1546.78 1155.94,-1552.9 1152.99,-1542.72 1147.29,-1546.78"/>
</g>
<!-- Unstable -->
<g id="node17" class="node">
<title>Unstable</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1236.5,-936C1236.5,-936 1411.5,-936 1411.5,-936 1417.5,-936 1423.5,-942 1423.5,-948 1423.5,-948 1423.5,-1062 1423.5,-1062 1423.5,-1068 1417.5,-1074 1411.5,-1074 1411.5,-1074 1236.5,-1074 1236.5,-1074 1230.5,-1074 1224.5,-1068 1224.5,-1062 1224.5,-1062 1224.5,-948 1224.5,-948 1224.5,-942 1230.5,-936 1236.5,-936"/>
<text text-anchor="middle" x="1324" y="-1058.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Unstable</text>
<polyline fill="none" stroke="#60b5ac" points="1224.5,-1051 1423.5,-1051 "/>
<text text-anchor="start" x="1232.5" y="-1035.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">在内存中存储RaftLog</text>
<polyline fill="none" stroke="#60b5ac" points="1224.5,-1028 1423.5,-1028 "/>
<text text-anchor="start" x="1232.5" y="-1012.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub snapshot: Option&lt;Snapshot&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1224.5,-1005 1423.5,-1005 "/>
<text text-anchor="start" x="1232.5" y="-989.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub entries: Vec&lt;Entry&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1224.5,-982 1423.5,-982 "/>
<text text-anchor="start" x="1232.5" y="-966.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub offset: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1224.5,-959 1423.5,-959 "/>
<text text-anchor="start" x="1232.5" y="-943.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub logger: Logge</text>
</g>
<!-- RaftLog&#45;&gt;Unstable -->
<g id="edge19" class="edge">
<title>RaftLog&#45;&gt;Unstable</title>
<path fill="none" stroke="#666666" d="M995.19,-1065.2C1055.68,-1054.09 1144.25,-1037.83 1214.09,-1025"/>
<polygon fill="#666666" stroke="#666666" points="1215.05,-1028.38 1224.25,-1023.14 1213.78,-1021.5 1215.05,-1028.38"/>
</g>
<!-- ReadOnlyOption -->
<g id="node22" class="node">
<title>ReadOnlyOption</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1281.5,-744.5C1281.5,-744.5 1366.5,-744.5 1366.5,-744.5 1372.5,-744.5 1378.5,-750.5 1378.5,-756.5 1378.5,-756.5 1378.5,-801.5 1378.5,-801.5 1378.5,-807.5 1372.5,-813.5 1366.5,-813.5 1366.5,-813.5 1281.5,-813.5 1281.5,-813.5 1275.5,-813.5 1269.5,-807.5 1269.5,-801.5 1269.5,-801.5 1269.5,-756.5 1269.5,-756.5 1269.5,-750.5 1275.5,-744.5 1281.5,-744.5"/>
<text text-anchor="middle" x="1324" y="-798.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadOnlyOption</text>
<polyline fill="none" stroke="#60b5ac" points="1269.5,-790.5 1378.5,-790.5 "/>
<text text-anchor="start" x="1277.5" y="-775.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Safe</text>
<polyline fill="none" stroke="#60b5ac" points="1269.5,-767.5 1378.5,-767.5 "/>
<text text-anchor="start" x="1277.5" y="-752.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">LeaseBased</text>
</g>
<!-- ReadOnly&#45;&gt;ReadOnlyOption -->
<g id="edge25" class="edge">
<title>ReadOnly&#45;&gt;ReadOnlyOption</title>
<path fill="none" stroke="#666666" d="M1113.19,-779C1165.71,-779 1219.26,-779 1259.11,-779"/>
<polygon fill="#666666" stroke="#666666" points="1259.2,-782.5 1269.2,-779 1259.2,-775.5 1259.2,-782.5"/>
</g>
<!-- ReadIndexStatus -->
<g id="node23" class="node">
<title>ReadIndexStatus</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1259,-630C1259,-630 1389,-630 1389,-630 1395,-630 1401,-636 1401,-642 1401,-642 1401,-710 1401,-710 1401,-716 1395,-722 1389,-722 1389,-722 1259,-722 1259,-722 1253,-722 1247,-716 1247,-710 1247,-710 1247,-642 1247,-642 1247,-636 1253,-630 1259,-630"/>
<text text-anchor="middle" x="1324" y="-706.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadIndexStatus</text>
<polyline fill="none" stroke="#60b5ac" points="1247,-699 1401,-699 "/>
<text text-anchor="start" x="1255" y="-683.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub req: Message</text>
<polyline fill="none" stroke="#60b5ac" points="1247,-676 1401,-676 "/>
<text text-anchor="start" x="1255" y="-660.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub index: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1247,-653 1401,-653 "/>
<text text-anchor="start" x="1255" y="-637.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub acks: HashSet&lt;u64&gt;</text>
</g>
<!-- ReadOnly&#45;&gt;ReadIndexStatus -->
<g id="edge26" class="edge">
<title>ReadOnly&#45;&gt;ReadIndexStatus</title>
<path fill="none" stroke="#666666" d="M1103.03,-733C1149.57,-720.94 1197.67,-708.48 1236.98,-698.29"/>
<polygon fill="#666666" stroke="#666666" points="1237.98,-701.65 1246.78,-695.75 1236.22,-694.87 1237.98,-701.65"/>
</g>
<!-- Unstable&#45;&gt;Logger -->
<g id="edge20" class="edge">
<title>Unstable&#45;&gt;Logger</title>
<path fill="none" stroke="#666666" d="M1423.77,-1011.77C1499.38,-1016.94 1599.47,-1023.8 1652.8,-1027.45"/>
<polygon fill="#666666" stroke="#666666" points="1652.61,-1030.95 1662.82,-1028.14 1653.09,-1023.96 1652.61,-1030.95"/>
</g>
<!-- Unstable&#45;&gt;Snapshot -->
<g id="edge21" class="edge">
<title>Unstable&#45;&gt;Snapshot</title>
<path fill="none" stroke="#666666" d="M1423.56,-1051.29C1458.12,-1065.79 1497.65,-1080.48 1535,-1090 1597.31,-1105.89 1748.04,-1122.5 1872.81,-1134.38"/>
<polygon fill="#666666" stroke="#666666" points="1872.6,-1137.87 1882.88,-1135.33 1873.26,-1130.9 1872.6,-1137.87"/>
</g>
<!-- Unstable&#45;&gt;Entry -->
<g id="edge22" class="edge">
<title>Unstable&#45;&gt;Entry</title>
<path fill="none" stroke="#666666" d="M1423.69,-1034.67C1458.52,-1043.75 1498.18,-1052.51 1535,-1057 1793.95,-1088.58 2097.01,-1046.57 2274.02,-1014.13"/>
<polygon fill="#666666" stroke="#666666" points="2274.73,-1017.56 2283.93,-1012.3 2273.46,-1010.68 2274.73,-1017.56"/>
</g>
<!-- SnapshotMetadata -->
<g id="node20" class="node">
<title>SnapshotMetadata</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M2378.5,-1446C2378.5,-1446 2471.5,-1446 2471.5,-1446 2477.5,-1446 2483.5,-1452 2483.5,-1458 2483.5,-1458 2483.5,-1526 2483.5,-1526 2483.5,-1532 2477.5,-1538 2471.5,-1538 2471.5,-1538 2378.5,-1538 2378.5,-1538 2372.5,-1538 2366.5,-1532 2366.5,-1526 2366.5,-1526 2366.5,-1458 2366.5,-1458 2366.5,-1452 2372.5,-1446 2378.5,-1446"/>
<text text-anchor="middle" x="2425" y="-1522.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">SnapshotMetadata</text>
<polyline fill="none" stroke="#60b5ac" points="2366.5,-1515 2483.5,-1515 "/>
<text text-anchor="middle" x="2425" y="-1499.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub conf_state</text>
<polyline fill="none" stroke="#60b5ac" points="2366.5,-1492 2483.5,-1492 "/>
<text text-anchor="start" x="2374.5" y="-1476.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub index: u64</text>
<polyline fill="none" stroke="#60b5ac" points="2366.5,-1469 2483.5,-1469 "/>
<text text-anchor="start" x="2374.5" y="-1453.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub term: u64</text>
</g>
<!-- Snapshot&#45;&gt;SnapshotMetadata -->
<g id="edge23" class="edge">
<title>Snapshot&#45;&gt;SnapshotMetadata</title>
<path fill="none" stroke="#666666" d="M2115.09,-1197.34C2181.03,-1260.24 2298.59,-1372.38 2368.12,-1438.7"/>
<polygon fill="#666666" stroke="#666666" points="2365.87,-1441.39 2375.52,-1445.76 2370.7,-1436.32 2365.87,-1441.39"/>
</g>
<!-- EntryType -->
<g id="node35" class="node">
<title>EntryType</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M2662,-937C2662,-937 2792,-937 2792,-937 2798,-937 2804,-943 2804,-949 2804,-949 2804,-1017 2804,-1017 2804,-1023 2798,-1029 2792,-1029 2792,-1029 2662,-1029 2662,-1029 2656,-1029 2650,-1023 2650,-1017 2650,-1017 2650,-949 2650,-949 2650,-943 2656,-937 2662,-937"/>
<text text-anchor="middle" x="2727" y="-1013.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">EntryType</text>
<polyline fill="none" stroke="#60b5ac" points="2650,-1006 2804,-1006 "/>
<text text-anchor="start" x="2658" y="-990.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">EntryNormal = 0</text>
<polyline fill="none" stroke="#60b5ac" points="2650,-983 2804,-983 "/>
<text text-anchor="start" x="2658" y="-967.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">EntryConfChange = 1</text>
<polyline fill="none" stroke="#60b5ac" points="2650,-960 2804,-960 "/>
<text text-anchor="start" x="2658" y="-944.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">EntryConfChangeV2 = 2</text>
</g>
<!-- Entry&#45;&gt;EntryType -->
<g id="edge50" class="edge">
<title>Entry&#45;&gt;EntryType</title>
<path fill="none" stroke="#666666" d="M2566.34,-983C2591.44,-983 2616.91,-983 2639.92,-983"/>
<polygon fill="#666666" stroke="#666666" points="2639.96,-986.5 2649.96,-983 2639.96,-979.5 2639.96,-986.5"/>
</g>
<!-- ConfState -->
<g id="node21" class="node">
<title>ConfState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M2614,-1473C2614,-1473 2840,-1473 2840,-1473 2846,-1473 2852,-1479 2852,-1485 2852,-1485 2852,-1599 2852,-1599 2852,-1605 2846,-1611 2840,-1611 2840,-1611 2614,-1611 2614,-1611 2608,-1611 2602,-1605 2602,-1599 2602,-1599 2602,-1485 2602,-1485 2602,-1479 2608,-1473 2614,-1473"/>
<text text-anchor="middle" x="2727" y="-1595.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ConfState</text>
<polyline fill="none" stroke="#60b5ac" points="2602,-1588 2852,-1588 "/>
<text text-anchor="start" x="2610" y="-1572.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub voters: ::std::vec::Vec&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="2602,-1565 2852,-1565 "/>
<text text-anchor="start" x="2610" y="-1549.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub learners: ::std::vec::Vec&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="2602,-1542 2852,-1542 "/>
<text text-anchor="start" x="2610" y="-1526.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub voters_outgoing: ::std::vec::Vec&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="2602,-1519 2852,-1519 "/>
<text text-anchor="start" x="2610" y="-1503.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub learners_next: ::std::vec::Vec&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="2602,-1496 2852,-1496 "/>
<text text-anchor="start" x="2610" y="-1480.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub auto_leave: bool</text>
</g>
<!-- SnapshotMetadata&#45;&gt;ConfState -->
<g id="edge24" class="edge">
<title>SnapshotMetadata&#45;&gt;ConfState</title>
<path fill="none" stroke="#666666" d="M2483.84,-1501.64C2514.63,-1506.77 2553.88,-1513.31 2591.78,-1519.63"/>
<polygon fill="#666666" stroke="#666666" points="2591.45,-1523.12 2601.89,-1521.32 2592.61,-1516.22 2591.45,-1523.12"/>
</g>
<!-- Safe -->
<g id="node31" class="node">
<title>Safe</title>
<path fill="#feed9b" stroke="#f7e495" d="M1624,-872.5C1624,-872.5 1758,-872.5 1758,-872.5 1764,-872.5 1770,-878.5 1770,-884.5 1770,-884.5 1770,-981.5 1770,-981.5 1770,-987.5 1764,-993.5 1758,-993.5 1758,-993.5 1624,-993.5 1624,-993.5 1618,-993.5 1612,-987.5 1612,-981.5 1612,-981.5 1612,-884.5 1612,-884.5 1612,-878.5 1618,-872.5 1624,-872.5"/>
<text text-anchor="middle" x="1691" y="-978.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Safe</text>
<polyline fill="none" stroke="#f7e495" points="1612,-970.5 1770,-970.5 "/>
<text text-anchor="start" x="1620" y="-955.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Safe guarantees the </text>
<text text-anchor="start" x="1620" y="-940.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> linearizability of the</text>
<text text-anchor="start" x="1620" y="-925.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> read only request by</text>
<text text-anchor="start" x="1620" y="-910.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> communicating with the </text>
<text text-anchor="start" x="1620" y="-895.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> quorum. It is the default</text>
<text text-anchor="start" x="1620" y="-880.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> and suggested option.</text>
</g>
<!-- ReadOnlyOption&#45;&gt;Safe -->
<g id="edge38" class="edge">
<title>ReadOnlyOption&#45;&gt;Safe</title>
<path fill="none" stroke="#666666" d="M1378.86,-801.72C1437.78,-826.59 1533.12,-866.81 1602.75,-896.19"/>
<polygon fill="#666666" stroke="#666666" points="1601.39,-899.41 1611.97,-900.08 1604.11,-892.96 1601.39,-899.41"/>
</g>
<!-- LeaseBased -->
<g id="node32" class="node">
<title>LeaseBased</title>
<path fill="#feed9b" stroke="#f7e495" d="M1577,-687C1577,-687 1805,-687 1805,-687 1811,-687 1817,-693 1817,-699 1817,-699 1817,-841 1817,-841 1817,-847 1811,-853 1805,-853 1805,-853 1577,-853 1577,-853 1571,-853 1565,-847 1565,-841 1565,-841 1565,-699 1565,-699 1565,-693 1571,-687 1577,-687"/>
<text text-anchor="middle" x="1691" y="-837.8" font-family="Times,serif" font-size="14.00" fill="#40575d">LeaseBased</text>
<polyline fill="none" stroke="#f7e495" points="1565,-830 1817,-830 "/>
<text text-anchor="start" x="1573" y="-814.8" font-family="Times,serif" font-size="14.00" fill="#40575d">LeaseBased ensures linearizability</text>
<text text-anchor="start" x="1573" y="-799.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> of the read only request by</text>
<text text-anchor="start" x="1573" y="-784.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> relying on the leader lease.</text>
<text text-anchor="start" x="1573" y="-769.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> It can be affected by clock drift.</text>
<text text-anchor="start" x="1573" y="-754.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> If the clock drift is unbounded,</text>
<text text-anchor="start" x="1573" y="-739.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> leader might keep the lease longer than it</text>
<text text-anchor="start" x="1573" y="-724.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> should (clock can move backward/pause</text>
<text text-anchor="start" x="1573" y="-709.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> without any bound). ReadIndex is not safe</text>
<text text-anchor="start" x="1573" y="-694.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> in that case.</text>
</g>
<!-- ReadOnlyOption&#45;&gt;LeaseBased -->
<g id="edge39" class="edge">
<title>ReadOnlyOption&#45;&gt;LeaseBased</title>
<path fill="none" stroke="#666666" d="M1378.86,-777.67C1425.07,-776.53 1493.67,-774.84 1554.7,-773.34"/>
<polygon fill="#666666" stroke="#666666" points="1554.91,-776.83 1564.82,-773.09 1554.74,-769.83 1554.91,-776.83"/>
</g>
<!-- ReadIndexStatus&#45;&gt;Message -->
<g id="edge40" class="edge">
<title>ReadIndexStatus&#45;&gt;Message</title>
<path fill="none" stroke="#666666" d="M1401.08,-651.26C1432.11,-640.12 1467.94,-625.89 1499,-610 1507.98,-605.41 1517.05,-600.49 1526.12,-595.35"/>
<polygon fill="#666666" stroke="#666666" points="1527.88,-598.37 1534.81,-590.36 1524.39,-592.3 1527.88,-598.37"/>
</g>
<!-- Progress -->
<g id="node26" class="node">
<title>Progress</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1162.5,-1280.5C1162.5,-1280.5 1485.5,-1280.5 1485.5,-1280.5 1491.5,-1280.5 1497.5,-1286.5 1497.5,-1292.5 1497.5,-1292.5 1497.5,-1521.5 1497.5,-1521.5 1497.5,-1527.5 1491.5,-1533.5 1485.5,-1533.5 1485.5,-1533.5 1162.5,-1533.5 1162.5,-1533.5 1156.5,-1533.5 1150.5,-1527.5 1150.5,-1521.5 1150.5,-1521.5 1150.5,-1292.5 1150.5,-1292.5 1150.5,-1286.5 1156.5,-1280.5 1162.5,-1280.5"/>
<text text-anchor="middle" x="1324" y="-1518.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Progress</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1510.5 1497.5,-1510.5 "/>
<text text-anchor="start" x="1158.5" y="-1495.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">用来跟踪peer一些重要信息</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1487.5 1497.5,-1487.5 "/>
<text text-anchor="start" x="1158.5" y="-1472.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub matched: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1464.5 1497.5,-1464.5 "/>
<text text-anchor="start" x="1158.5" y="-1449.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub next_idx: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1441.5 1497.5,-1441.5 "/>
<text text-anchor="start" x="1158.5" y="-1426.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub state: ProgressState</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1418.5 1497.5,-1418.5 "/>
<text text-anchor="start" x="1158.5" y="-1403.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub paused: bool</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1395.5 1497.5,-1395.5 "/>
<text text-anchor="start" x="1158.5" y="-1380.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pending_snapshot: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1372.5 1497.5,-1372.5 "/>
<text text-anchor="start" x="1158.5" y="-1357.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub pending_request_snapshot: u64, pub recent_active: bool</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1349.5 1497.5,-1349.5 "/>
<text text-anchor="start" x="1158.5" y="-1334.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub ins: Inflights</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1326.5 1497.5,-1326.5 "/>
<text text-anchor="start" x="1158.5" y="-1311.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub commit_group_id: u64</text>
<polyline fill="none" stroke="#60b5ac" points="1150.5,-1303.5 1497.5,-1303.5 "/>
<text text-anchor="start" x="1158.5" y="-1288.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub committed_index: u64</text>
</g>
<!-- ProgressMap&#45;&gt;Progress -->
<g id="edge29" class="edge">
<title>ProgressMap&#45;&gt;Progress</title>
<path fill="none" stroke="#666666" d="M1026.58,-1409.98C1061.1,-1409.64 1100.85,-1409.24 1139.81,-1408.84"/>
<polygon fill="#666666" stroke="#666666" points="1140.26,-1412.34 1150.23,-1408.74 1140.19,-1405.34 1140.26,-1412.34"/>
</g>
<!-- JointConfig -->
<g id="node27" class="node">
<title>JointConfig</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1224,-1093C1224,-1093 1424,-1093 1424,-1093 1430,-1093 1436,-1099 1436,-1105 1436,-1105 1436,-1249 1436,-1249 1436,-1255 1430,-1261 1424,-1261 1424,-1261 1224,-1261 1224,-1261 1218,-1261 1212,-1255 1212,-1249 1212,-1249 1212,-1105 1212,-1105 1212,-1099 1218,-1093 1224,-1093"/>
<text text-anchor="middle" x="1324" y="-1245.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">JoinConfig</text>
<polyline fill="none" stroke="#60b5ac" points="1212,-1238 1436,-1238 "/>
<text text-anchor="start" x="1220" y="-1222.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub struct Configuration </text>
<polyline fill="none" stroke="#60b5ac" points="1212,-1215 1436,-1215 "/>
<text text-anchor="start" x="1220" y="-1199.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">保留了新老配置, 会同时使用新老</text>
<text text-anchor="start" x="1220" y="-1184.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 配置来计算大多数</text>
<polyline fill="none" stroke="#60b5ac" points="1212,-1177 1436,-1177 "/>
<text text-anchor="start" x="1220" y="-1161.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">incoming: 新配置</text>
<text text-anchor="start" x="1220" y="-1146.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> outgoing: 旧配置</text>
<polyline fill="none" stroke="#60b5ac" points="1212,-1139 1436,-1139 "/>
<text text-anchor="start" x="1220" y="-1123.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) incoming: MajorityConfig</text>
<polyline fill="none" stroke="#60b5ac" points="1212,-1116 1436,-1116 "/>
<text text-anchor="start" x="1220" y="-1100.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub(crate) outgoing: MajorityConfig</text>
</g>
<!-- Configuration&#45;&gt;JointConfig -->
<g id="edge30" class="edge">
<title>Configuration&#45;&gt;JointConfig</title>
<path fill="none" stroke="#666666" d="M1043.69,-1233.92C1093.57,-1223.75 1151.6,-1211.93 1201.8,-1201.7"/>
<polygon fill="#666666" stroke="#666666" points="1202.64,-1205.1 1211.74,-1199.67 1201.24,-1198.24 1202.64,-1205.1"/>
</g>
<!-- ProgressState -->
<g id="node29" class="node">
<title>ProgressState</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1660,-1231C1660,-1231 1722,-1231 1722,-1231 1728,-1231 1734,-1237 1734,-1243 1734,-1243 1734,-1311 1734,-1311 1734,-1317 1728,-1323 1722,-1323 1722,-1323 1660,-1323 1660,-1323 1654,-1323 1648,-1317 1648,-1311 1648,-1311 1648,-1243 1648,-1243 1648,-1237 1654,-1231 1660,-1231"/>
<text text-anchor="middle" x="1691" y="-1307.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ProgressSate</text>
<polyline fill="none" stroke="#60b5ac" points="1648,-1300 1734,-1300 "/>
<text text-anchor="start" x="1656" y="-1284.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Probe</text>
<polyline fill="none" stroke="#60b5ac" points="1648,-1277 1734,-1277 "/>
<text text-anchor="start" x="1656" y="-1261.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Replicate</text>
<polyline fill="none" stroke="#60b5ac" points="1648,-1254 1734,-1254 "/>
<text text-anchor="start" x="1656" y="-1238.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Snapshot</text>
</g>
<!-- Progress&#45;&gt;ProgressState -->
<g id="edge32" class="edge">
<title>Progress&#45;&gt;ProgressState</title>
<path fill="none" stroke="#666666" d="M1497.61,-1345.52C1548.91,-1327.25 1601.25,-1308.61 1638.36,-1295.39"/>
<polygon fill="#666666" stroke="#666666" points="1639.69,-1298.64 1647.93,-1291.98 1637.34,-1292.04 1639.69,-1298.64"/>
</g>
<!-- Inflights -->
<g id="node30" class="node">
<title>Inflights</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1635.5,-1342C1635.5,-1342 1746.5,-1342 1746.5,-1342 1752.5,-1342 1758.5,-1348 1758.5,-1354 1758.5,-1354 1758.5,-1460 1758.5,-1460 1758.5,-1466 1752.5,-1472 1746.5,-1472 1746.5,-1472 1635.5,-1472 1635.5,-1472 1629.5,-1472 1623.5,-1466 1623.5,-1460 1623.5,-1460 1623.5,-1354 1623.5,-1354 1623.5,-1348 1629.5,-1342 1635.5,-1342"/>
<text text-anchor="middle" x="1691" y="-1456.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">Inflights</text>
<polyline fill="none" stroke="#60b5ac" points="1623.5,-1449 1758.5,-1449 "/>
<text text-anchor="start" x="1631.5" y="-1433.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">sliding window for</text>
<text text-anchor="middle" x="1691" y="-1418.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> the inflight messages</text>
<polyline fill="none" stroke="#60b5ac" points="1623.5,-1411 1758.5,-1411 "/>
<text text-anchor="start" x="1631.5" y="-1395.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">start: usize</text>
<polyline fill="none" stroke="#60b5ac" points="1623.5,-1388 1758.5,-1388 "/>
<text text-anchor="start" x="1631.5" y="-1372.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">count: usize</text>
<polyline fill="none" stroke="#60b5ac" points="1623.5,-1365 1758.5,-1365 "/>
<text text-anchor="start" x="1631.5" y="-1349.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">buffer: Vec&lt;u64&gt;</text>
</g>
<!-- Progress&#45;&gt;Inflights -->
<g id="edge33" class="edge">
<title>Progress&#45;&gt;Inflights</title>
<path fill="none" stroke="#666666" d="M1497.61,-1407C1538.06,-1407 1579.15,-1407 1612.92,-1407"/>
<polygon fill="#666666" stroke="#666666" points="1613.16,-1410.5 1623.16,-1407 1613.16,-1403.5 1613.16,-1410.5"/>
</g>
<!-- MajorityConfig -->
<g id="node28" class="node">
<title>MajorityConfig</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1626.5,-1142.5C1626.5,-1142.5 1755.5,-1142.5 1755.5,-1142.5 1761.5,-1142.5 1767.5,-1148.5 1767.5,-1154.5 1767.5,-1154.5 1767.5,-1199.5 1767.5,-1199.5 1767.5,-1205.5 1761.5,-1211.5 1755.5,-1211.5 1755.5,-1211.5 1626.5,-1211.5 1626.5,-1211.5 1620.5,-1211.5 1614.5,-1205.5 1614.5,-1199.5 1614.5,-1199.5 1614.5,-1154.5 1614.5,-1154.5 1614.5,-1148.5 1620.5,-1142.5 1626.5,-1142.5"/>
<text text-anchor="middle" x="1691" y="-1196.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">MajorityConfig</text>
<polyline fill="none" stroke="#60b5ac" points="1614.5,-1188.5 1767.5,-1188.5 "/>
<text text-anchor="start" x="1622.5" y="-1173.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">pub struct Configuration </text>
<polyline fill="none" stroke="#60b5ac" points="1614.5,-1165.5 1767.5,-1165.5 "/>
<text text-anchor="start" x="1622.5" y="-1150.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">voters: HashSet&lt;u64&gt;</text>
</g>
<!-- JointConfig&#45;&gt;MajorityConfig -->
<g id="edge31" class="edge">
<title>JointConfig&#45;&gt;MajorityConfig</title>
<path fill="none" stroke="#666666" d="M1436.5,-1177C1490.43,-1177 1554.17,-1177 1604.25,-1177"/>
<polygon fill="#666666" stroke="#666666" points="1604.39,-1180.5 1614.39,-1177 1604.39,-1173.5 1604.39,-1180.5"/>
</g>
<!-- RaftState&#45;&gt;HardState -->
<g id="edge48" class="edge">
<title>RaftState&#45;&gt;HardState</title>
<path fill="none" stroke="#666666" d="M2504.08,-1584.53C2527.52,-1578.3 2550.96,-1567.29 2566,-1548 2608.49,-1493.49 2595.1,-995.77 2602,-927 2632,-628.15 2689.65,-274.25 2714.32,-128.68"/>
<polygon fill="#666666" stroke="#666666" points="2717.82,-129.01 2716.04,-118.56 2710.92,-127.83 2717.82,-129.01"/>
</g>
<!-- RaftState&#45;&gt;ConfState -->
<g id="edge49" class="edge">
<title>RaftState&#45;&gt;ConfState</title>
<path fill="none" stroke="#666666" d="M2504.04,-1578.99C2530.87,-1574.52 2561.72,-1569.38 2591.72,-1564.38"/>
<polygon fill="#666666" stroke="#666666" points="2592.57,-1567.79 2601.86,-1562.69 2591.42,-1560.88 2592.57,-1567.79"/>
</g>
<!-- MemStorageCore&#45;&gt;Entry -->
<g id="edge45" class="edge">
<title>MemStorageCore&#45;&gt;Entry</title>
<path fill="none" stroke="#666666" d="M2179.89,-1571.82C2204.9,-1562.82 2229.44,-1549.81 2248,-1531 2255.98,-1522.92 2341.4,-1249.89 2390.24,-1092.34"/>
<polygon fill="#666666" stroke="#666666" points="2393.64,-1093.19 2393.26,-1082.6 2386.95,-1091.12 2393.64,-1093.19"/>
</g>
<!-- MemStorageCore&#45;&gt;SnapshotMetadata -->
<g id="edge46" class="edge">
<title>MemStorageCore&#45;&gt;SnapshotMetadata</title>
<path fill="none" stroke="#666666" d="M2179.62,-1560.36C2237.72,-1544.11 2306.58,-1524.85 2356.37,-1510.92"/>
<polygon fill="#666666" stroke="#666666" points="2357.38,-1514.27 2366.06,-1508.21 2355.49,-1507.53 2357.38,-1514.27"/>
</g>
<!-- MemStorageCore&#45;&gt;RaftState -->
<g id="edge47" class="edge">
<title>MemStorageCore&#45;&gt;RaftState</title>
<path fill="none" stroke="#666666" d="M2179.62,-1592C2230.02,-1592 2288.52,-1592 2335.64,-1592"/>
<polygon fill="#666666" stroke="#666666" points="2335.82,-1595.5 2345.82,-1592 2335.82,-1588.5 2335.82,-1595.5"/>
</g>
<!-- Ready -->
<g id="node37" class="node">
<title>Ready</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M836.5,-28.5C836.5,-28.5 1012.5,-28.5 1012.5,-28.5 1018.5,-28.5 1024.5,-34.5 1024.5,-40.5 1024.5,-40.5 1024.5,-291.5 1024.5,-291.5 1024.5,-297.5 1018.5,-303.5 1012.5,-303.5 1012.5,-303.5 836.5,-303.5 836.5,-303.5 830.5,-303.5 824.5,-297.5 824.5,-291.5 824.5,-291.5 824.5,-40.5 824.5,-40.5 824.5,-34.5 830.5,-28.5 836.5,-28.5"/>
<text text-anchor="middle" x="924.5" y="-288.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Ready</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-280.5 1024.5,-280.5 "/>
<text text-anchor="start" x="832.5" y="-265.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">上层应用调用ready</text>
<text text-anchor="start" x="832.5" y="-250.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 获取Ready struct</text>
<text text-anchor="start" x="832.5" y="-235.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 得到要发送的消息,snapshot等</text>
<text text-anchor="start" x="832.5" y="-220.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> number: u64</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-212.5 1024.5,-212.5 "/>
<text text-anchor="start" x="832.5" y="-197.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ss: Option&lt;SoftState&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-189.5 1024.5,-189.5 "/>
<text text-anchor="start" x="832.5" y="-174.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">hs: Option&lt;HardState&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-166.5 1024.5,-166.5 "/>
<text text-anchor="start" x="832.5" y="-151.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">read_states: Vec&lt;ReadState&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-143.5 1024.5,-143.5 "/>
<text text-anchor="start" x="832.5" y="-128.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">entries: Vec&lt;Entry&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-120.5 1024.5,-120.5 "/>
<text text-anchor="start" x="832.5" y="-105.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">snapshot: Snapshot</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-97.5 1024.5,-97.5 "/>
<text text-anchor="start" x="832.5" y="-82.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">light: LightReady</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-74.5 1024.5,-74.5 "/>
<text text-anchor="start" x="832.5" y="-59.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">must_sync: bool</text>
<polyline fill="none" stroke="#60b5ac" points="824.5,-51.5 1024.5,-51.5 "/>
<text text-anchor="middle" x="924.5" y="-36.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> </text>
</g>
<!-- Ready&#45;&gt;SoftState -->
<g id="edge53" class="edge">
<title>Ready&#45;&gt;SoftState</title>
<path fill="none" stroke="#b83b5e" d="M1024.67,-194.45C1063.41,-205.44 1108.23,-217.98 1149,-229 1178.1,-236.86 1210.02,-245.2 1238.48,-252.53"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1237.84,-255.98 1248.39,-255.08 1239.58,-249.2 1237.84,-255.98"/>
</g>
<!-- Ready&#45;&gt;HardState -->
<g id="edge54" class="edge">
<title>Ready&#45;&gt;HardState</title>
<path fill="none" stroke="#b83b5e" d="M1024.54,-135.91C1063.06,-125.25 1107.78,-114.14 1149,-107 1386.77,-65.83 1448.69,-61 1690,-61 1690,-61 1690,-61 2066.5,-61 2253.69,-61 2470.77,-61 2603.21,-61"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="2603.39,-64.5 2613.39,-61 2603.39,-57.5 2603.39,-64.5"/>
</g>
<!-- Ready&#45;&gt;ReadState -->
<g id="edge55" class="edge">
<title>Ready&#45;&gt;ReadState</title>
<path fill="none" stroke="#b83b5e" d="M1024.52,-244.97C1097.18,-302.91 1193.84,-380 1257.2,-430.53"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1255.15,-433.36 1265.15,-436.86 1259.51,-427.89 1255.15,-433.36"/>
</g>
<!-- Ready&#45;&gt;Entry -->
<g id="edge56" class="edge">
<title>Ready&#45;&gt;Entry</title>
<path fill="none" stroke="#b83b5e" d="M1024.63,-140C1063.16,-131.14 1107.86,-122.37 1149,-118 1405.94,-90.72 2239.05,-143.41 2248,-151 2356.67,-243.13 2401.52,-669.2 2417.01,-873.35"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="2413.54,-873.79 2417.77,-883.5 2420.52,-873.26 2413.54,-873.79"/>
</g>
<!-- LightReady -->
<g id="node38" class="node">
<title>LightReady</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1237.5,-128C1237.5,-128 1410.5,-128 1410.5,-128 1416.5,-128 1422.5,-134 1422.5,-140 1422.5,-140 1422.5,-208 1422.5,-208 1422.5,-214 1416.5,-220 1410.5,-220 1410.5,-220 1237.5,-220 1237.5,-220 1231.5,-220 1225.5,-214 1225.5,-208 1225.5,-208 1225.5,-140 1225.5,-140 1225.5,-134 1231.5,-128 1237.5,-128"/>
<text text-anchor="middle" x="1324" y="-204.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">LightReady</text>
<polyline fill="none" stroke="#60b5ac" points="1225.5,-197 1422.5,-197 "/>
<text text-anchor="start" x="1233.5" y="-181.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">commit_index: Option&lt;u64&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1225.5,-174 1422.5,-174 "/>
<text text-anchor="start" x="1233.5" y="-158.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">committed_entries: Vec&lt;Entry&gt;</text>
<polyline fill="none" stroke="#60b5ac" points="1225.5,-151 1422.5,-151 "/>
<text text-anchor="start" x="1233.5" y="-135.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">messages: Vec&lt;Vec&lt;Message&gt;&gt;</text>
</g>
<!-- Ready&#45;&gt;LightReady -->
<g id="edge57" class="edge">
<title>Ready&#45;&gt;LightReady</title>
<path fill="none" stroke="#b83b5e" d="M1024.52,-167.99C1082.45,-169.16 1155.64,-170.63 1215.04,-171.83"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="1215.14,-175.33 1225.21,-172.03 1215.28,-168.33 1215.14,-175.33"/>
</g>
<!-- LightReady&#45;&gt;Message -->
<g id="edge58" class="edge">
<title>LightReady&#45;&gt;Message</title>
<path fill="none" stroke="#666666" d="M1422.74,-192.13C1449.42,-200.46 1477,-212.54 1499,-230 1523.36,-249.33 1517.25,-264.46 1535,-290 1535.36,-290.51 1535.71,-291.02 1536.07,-291.54"/>
<polygon fill="#666666" stroke="#666666" points="1533.32,-293.71 1541.93,-299.87 1539.04,-289.68 1533.32,-293.71"/>
</g>
<!-- LightReady&#45;&gt;Entry -->
<g id="edge59" class="edge">
<title>LightReady&#45;&gt;Entry</title>
<path fill="none" stroke="#666666" d="M1422.65,-163.88C1458,-160.68 1498.26,-157.57 1535,-156 1694.5,-149.18 2134.11,-132.12 2248,-244 2336.57,-331.01 2390.06,-689.79 2412.16,-873.5"/>
<polygon fill="#666666" stroke="#666666" points="2408.69,-873.95 2413.35,-883.46 2415.64,-873.12 2408.69,-873.95"/>
</g>
</g>
</svg>
