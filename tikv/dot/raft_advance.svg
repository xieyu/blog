<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: raft_storage Pages: 1 -->
<svg width="1898pt" height="387pt"
 viewBox="0.00 0.00 1898.00 386.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 382.5)">
<title>raft_storage</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-382.5 1894,-382.5 1894,4 -4,4"/>
<!-- RaftCore__commit_apply -->
<g id="node1" class="node">
<title>RaftCore__commit_apply</title>
<path fill="#feed9b" stroke="#f7e495" d="M796,-116.5C796,-116.5 973,-116.5 973,-116.5 979,-116.5 985,-122.5 985,-128.5 985,-128.5 985,-188.5 985,-188.5 985,-194.5 979,-200.5 973,-200.5 973,-200.5 796,-200.5 796,-200.5 790,-200.5 784,-194.5 784,-188.5 784,-188.5 784,-128.5 784,-128.5 784,-122.5 790,-116.5 796,-116.5"/>
<text text-anchor="middle" x="884.5" y="-185.3" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftCore__commit_apply</text>
<polyline fill="none" stroke="#f7e495" points="784,-177.5 985,-177.5 "/>
<text text-anchor="start" x="792" y="-162.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Commit that the Raft peer</text>
<text text-anchor="start" x="792" y="-147.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> has applied up to the given index</text>
<polyline fill="none" stroke="#f7e495" points="784,-139.5 985,-139.5 "/>
<text text-anchor="start" x="792" y="-124.3" font-family="Times,serif" font-size="14.00" fill="#40575d">影响pending_conf_index</text>
</g>
<!-- RaftCore__append_entry -->
<g id="node2" class="node">
<title>RaftCore__append_entry</title>
<path fill="none" stroke="#1c2123" d="M1039,-121.5C1039,-121.5 1202,-121.5 1202,-121.5 1208,-121.5 1214,-127.5 1214,-133.5 1214,-133.5 1214,-185.5 1214,-185.5 1214,-191.5 1208,-197.5 1202,-197.5 1202,-197.5 1039,-197.5 1039,-197.5 1033,-197.5 1027,-191.5 1027,-185.5 1027,-185.5 1027,-133.5 1027,-133.5 1027,-127.5 1033,-121.5 1039,-121.5"/>
<text text-anchor="middle" x="1120.5" y="-182.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__append_entry</text>
<polyline fill="none" stroke="#1c2123" points="1027,-174.5 1214,-174.5 "/>
<text text-anchor="start" x="1035" y="-159.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Appends a slice of entries</text>
<text text-anchor="start" x="1035" y="-144.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> to the log</text>
<text text-anchor="start" x="1035" y="-129.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> only called by leader currently</text>
</g>
<!-- RaftCore__commit_apply&#45;&gt;RaftCore__append_entry -->
<g id="edge24" class="edge">
<title>RaftCore__commit_apply&#45;&gt;RaftCore__append_entry</title>
<path fill="none" stroke="#666666" d="M985.08,-158.93C995.54,-158.97 1006.19,-159.02 1016.69,-159.06"/>
<polygon fill="#666666" stroke="#666666" points="1016.69,-162.56 1026.7,-159.1 1016.72,-155.56 1016.69,-162.56"/>
</g>
<!-- RaftLog__applied_to -->
<g id="node24" class="node">
<title>RaftLog__applied_to</title>
<path fill="none" stroke="#1c2123" d="M1174.5,-102.5C1174.5,-102.5 1066.5,-102.5 1066.5,-102.5 1060.5,-102.5 1054.5,-96.5 1054.5,-90.5 1054.5,-90.5 1054.5,-78.5 1054.5,-78.5 1054.5,-72.5 1060.5,-66.5 1066.5,-66.5 1066.5,-66.5 1174.5,-66.5 1174.5,-66.5 1180.5,-66.5 1186.5,-72.5 1186.5,-78.5 1186.5,-78.5 1186.5,-90.5 1186.5,-90.5 1186.5,-96.5 1180.5,-102.5 1174.5,-102.5"/>
<text text-anchor="middle" x="1120.5" y="-80.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__applied_to</text>
</g>
<!-- RaftCore__commit_apply&#45;&gt;RaftLog__applied_to -->
<g id="edge25" class="edge">
<title>RaftCore__commit_apply&#45;&gt;RaftLog__applied_to</title>
<path fill="none" stroke="#666666" d="M985.08,-124.92C999.13,-120.33 1013.41,-115.74 1027,-111.5 1033.33,-109.53 1039.92,-107.51 1046.53,-105.53"/>
<polygon fill="#666666" stroke="#666666" points="1047.63,-108.85 1056.21,-102.64 1045.63,-102.14 1047.63,-108.85"/>
</g>
<!-- RawNode__recods -->
<g id="node3" class="node">
<title>RawNode__recods</title>
<path fill="none" stroke="#1c2123" d="M932,-377.5C932,-377.5 837,-377.5 837,-377.5 831,-377.5 825,-371.5 825,-365.5 825,-365.5 825,-353.5 825,-353.5 825,-347.5 831,-341.5 837,-341.5 837,-341.5 932,-341.5 932,-341.5 938,-341.5 944,-347.5 944,-353.5 944,-353.5 944,-365.5 944,-365.5 944,-371.5 938,-377.5 932,-377.5"/>
<text text-anchor="middle" x="884.5" y="-355.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__recods</text>
</g>
<!-- RawNode__messages -->
<g id="node4" class="node">
<title>RawNode__messages</title>
<path fill="none" stroke="#1c2123" d="M1176.5,-376.5C1176.5,-376.5 1064.5,-376.5 1064.5,-376.5 1058.5,-376.5 1052.5,-370.5 1052.5,-364.5 1052.5,-364.5 1052.5,-352.5 1052.5,-352.5 1052.5,-346.5 1058.5,-340.5 1064.5,-340.5 1064.5,-340.5 1176.5,-340.5 1176.5,-340.5 1182.5,-340.5 1188.5,-346.5 1188.5,-352.5 1188.5,-352.5 1188.5,-364.5 1188.5,-364.5 1188.5,-370.5 1182.5,-376.5 1176.5,-376.5"/>
<text text-anchor="middle" x="1120.5" y="-354.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__messages</text>
</g>
<!-- RawNode__recods&#45;&gt;RawNode__messages -->
<g id="edge1" class="edge">
<title>RawNode__recods&#45;&gt;RawNode__messages</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M944.25,-359.25C973.93,-359.12 1010.33,-358.97 1042.25,-358.83"/>
<polygon fill="green" stroke="green" points="1042.46,-362.33 1052.45,-358.79 1042.43,-355.33 1042.46,-362.33"/>
</g>
<!-- RawNode__on_persist_ready -->
<g id="node5" class="node">
<title>RawNode__on_persist_ready</title>
<path fill="none" stroke="#1c2123" d="M518,-249C518,-249 730,-249 730,-249 736,-249 742,-255 742,-261 742,-261 742,-366 742,-366 742,-372 736,-378 730,-378 730,-378 518,-378 518,-378 512,-378 506,-372 506,-366 506,-366 506,-261 506,-261 506,-255 512,-249 518,-249"/>
<text text-anchor="middle" x="624" y="-362.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__on_persist_ready</text>
<polyline fill="none" stroke="#1c2123" points="506,-355 742,-355 "/>
<text text-anchor="start" x="514" y="-339.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">entries已保存好，可以把raft message</text>
<text text-anchor="start" x="514" y="-324.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发出去了</text>
<polyline fill="none" stroke="#1c2123" points="506,-317 742,-317 "/>
<text text-anchor="start" x="514" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将records中的messages放到</text>
<text text-anchor="start" x="514" y="-286.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> RawNode.messages中</text>
<text text-anchor="start" x="514" y="-271.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 这样下次调用ready时候</text>
<text text-anchor="start" x="514" y="-256.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 就能获取这些message了</text>
</g>
<!-- RawNode__on_persist_ready&#45;&gt;RawNode__recods -->
<g id="edge2" class="edge">
<title>RawNode__on_persist_ready&#45;&gt;RawNode__recods</title>
<path fill="none" stroke="#666666" d="M742.15,-334.35C767.06,-338.78 792.57,-343.32 814.94,-347.3"/>
<polygon fill="#666666" stroke="#666666" points="814.53,-350.78 824.98,-349.09 815.75,-343.89 814.53,-350.78"/>
</g>
<!-- RawNode__on_persist_ready&#45;&gt;RawNode__messages -->
<g id="edge3" class="edge">
<title>RawNode__on_persist_ready&#45;&gt;RawNode__messages</title>
<path fill="none" stroke="#666666" d="M742.01,-315.18C814.05,-317.3 908.15,-322.03 991,-332.5 1007.8,-334.62 1025.69,-337.71 1042.61,-341.02"/>
<polygon fill="#666666" stroke="#666666" points="1041.96,-344.46 1052.45,-342.99 1043.33,-337.59 1041.96,-344.46"/>
</g>
<!-- RaftCore__on_persist_entries -->
<g id="node6" class="node">
<title>RaftCore__on_persist_entries</title>
<path fill="none" stroke="#1c2123" d="M790,-224C790,-224 979,-224 979,-224 985,-224 991,-230 991,-236 991,-236 991,-273 991,-273 991,-279 985,-285 979,-285 979,-285 790,-285 790,-285 784,-285 778,-279 778,-273 778,-273 778,-236 778,-236 778,-230 784,-224 790,-224"/>
<text text-anchor="middle" x="884.5" y="-269.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__on_persist_entries</text>
<polyline fill="none" stroke="#1c2123" points="778,-262 991,-262 "/>
<text text-anchor="start" x="786" y="-246.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Notifies that the raft logs</text>
<text text-anchor="start" x="786" y="-231.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> or the snapshot have been persisted</text>
</g>
<!-- RawNode__on_persist_ready&#45;&gt;RaftCore__on_persist_entries -->
<g id="edge4" class="edge">
<title>RawNode__on_persist_ready&#45;&gt;RaftCore__on_persist_entries</title>
<path fill="none" stroke="#666666" d="M742.15,-286.76C750.69,-284.81 759.31,-282.85 767.85,-280.9"/>
<polygon fill="#666666" stroke="#666666" points="768.85,-284.26 777.82,-278.62 767.29,-277.43 768.85,-284.26"/>
</g>
<!-- RaftLog__maybe_persist -->
<g id="node11" class="node">
<title>RaftLog__maybe_persist</title>
<path fill="#feed9b" stroke="#f7e495" d="M1055.5,-274.5C1055.5,-274.5 1185.5,-274.5 1185.5,-274.5 1191.5,-274.5 1197.5,-280.5 1197.5,-286.5 1197.5,-286.5 1197.5,-308.5 1197.5,-308.5 1197.5,-314.5 1191.5,-320.5 1185.5,-320.5 1185.5,-320.5 1055.5,-320.5 1055.5,-320.5 1049.5,-320.5 1043.5,-314.5 1043.5,-308.5 1043.5,-308.5 1043.5,-286.5 1043.5,-286.5 1043.5,-280.5 1049.5,-274.5 1055.5,-274.5"/>
<text text-anchor="middle" x="1120.5" y="-305.3" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftLog__maybe_persist</text>
<polyline fill="none" stroke="#f7e495" points="1043.5,-297.5 1197.5,-297.5 "/>
<text text-anchor="start" x="1051.5" y="-282.3" font-family="Times,serif" font-size="14.00" fill="#40575d">更新RaftLog的persisted</text>
</g>
<!-- RaftCore__on_persist_entries&#45;&gt;RaftLog__maybe_persist -->
<g id="edge8" class="edge">
<title>RaftCore__on_persist_entries&#45;&gt;RaftLog__maybe_persist</title>
<path fill="none" stroke="#666666" d="M991.2,-273.92C1005.34,-276.52 1019.69,-279.16 1033.43,-281.68"/>
<polygon fill="#666666" stroke="#666666" points="1032.85,-285.14 1043.32,-283.5 1034.11,-278.25 1032.85,-285.14"/>
</g>
<!-- RaftCore__maybe_commit -->
<g id="node12" class="node">
<title>RaftCore__maybe_commit</title>
<path fill="none" stroke="#1c2123" d="M1191.5,-255.5C1191.5,-255.5 1049.5,-255.5 1049.5,-255.5 1043.5,-255.5 1037.5,-249.5 1037.5,-243.5 1037.5,-243.5 1037.5,-231.5 1037.5,-231.5 1037.5,-225.5 1043.5,-219.5 1049.5,-219.5 1049.5,-219.5 1191.5,-219.5 1191.5,-219.5 1197.5,-219.5 1203.5,-225.5 1203.5,-231.5 1203.5,-231.5 1203.5,-243.5 1203.5,-243.5 1203.5,-249.5 1197.5,-255.5 1191.5,-255.5"/>
<text text-anchor="middle" x="1120.5" y="-233.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__maybe_commit</text>
</g>
<!-- RaftCore__on_persist_entries&#45;&gt;RaftCore__maybe_commit -->
<g id="edge9" class="edge">
<title>RaftCore__on_persist_entries&#45;&gt;RaftCore__maybe_commit</title>
<path fill="none" stroke="#666666" d="M991.2,-246.82C1003.19,-245.95 1015.35,-245.07 1027.14,-244.21"/>
<polygon fill="#666666" stroke="#666666" points="1027.69,-247.68 1037.41,-243.46 1027.18,-240.7 1027.69,-247.68"/>
</g>
<!-- ProgressTracker_maximal_committed_index -->
<g id="node7" class="node">
<title>ProgressTracker_maximal_committed_index</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M1262,-214.5C1262,-214.5 1501,-214.5 1501,-214.5 1507,-214.5 1513,-220.5 1513,-226.5 1513,-226.5 1513,-248.5 1513,-248.5 1513,-254.5 1507,-260.5 1501,-260.5 1501,-260.5 1262,-260.5 1262,-260.5 1256,-260.5 1250,-254.5 1250,-248.5 1250,-248.5 1250,-226.5 1250,-226.5 1250,-220.5 1256,-214.5 1262,-214.5"/>
<text text-anchor="middle" x="1381.5" y="-245.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ProgressTracker_maximal_committed_index</text>
<polyline fill="none" stroke="#8a8898" points="1250,-237.5 1513,-237.5 "/>
<text text-anchor="start" x="1258" y="-222.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">获取voters的committed_index</text>
</g>
<!-- RaftLog__committed -->
<g id="node8" class="node">
<title>RaftLog__committed</title>
<path fill="#feed9b" stroke="#f7e495" d="M1768,-204.5C1768,-204.5 1878,-204.5 1878,-204.5 1884,-204.5 1890,-210.5 1890,-216.5 1890,-216.5 1890,-228.5 1890,-228.5 1890,-234.5 1884,-240.5 1878,-240.5 1878,-240.5 1768,-240.5 1768,-240.5 1762,-240.5 1756,-234.5 1756,-228.5 1756,-228.5 1756,-216.5 1756,-216.5 1756,-210.5 1762,-204.5 1768,-204.5"/>
<text text-anchor="middle" x="1823" y="-218.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftLog__committed</text>
</g>
<!-- ProgressTracker_maximal_committed_index&#45;&gt;RaftLog__committed -->
<g id="edge5" class="edge">
<title>ProgressTracker_maximal_committed_index&#45;&gt;RaftLog__committed</title>
<path fill="none" stroke="#666666" d="M1474.89,-260.58C1487.71,-263.86 1500.69,-267.23 1513,-270.5 1529.05,-274.76 1532.55,-278.26 1549,-280.5 1624.3,-290.76 1646.53,-299.93 1720,-280.5 1745.28,-273.82 1770.85,-259.26 1790.06,-246.4"/>
<polygon fill="#666666" stroke="#666666" points="1792.17,-249.2 1798.42,-240.64 1788.2,-243.43 1792.17,-249.2"/>
</g>
<!-- incoming_committed_index -->
<g id="node9" class="node">
<title>incoming_committed_index</title>
<path fill="none" stroke="#1c2123" d="M1708,-271.5C1708,-271.5 1561,-271.5 1561,-271.5 1555,-271.5 1549,-265.5 1549,-259.5 1549,-259.5 1549,-247.5 1549,-247.5 1549,-241.5 1555,-235.5 1561,-235.5 1561,-235.5 1708,-235.5 1708,-235.5 1714,-235.5 1720,-241.5 1720,-247.5 1720,-247.5 1720,-259.5 1720,-259.5 1720,-265.5 1714,-271.5 1708,-271.5"/>
<text text-anchor="middle" x="1634.5" y="-249.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">incoming_committed_index</text>
</g>
<!-- ProgressTracker_maximal_committed_index&#45;&gt;incoming_committed_index -->
<g id="edge6" class="edge">
<title>ProgressTracker_maximal_committed_index&#45;&gt;incoming_committed_index</title>
<path fill="none" stroke="#666666" d="M1513.15,-245.83C1521.78,-246.38 1530.39,-246.93 1538.8,-247.46"/>
<polygon fill="#666666" stroke="#666666" points="1538.74,-250.97 1548.95,-248.11 1539.19,-243.98 1538.74,-250.97"/>
</g>
<!-- outgoing_committed_index -->
<g id="node10" class="node">
<title>outgoing_committed_index</title>
<path fill="none" stroke="#1c2123" d="M1706,-217.5C1706,-217.5 1563,-217.5 1563,-217.5 1557,-217.5 1551,-211.5 1551,-205.5 1551,-205.5 1551,-193.5 1551,-193.5 1551,-187.5 1557,-181.5 1563,-181.5 1563,-181.5 1706,-181.5 1706,-181.5 1712,-181.5 1718,-187.5 1718,-193.5 1718,-193.5 1718,-205.5 1718,-205.5 1718,-211.5 1712,-217.5 1706,-217.5"/>
<text text-anchor="middle" x="1634.5" y="-195.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">outgoing_committed_index</text>
</g>
<!-- ProgressTracker_maximal_committed_index&#45;&gt;outgoing_committed_index -->
<g id="edge7" class="edge">
<title>ProgressTracker_maximal_committed_index&#45;&gt;outgoing_committed_index</title>
<path fill="none" stroke="#666666" d="M1513.15,-217.72C1522.49,-216.31 1531.8,-214.9 1540.87,-213.52"/>
<polygon fill="#666666" stroke="#666666" points="1541.62,-216.95 1550.98,-211.99 1540.57,-210.03 1541.62,-216.95"/>
</g>
<!-- RaftLog__psersisted -->
<g id="node15" class="node">
<title>RaftLog__psersisted</title>
<path fill="#feed9b" stroke="#f7e495" d="M1329.5,-279.5C1329.5,-279.5 1433.5,-279.5 1433.5,-279.5 1439.5,-279.5 1445.5,-285.5 1445.5,-291.5 1445.5,-291.5 1445.5,-303.5 1445.5,-303.5 1445.5,-309.5 1439.5,-315.5 1433.5,-315.5 1433.5,-315.5 1329.5,-315.5 1329.5,-315.5 1323.5,-315.5 1317.5,-309.5 1317.5,-303.5 1317.5,-303.5 1317.5,-291.5 1317.5,-291.5 1317.5,-285.5 1323.5,-279.5 1329.5,-279.5"/>
<text text-anchor="middle" x="1381.5" y="-293.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftLog__psersisted</text>
</g>
<!-- RaftLog__maybe_persist&#45;&gt;RaftLog__psersisted -->
<g id="edge14" class="edge">
<title>RaftLog__maybe_persist&#45;&gt;RaftLog__psersisted</title>
<path fill="none" stroke="#666666" d="M1197.81,-297.5C1232.29,-297.5 1272.86,-297.5 1307,-297.5"/>
<polygon fill="#666666" stroke="#666666" points="1307.38,-301 1317.38,-297.5 1307.38,-294 1307.38,-301"/>
</g>
<!-- RaftCore__maybe_commit&#45;&gt;ProgressTracker_maximal_committed_index -->
<g id="edge10" class="edge">
<title>RaftCore__maybe_commit&#45;&gt;ProgressTracker_maximal_committed_index</title>
<path fill="none" stroke="#666666" d="M1203.81,-237.5C1215.26,-237.5 1227.29,-237.5 1239.45,-237.5"/>
<polygon fill="#666666" stroke="#666666" points="1239.69,-241 1249.69,-237.5 1239.69,-234 1239.69,-241"/>
</g>
<!-- RaftLog__maybe_commit -->
<g id="node13" class="node">
<title>RaftLog__maybe_commit</title>
<path fill="none" stroke="#1c2123" d="M1450,-178.5C1450,-178.5 1313,-178.5 1313,-178.5 1307,-178.5 1301,-172.5 1301,-166.5 1301,-166.5 1301,-154.5 1301,-154.5 1301,-148.5 1307,-142.5 1313,-142.5 1313,-142.5 1450,-142.5 1450,-142.5 1456,-142.5 1462,-148.5 1462,-154.5 1462,-154.5 1462,-166.5 1462,-166.5 1462,-172.5 1456,-178.5 1450,-178.5"/>
<text text-anchor="middle" x="1381.5" y="-156.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__maybe_commit</text>
</g>
<!-- RaftCore__maybe_commit&#45;&gt;RaftLog__maybe_commit -->
<g id="edge11" class="edge">
<title>RaftCore__maybe_commit&#45;&gt;RaftLog__maybe_commit</title>
<path fill="none" stroke="#666666" d="M1182.22,-219.45C1220.49,-208.07 1270.03,-193.34 1310.02,-181.45"/>
<polygon fill="#666666" stroke="#666666" points="1311.12,-184.78 1319.71,-178.57 1309.13,-178.07 1311.12,-184.78"/>
</g>
<!-- RaftLog__comit_to -->
<g id="node14" class="node">
<title>RaftLog__comit_to</title>
<path fill="none" stroke="#1c2123" d="M1684.5,-163.5C1684.5,-163.5 1584.5,-163.5 1584.5,-163.5 1578.5,-163.5 1572.5,-157.5 1572.5,-151.5 1572.5,-151.5 1572.5,-139.5 1572.5,-139.5 1572.5,-133.5 1578.5,-127.5 1584.5,-127.5 1584.5,-127.5 1684.5,-127.5 1684.5,-127.5 1690.5,-127.5 1696.5,-133.5 1696.5,-139.5 1696.5,-139.5 1696.5,-151.5 1696.5,-151.5 1696.5,-157.5 1690.5,-163.5 1684.5,-163.5"/>
<text text-anchor="middle" x="1634.5" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__comit_to</text>
</g>
<!-- RaftLog__maybe_commit&#45;&gt;RaftLog__comit_to -->
<g id="edge12" class="edge">
<title>RaftLog__maybe_commit&#45;&gt;RaftLog__comit_to</title>
<path fill="none" stroke="#666666" d="M1462.26,-155.73C1494.25,-153.82 1530.82,-151.64 1561.94,-149.78"/>
<polygon fill="#666666" stroke="#666666" points="1562.49,-153.25 1572.26,-149.16 1562.07,-146.26 1562.49,-153.25"/>
</g>
<!-- RaftLog__comit_to&#45;&gt;RaftLog__committed -->
<g id="edge13" class="edge">
<title>RaftLog__comit_to&#45;&gt;RaftLog__committed</title>
<path fill="none" stroke="#666666" d="M1695.9,-163.6C1704.06,-166.4 1712.28,-169.4 1720,-172.5 1739.79,-180.46 1761.06,-190.62 1779.03,-199.7"/>
<polygon fill="#666666" stroke="#666666" points="1777.6,-202.9 1788.1,-204.33 1780.79,-196.66 1777.6,-202.9"/>
</g>
<!-- RawNode__advance_append -->
<g id="node16" class="node">
<title>RawNode__advance_append</title>
<path fill="none" stroke="#1c2123" d="M261,-208.5C261,-208.5 435,-208.5 435,-208.5 441,-208.5 447,-214.5 447,-220.5 447,-220.5 447,-272.5 447,-272.5 447,-278.5 441,-284.5 435,-284.5 435,-284.5 261,-284.5 261,-284.5 255,-284.5 249,-278.5 249,-272.5 249,-272.5 249,-220.5 249,-220.5 249,-214.5 255,-208.5 261,-208.5"/>
<text text-anchor="middle" x="348" y="-269.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__advance_append</text>
<polyline fill="none" stroke="#1c2123" points="249,-261.5 447,-261.5 "/>
<text text-anchor="start" x="257" y="-246.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Returns LightReady that</text>
<text text-anchor="start" x="257" y="-231.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> contains commit index</text>
<text text-anchor="start" x="257" y="-216.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> committed entries and messages</text>
</g>
<!-- RawNode__advance_append&#45;&gt;RawNode__on_persist_ready -->
<g id="edge15" class="edge">
<title>RawNode__advance_append&#45;&gt;RawNode__on_persist_ready</title>
<path fill="none" stroke="#666666" d="M447.15,-270.5C462.91,-274.36 479.43,-278.39 495.76,-282.39"/>
<polygon fill="#666666" stroke="#666666" points="495.35,-285.89 505.9,-284.87 497.02,-279.09 495.35,-285.89"/>
</g>
<!-- RawNode__gen_light_ready -->
<g id="node17" class="node">
<title>RawNode__gen_light_ready</title>
<path fill="none" stroke="#1c2123" d="M698,-230.5C698,-230.5 550,-230.5 550,-230.5 544,-230.5 538,-224.5 538,-218.5 538,-218.5 538,-206.5 538,-206.5 538,-200.5 544,-194.5 550,-194.5 550,-194.5 698,-194.5 698,-194.5 704,-194.5 710,-200.5 710,-206.5 710,-206.5 710,-218.5 710,-218.5 710,-224.5 704,-230.5 698,-230.5"/>
<text text-anchor="middle" x="624" y="-208.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__gen_light_ready</text>
</g>
<!-- RawNode__advance_append&#45;&gt;RawNode__gen_light_ready -->
<g id="edge16" class="edge">
<title>RawNode__advance_append&#45;&gt;RawNode__gen_light_ready</title>
<path fill="none" stroke="#666666" d="M447.15,-234.32C473.31,-231.07 501.53,-227.57 527.55,-224.34"/>
<polygon fill="#666666" stroke="#666666" points="528.29,-227.78 537.78,-223.07 527.43,-220.83 528.29,-227.78"/>
</g>
<!-- RawNode__advance -->
<g id="node18" class="node">
<title>RawNode__advance</title>
<path fill="none" stroke="#1c2123" d="M12,-164.5C12,-164.5 178,-164.5 178,-164.5 184,-164.5 190,-170.5 190,-176.5 190,-176.5 190,-228.5 190,-228.5 190,-234.5 184,-240.5 178,-240.5 178,-240.5 12,-240.5 12,-240.5 6,-240.5 0,-234.5 0,-228.5 0,-228.5 0,-176.5 0,-176.5 0,-170.5 6,-164.5 12,-164.5"/>
<text text-anchor="middle" x="95" y="-225.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__advance(Ready)</text>
<polyline fill="none" stroke="#1c2123" points="0,-217.5 190,-217.5 "/>
<text text-anchor="start" x="8" y="-202.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">advance the ready </text>
<text text-anchor="start" x="8" y="-187.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> after full procssing it</text>
<text text-anchor="start" x="8" y="-172.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> applied = commit_since_index</text>
</g>
<!-- RawNode__advance&#45;&gt;RawNode__on_persist_ready -->
<g id="edge17" class="edge">
<title>RawNode__advance&#45;&gt;RawNode__on_persist_ready</title>
<path fill="none" stroke="#666666" d="M136.76,-240.56C160.8,-260.51 192.93,-283.11 226,-294.5 312.65,-324.36 416.25,-328.35 495.89,-325.28"/>
<polygon fill="#666666" stroke="#666666" points="496.13,-328.77 505.97,-324.84 495.83,-321.77 496.13,-328.77"/>
</g>
<!-- RawNode__advance&#45;&gt;RawNode__advance_append -->
<g id="edge18" class="edge">
<title>RawNode__advance&#45;&gt;RawNode__advance_append</title>
<path fill="none" stroke="#666666" d="M190.18,-219.01C206.07,-221.8 222.69,-224.71 238.91,-227.55"/>
<polygon fill="#666666" stroke="#666666" points="238.49,-231.03 248.94,-229.31 239.7,-224.14 238.49,-231.03"/>
</g>
<!-- RawNode__advance_apply_to -->
<g id="node19" class="node">
<title>RawNode__advance_apply_to</title>
<path fill="none" stroke="#1c2123" d="M269,-128C269,-128 427,-128 427,-128 433,-128 439,-134 439,-140 439,-140 439,-177 439,-177 439,-183 433,-189 427,-189 427,-189 269,-189 269,-189 263,-189 257,-183 257,-177 257,-177 257,-140 257,-140 257,-134 263,-128 269,-128"/>
<text text-anchor="middle" x="348" y="-173.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__advance_apply_to</text>
<polyline fill="none" stroke="#1c2123" points="257,-166 439,-166 "/>
<text text-anchor="start" x="265" y="-150.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_to到</text>
<text text-anchor="start" x="265" y="-135.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> commit_since_index</text>
</g>
<!-- RawNode__advance&#45;&gt;RawNode__advance_apply_to -->
<g id="edge19" class="edge">
<title>RawNode__advance&#45;&gt;RawNode__advance_apply_to</title>
<path fill="none" stroke="#666666" d="M190.18,-185.99C208.69,-182.75 228.17,-179.33 246.87,-176.05"/>
<polygon fill="#666666" stroke="#666666" points="247.62,-179.47 256.87,-174.3 246.42,-172.58 247.62,-179.47"/>
</g>
<!-- RawNode__commit_ready -->
<g id="node20" class="node">
<title>RawNode__commit_ready</title>
<path fill="none" stroke="#1c2123" d="M238,-48C238,-48 458,-48 458,-48 464,-48 470,-54 470,-60 470,-60 470,-97 470,-97 470,-103 464,-109 458,-109 458,-109 238,-109 238,-109 232,-109 226,-103 226,-97 226,-97 226,-60 226,-60 226,-54 232,-48 238,-48"/>
<text text-anchor="middle" x="348" y="-93.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__commit_ready</text>
<polyline fill="none" stroke="#1c2123" points="226,-86 470,-86 "/>
<text text-anchor="start" x="234" y="-70.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">1.清理掉raftlog的snap和unstable entries</text>
<text text-anchor="start" x="234" y="-55.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.更新prev_ss和prev_hs</text>
</g>
<!-- RawNode__advance&#45;&gt;RawNode__commit_ready -->
<g id="edge20" class="edge">
<title>RawNode__advance&#45;&gt;RawNode__commit_ready</title>
<path fill="none" stroke="#666666" d="M148.29,-164.36C171.34,-148.72 199.22,-131.32 226,-118.5 229.87,-116.65 233.85,-114.84 237.9,-113.09"/>
<polygon fill="#666666" stroke="#666666" points="239.58,-116.19 247.46,-109.11 236.89,-109.73 239.58,-116.19"/>
</g>
<!-- RawNode__commit_apply -->
<g id="node23" class="node">
<title>RawNode__commit_apply</title>
<path fill="none" stroke="#1c2123" d="M694,-176.5C694,-176.5 554,-176.5 554,-176.5 548,-176.5 542,-170.5 542,-164.5 542,-164.5 542,-152.5 542,-152.5 542,-146.5 548,-140.5 554,-140.5 554,-140.5 694,-140.5 694,-140.5 700,-140.5 706,-146.5 706,-152.5 706,-152.5 706,-164.5 706,-164.5 706,-170.5 700,-176.5 694,-176.5"/>
<text text-anchor="middle" x="624" y="-154.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__commit_apply</text>
</g>
<!-- RawNode__advance_apply_to&#45;&gt;RawNode__commit_apply -->
<g id="edge27" class="edge">
<title>RawNode__advance_apply_to&#45;&gt;RawNode__commit_apply</title>
<path fill="none" stroke="#666666" d="M439.1,-158.5C468.68,-158.5 501.57,-158.5 531.27,-158.5"/>
<polygon fill="#666666" stroke="#666666" points="531.63,-162 541.63,-158.5 531.63,-155 531.63,-162"/>
</g>
<!-- RaftLog__stable_snap -->
<g id="node21" class="node">
<title>RaftLog__stable_snap</title>
<path fill="none" stroke="#1c2123" d="M567,-65.5C567,-65.5 681,-65.5 681,-65.5 687,-65.5 693,-71.5 693,-77.5 693,-77.5 693,-99.5 693,-99.5 693,-105.5 687,-111.5 681,-111.5 681,-111.5 567,-111.5 567,-111.5 561,-111.5 555,-105.5 555,-99.5 555,-99.5 555,-77.5 555,-77.5 555,-71.5 561,-65.5 567,-65.5"/>
<text text-anchor="middle" x="624" y="-96.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__stable_snap</text>
<polyline fill="none" stroke="#1c2123" points="555,-88.5 693,-88.5 "/>
<text text-anchor="start" x="563" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">清理掉snapshot</text>
</g>
<!-- RawNode__commit_ready&#45;&gt;RaftLog__stable_snap -->
<g id="edge21" class="edge">
<title>RawNode__commit_ready&#45;&gt;RaftLog__stable_snap</title>
<path fill="none" stroke="#666666" d="M470.38,-82.93C495.56,-83.85 521.47,-84.79 544.62,-85.64"/>
<polygon fill="#666666" stroke="#666666" points="544.58,-89.14 554.7,-86.01 544.84,-82.14 544.58,-89.14"/>
</g>
<!-- RaftLog__stable_entries -->
<g id="node22" class="node">
<title>RaftLog__stable_entries</title>
<path fill="none" stroke="#1c2123" d="M548,-0.5C548,-0.5 700,-0.5 700,-0.5 706,-0.5 712,-6.5 712,-12.5 712,-12.5 712,-34.5 712,-34.5 712,-40.5 706,-46.5 700,-46.5 700,-46.5 548,-46.5 548,-46.5 542,-46.5 536,-40.5 536,-34.5 536,-34.5 536,-12.5 536,-12.5 536,-6.5 542,-0.5 548,-0.5"/>
<text text-anchor="middle" x="624" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__stable_entries</text>
<polyline fill="none" stroke="#1c2123" points="536,-23.5 712,-23.5 "/>
<text text-anchor="middle" x="624" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">清理掉unstable的log entries</text>
</g>
<!-- RawNode__commit_ready&#45;&gt;RaftLog__stable_entries -->
<g id="edge22" class="edge">
<title>RawNode__commit_ready&#45;&gt;RaftLog__stable_entries</title>
<path fill="none" stroke="#666666" d="M470.38,-54.14C488.98,-50.4 507.97,-46.59 525.95,-42.98"/>
<polygon fill="#666666" stroke="#666666" points="526.71,-46.4 535.83,-41 525.33,-39.53 526.71,-46.4"/>
</g>
<!-- RawNode__commit_apply&#45;&gt;RaftCore__commit_apply -->
<g id="edge23" class="edge">
<title>RawNode__commit_apply&#45;&gt;RaftCore__commit_apply</title>
<path fill="none" stroke="#666666" d="M706.08,-158.5C727.4,-158.5 750.75,-158.5 773.31,-158.5"/>
<polygon fill="#666666" stroke="#666666" points="773.61,-162 783.61,-158.5 773.61,-155 773.61,-162"/>
</g>
<!-- RaftLog__applied -->
<g id="node25" class="node">
<title>RaftLog__applied</title>
<path fill="#feed9b" stroke="#f7e495" d="M1336,-66.5C1336,-66.5 1427,-66.5 1427,-66.5 1433,-66.5 1439,-72.5 1439,-78.5 1439,-78.5 1439,-90.5 1439,-90.5 1439,-96.5 1433,-102.5 1427,-102.5 1427,-102.5 1336,-102.5 1336,-102.5 1330,-102.5 1324,-96.5 1324,-90.5 1324,-90.5 1324,-78.5 1324,-78.5 1324,-72.5 1330,-66.5 1336,-66.5"/>
<text text-anchor="middle" x="1381.5" y="-80.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftLog__applied</text>
</g>
<!-- RaftLog__applied_to&#45;&gt;RaftLog__applied -->
<g id="edge26" class="edge">
<title>RaftLog__applied_to&#45;&gt;RaftLog__applied</title>
<path fill="none" stroke="#666666" d="M1186.52,-84.5C1225.31,-84.5 1274.46,-84.5 1313.59,-84.5"/>
<polygon fill="#666666" stroke="#666666" points="1313.82,-88 1323.82,-84.5 1313.82,-81 1313.82,-88"/>
</g>
</g>
</svg>
