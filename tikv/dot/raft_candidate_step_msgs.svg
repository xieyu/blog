<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: follower_step_msgs Pages: 1 -->
<svg width="1084pt" height="555pt"
 viewBox="0.00 0.00 1084.00 554.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 550.76)">
<title>follower_step_msgs</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-550.76 1080,-550.76 1080,4 -4,4"/>
<!-- RaftCore__step_candidate -->
<g id="node1" class="node">
<title>RaftCore__step_candidate</title>
<path fill="none" stroke="#1c2123" d="M148,-287.5C148,-287.5 12,-287.5 12,-287.5 6,-287.5 0,-281.5 0,-275.5 0,-275.5 0,-263.5 0,-263.5 0,-257.5 6,-251.5 12,-251.5 12,-251.5 148,-251.5 148,-251.5 154,-251.5 160,-257.5 160,-263.5 160,-263.5 160,-275.5 160,-275.5 160,-281.5 154,-287.5 148,-287.5"/>
<text text-anchor="middle" x="80" y="-265.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__step_candidate</text>
</g>
<!-- RaftCore__handle_append_entries -->
<g id="node2" class="node">
<title>RaftCore__handle_append_entries</title>
<path fill="none" stroke="#1c2123" d="M468.5,-437.5C468.5,-437.5 288.5,-437.5 288.5,-437.5 282.5,-437.5 276.5,-431.5 276.5,-425.5 276.5,-425.5 276.5,-413.5 276.5,-413.5 276.5,-407.5 282.5,-401.5 288.5,-401.5 288.5,-401.5 468.5,-401.5 468.5,-401.5 474.5,-401.5 480.5,-407.5 480.5,-413.5 480.5,-413.5 480.5,-425.5 480.5,-425.5 480.5,-431.5 474.5,-437.5 468.5,-437.5"/>
<text text-anchor="middle" x="378.5" y="-415.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_append_entries</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__handle_append_entries -->
<g id="edge1" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__handle_append_entries</title>
<path fill="none" stroke="#666666" d="M103.25,-287.73C125.65,-305.45 161.71,-332.28 196,-350.5 232.05,-369.66 274.62,-386.13 309.46,-398.18"/>
<polygon fill="#666666" stroke="#666666" points="308.48,-401.54 319.07,-401.45 310.74,-394.91 308.48,-401.54"/>
</g>
<!-- RaftCore__handle_heartbeat -->
<g id="node3" class="node">
<title>RaftCore__handle_heartbeat</title>
<path fill="none" stroke="#1c2123" d="M452.5,-341.5C452.5,-341.5 304.5,-341.5 304.5,-341.5 298.5,-341.5 292.5,-335.5 292.5,-329.5 292.5,-329.5 292.5,-317.5 292.5,-317.5 292.5,-311.5 298.5,-305.5 304.5,-305.5 304.5,-305.5 452.5,-305.5 452.5,-305.5 458.5,-305.5 464.5,-311.5 464.5,-317.5 464.5,-317.5 464.5,-329.5 464.5,-329.5 464.5,-335.5 458.5,-341.5 452.5,-341.5"/>
<text text-anchor="middle" x="378.5" y="-319.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_heartbeat</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__handle_heartbeat -->
<g id="edge2" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__handle_heartbeat</title>
<path fill="none" stroke="#666666" d="M153.81,-287.55C167.77,-290.74 182.3,-293.88 196,-296.5 223.87,-301.83 254.31,-306.73 282.17,-310.84"/>
<polygon fill="#666666" stroke="#666666" points="281.9,-314.33 292.3,-312.31 282.91,-307.41 281.9,-314.33"/>
</g>
<!-- RaftCore__handle_snapshot -->
<g id="node4" class="node">
<title>RaftCore__handle_snapshot</title>
<path fill="none" stroke="#1c2123" d="M451.5,-287.5C451.5,-287.5 305.5,-287.5 305.5,-287.5 299.5,-287.5 293.5,-281.5 293.5,-275.5 293.5,-275.5 293.5,-263.5 293.5,-263.5 293.5,-257.5 299.5,-251.5 305.5,-251.5 305.5,-251.5 451.5,-251.5 451.5,-251.5 457.5,-251.5 463.5,-257.5 463.5,-263.5 463.5,-263.5 463.5,-275.5 463.5,-275.5 463.5,-281.5 457.5,-287.5 451.5,-287.5"/>
<text text-anchor="middle" x="378.5" y="-265.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_snapshot</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__handle_snapshot -->
<g id="edge3" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__handle_snapshot</title>
<path fill="none" stroke="#666666" d="M160.07,-269.5C197.94,-269.5 243.58,-269.5 283.25,-269.5"/>
<polygon fill="#666666" stroke="#666666" points="283.46,-273 293.46,-269.5 283.46,-266 283.46,-273"/>
</g>
<!-- RaftCore__become_follower -->
<g id="node5" class="node">
<title>RaftCore__become_follower</title>
<path fill="none" stroke="#1c2123" d="M454,-233.5C454,-233.5 303,-233.5 303,-233.5 297,-233.5 291,-227.5 291,-221.5 291,-221.5 291,-209.5 291,-209.5 291,-203.5 297,-197.5 303,-197.5 303,-197.5 454,-197.5 454,-197.5 460,-197.5 466,-203.5 466,-209.5 466,-209.5 466,-221.5 466,-221.5 466,-227.5 460,-233.5 454,-233.5"/>
<text text-anchor="middle" x="378.5" y="-211.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__become_follower</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__become_follower -->
<g id="edge4" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__become_follower</title>
<path fill="none" stroke="#666666" d="M153.81,-251.45C167.77,-248.26 182.3,-245.12 196,-242.5 223.45,-237.25 253.4,-232.42 280.91,-228.35"/>
<polygon fill="#666666" stroke="#666666" points="281.54,-231.8 290.93,-226.88 280.53,-224.87 281.54,-231.8"/>
</g>
<!-- RaftCore__poll -->
<g id="node6" class="node">
<title>RaftCore__poll</title>
<path fill="none" stroke="#1c2123" d="M208,-78C208,-78 549,-78 549,-78 555,-78 561,-84 561,-90 561,-90 561,-157 561,-157 561,-163 555,-169 549,-169 549,-169 208,-169 208,-169 202,-169 196,-163 196,-157 196,-157 196,-90 196,-90 196,-84 202,-78 208,-78"/>
<text text-anchor="middle" x="378.5" y="-153.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__poll</text>
<polyline fill="none" stroke="#1c2123" points="196,-146 561,-146 "/>
<text text-anchor="start" x="204" y="-130.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">查看投票结果</text>
<text text-anchor="start" x="204" y="-115.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果赢得了选票 如过stateRole是PreCandidate 就继续发起</text>
<text text-anchor="start" x="204" y="-100.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> campaign(CAMPAIGN_ELECTION)</text>
<text text-anchor="start" x="204" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果stateRole是Candidate就成为leader</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__poll -->
<g id="edge5" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__poll</title>
<path fill="none" stroke="#666666" d="M102.76,-251.46C125.07,-233.64 161.32,-206.5 196,-188.5 206.44,-183.08 217.44,-177.92 228.65,-173.06"/>
<polygon fill="#666666" stroke="#666666" points="230.26,-176.17 238.1,-169.04 227.52,-169.73 230.26,-176.17"/>
</g>
<!-- RaftCore__send -->
<g id="node10" class="node">
<title>RaftCore__send</title>
<path fill="none" stroke="#1c2123" d="M938.5,-325.5C938.5,-325.5 858.5,-325.5 858.5,-325.5 852.5,-325.5 846.5,-319.5 846.5,-313.5 846.5,-313.5 846.5,-301.5 846.5,-301.5 846.5,-295.5 852.5,-289.5 858.5,-289.5 858.5,-289.5 938.5,-289.5 938.5,-289.5 944.5,-289.5 950.5,-295.5 950.5,-301.5 950.5,-301.5 950.5,-313.5 950.5,-313.5 950.5,-319.5 944.5,-325.5 938.5,-325.5"/>
<text text-anchor="middle" x="898.5" y="-303.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send</text>
</g>
<!-- RaftCore__handle_append_entries&#45;&gt;RaftCore__send -->
<g id="edge10" class="edge">
<title>RaftCore__handle_append_entries&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M404.93,-437.59C474.46,-484.65 671.33,-601.47 803,-516.5 865.7,-476.04 887.25,-382.82 894.29,-335.76"/>
<polygon fill="#666666" stroke="#666666" points="897.78,-336.04 895.68,-325.65 890.85,-335.08 897.78,-336.04"/>
</g>
<!-- RaftCore__send_request_snapshot -->
<g id="node11" class="node">
<title>RaftCore__send_request_snapshot</title>
<path fill="none" stroke="#1c2123" d="M610,-336C610,-336 790,-336 790,-336 796,-336 802,-342 802,-348 802,-348 802,-385 802,-385 802,-391 796,-397 790,-397 790,-397 610,-397 610,-397 604,-397 598,-391 598,-385 598,-385 598,-348 598,-348 598,-342 604,-336 610,-336"/>
<text text-anchor="middle" x="700" y="-381.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send_request_snapshot</text>
<polyline fill="none" stroke="#1c2123" points="598,-374 802,-374 "/>
<text text-anchor="start" x="606" y="-358.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">follower日志落后太多了</text>
<text text-anchor="start" x="606" y="-343.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 让leader发送snapshot过来</text>
</g>
<!-- RaftCore__handle_append_entries&#45;&gt;RaftCore__send_request_snapshot -->
<g id="edge11" class="edge">
<title>RaftCore__handle_append_entries&#45;&gt;RaftCore__send_request_snapshot</title>
<path fill="none" stroke="#666666" d="M480.59,-402.73C514.62,-397.09 552.77,-390.76 587.55,-384.99"/>
<polygon fill="#666666" stroke="#666666" points="588.45,-388.39 597.74,-383.3 587.31,-381.48 588.45,-388.39"/>
</g>
<!-- RaftLog__maybe_append -->
<g id="node12" class="node">
<title>RaftLog__maybe_append</title>
<path fill="none" stroke="#1c2123" d="M622.5,-416C622.5,-416 777.5,-416 777.5,-416 783.5,-416 789.5,-422 789.5,-428 789.5,-428 789.5,-495 789.5,-495 789.5,-501 783.5,-507 777.5,-507 777.5,-507 622.5,-507 622.5,-507 616.5,-507 610.5,-501 610.5,-495 610.5,-495 610.5,-428 610.5,-428 610.5,-422 616.5,-416 622.5,-416"/>
<text text-anchor="middle" x="700" y="-491.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__maybe_append</text>
<polyline fill="none" stroke="#1c2123" points="610.5,-484 789.5,-484 "/>
<text text-anchor="start" x="618.5" y="-468.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">append leade发来的log entry</text>
<text text-anchor="start" x="618.5" y="-453.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果不能append</text>
<text text-anchor="start" x="618.5" y="-438.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 就handle_append_entries</text>
<text text-anchor="start" x="618.5" y="-423.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 就会发送reject消息</text>
</g>
<!-- RaftCore__handle_append_entries&#45;&gt;RaftLog__maybe_append -->
<g id="edge12" class="edge">
<title>RaftCore__handle_append_entries&#45;&gt;RaftLog__maybe_append</title>
<path fill="none" stroke="#666666" d="M480.59,-432.79C518.86,-437.82 562.33,-443.53 600.37,-448.53"/>
<polygon fill="#666666" stroke="#666666" points="600.05,-452.02 610.43,-449.86 600.97,-445.08 600.05,-452.02"/>
</g>
<!-- RaftCore__handle_heartbeat&#45;&gt;RaftCore__send -->
<g id="edge13" class="edge">
<title>RaftCore__handle_heartbeat&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M464.75,-320.87C569.38,-317.63 744.24,-312.23 836.39,-309.39"/>
<polygon fill="#666666" stroke="#666666" points="836.51,-312.89 846.4,-309.08 836.29,-305.89 836.51,-312.89"/>
</g>
<!-- RaftCore__handle_heartbeat&#45;&gt;RaftCore__send_request_snapshot -->
<g id="edge14" class="edge">
<title>RaftCore__handle_heartbeat&#45;&gt;RaftCore__send_request_snapshot</title>
<path fill="none" stroke="#666666" d="M464.7,-334.97C502.45,-340.05 547.35,-346.09 587.7,-351.52"/>
<polygon fill="#666666" stroke="#666666" points="587.48,-355.02 597.86,-352.89 588.41,-348.08 587.48,-355.02"/>
</g>
<!-- RaftCore__handle_snapshot&#45;&gt;RaftCore__send -->
<g id="edge15" class="edge">
<title>RaftCore__handle_snapshot&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M463.59,-275.67C567.98,-283.33 743.52,-296.2 836.1,-303"/>
<polygon fill="#666666" stroke="#666666" points="835.92,-306.49 846.15,-303.73 836.43,-299.51 835.92,-306.49"/>
</g>
<!-- RaftCore__campaign -->
<g id="node7" class="node">
<title>RaftCore__campaign</title>
<path fill="none" stroke="#1c2123" d="M632,-150C632,-150 768,-150 768,-150 774,-150 780,-156 780,-162 780,-162 780,-229 780,-229 780,-235 774,-241 768,-241 768,-241 632,-241 632,-241 626,-241 620,-235 620,-229 620,-229 620,-162 620,-162 620,-156 626,-150 632,-150"/>
<text text-anchor="middle" x="700" y="-225.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__campaign</text>
<polyline fill="none" stroke="#1c2123" points="620,-218 780,-218 "/>
<text text-anchor="start" x="628" y="-202.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向pr中的所有voters</text>
<text text-anchor="start" x="628" y="-187.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送MsgRequestPreVote</text>
<text text-anchor="start" x="628" y="-172.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> MsgRequestVote</text>
<text text-anchor="start" x="628" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 消息</text>
</g>
<!-- RaftCore__poll&#45;&gt;RaftCore__campaign -->
<g id="edge6" class="edge">
<title>RaftCore__poll&#45;&gt;RaftCore__campaign</title>
<path fill="none" stroke="#666666" d="M561.19,-164.44C578.01,-168.23 594.51,-171.95 609.9,-175.42"/>
<polygon fill="#666666" stroke="#666666" points="609.33,-178.88 619.86,-177.67 610.87,-172.05 609.33,-178.88"/>
</g>
<!-- RaftCore__become_leader -->
<g id="node8" class="node">
<title>RaftCore__become_leader</title>
<path fill="none" stroke="#1c2123" d="M769,-131.5C769,-131.5 631,-131.5 631,-131.5 625,-131.5 619,-125.5 619,-119.5 619,-119.5 619,-107.5 619,-107.5 619,-101.5 625,-95.5 631,-95.5 631,-95.5 769,-95.5 769,-95.5 775,-95.5 781,-101.5 781,-107.5 781,-107.5 781,-119.5 781,-119.5 781,-125.5 775,-131.5 769,-131.5"/>
<text text-anchor="middle" x="700" y="-109.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__become_leader</text>
</g>
<!-- RaftCore__poll&#45;&gt;RaftCore__become_leader -->
<g id="edge7" class="edge">
<title>RaftCore__poll&#45;&gt;RaftCore__become_leader</title>
<path fill="none" stroke="#666666" d="M561.19,-117.81C577.51,-117.3 593.52,-116.8 608.52,-116.33"/>
<polygon fill="#666666" stroke="#666666" points="608.85,-119.82 618.74,-116.01 608.63,-112.83 608.85,-119.82"/>
</g>
<!-- RaftCore__bcast_append -->
<g id="node9" class="node">
<title>RaftCore__bcast_append</title>
<path fill="none" stroke="#1c2123" d="M609,-0.5C609,-0.5 791,-0.5 791,-0.5 797,-0.5 803,-6.5 803,-12.5 803,-12.5 803,-64.5 803,-64.5 803,-70.5 797,-76.5 791,-76.5 791,-76.5 609,-76.5 609,-76.5 603,-76.5 597,-70.5 597,-64.5 597,-64.5 597,-12.5 597,-12.5 597,-6.5 603,-0.5 609,-0.5"/>
<text text-anchor="middle" x="700" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__bcast_append</text>
<polyline fill="none" stroke="#1c2123" points="597,-53.5 803,-53.5 "/>
<text text-anchor="start" x="605" y="-38.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">赢得了Election</text>
<text text-anchor="start" x="605" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 成为了新的leader</text>
<text text-anchor="start" x="605" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送Append消息给所有的peers</text>
</g>
<!-- RaftCore__poll&#45;&gt;RaftCore__bcast_append -->
<g id="edge8" class="edge">
<title>RaftCore__poll&#45;&gt;RaftCore__bcast_append</title>
<path fill="none" stroke="#666666" d="M550.94,-77.89C563.2,-74.63 575.37,-71.39 587.15,-68.26"/>
<polygon fill="#666666" stroke="#666666" points="588.19,-71.6 596.95,-65.65 586.39,-64.84 588.19,-71.6"/>
</g>
<!-- RaftCore__campaign&#45;&gt;RaftCore__send -->
<g id="edge9" class="edge">
<title>RaftCore__campaign&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M780.07,-240.57C806.51,-255.64 834.87,-271.8 857.09,-284.47"/>
<polygon fill="#666666" stroke="#666666" points="855.49,-287.58 865.91,-289.49 858.95,-281.5 855.49,-287.58"/>
</g>
<!-- RaftCore__append -->
<g id="node14" class="node">
<title>RaftCore__append</title>
<path fill="none" stroke="#1c2123" d="M946,-56.5C946,-56.5 851,-56.5 851,-56.5 845,-56.5 839,-50.5 839,-44.5 839,-44.5 839,-32.5 839,-32.5 839,-26.5 845,-20.5 851,-20.5 851,-20.5 946,-20.5 946,-20.5 952,-20.5 958,-26.5 958,-32.5 958,-32.5 958,-44.5 958,-44.5 958,-50.5 952,-56.5 946,-56.5"/>
<text text-anchor="middle" x="898.5" y="-34.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__append</text>
</g>
<!-- RaftCore__bcast_append&#45;&gt;RaftCore__append -->
<g id="edge18" class="edge">
<title>RaftCore__bcast_append&#45;&gt;RaftCore__append</title>
<path fill="none" stroke="#666666" d="M803.28,-38.5C811.87,-38.5 820.42,-38.5 828.66,-38.5"/>
<polygon fill="#666666" stroke="#666666" points="828.92,-42 838.92,-38.5 828.92,-35 828.92,-42"/>
</g>
<!-- Raft__msgs -->
<g id="node13" class="node">
<title>Raft__msgs</title>
<path fill="none" stroke="#1c2123" d="M1064,-325.5C1064,-325.5 1006,-325.5 1006,-325.5 1000,-325.5 994,-319.5 994,-313.5 994,-313.5 994,-301.5 994,-301.5 994,-295.5 1000,-289.5 1006,-289.5 1006,-289.5 1064,-289.5 1064,-289.5 1070,-289.5 1076,-295.5 1076,-301.5 1076,-301.5 1076,-313.5 1076,-313.5 1076,-319.5 1070,-325.5 1064,-325.5"/>
<text text-anchor="middle" x="1035" y="-303.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Raft__msgs</text>
</g>
<!-- RaftCore__send&#45;&gt;Raft__msgs -->
<g id="edge17" class="edge">
<title>RaftCore__send&#45;&gt;Raft__msgs</title>
<path fill="none" stroke="#666666" d="M950.73,-307.5C961.53,-307.5 972.92,-307.5 983.69,-307.5"/>
<polygon fill="#666666" stroke="#666666" points="983.78,-311 993.78,-307.5 983.78,-304 983.78,-311"/>
</g>
<!-- RaftCore__send_request_snapshot&#45;&gt;RaftCore__send -->
<g id="edge16" class="edge">
<title>RaftCore__send_request_snapshot&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M802.13,-336.14C813.86,-332.61 825.54,-329.1 836.5,-325.82"/>
<polygon fill="#666666" stroke="#666666" points="837.77,-329.09 846.34,-322.86 835.75,-322.39 837.77,-329.09"/>
</g>
</g>
</svg>
