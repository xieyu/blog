<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: handle_vote_resp Pages: 1 -->
<svg width="1013pt" height="339pt"
 viewBox="0.00 0.00 1013.00 338.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 334.5)">
<title>handle_vote_resp</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-334.5 1009,-334.5 1009,4 -4,4"/>
<!-- RaftCore__step_candidate -->
<g id="node1" class="node">
<title>RaftCore__step_candidate</title>
<path fill="none" stroke="#1c2123" d="M148,-179.5C148,-179.5 12,-179.5 12,-179.5 6,-179.5 0,-173.5 0,-167.5 0,-167.5 0,-155.5 0,-155.5 0,-149.5 6,-143.5 12,-143.5 12,-143.5 148,-143.5 148,-143.5 154,-143.5 160,-149.5 160,-155.5 160,-155.5 160,-167.5 160,-167.5 160,-173.5 154,-179.5 148,-179.5"/>
<text text-anchor="middle" x="80" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__step_candidate</text>
</g>
<!-- RaftCore__poll -->
<g id="node2" class="node">
<title>RaftCore__poll</title>
<path fill="none" stroke="#1c2123" d="M348,-179.5C348,-179.5 271,-179.5 271,-179.5 265,-179.5 259,-173.5 259,-167.5 259,-167.5 259,-155.5 259,-155.5 259,-149.5 265,-143.5 271,-143.5 271,-143.5 348,-143.5 348,-143.5 354,-143.5 360,-149.5 360,-155.5 360,-155.5 360,-167.5 360,-167.5 360,-173.5 354,-179.5 348,-179.5"/>
<text text-anchor="middle" x="309.5" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__poll</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__poll -->
<g id="edge1" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__poll</title>
<path fill="none" stroke="#666666" d="M160.25,-161.5C189.36,-161.5 221.8,-161.5 248.89,-161.5"/>
<polygon fill="#666666" stroke="#666666" points="249,-165 259,-161.5 249,-158 249,-165"/>
</g>
<!-- RaftCore__campaign -->
<g id="node3" class="node">
<title>RaftCore__campaign</title>
<path fill="none" stroke="#1c2123" d="M254.5,-253C254.5,-253 364.5,-253 364.5,-253 370.5,-253 376.5,-259 376.5,-265 376.5,-265 376.5,-302 376.5,-302 376.5,-308 370.5,-314 364.5,-314 364.5,-314 254.5,-314 254.5,-314 248.5,-314 242.5,-308 242.5,-302 242.5,-302 242.5,-265 242.5,-265 242.5,-259 248.5,-253 254.5,-253"/>
<text text-anchor="middle" x="309.5" y="-298.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__campaign</text>
<polyline fill="none" stroke="#1c2123" points="242.5,-291 376.5,-291 "/>
<text text-anchor="start" x="250.5" y="-275.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">赢得了Pre election</text>
<text text-anchor="start" x="250.5" y="-260.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发起真正的election</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__campaign -->
<g id="edge2" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__campaign</title>
<path fill="none" stroke="#666666" d="M114.57,-179.5C148.08,-197.47 200.47,-225.57 242.36,-248.03"/>
<polygon fill="#666666" stroke="#666666" points="240.93,-251.24 251.4,-252.88 244.24,-245.07 240.93,-251.24"/>
</g>
<!-- RaftCore__maybe_commit_by_vote -->
<g id="node4" class="node">
<title>RaftCore__maybe_commit_by_vote</title>
<path fill="none" stroke="#1c2123" d="M208,-64C208,-64 411,-64 411,-64 417,-64 423,-70 423,-76 423,-76 423,-113 423,-113 423,-119 417,-125 411,-125 411,-125 208,-125 208,-125 202,-125 196,-119 196,-113 196,-113 196,-76 196,-76 196,-70 202,-64 208,-64"/>
<text text-anchor="middle" x="309.5" y="-109.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__maybe_commit_by_vote</text>
<polyline fill="none" stroke="#1c2123" points="196,-102 423,-102 "/>
<text text-anchor="start" x="204" y="-86.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用vote resp中的comit info</text>
<text text-anchor="start" x="204" y="-71.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 来尝试更新自己的committed index</text>
</g>
<!-- RaftCore__step_candidate&#45;&gt;RaftCore__maybe_commit_by_vote -->
<g id="edge3" class="edge">
<title>RaftCore__step_candidate&#45;&gt;RaftCore__maybe_commit_by_vote</title>
<path fill="none" stroke="#666666" d="M142.27,-143.46C158.55,-138.66 176.68,-133.32 194.8,-127.98"/>
<polygon fill="#666666" stroke="#666666" points="195.96,-131.29 204.56,-125.11 193.98,-124.58 195.96,-131.29"/>
</g>
<!-- ProgressTracker__record_votes -->
<g id="node5" class="node">
<title>ProgressTracker__record_votes</title>
<path fill="none" stroke="#1c2123" d="M471,-0.5C471,-0.5 635,-0.5 635,-0.5 641,-0.5 647,-6.5 647,-12.5 647,-12.5 647,-34.5 647,-34.5 647,-40.5 641,-46.5 635,-46.5 635,-46.5 471,-46.5 471,-46.5 465,-46.5 459,-40.5 459,-34.5 459,-34.5 459,-12.5 459,-12.5 459,-6.5 465,-0.5 471,-0.5"/>
<text text-anchor="middle" x="553" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ProgressTracker__record_votes</text>
<polyline fill="none" stroke="#1c2123" points="459,-23.5 647,-23.5 "/>
<text text-anchor="start" x="467" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">记录peer对自己的投票</text>
</g>
<!-- RaftCore__poll&#45;&gt;ProgressTracker__record_votes -->
<g id="edge4" class="edge">
<title>RaftCore__poll&#45;&gt;ProgressTracker__record_votes</title>
<path fill="none" stroke="#666666" d="M360.28,-158.86C381.48,-155.53 405.35,-148.6 423,-134.5 451.26,-111.92 432.54,-86.17 459,-61.5 462.73,-58.02 466.83,-54.84 471.15,-51.94"/>
<polygon fill="#666666" stroke="#666666" points="473.02,-54.9 479.71,-46.69 469.36,-48.93 473.02,-54.9"/>
</g>
<!-- ProgressTracker__tally_votes -->
<g id="node6" class="node">
<title>ProgressTracker__tally_votes</title>
<path fill="none" stroke="#1c2123" d="M476,-184C476,-184 630,-184 630,-184 636,-184 642,-190 642,-196 642,-196 642,-233 642,-233 642,-239 636,-245 630,-245 630,-245 476,-245 476,-245 470,-245 464,-239 464,-233 464,-233 464,-196 464,-196 464,-190 470,-184 476,-184"/>
<text text-anchor="middle" x="553" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ProgressTracker__tally_votes</text>
<polyline fill="none" stroke="#1c2123" points="464,-222 642,-222 "/>
<text text-anchor="start" x="472" y="-206.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">统计选票，看自己</text>
<text text-anchor="start" x="472" y="-191.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 是否赢得了选举</text>
</g>
<!-- RaftCore__poll&#45;&gt;ProgressTracker__tally_votes -->
<g id="edge5" class="edge">
<title>RaftCore__poll&#45;&gt;ProgressTracker__tally_votes</title>
<path fill="none" stroke="#666666" d="M360.25,-172.42C387.27,-178.35 421.67,-185.9 453.84,-192.96"/>
<polygon fill="#666666" stroke="#666666" points="453.22,-196.41 463.74,-195.13 454.72,-189.57 453.22,-196.41"/>
</g>
<!-- RaftCore__become_leader -->
<g id="node7" class="node">
<title>RaftCore__become_leader</title>
<path fill="none" stroke="#1c2123" d="M703.5,-203.5C703.5,-203.5 843.5,-203.5 843.5,-203.5 849.5,-203.5 855.5,-209.5 855.5,-215.5 855.5,-215.5 855.5,-237.5 855.5,-237.5 855.5,-243.5 849.5,-249.5 843.5,-249.5 843.5,-249.5 703.5,-249.5 703.5,-249.5 697.5,-249.5 691.5,-243.5 691.5,-237.5 691.5,-237.5 691.5,-215.5 691.5,-215.5 691.5,-209.5 697.5,-203.5 703.5,-203.5"/>
<text text-anchor="middle" x="773.5" y="-234.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__become_leader</text>
<polyline fill="none" stroke="#1c2123" points="691.5,-226.5 855.5,-226.5 "/>
<text text-anchor="start" x="699.5" y="-211.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">赢得了选举，传给leader</text>
</g>
<!-- RaftCore__poll&#45;&gt;RaftCore__become_leader -->
<g id="edge6" class="edge">
<title>RaftCore__poll&#45;&gt;RaftCore__become_leader</title>
<path fill="none" stroke="#666666" d="M330.79,-179.51C357.81,-202.17 408.13,-239.88 459,-254.5 532.16,-275.52 618.52,-265.37 682.06,-251.75"/>
<polygon fill="#666666" stroke="#666666" points="683.05,-255.12 692.06,-249.54 681.54,-248.29 683.05,-255.12"/>
</g>
<!-- RaftCore__bcast_append -->
<g id="node8" class="node">
<title>RaftCore__bcast_append</title>
<path fill="none" stroke="#1c2123" d="M488.5,-104C488.5,-104 617.5,-104 617.5,-104 623.5,-104 629.5,-110 629.5,-116 629.5,-116 629.5,-153 629.5,-153 629.5,-159 623.5,-165 617.5,-165 617.5,-165 488.5,-165 488.5,-165 482.5,-165 476.5,-159 476.5,-153 476.5,-153 476.5,-116 476.5,-116 476.5,-110 482.5,-104 488.5,-104"/>
<text text-anchor="middle" x="553" y="-149.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__bcast_append</text>
<polyline fill="none" stroke="#1c2123" points="476.5,-142 629.5,-142 "/>
<text text-anchor="start" x="484.5" y="-126.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">成为leader之后</text>
<text text-anchor="start" x="484.5" y="-111.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 广播append消息</text>
</g>
<!-- RaftCore__poll&#45;&gt;RaftCore__bcast_append -->
<g id="edge7" class="edge">
<title>RaftCore__poll&#45;&gt;RaftCore__bcast_append</title>
<path fill="none" stroke="#666666" d="M360.25,-155.94C390.66,-152.54 430.39,-148.1 465.8,-144.14"/>
<polygon fill="#666666" stroke="#666666" points="466.59,-147.57 476.14,-142.98 465.82,-140.61 466.59,-147.57"/>
</g>
<!-- RaftCore__become_follower -->
<g id="node9" class="node">
<title>RaftCore__become_follower</title>
<path fill="none" stroke="#1c2123" d="M698,-123C698,-123 849,-123 849,-123 855,-123 861,-129 861,-135 861,-135 861,-172 861,-172 861,-178 855,-184 849,-184 849,-184 698,-184 698,-184 692,-184 686,-178 686,-172 686,-172 686,-135 686,-135 686,-129 692,-123 698,-123"/>
<text text-anchor="middle" x="773.5" y="-168.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__become_follower</text>
<polyline fill="none" stroke="#1c2123" points="686,-161 861,-161 "/>
<text text-anchor="start" x="694" y="-145.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">选举失败，成为follower</text>
<text text-anchor="start" x="694" y="-130.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> leaderID为INVALID_ID</text>
</g>
<!-- RaftCore__poll&#45;&gt;RaftCore__become_follower -->
<g id="edge8" class="edge">
<title>RaftCore__poll&#45;&gt;RaftCore__become_follower</title>
<path fill="none" stroke="#666666" d="M360.01,-156.2C380.57,-152.37 404.01,-145.8 423,-134.5 443.55,-122.27 437.15,-104.23 459,-94.5 535.33,-60.51 565.45,-76.29 647,-94.5 669.11,-99.44 691.92,-108.72 711.93,-118.48"/>
<polygon fill="#666666" stroke="#666666" points="710.4,-121.63 720.91,-122.98 713.54,-115.37 710.4,-121.63"/>
</g>
<!-- RaftCore__become_candidate -->
<g id="node11" class="node">
<title>RaftCore__become_candidate</title>
<path fill="#feed9b" stroke="#f7e495" d="M695,-269C695,-269 852,-269 852,-269 858,-269 864,-275 864,-281 864,-281 864,-318 864,-318 864,-324 858,-330 852,-330 852,-330 695,-330 695,-330 689,-330 683,-324 683,-318 683,-318 683,-281 683,-281 683,-275 689,-269 695,-269"/>
<text text-anchor="middle" x="773.5" y="-314.8" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftCore__become_candidate</text>
<polyline fill="none" stroke="#f7e495" points="683,-307 864,-307 "/>
<text text-anchor="start" x="691" y="-291.8" font-family="Times,serif" font-size="14.00" fill="#40575d">传为真正的candidate</text>
<text text-anchor="start" x="691" y="-276.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 将自己的term + 1</text>
</g>
<!-- RaftCore__campaign&#45;&gt;RaftCore__become_candidate -->
<g id="edge11" class="edge">
<title>RaftCore__campaign&#45;&gt;RaftCore__become_candidate</title>
<path fill="none" stroke="#666666" d="M376.69,-285.79C454.05,-288.47 582.87,-292.93 672.45,-296.03"/>
<polygon fill="#666666" stroke="#666666" points="672.51,-299.54 682.63,-296.39 672.75,-292.54 672.51,-299.54"/>
</g>
<!-- ProgressTracker__votes -->
<g id="node10" class="node">
<title>ProgressTracker__votes</title>
<path fill="#feed9b" stroke="#f7e495" d="M696.5,-35.5C696.5,-35.5 850.5,-35.5 850.5,-35.5 856.5,-35.5 862.5,-41.5 862.5,-47.5 862.5,-47.5 862.5,-69.5 862.5,-69.5 862.5,-75.5 856.5,-81.5 850.5,-81.5 850.5,-81.5 696.5,-81.5 696.5,-81.5 690.5,-81.5 684.5,-75.5 684.5,-69.5 684.5,-69.5 684.5,-47.5 684.5,-47.5 684.5,-41.5 690.5,-35.5 696.5,-35.5"/>
<text text-anchor="middle" x="773.5" y="-66.3" font-family="Times,serif" font-size="14.00" fill="#40575d">ProgressTracker__votes</text>
<polyline fill="none" stroke="#f7e495" points="684.5,-58.5 862.5,-58.5 "/>
<text text-anchor="start" x="692.5" y="-43.3" font-family="Times,serif" font-size="14.00" fill="#40575d">votes: HashMap&lt;u64, bool&gt;,</text>
</g>
<!-- ProgressTracker__record_votes&#45;&gt;ProgressTracker__votes -->
<g id="edge9" class="edge">
<title>ProgressTracker__record_votes&#45;&gt;ProgressTracker__votes</title>
<path fill="none" stroke="#666666" d="M647.3,-38.44C656.23,-39.88 665.31,-41.33 674.29,-42.77"/>
<polygon fill="#666666" stroke="#666666" points="673.94,-46.26 684.37,-44.38 675.05,-39.35 673.94,-46.26"/>
</g>
<!-- ProgressTracker__tally_votes&#45;&gt;RaftCore__become_leader -->
<g id="edge12" class="edge">
<title>ProgressTracker__tally_votes&#45;&gt;RaftCore__become_leader</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M642.24,-219.35C655.05,-220.05 668.25,-220.77 681.11,-221.48"/>
<polygon fill="green" stroke="green" points="681.17,-224.99 691.34,-222.04 681.55,-218 681.17,-224.99"/>
</g>
<!-- ProgressTracker__tally_votes&#45;&gt;RaftCore__become_follower -->
<g id="edge13" class="edge">
<title>ProgressTracker__tally_votes&#45;&gt;RaftCore__become_follower</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M642.24,-189.86C653.33,-186.77 664.71,-183.59 675.92,-180.46"/>
<polygon fill="green" stroke="green" points="677.01,-183.79 685.7,-177.73 675.13,-177.05 677.01,-183.79"/>
</g>
<!-- ProgressTracker__tally_votes&#45;&gt;ProgressTracker__votes -->
<g id="edge10" class="edge">
<title>ProgressTracker__tally_votes&#45;&gt;ProgressTracker__votes</title>
<path fill="none" stroke="#666666" d="M634.67,-183.87C639.02,-180.99 643.17,-177.87 647,-174.5 670.63,-153.7 660.94,-135.96 683,-113.5 692.77,-103.55 704.69,-94.64 716.59,-87.04"/>
<polygon fill="#666666" stroke="#666666" points="718.54,-89.95 725.23,-81.73 714.88,-83.98 718.54,-89.95"/>
</g>
<!-- ProgressTracker__tally_votes&#45;&gt;RaftCore__become_candidate -->
<g id="edge14" class="edge">
<title>ProgressTracker__tally_votes&#45;&gt;RaftCore__become_candidate</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M632.57,-245.07C649.4,-251.61 667.28,-258.57 684.44,-265.24"/>
<polygon fill="green" stroke="green" points="683.3,-268.56 693.89,-268.92 685.84,-262.03 683.3,-268.56"/>
</g>
<!-- RaftCore__reset -->
<g id="node12" class="node">
<title>RaftCore__reset</title>
<path fill="none" stroke="#1c2123" d="M993,-244.5C993,-244.5 912,-244.5 912,-244.5 906,-244.5 900,-238.5 900,-232.5 900,-232.5 900,-220.5 900,-220.5 900,-214.5 906,-208.5 912,-208.5 912,-208.5 993,-208.5 993,-208.5 999,-208.5 1005,-214.5 1005,-220.5 1005,-220.5 1005,-232.5 1005,-232.5 1005,-238.5 999,-244.5 993,-244.5"/>
<text text-anchor="middle" x="952.5" y="-222.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__reset</text>
</g>
<!-- RaftCore__become_leader&#45;&gt;RaftCore__reset -->
<g id="edge15" class="edge">
<title>RaftCore__become_leader&#45;&gt;RaftCore__reset</title>
<path fill="none" stroke="#666666" d="M855.75,-226.5C867.11,-226.5 878.64,-226.5 889.56,-226.5"/>
<polygon fill="#666666" stroke="#666666" points="889.83,-230 899.83,-226.5 889.83,-223 889.83,-230"/>
</g>
<!-- RaftCore__become_follower&#45;&gt;RaftCore__reset -->
<g id="edge16" class="edge">
<title>RaftCore__become_follower&#45;&gt;RaftCore__reset</title>
<path fill="none" stroke="#666666" d="M848.54,-184.04C865.25,-190.93 882.66,-198.11 898.32,-204.57"/>
<polygon fill="#666666" stroke="#666666" points="897.24,-207.91 907.81,-208.48 899.9,-201.43 897.24,-207.91"/>
</g>
<!-- RaftCore__become_candidate&#45;&gt;RaftCore__reset -->
<g id="edge17" class="edge">
<title>RaftCore__become_candidate&#45;&gt;RaftCore__reset</title>
<path fill="none" stroke="#666666" d="M848.54,-268.96C865.25,-262.07 882.66,-254.89 898.32,-248.43"/>
<polygon fill="#666666" stroke="#666666" points="899.9,-251.57 907.81,-244.52 897.24,-245.09 899.9,-251.57"/>
</g>
</g>
</svg>
