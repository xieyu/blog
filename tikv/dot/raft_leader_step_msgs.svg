<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: leader_step_msgs Pages: 1 -->
<svg width="1638pt" height="521pt"
 viewBox="0.00 0.00 1638.00 521.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 517)">
<title>leader_step_msgs</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-517 1634,-517 1634,4 -4,4"/>
<!-- RaftCore__step_leader -->
<g id="node1" class="node">
<title>RaftCore__step_leader</title>
<path fill="none" stroke="#1c2123" d="M129,-296.93C129,-296.93 12,-296.93 12,-296.93 6,-296.93 0,-290.93 0,-284.93 0,-284.93 0,-272.93 0,-272.93 0,-266.93 6,-260.93 12,-260.93 12,-260.93 129,-260.93 129,-260.93 135,-260.93 141,-266.93 141,-272.93 141,-272.93 141,-284.93 141,-284.93 141,-290.93 135,-296.93 129,-296.93"/>
<text text-anchor="middle" x="70.5" y="-275.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__step_leader</text>
</g>
<!-- Raft__bcast_heartbeat -->
<g id="node2" class="node">
<title>Raft__bcast_heartbeat</title>
<path fill="none" stroke="#1c2123" d="M189,-346.93C189,-346.93 413,-346.93 413,-346.93 419,-346.93 425,-352.93 425,-358.93 425,-358.93 425,-410.93 425,-410.93 425,-416.93 419,-422.93 413,-422.93 413,-422.93 189,-422.93 189,-422.93 183,-422.93 177,-416.93 177,-410.93 177,-410.93 177,-358.93 177,-358.93 177,-352.93 183,-346.93 189,-346.93"/>
<text text-anchor="middle" x="301" y="-407.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">Raft__bcast_heartbeat</text>
<polyline fill="none" stroke="#1c2123" points="177,-399.93 425,-399.93 "/>
<text text-anchor="start" x="185" y="-384.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.read_only.last_pending_request_ctx();</text>
<text text-anchor="start" x="185" y="-369.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 遍历所有的ProgressTracker</text>
<text text-anchor="start" x="185" y="-354.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 给所有的peer发送heartbeat</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;Raft__bcast_heartbeat -->
<g id="edge1" class="edge">
<title>RaftCore__step_leader&#45;&gt;Raft__bcast_heartbeat</title>
<path fill="none" stroke="#666666" d="M110.52,-297.03C137.55,-309.57 174.69,-326.8 208.93,-342.68"/>
<polygon fill="#666666" stroke="#666666" points="207.49,-345.87 218.03,-346.9 210.44,-339.52 207.49,-345.87"/>
</g>
<!-- RaftCore__handle_append_response -->
<g id="node3" class="node">
<title>RaftCore__handle_append_response</title>
<path fill="none" stroke="#1c2123" d="M205.5,-141.93C205.5,-141.93 396.5,-141.93 396.5,-141.93 402.5,-141.93 408.5,-147.93 408.5,-153.93 408.5,-153.93 408.5,-205.93 408.5,-205.93 408.5,-211.93 402.5,-217.93 396.5,-217.93 396.5,-217.93 205.5,-217.93 205.5,-217.93 199.5,-217.93 193.5,-211.93 193.5,-205.93 193.5,-205.93 193.5,-153.93 193.5,-153.93 193.5,-147.93 199.5,-141.93 205.5,-141.93"/>
<text text-anchor="middle" x="301" y="-202.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_append_response</text>
<polyline fill="none" stroke="#1c2123" points="193.5,-194.93 408.5,-194.93 "/>
<text text-anchor="start" x="201.5" y="-179.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果被follower reject了</text>
<text text-anchor="start" x="201.5" y="-164.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 重新计算log entries</text>
<text text-anchor="start" x="201.5" y="-149.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后发给follower</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftCore__handle_append_response -->
<g id="edge2" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftCore__handle_append_response</title>
<path fill="none" stroke="#666666" d="M113.14,-260.89C138.33,-249.97 171.56,-235.58 203.01,-221.95"/>
<polygon fill="#666666" stroke="#666666" points="204.47,-225.13 212.26,-217.94 201.69,-218.71 204.47,-225.13"/>
</g>
<!-- RaftCore__handle_transfer_leader -->
<g id="node4" class="node">
<title>RaftCore__handle_transfer_leader</title>
<path fill="none" stroke="#1c2123" d="M390.5,-46.93C390.5,-46.93 211.5,-46.93 211.5,-46.93 205.5,-46.93 199.5,-40.93 199.5,-34.93 199.5,-34.93 199.5,-22.93 199.5,-22.93 199.5,-16.93 205.5,-10.93 211.5,-10.93 211.5,-10.93 390.5,-10.93 390.5,-10.93 396.5,-10.93 402.5,-16.93 402.5,-22.93 402.5,-22.93 402.5,-34.93 402.5,-34.93 402.5,-40.93 396.5,-46.93 390.5,-46.93"/>
<text text-anchor="middle" x="301" y="-25.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_transfer_leader</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftCore__handle_transfer_leader -->
<g id="edge3" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftCore__handle_transfer_leader</title>
<path fill="none" stroke="#666666" d="M82.51,-260.64C100.38,-231.7 137.68,-174.3 177,-131.93 204.7,-102.08 240.87,-72.74 266.8,-53.05"/>
<polygon fill="#666666" stroke="#666666" points="268.95,-55.82 274.84,-47.01 264.75,-50.22 268.95,-55.82"/>
</g>
<!-- RaftCore__handle_hearbeat_response -->
<g id="node5" class="node">
<title>RaftCore__handle_hearbeat_response</title>
<path fill="none" stroke="#1c2123" d="M202,-248.43C202,-248.43 400,-248.43 400,-248.43 406,-248.43 412,-254.43 412,-260.43 412,-260.43 412,-297.43 412,-297.43 412,-303.43 406,-309.43 400,-309.43 400,-309.43 202,-309.43 202,-309.43 196,-309.43 190,-303.43 190,-297.43 190,-297.43 190,-260.43 190,-260.43 190,-254.43 196,-248.43 202,-248.43"/>
<text text-anchor="middle" x="301" y="-294.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_hearbeat_response</text>
<polyline fill="none" stroke="#1c2123" points="190,-286.43 412,-286.43 "/>
<text text-anchor="start" x="198" y="-271.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果folower matched &lt; last_index</text>
<text text-anchor="start" x="198" y="-256.23" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送新log entry给follower</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftCore__handle_hearbeat_response -->
<g id="edge4" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftCore__handle_hearbeat_response</title>
<path fill="none" stroke="#666666" d="M141.3,-278.93C153.54,-278.93 166.58,-278.93 179.73,-278.93"/>
<polygon fill="#666666" stroke="#666666" points="179.79,-282.43 189.79,-278.93 179.79,-275.43 179.79,-282.43"/>
</g>
<!-- RaftCore__send -->
<g id="node6" class="node">
<title>RaftCore__send</title>
<path fill="none" stroke="#1c2123" d="M1500,-313.93C1500,-313.93 1420,-313.93 1420,-313.93 1414,-313.93 1408,-307.93 1408,-301.93 1408,-301.93 1408,-289.93 1408,-289.93 1408,-283.93 1414,-277.93 1420,-277.93 1420,-277.93 1500,-277.93 1500,-277.93 1506,-277.93 1512,-283.93 1512,-289.93 1512,-289.93 1512,-301.93 1512,-301.93 1512,-307.93 1506,-313.93 1500,-313.93"/>
<text text-anchor="middle" x="1460" y="-292.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftCore__send -->
<g id="edge5" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M78.17,-297.1C91.39,-330.27 124.26,-400.22 177,-432.93 323.09,-523.53 388.09,-486.93 560,-486.93 560,-486.93 560,-486.93 1008.5,-486.93 1170.28,-486.93 1236.45,-556.23 1372,-467.93 1422.45,-435.07 1444.96,-363.44 1453.88,-323.76"/>
<polygon fill="#666666" stroke="#666666" points="1457.31,-324.45 1455.96,-313.94 1450.47,-323 1457.31,-324.45"/>
</g>
<!-- Raft__bcast_heartbeat_with_ctx -->
<g id="node8" class="node">
<title>Raft__bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#1c2123" d="M644.5,-405.93C644.5,-405.93 477.5,-405.93 477.5,-405.93 471.5,-405.93 465.5,-399.93 465.5,-393.93 465.5,-393.93 465.5,-381.93 465.5,-381.93 465.5,-375.93 471.5,-369.93 477.5,-369.93 477.5,-369.93 644.5,-369.93 644.5,-369.93 650.5,-369.93 656.5,-375.93 656.5,-381.93 656.5,-381.93 656.5,-393.93 656.5,-393.93 656.5,-399.93 650.5,-405.93 644.5,-405.93"/>
<text text-anchor="middle" x="561" y="-384.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">Raft__bcast_heartbeat_with_ctx</text>
</g>
<!-- Raft__bcast_heartbeat&#45;&gt;Raft__bcast_heartbeat_with_ctx -->
<g id="edge6" class="edge">
<title>Raft__bcast_heartbeat&#45;&gt;Raft__bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#666666" d="M425.33,-386.36C435.33,-386.48 445.38,-386.6 455.23,-386.71"/>
<polygon fill="#666666" stroke="#666666" points="455.37,-390.21 465.41,-386.83 455.45,-383.21 455.37,-390.21"/>
</g>
<!-- RaftCore__send_append -->
<g id="node9" class="node">
<title>RaftCore__send_append</title>
<path fill="none" stroke="#1c2123" d="M916,-179.43C916,-179.43 1099,-179.43 1099,-179.43 1105,-179.43 1111,-185.43 1111,-191.43 1111,-191.43 1111,-258.43 1111,-258.43 1111,-264.43 1105,-270.43 1099,-270.43 1099,-270.43 916,-270.43 916,-270.43 910,-270.43 904,-264.43 904,-258.43 904,-258.43 904,-191.43 904,-191.43 904,-185.43 910,-179.43 916,-179.43"/>
<text text-anchor="middle" x="1007.5" y="-255.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send_append</text>
<polyline fill="none" stroke="#1c2123" points="904,-247.43 1111,-247.43 "/>
<text text-anchor="start" x="912" y="-232.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">Sends an append RPC with </text>
<text text-anchor="start" x="912" y="-217.23" font-family="Times,serif" font-size="14.00" fill="#2f3638"> new entries (if any) and the </text>
<text text-anchor="start" x="912" y="-202.23" font-family="Times,serif" font-size="14.00" fill="#2f3638"> current commit index to the given</text>
<text text-anchor="start" x="912" y="-187.23" font-family="Times,serif" font-size="14.00" fill="#2f3638"> peer.</text>
</g>
<!-- RaftCore__handle_append_response&#45;&gt;RaftCore__send_append -->
<g id="edge11" class="edge">
<title>RaftCore__handle_append_response&#45;&gt;RaftCore__send_append</title>
<path fill="none" stroke="#666666" d="M408.67,-210.44C426.03,-214.34 443.92,-217.73 461,-219.93 609.71,-239.04 783.1,-236.43 893.78,-231.65"/>
<polygon fill="#666666" stroke="#666666" points="894.13,-235.14 903.96,-231.2 893.81,-228.14 894.13,-235.14"/>
</g>
<!-- RaftCore__maybe_commit -->
<g id="node10" class="node">
<title>RaftCore__maybe_commit</title>
<path fill="none" stroke="#1c2123" d="M490,-149.43C490,-149.43 632,-149.43 632,-149.43 638,-149.43 644,-155.43 644,-161.43 644,-161.43 644,-198.43 644,-198.43 644,-204.43 638,-210.43 632,-210.43 632,-210.43 490,-210.43 490,-210.43 484,-210.43 478,-204.43 478,-198.43 478,-198.43 478,-161.43 478,-161.43 478,-155.43 484,-149.43 490,-149.43"/>
<text text-anchor="middle" x="561" y="-195.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__maybe_commit</text>
<polyline fill="none" stroke="#1c2123" points="478,-187.43 644,-187.43 "/>
<text text-anchor="start" x="486" y="-172.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">Attempts to advance</text>
<text text-anchor="start" x="486" y="-157.23" font-family="Times,serif" font-size="14.00" fill="#2f3638"> the commit index</text>
</g>
<!-- RaftCore__handle_append_response&#45;&gt;RaftCore__maybe_commit -->
<g id="edge12" class="edge">
<title>RaftCore__handle_append_response&#45;&gt;RaftCore__maybe_commit</title>
<path fill="none" stroke="#666666" d="M408.8,-179.93C428.31,-179.93 448.51,-179.93 467.56,-179.93"/>
<polygon fill="#666666" stroke="#666666" points="467.7,-183.43 477.7,-179.93 467.7,-176.43 467.7,-183.43"/>
</g>
<!-- RaftCore__should_bcast_commit -->
<g id="node11" class="node">
<title>RaftCore__should_bcast_commit</title>
<path fill="none" stroke="#1c2123" d="M649,-130.93C649,-130.93 473,-130.93 473,-130.93 467,-130.93 461,-124.93 461,-118.93 461,-118.93 461,-106.93 461,-106.93 461,-100.93 467,-94.93 473,-94.93 473,-94.93 649,-94.93 649,-94.93 655,-94.93 661,-100.93 661,-106.93 661,-106.93 661,-118.93 661,-118.93 661,-124.93 655,-130.93 649,-130.93"/>
<text text-anchor="middle" x="561" y="-109.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__should_bcast_commit</text>
</g>
<!-- RaftCore__handle_append_response&#45;&gt;RaftCore__should_bcast_commit -->
<g id="edge13" class="edge">
<title>RaftCore__handle_append_response&#45;&gt;RaftCore__should_bcast_commit</title>
<path fill="none" stroke="#666666" d="M408.8,-152.19C432.83,-145.95 457.92,-139.44 480.6,-133.55"/>
<polygon fill="#666666" stroke="#666666" points="481.7,-136.88 490.5,-130.98 479.94,-130.1 481.7,-136.88"/>
</g>
<!-- Raft__bcast_append -->
<g id="node12" class="node">
<title>Raft__bcast_append</title>
<path fill="none" stroke="#1c2123" d="M709,-104.93C709,-104.93 849,-104.93 849,-104.93 855,-104.93 861,-110.93 861,-116.93 861,-116.93 861,-168.93 861,-168.93 861,-174.93 855,-180.93 849,-180.93 849,-180.93 709,-180.93 709,-180.93 703,-180.93 697,-174.93 697,-168.93 697,-168.93 697,-116.93 697,-116.93 697,-110.93 703,-104.93 709,-104.93"/>
<text text-anchor="middle" x="779" y="-165.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">Raft__bcast_append</text>
<polyline fill="none" stroke="#1c2123" points="697,-157.93 861,-157.93 "/>
<text text-anchor="start" x="705" y="-142.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">Sends RPC, with entries to</text>
<text text-anchor="start" x="705" y="-127.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> all peers that are</text>
<text text-anchor="start" x="705" y="-112.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> not up&#45;to&#45;date</text>
</g>
<!-- RaftCore__handle_append_response&#45;&gt;Raft__bcast_append -->
<g id="edge14" class="edge">
<title>RaftCore__handle_append_response&#45;&gt;Raft__bcast_append</title>
<path fill="none" stroke="#666666" d="M350.76,-141.78C380.73,-120.81 420.94,-96.88 461,-85.93 546.74,-62.48 574.38,-65.95 661,-85.93 675.31,-89.23 689.9,-94.53 703.7,-100.6"/>
<polygon fill="#666666" stroke="#666666" points="702.56,-103.93 713.11,-104.91 705.48,-97.56 702.56,-103.93"/>
</g>
<!-- RaftCore__handle_transfer_leader&#45;&gt;RaftCore__send_append -->
<g id="edge15" class="edge">
<title>RaftCore__handle_transfer_leader&#45;&gt;RaftCore__send_append</title>
<path fill="none" stroke="#666666" d="M402.53,-22.34C518.55,-18.8 712.45,-25.61 861,-94.93 899.3,-112.8 934.83,-144.13 961.19,-171.56"/>
<polygon fill="#666666" stroke="#666666" points="958.97,-174.3 968.38,-179.17 964.06,-169.5 958.97,-174.3"/>
</g>
<!-- RaftCore__send_timeout_now -->
<g id="node13" class="node">
<title>RaftCore__send_timeout_now</title>
<path fill="none" stroke="#1c2123" d="M909,-24.93C909,-24.93 1106,-24.93 1106,-24.93 1112,-24.93 1118,-30.93 1118,-36.93 1118,-36.93 1118,-88.93 1118,-88.93 1118,-94.93 1112,-100.93 1106,-100.93 1106,-100.93 909,-100.93 909,-100.93 903,-100.93 897,-94.93 897,-88.93 897,-88.93 897,-36.93 897,-36.93 897,-30.93 903,-24.93 909,-24.93"/>
<text text-anchor="middle" x="1007.5" y="-85.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send_timeout_now</text>
<polyline fill="none" stroke="#1c2123" points="897,-77.93 1118,-77.93 "/>
<text text-anchor="start" x="905" y="-62.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果leader transfee 有足够</text>
<text text-anchor="start" x="905" y="-47.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 新的日志，立刻发送TimeoutNow</text>
<text text-anchor="start" x="905" y="-32.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 消息给它</text>
</g>
<!-- RaftCore__handle_transfer_leader&#45;&gt;RaftCore__send_timeout_now -->
<g id="edge16" class="edge">
<title>RaftCore__handle_transfer_leader&#45;&gt;RaftCore__send_timeout_now</title>
<path fill="none" stroke="#666666" d="M402.71,-15.36C515.21,-2.76 702.37,10.56 861,-14.93 872.17,-16.72 883.65,-19.25 895.02,-22.21"/>
<polygon fill="#666666" stroke="#666666" points="894.41,-25.67 904.98,-24.92 896.24,-18.91 894.41,-25.67"/>
</g>
<!-- RaftCore__handle_hearbeat_response&#45;&gt;RaftCore__send -->
<g id="edge9" class="edge">
<title>RaftCore__handle_hearbeat_response&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M412.43,-292.03C508.79,-302.32 652.44,-314.93 778,-314.93 778,-314.93 778,-314.93 1008.5,-314.93 1147.66,-314.93 1310.79,-305.77 1397.5,-300.17"/>
<polygon fill="#666666" stroke="#666666" points="1397.93,-303.65 1407.68,-299.5 1397.48,-296.66 1397.93,-303.65"/>
</g>
<!-- RaftCore__handle_hearbeat_response&#45;&gt;RaftCore__send_append -->
<g id="edge10" class="edge">
<title>RaftCore__handle_hearbeat_response&#45;&gt;RaftCore__send_append</title>
<path fill="none" stroke="#666666" d="M412.05,-276.12C524.97,-272.46 705.63,-264.47 861,-247.93 871.61,-246.8 882.63,-245.43 893.64,-243.92"/>
<polygon fill="#666666" stroke="#666666" points="894.32,-247.36 903.74,-242.5 893.35,-240.43 894.32,-247.36"/>
</g>
<!-- Raft__msgs -->
<g id="node15" class="node">
<title>Raft__msgs</title>
<path fill="none" stroke="#1c2123" d="M1618,-313.93C1618,-313.93 1560,-313.93 1560,-313.93 1554,-313.93 1548,-307.93 1548,-301.93 1548,-301.93 1548,-289.93 1548,-289.93 1548,-283.93 1554,-277.93 1560,-277.93 1560,-277.93 1618,-277.93 1618,-277.93 1624,-277.93 1630,-283.93 1630,-289.93 1630,-289.93 1630,-301.93 1630,-301.93 1630,-307.93 1624,-313.93 1618,-313.93"/>
<text text-anchor="middle" x="1589" y="-292.23" font-family="Times,serif" font-size="14.00" fill="#2f3638">Raft__msgs</text>
</g>
<!-- RaftCore__send&#45;&gt;Raft__msgs -->
<g id="edge24" class="edge">
<title>RaftCore__send&#45;&gt;Raft__msgs</title>
<path fill="none" stroke="#666666" d="M1512.29,-295.93C1520.71,-295.93 1529.42,-295.93 1537.81,-295.93"/>
<polygon fill="#666666" stroke="#666666" points="1537.85,-299.43 1547.85,-295.93 1537.85,-292.43 1537.85,-299.43"/>
</g>
<!-- RaftCore__send_heartbeat -->
<g id="node7" class="node">
<title>RaftCore__send_heartbeat</title>
<path fill="none" stroke="#1c2123" d="M1166,-343.93C1166,-343.93 1360,-343.93 1360,-343.93 1366,-343.93 1372,-349.93 1372,-355.93 1372,-355.93 1372,-445.93 1372,-445.93 1372,-451.93 1366,-457.93 1360,-457.93 1360,-457.93 1166,-457.93 1166,-457.93 1160,-457.93 1154,-451.93 1154,-445.93 1154,-445.93 1154,-355.93 1154,-355.93 1154,-349.93 1160,-343.93 1166,-343.93"/>
<text text-anchor="middle" x="1263" y="-442.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send_heartbeat</text>
<polyline fill="none" stroke="#1c2123" points="1154,-434.93 1372,-434.93 "/>
<text text-anchor="start" x="1162" y="-419.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">发送MsgHeartbeat</text>
<text text-anchor="start" x="1162" y="-404.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 并附带上commit index</text>
<text text-anchor="start" x="1162" y="-389.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> let commit = cmp::min(pr.matched,</text>
<text text-anchor="start" x="1162" y="-374.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> self.raft_log.committed);</text>
<polyline fill="none" stroke="#1c2123" points="1154,-366.93 1372,-366.93 "/>
<text text-anchor="start" x="1162" y="-351.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">m.context= context</text>
</g>
<!-- RaftCore__send_heartbeat&#45;&gt;RaftCore__send -->
<g id="edge8" class="edge">
<title>RaftCore__send_heartbeat&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M1370.06,-343.82C1386.32,-335.07 1402.26,-326.48 1416.05,-319.06"/>
<polygon fill="#666666" stroke="#666666" points="1418.08,-321.94 1425.23,-314.11 1414.76,-315.77 1418.08,-321.94"/>
</g>
<!-- Raft__bcast_heartbeat_with_ctx&#45;&gt;RaftCore__send_heartbeat -->
<g id="edge7" class="edge">
<title>Raft__bcast_heartbeat_with_ctx&#45;&gt;RaftCore__send_heartbeat</title>
<path fill="none" stroke="#666666" d="M656.77,-389.69C783.03,-392.03 1006.39,-396.18 1143.6,-398.73"/>
<polygon fill="#666666" stroke="#666666" points="1143.67,-402.23 1153.74,-398.92 1143.8,-395.23 1143.67,-402.23"/>
</g>
<!-- RaftCore__send_append&#45;&gt;RaftCore__send -->
<g id="edge21" class="edge">
<title>RaftCore__send_append&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M1111.18,-249.55C1125.52,-252.6 1140.1,-255.49 1154,-257.93 1238.02,-272.65 1336.03,-283.81 1397.8,-290.11"/>
<polygon fill="#666666" stroke="#666666" points="1397.47,-293.59 1407.77,-291.11 1398.17,-286.62 1397.47,-293.59"/>
</g>
<!-- RaftCore__maybe_send_append -->
<g id="node14" class="node">
<title>RaftCore__maybe_send_append</title>
<path fill="none" stroke="#1c2123" d="M1170,-171.93C1170,-171.93 1356,-171.93 1356,-171.93 1362,-171.93 1368,-177.93 1368,-183.93 1368,-183.93 1368,-235.93 1368,-235.93 1368,-241.93 1362,-247.93 1356,-247.93 1356,-247.93 1170,-247.93 1170,-247.93 1164,-247.93 1158,-241.93 1158,-235.93 1158,-235.93 1158,-183.93 1158,-183.93 1158,-177.93 1164,-171.93 1170,-171.93"/>
<text text-anchor="middle" x="1263" y="-232.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__maybe_send_append</text>
<polyline fill="none" stroke="#1c2123" points="1158,-224.93 1368,-224.93 "/>
<text text-anchor="start" x="1166" y="-209.73" font-family="Times,serif" font-size="14.00" fill="#2f3638">发送entries或空的message</text>
<text text-anchor="start" x="1166" y="-194.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> covey updated Committed indexes</text>
<text text-anchor="start" x="1166" y="-179.73" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 或snapshot给peer</text>
</g>
<!-- RaftCore__send_append&#45;&gt;RaftCore__maybe_send_append -->
<g id="edge19" class="edge">
<title>RaftCore__send_append&#45;&gt;RaftCore__maybe_send_append</title>
<path fill="none" stroke="#666666" d="M1111.24,-218.85C1123.25,-218.14 1135.56,-217.41 1147.71,-216.69"/>
<polygon fill="#666666" stroke="#666666" points="1148.1,-220.17 1157.87,-216.09 1147.69,-213.19 1148.1,-220.17"/>
</g>
<!-- RaftCore__maybe_commit&#45;&gt;Raft__bcast_append -->
<g id="edge22" class="edge">
<title>RaftCore__maybe_commit&#45;&gt;Raft__bcast_append</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M644.28,-165.83C658.09,-163.47 672.5,-161 686.53,-158.6"/>
<polygon fill="green" stroke="green" points="687.4,-162 696.67,-156.86 686.22,-155.1 687.4,-162"/>
</g>
<!-- RaftCore__should_bcast_commit&#45;&gt;Raft__bcast_append -->
<g id="edge23" class="edge">
<title>RaftCore__should_bcast_commit&#45;&gt;Raft__bcast_append</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M661.15,-126.7C669.76,-127.89 678.44,-129.1 686.98,-130.29"/>
<polygon fill="green" stroke="green" points="686.54,-133.76 696.93,-131.67 687.5,-126.83 686.54,-133.76"/>
</g>
<!-- Raft__bcast_append&#45;&gt;RaftCore__send_append -->
<g id="edge18" class="edge">
<title>Raft__bcast_append&#45;&gt;RaftCore__send_append</title>
<path fill="none" stroke="#666666" d="M861.13,-172.3C871.94,-176.21 883.18,-180.28 894.4,-184.34"/>
<polygon fill="#666666" stroke="#666666" points="893.21,-187.64 903.81,-187.75 895.6,-181.06 893.21,-187.64"/>
</g>
<!-- RaftCore__send_timeout_now&#45;&gt;RaftCore__send -->
<g id="edge17" class="edge">
<title>RaftCore__send_timeout_now&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M1118.33,-72.54C1195.46,-83.92 1297.69,-108.75 1372,-162.93 1409.06,-189.95 1434.67,-237.95 1448.08,-268.29"/>
<polygon fill="#666666" stroke="#666666" points="1445.01,-270.03 1452.15,-277.85 1451.45,-267.28 1445.01,-270.03"/>
</g>
<!-- RaftCore__maybe_send_append&#45;&gt;RaftCore__send -->
<g id="edge20" class="edge">
<title>RaftCore__maybe_send_append&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M1350.38,-248.02C1370.24,-256.78 1390.72,-265.81 1408.47,-273.64"/>
<polygon fill="#666666" stroke="#666666" points="1407.46,-277.02 1418.03,-277.86 1410.29,-270.62 1407.46,-277.02"/>
</g>
</g>
</svg>
