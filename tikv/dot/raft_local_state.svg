<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: raft_local_state Pages: 1 -->
<svg width="1080pt" height="622pt"
 viewBox="0.00 0.00 1080.00 622.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 618)">
<title>raft_local_state</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-618 1076,-618 1076,4 -4,4"/>
<!-- Ready -->
<g id="node1" class="node">
<title>Ready</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M22.5,-170.5C22.5,-170.5 177.5,-170.5 177.5,-170.5 183.5,-170.5 189.5,-176.5 189.5,-182.5 189.5,-182.5 189.5,-365.5 189.5,-365.5 189.5,-371.5 183.5,-377.5 177.5,-377.5 177.5,-377.5 22.5,-377.5 22.5,-377.5 16.5,-377.5 10.5,-371.5 10.5,-365.5 10.5,-365.5 10.5,-182.5 10.5,-182.5 10.5,-176.5 16.5,-170.5 22.5,-170.5"/>
<text text-anchor="middle" x="100" y="-362.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">Ready</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-354.5 189.5,-354.5 "/>
<text text-anchor="start" x="18.5" y="-339.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">number: u64,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-331.5 189.5,-331.5 "/>
<text text-anchor="start" x="18.5" y="-316.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">ss: Option&lt;SoftState&gt;,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-308.5 189.5,-308.5 "/>
<text text-anchor="start" x="18.5" y="-293.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">hs: Option&lt;HardState&gt;,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-285.5 189.5,-285.5 "/>
<text text-anchor="start" x="18.5" y="-270.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">read_states: Vec&lt;ReadState&gt;,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-262.5 189.5,-262.5 "/>
<text text-anchor="start" x="18.5" y="-247.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">entries: Vec&lt;Entry&gt;,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-239.5 189.5,-239.5 "/>
<text text-anchor="start" x="18.5" y="-224.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">snapshot: Snapshot,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-216.5 189.5,-216.5 "/>
<text text-anchor="start" x="18.5" y="-201.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">light: LightReady,</text>
<polyline fill="none" stroke="#8a8898" points="10.5,-193.5 189.5,-193.5 "/>
<text text-anchor="start" x="18.5" y="-178.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">must_sync: bool,</text>
</g>
<!-- PeerStorage_handle_raft_ready -->
<g id="node2" class="node">
<title>PeerStorage_handle_raft_ready</title>
<path fill="none" stroke="#1c2123" d="M259,-228.5C259,-228.5 411,-228.5 411,-228.5 417,-228.5 423,-234.5 423,-240.5 423,-240.5 423,-307.5 423,-307.5 423,-313.5 417,-319.5 411,-319.5 411,-319.5 259,-319.5 259,-319.5 253,-319.5 247,-313.5 247,-307.5 247,-307.5 247,-240.5 247,-240.5 247,-234.5 253,-228.5 259,-228.5"/>
<text text-anchor="start" x="255" y="-304.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerStorage</text>
<text text-anchor="start" x="255" y="-289.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_raft_ready</text>
<polyline fill="none" stroke="#1c2123" points="247,-281.5 423,-281.5 "/>
<text text-anchor="start" x="255" y="-266.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建InvokeContext</text>
<text text-anchor="start" x="255" y="-251.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 设置ctx的hardstate</text>
<text text-anchor="start" x="255" y="-236.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将log entrie写入write batch</text>
</g>
<!-- Ready&#45;&gt;PeerStorage_handle_raft_ready -->
<g id="edge1" class="edge">
<title>Ready&#45;&gt;PeerStorage_handle_raft_ready</title>
<path fill="none" stroke="#666666" d="M189.75,-274C205.05,-274 221.02,-274 236.54,-274"/>
<polygon fill="#666666" stroke="#666666" points="236.65,-277.5 246.65,-274 236.65,-270.5 236.65,-277.5"/>
</g>
<!-- InvokeContext -->
<g id="node3" class="node">
<title>InvokeContext</title>
<path fill="none" stroke="#1c2123" d="M691,-81C691,-81 942,-81 942,-81 948,-81 954,-87 954,-93 954,-93 954,-291 954,-291 954,-297 948,-303 942,-303 942,-303 691,-303 691,-303 685,-303 679,-297 679,-291 679,-291 679,-93 679,-93 679,-87 685,-81 691,-81"/>
<text text-anchor="middle" x="816.5" y="-287.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">InvokeContext</text>
<polyline fill="none" stroke="#1c2123" points="679,-280 954,-280 "/>
<text text-anchor="start" x="687" y="-264.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub region_id: u64,</text>
<polyline fill="none" stroke="#1c2123" points="679,-257 954,-257 "/>
<text text-anchor="start" x="687" y="-241.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub raft_state: RaftLocalState,</text>
<polyline fill="none" stroke="#1c2123" points="679,-234 954,-234 "/>
<text text-anchor="start" x="687" y="-218.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub apply_state: RaftApplyState,</text>
<polyline fill="none" stroke="#1c2123" points="679,-211 954,-211 "/>
<text text-anchor="start" x="687" y="-195.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_term: u64,</text>
<polyline fill="none" stroke="#1c2123" points="679,-188 954,-188 "/>
<text text-anchor="start" x="687" y="-172.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub has_new_entries: bool,</text>
<polyline fill="none" stroke="#1c2123" points="679,-165 954,-165 "/>
<text text-anchor="start" x="687" y="-149.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub snap_region: Option&lt;Region&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="679,-142 954,-142 "/>
<text text-anchor="start" x="687" y="-126.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub destroyed_regions: Vec&lt;metapb::Region&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="679,-119 954,-119 "/>
<text text-anchor="start" x="687" y="-103.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_state为PeerStorage</text>
<text text-anchor="start" x="687" y="-88.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> raft state的clone</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;InvokeContext -->
<g id="edge3" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;InvokeContext</title>
<path fill="none" stroke="#666666" d="M420.32,-228.42C436.42,-221.44 453.42,-215.18 470,-211 533.87,-194.88 606.4,-189.09 668.47,-187.73"/>
<polygon fill="#666666" stroke="#666666" points="668.8,-191.22 678.73,-187.54 668.67,-184.22 668.8,-191.22"/>
</g>
<!-- InvokeContext_set_hard_state -->
<g id="node4" class="node">
<title>InvokeContext_set_hard_state</title>
<path fill="none" stroke="#1c2123" d="M779.5,-0.5C779.5,-0.5 853.5,-0.5 853.5,-0.5 859.5,-0.5 865.5,-6.5 865.5,-12.5 865.5,-12.5 865.5,-49.5 865.5,-49.5 865.5,-55.5 859.5,-61.5 853.5,-61.5 853.5,-61.5 779.5,-61.5 779.5,-61.5 773.5,-61.5 767.5,-55.5 767.5,-49.5 767.5,-49.5 767.5,-12.5 767.5,-12.5 767.5,-6.5 773.5,-0.5 779.5,-0.5"/>
<text text-anchor="start" x="775.5" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">InvokeContext</text>
<polyline fill="none" stroke="#1c2123" points="767.5,-38.5 865.5,-38.5 "/>
<text text-anchor="start" x="775.5" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_state</text>
<text text-anchor="start" x="775.5" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> set_hard_state</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;InvokeContext_set_hard_state -->
<g id="edge4" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;InvokeContext_set_hard_state</title>
<path fill="none" stroke="#666666" d="M400.12,-228.47C466.93,-182.9 576.05,-113.58 679,-71 704.07,-60.63 732.76,-51.79 757.35,-45.08"/>
<polygon fill="#666666" stroke="#666666" points="758.5,-48.4 767.26,-42.43 756.69,-41.64 758.5,-48.4"/>
</g>
<!-- InvokeContext_save_snapshot_raft_state_to -->
<g id="node6" class="node">
<title>InvokeContext_save_snapshot_raft_state_to</title>
<path fill="none" stroke="#1c2123" d="M482,-427C482,-427 631,-427 631,-427 637,-427 643,-433 643,-439 643,-439 643,-453 643,-453 643,-459 637,-465 631,-465 631,-465 482,-465 482,-465 476,-465 470,-459 470,-453 470,-453 470,-439 470,-439 470,-433 476,-427 482,-427"/>
<text text-anchor="start" x="478" y="-449.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">InvokeContext</text>
<text text-anchor="start" x="478" y="-434.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> save_snapshot_raft_state_to</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;InvokeContext_save_snapshot_raft_state_to -->
<g id="edge5" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;InvokeContext_save_snapshot_raft_state_to</title>
<path fill="none" stroke="#666666" d="M368.94,-319.58C393.64,-350.85 429.96,-391.2 470,-417 473.08,-418.98 476.31,-420.85 479.64,-422.6"/>
<polygon fill="#666666" stroke="#666666" points="478.11,-425.75 488.64,-426.96 481.17,-419.45 478.11,-425.75"/>
</g>
<!-- InvokeContext_save_raft_state_to -->
<g id="node7" class="node">
<title>InvokeContext_save_raft_state_to</title>
<path fill="none" stroke="#1c2123" d="M494,-346.5C494,-346.5 619,-346.5 619,-346.5 625,-346.5 631,-352.5 631,-358.5 631,-358.5 631,-395.5 631,-395.5 631,-401.5 625,-407.5 619,-407.5 619,-407.5 494,-407.5 494,-407.5 488,-407.5 482,-401.5 482,-395.5 482,-395.5 482,-358.5 482,-358.5 482,-352.5 488,-346.5 494,-346.5"/>
<text text-anchor="start" x="490" y="-392.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">InvokeContext</text>
<text text-anchor="start" x="490" y="-377.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> save_raft_state_to</text>
<polyline fill="none" stroke="#1c2123" points="482,-369.5 631,-369.5 "/>
<text text-anchor="middle" x="556.5" y="-354.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将raft state写入raft_wb</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;InvokeContext_save_raft_state_to -->
<g id="edge6" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;InvokeContext_save_raft_state_to</title>
<path fill="none" stroke="#666666" d="M423.07,-314.86C442.22,-323.84 462.33,-333.28 480.93,-342.01"/>
<polygon fill="#666666" stroke="#666666" points="479.68,-345.29 490.22,-346.37 482.65,-338.95 479.68,-345.29"/>
</g>
<!-- PeerStorage_append -->
<g id="node8" class="node">
<title>PeerStorage_append</title>
<path fill="none" stroke="#1c2123" d="M482.5,-221C482.5,-221 630.5,-221 630.5,-221 636.5,-221 642.5,-227 642.5,-233 642.5,-233 642.5,-315 642.5,-315 642.5,-321 636.5,-327 630.5,-327 630.5,-327 482.5,-327 482.5,-327 476.5,-327 470.5,-321 470.5,-315 470.5,-315 470.5,-233 470.5,-233 470.5,-227 476.5,-221 482.5,-221"/>
<text text-anchor="start" x="478.5" y="-311.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerStorage</text>
<text text-anchor="start" x="478.5" y="-296.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">append</text>
<polyline fill="none" stroke="#1c2123" points="470.5,-289 642.5,-289 "/>
<text text-anchor="start" x="478.5" y="-273.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将Ready中的entries</text>
<text text-anchor="start" x="478.5" y="-258.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入raft write batch</text>
<text text-anchor="start" x="478.5" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后更新InvokeContext的</text>
<text text-anchor="start" x="478.5" y="-228.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> last_index 和last_term</text>
</g>
<!-- PeerStorage_handle_raft_ready&#45;&gt;PeerStorage_append -->
<g id="edge7" class="edge">
<title>PeerStorage_handle_raft_ready&#45;&gt;PeerStorage_append</title>
<path fill="none" stroke="#666666" d="M423.07,-274C435.22,-274 447.77,-274 460.07,-274"/>
<polygon fill="#666666" stroke="#666666" points="460.33,-277.5 470.33,-274 460.33,-270.5 460.33,-277.5"/>
</g>
<!-- PeerStorage_raft_state -->
<g id="node5" class="node">
<title>PeerStorage_raft_state</title>
<path fill="#feed9b" stroke="#f7e495" d="M1002,-261C1002,-261 1060,-261 1060,-261 1066,-261 1072,-267 1072,-273 1072,-273 1072,-287 1072,-287 1072,-293 1066,-299 1060,-299 1060,-299 1002,-299 1002,-299 996,-299 990,-293 990,-287 990,-287 990,-273 990,-273 990,-267 996,-261 1002,-261"/>
<text text-anchor="start" x="998" y="-283.8" font-family="Times,serif" font-size="14.00" fill="#40575d">PeerStorage</text>
<text text-anchor="start" x="998" y="-268.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> raft_state</text>
</g>
<!-- InvokeContext&#45;&gt;PeerStorage_raft_state -->
<g id="edge2" class="edge">
<title>InvokeContext&#45;&gt;PeerStorage_raft_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M954.18,-248.6C963.33,-252.39 972.15,-256.04 980.34,-259.44"/>
<polygon fill="green" stroke="green" points="979.06,-262.69 989.64,-263.29 981.74,-256.23 979.06,-262.69"/>
</g>
<!-- InvokeContext_set_hard_state&#45;&gt;PeerStorage_raft_state -->
<g id="edge15" class="edge">
<title>InvokeContext_set_hard_state&#45;&gt;PeerStorage_raft_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M865.82,-34.36C894.68,-38.76 930.23,-48.7 954,-71 1005.61,-119.42 1022.28,-205.66 1027.58,-250.73"/>
<polygon fill="green" stroke="green" points="1024.11,-251.16 1028.65,-260.73 1031.07,-250.42 1024.11,-251.16"/>
</g>
<!-- raft_wb -->
<g id="node9" class="node">
<title>raft_wb</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M743,-433C743,-433 890,-433 890,-433 896,-433 902,-439 902,-445 902,-445 902,-497 902,-497 902,-503 896,-509 890,-509 890,-509 743,-509 743,-509 737,-509 731,-503 731,-497 731,-497 731,-445 731,-445 731,-439 737,-433 743,-433"/>
<text text-anchor="middle" x="816.5" y="-493.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">raft_wb</text>
<polyline fill="none" stroke="#8a8898" points="731,-486 902,-486 "/>
<text text-anchor="start" x="739" y="-470.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">raft 的entries和raft state</text>
<text text-anchor="start" x="739" y="-455.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 一起被写入raft log engine</text>
<text text-anchor="start" x="739" y="-440.8" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 的write batch</text>
</g>
<!-- InvokeContext_save_snapshot_raft_state_to&#45;&gt;raft_wb -->
<g id="edge11" class="edge">
<title>InvokeContext_save_snapshot_raft_state_to&#45;&gt;raft_wb</title>
<path fill="none" stroke="#666666" d="M643.05,-454.29C667.91,-456.7 695.22,-459.34 720.61,-461.81"/>
<polygon fill="#666666" stroke="#666666" points="720.33,-465.29 730.62,-462.78 721,-458.33 720.33,-465.29"/>
</g>
<!-- InvokeContext_save_raft_state_to&#45;&gt;raft_wb -->
<g id="edge10" class="edge">
<title>InvokeContext_save_raft_state_to&#45;&gt;raft_wb</title>
<path fill="none" stroke="#666666" d="M631.29,-405.26C647.01,-411.19 663.53,-417.35 679,-423 692.61,-427.97 707.02,-433.14 721.18,-438.16"/>
<polygon fill="#666666" stroke="#666666" points="720.33,-441.57 730.92,-441.61 722.66,-434.97 720.33,-441.57"/>
</g>
<!-- PeerStorage_append&#45;&gt;InvokeContext -->
<g id="edge8" class="edge">
<title>PeerStorage_append&#45;&gt;InvokeContext</title>
<path fill="none" stroke="#666666" d="M642.69,-246.92C651.21,-244.22 660.01,-241.42 668.93,-238.58"/>
<polygon fill="#666666" stroke="#666666" points="670.18,-241.86 678.65,-235.5 668.06,-235.19 670.18,-241.86"/>
</g>
<!-- PeerStorage_append&#45;&gt;raft_wb -->
<g id="edge9" class="edge">
<title>PeerStorage_append&#45;&gt;raft_wb</title>
<path fill="none" stroke="#666666" d="M634.54,-327.28C637.54,-330.42 640.38,-333.67 643,-337 668.6,-369.58 648.86,-394.57 679,-423 690.95,-434.28 705.71,-442.93 721.06,-449.55"/>
<polygon fill="#666666" stroke="#666666" points="720.09,-452.93 730.68,-453.42 722.71,-446.44 720.09,-452.93"/>
</g>
<!-- InvokeContext_set_last_index -->
<g id="node12" class="node">
<title>InvokeContext_set_last_index</title>
<path fill="none" stroke="#1c2123" d="M779.5,-322.5C779.5,-322.5 853.5,-322.5 853.5,-322.5 859.5,-322.5 865.5,-328.5 865.5,-334.5 865.5,-334.5 865.5,-401.5 865.5,-401.5 865.5,-407.5 859.5,-413.5 853.5,-413.5 853.5,-413.5 779.5,-413.5 779.5,-413.5 773.5,-413.5 767.5,-407.5 767.5,-401.5 767.5,-401.5 767.5,-334.5 767.5,-334.5 767.5,-328.5 773.5,-322.5 779.5,-322.5"/>
<text text-anchor="start" x="775.5" y="-398.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">InvokeContext</text>
<text text-anchor="start" x="775.5" y="-383.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> raft_state</text>
<text text-anchor="middle" x="816.5" y="-368.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> set_last_index</text>
<polyline fill="none" stroke="#1c2123" points="767.5,-360.5 865.5,-360.5 "/>
<text text-anchor="start" x="775.5" y="-345.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">更新last index</text>
<text text-anchor="start" x="775.5" y="-330.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 和last term</text>
</g>
<!-- PeerStorage_append&#45;&gt;InvokeContext_set_last_index -->
<g id="edge14" class="edge">
<title>PeerStorage_append&#45;&gt;InvokeContext_set_last_index</title>
<path fill="none" stroke="#666666" d="M642.69,-305.04C680.37,-318.77 723.69,-334.55 757.54,-346.88"/>
<polygon fill="#666666" stroke="#666666" points="756.68,-350.29 767.27,-350.43 759.07,-343.72 756.68,-350.29"/>
</g>
<!-- RaftPoller_handle_raft_ready -->
<g id="node10" class="node">
<title>RaftPoller_handle_raft_ready</title>
<path fill="none" stroke="#1c2123" d="M12,-485.5C12,-485.5 188,-485.5 188,-485.5 194,-485.5 200,-491.5 200,-497.5 200,-497.5 200,-564.5 200,-564.5 200,-570.5 194,-576.5 188,-576.5 188,-576.5 12,-576.5 12,-576.5 6,-576.5 0,-570.5 0,-564.5 0,-564.5 0,-497.5 0,-497.5 0,-491.5 6,-485.5 12,-485.5"/>
<text text-anchor="start" x="8" y="-561.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftPoller</text>
<text text-anchor="start" x="8" y="-546.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_raft_ready</text>
<polyline fill="none" stroke="#1c2123" points="0,-538.5 200,-538.5 "/>
<text text-anchor="start" x="8" y="-523.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将raft_wb写入raft log engine</text>
<text text-anchor="start" x="8" y="-508.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 写入成功后，回调PeerStorage</text>
<text text-anchor="start" x="8" y="-493.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 的post_ready</text>
</g>
<!-- RaftPoller_handle_raft_ready&#45;&gt;raft_wb -->
<g id="edge13" class="edge">
<title>RaftPoller_handle_raft_ready&#45;&gt;raft_wb</title>
<path fill="none" stroke="#666666" d="M200.08,-517.1C212.17,-515.6 224.36,-514.2 236,-513 406.46,-495.48 605.86,-482.71 720.74,-476.11"/>
<polygon fill="#666666" stroke="#666666" points="721.12,-479.6 730.91,-475.53 720.72,-472.61 721.12,-479.6"/>
</g>
<!-- PeerStorage_post_ready -->
<g id="node11" class="node">
<title>PeerStorage_post_ready</title>
<path fill="none" stroke="#1c2123" d="M248,-522.5C248,-522.5 422,-522.5 422,-522.5 428,-522.5 434,-528.5 434,-534.5 434,-534.5 434,-601.5 434,-601.5 434,-607.5 428,-613.5 422,-613.5 422,-613.5 248,-613.5 248,-613.5 242,-613.5 236,-607.5 236,-601.5 236,-601.5 236,-534.5 236,-534.5 236,-528.5 242,-522.5 248,-522.5"/>
<text text-anchor="start" x="244" y="-598.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PeerStorage</text>
<text text-anchor="start" x="244" y="-583.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> post_ready</text>
<polyline fill="none" stroke="#1c2123" points="236,-575.5 434,-575.5 "/>
<text text-anchor="start" x="244" y="-560.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用InvokeContext的</text>
<text text-anchor="start" x="244" y="-545.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> raft_state, apply_state, last_term</text>
<text text-anchor="start" x="244" y="-530.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 更新PeerStorage的成员变量</text>
</g>
<!-- RaftPoller_handle_raft_ready&#45;&gt;PeerStorage_post_ready -->
<g id="edge12" class="edge">
<title>RaftPoller_handle_raft_ready&#45;&gt;PeerStorage_post_ready</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M200.15,-546.74C208.61,-548.09 217.19,-549.45 225.71,-550.8"/>
<polygon fill="green" stroke="green" points="225.26,-554.28 235.68,-552.39 226.35,-547.36 225.26,-554.28"/>
</g>
<!-- PeerStorage_post_ready&#45;&gt;PeerStorage_raft_state -->
<g id="edge17" class="edge">
<title>PeerStorage_post_ready&#45;&gt;PeerStorage_raft_state</title>
<path fill="none" stroke="#666666" d="M434.17,-590.83C567.16,-615.59 805.01,-637.28 954,-519 1018.79,-467.57 1029.27,-360.84 1030.37,-309.22"/>
<polygon fill="#666666" stroke="#666666" points="1033.87,-309.12 1030.48,-299.08 1026.87,-309.04 1033.87,-309.12"/>
</g>
<!-- InvokeContext_set_last_index&#45;&gt;PeerStorage_raft_state -->
<g id="edge16" class="edge">
<title>InvokeContext_set_last_index&#45;&gt;PeerStorage_raft_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M865.55,-348.41C891.73,-337.71 924.67,-324.19 954,-312 962.54,-308.45 971.62,-304.65 980.41,-300.96"/>
<polygon fill="green" stroke="green" points="981.94,-304.11 989.8,-297.01 979.22,-297.66 981.94,-304.11"/>
</g>
</g>
</svg>
