<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: raft_log_entry_flow Pages: 1 -->
<svg width="1111pt" height="153pt"
 viewBox="0.00 0.00 1111.00 153.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 149)">
<title>raft_log_entry_flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-149 1107,-149 1107,4 -4,4"/>
<!-- App_propose -->
<g id="node1" class="node">
<title>App_propose</title>
<path fill="none" stroke="#1c2123" d="M12,-46C12,-46 101,-46 101,-46 107,-46 113,-52 113,-58 113,-58 113,-87 113,-87 113,-93 107,-99 101,-99 101,-99 12,-99 12,-99 6,-99 0,-93 0,-87 0,-87 0,-58 0,-58 0,-52 6,-46 12,-46"/>
<text text-anchor="start" x="8" y="-83.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">在leader节点</text>
<text text-anchor="start" x="8" y="-68.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 应用propose log</text>
<text text-anchor="start" x="8" y="-53.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> entry</text>
</g>
<!-- append_to_leader_log_entry -->
<g id="node2" class="node">
<title>append_to_leader_log_entry</title>
<path fill="none" stroke="#1c2123" d="M161,-53.5C161,-53.5 278,-53.5 278,-53.5 284,-53.5 290,-59.5 290,-65.5 290,-65.5 290,-79.5 290,-79.5 290,-85.5 284,-91.5 278,-91.5 278,-91.5 161,-91.5 161,-91.5 155,-91.5 149,-85.5 149,-79.5 149,-79.5 149,-65.5 149,-65.5 149,-59.5 155,-53.5 161,-53.5"/>
<text text-anchor="start" x="157" y="-76.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">leader节点将log entry</text>
<text text-anchor="start" x="157" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 保存到磁盘</text>
</g>
<!-- App_propose&#45;&gt;append_to_leader_log_entry -->
<g id="edge1" class="edge">
<title>App_propose&#45;&gt;append_to_leader_log_entry</title>
<path fill="none" stroke="#666666" d="M113.36,-72.5C121.58,-72.5 130.19,-72.5 138.78,-72.5"/>
<polygon fill="#666666" stroke="#666666" points="138.84,-76 148.84,-72.5 138.84,-69 138.84,-76"/>
</g>
<!-- send_to_followers -->
<g id="node3" class="node">
<title>send_to_followers</title>
<path fill="none" stroke="#1c2123" d="M338,-42C338,-42 478,-42 478,-42 484,-42 490,-48 490,-54 490,-54 490,-91 490,-91 490,-97 484,-103 478,-103 478,-103 338,-103 338,-103 332,-103 326,-97 326,-91 326,-91 326,-54 326,-54 326,-48 332,-42 338,-42"/>
<text text-anchor="middle" x="408" y="-87.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">send_to_followers</text>
<polyline fill="none" stroke="#1c2123" points="326,-80 490,-80 "/>
<text text-anchor="start" x="334" y="-64.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">leader节点将日志复制给</text>
<text text-anchor="start" x="334" y="-49.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 集群中的follower</text>
</g>
<!-- append_to_leader_log_entry&#45;&gt;send_to_followers -->
<g id="edge2" class="edge">
<title>append_to_leader_log_entry&#45;&gt;send_to_followers</title>
<path fill="none" stroke="#666666" d="M290.21,-72.5C298.54,-72.5 307.14,-72.5 315.71,-72.5"/>
<polygon fill="#666666" stroke="#666666" points="315.75,-76 325.75,-72.5 315.75,-69 315.75,-76"/>
</g>
<!-- save_in_follower_log -->
<g id="node4" class="node">
<title>save_in_follower_log</title>
<path fill="none" stroke="#1c2123" d="M538,-46C538,-46 655,-46 655,-46 661,-46 667,-52 667,-58 667,-58 667,-87 667,-87 667,-93 661,-99 655,-99 655,-99 538,-99 538,-99 532,-99 526,-93 526,-87 526,-87 526,-58 526,-58 526,-52 532,-46 538,-46"/>
<text text-anchor="start" x="534" y="-83.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">follower保存好日志</text>
<text text-anchor="start" x="534" y="-68.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后回复leader</text>
<text text-anchor="start" x="534" y="-53.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 自己last index和term</text>
</g>
<!-- send_to_followers&#45;&gt;save_in_follower_log -->
<g id="edge3" class="edge">
<title>send_to_followers&#45;&gt;save_in_follower_log</title>
<path fill="none" stroke="#666666" d="M490.26,-72.5C498.7,-72.5 507.28,-72.5 515.71,-72.5"/>
<polygon fill="#666666" stroke="#666666" points="515.89,-76 525.89,-72.5 515.89,-69 515.89,-76"/>
</g>
<!-- commit -->
<g id="node5" class="node">
<title>commit</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M715,-0.5C715,-0.5 897,-0.5 897,-0.5 903,-0.5 909,-6.5 909,-12.5 909,-12.5 909,-132.5 909,-132.5 909,-138.5 903,-144.5 897,-144.5 897,-144.5 715,-144.5 715,-144.5 709,-144.5 703,-138.5 703,-132.5 703,-132.5 703,-12.5 703,-12.5 703,-6.5 709,-0.5 715,-0.5"/>
<text text-anchor="middle" x="806" y="-129.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">commit</text>
<polyline fill="none" stroke="#8a8898" points="703,-121.5 909,-121.5 "/>
<text text-anchor="start" x="711" y="-106.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">leader根据follower的resp</text>
<text text-anchor="start" x="711" y="-91.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 计算commit index</text>
<text text-anchor="start" x="711" y="-76.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 并且commit当前term的</text>
<text text-anchor="start" x="711" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> log entry</text>
<polyline fill="none" stroke="#8a8898" points="703,-53.5 909,-53.5 "/>
<text text-anchor="start" x="711" y="-38.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">被commit的log entry是安全的</text>
<text text-anchor="start" x="711" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 已经被复制到集群大部分节点</text>
<text text-anchor="start" x="711" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 不会丢失</text>
</g>
<!-- save_in_follower_log&#45;&gt;commit -->
<g id="edge4" class="edge">
<title>save_in_follower_log&#45;&gt;commit</title>
<path fill="none" stroke="#666666" d="M667.17,-72.5C675.38,-72.5 683.91,-72.5 692.52,-72.5"/>
<polygon fill="#666666" stroke="#666666" points="692.65,-76 702.65,-72.5 692.65,-69 692.65,-76"/>
</g>
<!-- app_apply_to_log_entry -->
<g id="node6" class="node">
<title>app_apply_to_log_entry</title>
<path fill="none" stroke="#1c2123" d="M957,-53.5C957,-53.5 1091,-53.5 1091,-53.5 1097,-53.5 1103,-59.5 1103,-65.5 1103,-65.5 1103,-79.5 1103,-79.5 1103,-85.5 1097,-91.5 1091,-91.5 1091,-91.5 957,-91.5 957,-91.5 951,-91.5 945,-85.5 945,-79.5 945,-79.5 945,-65.5 945,-65.5 945,-59.5 951,-53.5 957,-53.5"/>
<text text-anchor="start" x="953" y="-76.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">应用将commit log entry</text>
<text text-anchor="start" x="953" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> apply 到state machine上</text>
</g>
<!-- commit&#45;&gt;app_apply_to_log_entry -->
<g id="edge5" class="edge">
<title>commit&#45;&gt;app_apply_to_log_entry</title>
<path fill="none" stroke="#666666" d="M909.31,-72.5C917.83,-72.5 926.41,-72.5 934.82,-72.5"/>
<polygon fill="#666666" stroke="#666666" points="934.98,-76 944.98,-72.5 934.98,-69 934.98,-76"/>
</g>
</g>
</svg>
