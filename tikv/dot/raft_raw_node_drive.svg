<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: raft_storage Pages: 1 -->
<svg width="1595pt" height="713pt"
 viewBox="0.00 0.00 1595.00 712.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 708.94)">
<title>raft_storage</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-708.94 1591,-708.94 1591,4 -4,4"/>
<!-- RaftLog_slice -->
<g id="node1" class="node">
<title>RaftLog_slice</title>
<path fill="none" stroke="#1c2123" d="M1182,-373.94C1182,-373.94 1113,-373.94 1113,-373.94 1107,-373.94 1101,-367.94 1101,-361.94 1101,-361.94 1101,-349.94 1101,-349.94 1101,-343.94 1107,-337.94 1113,-337.94 1113,-337.94 1182,-337.94 1182,-337.94 1188,-337.94 1194,-343.94 1194,-349.94 1194,-349.94 1194,-361.94 1194,-361.94 1194,-367.94 1188,-373.94 1182,-373.94"/>
<text text-anchor="middle" x="1147.5" y="-352.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog_slice</text>
</g>
<!-- Storage_entries -->
<g id="node2" class="node">
<title>Storage_entries</title>
<path fill="none" stroke="#1c2123" d="M1401.5,-373.94C1401.5,-373.94 1324.5,-373.94 1324.5,-373.94 1318.5,-373.94 1312.5,-367.94 1312.5,-361.94 1312.5,-361.94 1312.5,-349.94 1312.5,-349.94 1312.5,-343.94 1318.5,-337.94 1324.5,-337.94 1324.5,-337.94 1401.5,-337.94 1401.5,-337.94 1407.5,-337.94 1413.5,-343.94 1413.5,-349.94 1413.5,-349.94 1413.5,-361.94 1413.5,-361.94 1413.5,-367.94 1407.5,-373.94 1401.5,-373.94"/>
<text text-anchor="middle" x="1363" y="-352.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">Storage_entries</text>
</g>
<!-- RaftLog_slice&#45;&gt;Storage_entries -->
<g id="edge1" class="edge">
<title>RaftLog_slice&#45;&gt;Storage_entries</title>
<path fill="none" stroke="#666666" d="M1194.04,-355.94C1225.56,-355.94 1267.83,-355.94 1302.08,-355.94"/>
<polygon fill="#666666" stroke="#666666" points="1302.43,-359.44 1312.43,-355.94 1302.43,-352.44 1302.43,-359.44"/>
</g>
<!-- RaftLog_term -->
<g id="node3" class="node">
<title>RaftLog_term</title>
<path fill="none" stroke="#1c2123" d="M1398,-241.94C1398,-241.94 1328,-241.94 1328,-241.94 1322,-241.94 1316,-235.94 1316,-229.94 1316,-229.94 1316,-217.94 1316,-217.94 1316,-211.94 1322,-205.94 1328,-205.94 1328,-205.94 1398,-205.94 1398,-205.94 1404,-205.94 1410,-211.94 1410,-217.94 1410,-217.94 1410,-229.94 1410,-229.94 1410,-235.94 1404,-241.94 1398,-241.94"/>
<text text-anchor="middle" x="1363" y="-220.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog_term</text>
</g>
<!-- Storage_term -->
<g id="node4" class="node">
<title>Storage_term</title>
<path fill="none" stroke="#1c2123" d="M1557,-241.94C1557,-241.94 1491,-241.94 1491,-241.94 1485,-241.94 1479,-235.94 1479,-229.94 1479,-229.94 1479,-217.94 1479,-217.94 1479,-211.94 1485,-205.94 1491,-205.94 1491,-205.94 1557,-205.94 1557,-205.94 1563,-205.94 1569,-211.94 1569,-217.94 1569,-217.94 1569,-229.94 1569,-229.94 1569,-235.94 1563,-241.94 1557,-241.94"/>
<text text-anchor="middle" x="1524" y="-220.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">Storage_term</text>
</g>
<!-- RaftLog_term&#45;&gt;Storage_term -->
<g id="edge2" class="edge">
<title>RaftLog_term&#45;&gt;Storage_term</title>
<path fill="none" stroke="#666666" d="M1410.42,-223.94C1428.75,-223.94 1449.95,-223.94 1468.97,-223.94"/>
<polygon fill="#666666" stroke="#666666" points="1468.98,-227.44 1478.98,-223.94 1468.98,-220.44 1468.98,-227.44"/>
</g>
<!-- RaftLog_first_index -->
<g id="node5" class="node">
<title>RaftLog_first_index</title>
<path fill="none" stroke="#1c2123" d="M1575,-327.94C1575,-327.94 1473,-327.94 1473,-327.94 1467,-327.94 1461,-321.94 1461,-315.94 1461,-315.94 1461,-303.94 1461,-303.94 1461,-297.94 1467,-291.94 1473,-291.94 1473,-291.94 1575,-291.94 1575,-291.94 1581,-291.94 1587,-297.94 1587,-303.94 1587,-303.94 1587,-315.94 1587,-315.94 1587,-321.94 1581,-327.94 1575,-327.94"/>
<text text-anchor="middle" x="1524" y="-306.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog_first_index</text>
</g>
<!-- RaftLog_term&#45;&gt;RaftLog_first_index -->
<g id="edge3" class="edge">
<title>RaftLog_term&#45;&gt;RaftLog_first_index</title>
<path fill="none" stroke="#666666" d="M1397.33,-241.97C1421.61,-255.1 1454.67,-272.98 1480.79,-287.11"/>
<polygon fill="#666666" stroke="#666666" points="1479.25,-290.26 1489.71,-291.94 1482.58,-284.1 1479.25,-290.26"/>
</g>
<!-- RaftLog_next_entries_since -->
<g id="node6" class="node">
<title>RaftLog_next_entries_since</title>
<path fill="none" stroke="#1c2123" d="M960,-330.94C960,-330.94 815,-330.94 815,-330.94 809,-330.94 803,-324.94 803,-318.94 803,-318.94 803,-306.94 803,-306.94 803,-300.94 809,-294.94 815,-294.94 815,-294.94 960,-294.94 960,-294.94 966,-294.94 972,-300.94 972,-306.94 972,-306.94 972,-318.94 972,-318.94 972,-324.94 966,-330.94 960,-330.94"/>
<text text-anchor="middle" x="887.5" y="-309.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog_next_entries_since</text>
</g>
<!-- RaftLog_next_entries_since&#45;&gt;RaftLog_slice -->
<g id="edge4" class="edge">
<title>RaftLog_next_entries_since&#45;&gt;RaftLog_slice</title>
<path fill="none" stroke="#666666" d="M972.27,-326.9C1011.1,-333.37 1056.2,-340.89 1090.78,-346.65"/>
<polygon fill="#666666" stroke="#666666" points="1090.26,-350.12 1100.7,-348.31 1091.41,-343.21 1090.26,-350.12"/>
</g>
<!-- RaftLog_next_entries_since&#45;&gt;RaftLog_first_index -->
<g id="edge7" class="edge">
<title>RaftLog_next_entries_since&#45;&gt;RaftLog_first_index</title>
<path fill="none" stroke="#666666" d="M972.1,-312.54C1097.5,-311.95 1332.18,-310.84 1450.65,-310.28"/>
<polygon fill="#666666" stroke="#666666" points="1450.72,-313.78 1460.7,-310.23 1450.69,-306.78 1450.72,-313.78"/>
</g>
<!-- RaftLog_maybe_persist -->
<g id="node7" class="node">
<title>RaftLog_maybe_persist</title>
<path fill="#feed9b" stroke="#f7e495" d="M1083.5,-234.94C1083.5,-234.94 1211.5,-234.94 1211.5,-234.94 1217.5,-234.94 1223.5,-240.94 1223.5,-246.94 1223.5,-246.94 1223.5,-268.94 1223.5,-268.94 1223.5,-274.94 1217.5,-280.94 1211.5,-280.94 1211.5,-280.94 1083.5,-280.94 1083.5,-280.94 1077.5,-280.94 1071.5,-274.94 1071.5,-268.94 1071.5,-268.94 1071.5,-246.94 1071.5,-246.94 1071.5,-240.94 1077.5,-234.94 1083.5,-234.94"/>
<text text-anchor="middle" x="1147.5" y="-265.74" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftLog_maybe_persist</text>
<polyline fill="none" stroke="#f7e495" points="1071.5,-257.94 1223.5,-257.94 "/>
<text text-anchor="start" x="1079.5" y="-242.74" font-family="Times,serif" font-size="14.00" fill="#40575d">更新RaftLog的persisted</text>
</g>
<!-- RaftLog_maybe_persist&#45;&gt;RaftLog_term -->
<g id="edge5" class="edge">
<title>RaftLog_maybe_persist&#45;&gt;RaftLog_term</title>
<path fill="none" stroke="#666666" d="M1223.77,-245.95C1250.78,-241.65 1280.75,-236.88 1305.86,-232.88"/>
<polygon fill="#666666" stroke="#666666" points="1306.61,-236.3 1315.94,-231.28 1305.51,-229.39 1306.61,-236.3"/>
</g>
<!-- RaftLog_has_next_entries_since -->
<g id="node8" class="node">
<title>RaftLog_has_next_entries_since</title>
<path fill="none" stroke="#1c2123" d="M423.5,-419.94C423.5,-419.94 253.5,-419.94 253.5,-419.94 247.5,-419.94 241.5,-413.94 241.5,-407.94 241.5,-407.94 241.5,-395.94 241.5,-395.94 241.5,-389.94 247.5,-383.94 253.5,-383.94 253.5,-383.94 423.5,-383.94 423.5,-383.94 429.5,-383.94 435.5,-389.94 435.5,-395.94 435.5,-395.94 435.5,-407.94 435.5,-407.94 435.5,-413.94 429.5,-419.94 423.5,-419.94"/>
<text text-anchor="middle" x="338.5" y="-398.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog_has_next_entries_since</text>
</g>
<!-- RaftLog_has_next_entries_since&#45;&gt;RaftLog_first_index -->
<g id="edge6" class="edge">
<title>RaftLog_has_next_entries_since&#45;&gt;RaftLog_first_index</title>
<path fill="none" stroke="#666666" d="M435.84,-401.94C545.11,-401.94 728.62,-401.94 886.5,-401.94 886.5,-401.94 886.5,-401.94 1148.5,-401.94 1271.68,-401.94 1309.48,-425.69 1425,-382.94 1452.86,-372.63 1479.55,-351.77 1498.03,-334.97"/>
<polygon fill="#666666" stroke="#666666" points="1500.5,-337.45 1505.42,-328.07 1495.73,-332.34 1500.5,-337.45"/>
</g>
<!-- RaftCore_commit_apply -->
<g id="node9" class="node">
<title>RaftCore_commit_apply</title>
<path fill="#feed9b" stroke="#f7e495" d="M799,-15.94C799,-15.94 976,-15.94 976,-15.94 982,-15.94 988,-21.94 988,-27.94 988,-27.94 988,-87.94 988,-87.94 988,-93.94 982,-99.94 976,-99.94 976,-99.94 799,-99.94 799,-99.94 793,-99.94 787,-93.94 787,-87.94 787,-87.94 787,-27.94 787,-27.94 787,-21.94 793,-15.94 799,-15.94"/>
<text text-anchor="middle" x="887.5" y="-84.74" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftCore_commit_apply</text>
<polyline fill="none" stroke="#f7e495" points="787,-76.94 988,-76.94 "/>
<text text-anchor="start" x="795" y="-61.74" font-family="Times,serif" font-size="14.00" fill="#40575d">Commit that the Raft peer</text>
<text text-anchor="start" x="795" y="-46.74" font-family="Times,serif" font-size="14.00" fill="#40575d"> has applied up to the given index</text>
<polyline fill="none" stroke="#f7e495" points="787,-38.94 988,-38.94 "/>
<text text-anchor="start" x="795" y="-23.74" font-family="Times,serif" font-size="14.00" fill="#40575d">影响pending_conf_index</text>
</g>
<!-- RaftCore_append_entry -->
<g id="node10" class="node">
<title>RaftCore_append_entry</title>
<path fill="none" stroke="#1c2123" d="M1066,-19.94C1066,-19.94 1229,-19.94 1229,-19.94 1235,-19.94 1241,-25.94 1241,-31.94 1241,-31.94 1241,-83.94 1241,-83.94 1241,-89.94 1235,-95.94 1229,-95.94 1229,-95.94 1066,-95.94 1066,-95.94 1060,-95.94 1054,-89.94 1054,-83.94 1054,-83.94 1054,-31.94 1054,-31.94 1054,-25.94 1060,-19.94 1066,-19.94"/>
<text text-anchor="middle" x="1147.5" y="-80.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore_append_entry</text>
<polyline fill="none" stroke="#1c2123" points="1054,-72.94 1241,-72.94 "/>
<text text-anchor="start" x="1062" y="-57.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">Appends a slice of entries</text>
<text text-anchor="start" x="1062" y="-42.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> to the log</text>
<text text-anchor="start" x="1062" y="-27.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> only called by leader currently</text>
</g>
<!-- RaftCore_commit_apply&#45;&gt;RaftCore_append_entry -->
<g id="edge8" class="edge">
<title>RaftCore_commit_apply&#45;&gt;RaftCore_append_entry</title>
<path fill="none" stroke="#666666" d="M988.25,-57.94C1006.44,-57.94 1025.44,-57.94 1043.71,-57.94"/>
<polygon fill="#666666" stroke="#666666" points="1043.78,-61.44 1053.78,-57.94 1043.78,-54.44 1043.78,-61.44"/>
</g>
<!-- RaftLog_last_index -->
<g id="node11" class="node">
<title>RaftLog_last_index</title>
<path fill="none" stroke="#1c2123" d="M1413,-42.94C1413,-42.94 1313,-42.94 1313,-42.94 1307,-42.94 1301,-36.94 1301,-30.94 1301,-30.94 1301,-18.94 1301,-18.94 1301,-12.94 1307,-6.94 1313,-6.94 1313,-6.94 1413,-6.94 1413,-6.94 1419,-6.94 1425,-12.94 1425,-18.94 1425,-18.94 1425,-30.94 1425,-30.94 1425,-36.94 1419,-42.94 1413,-42.94"/>
<text text-anchor="middle" x="1363" y="-21.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog_last_index</text>
</g>
<!-- RaftCore_commit_apply&#45;&gt;RaftLog_last_index -->
<g id="edge9" class="edge">
<title>RaftCore_commit_apply&#45;&gt;RaftLog_last_index</title>
<path fill="none" stroke="#666666" d="M988.34,-19.59C1002.16,-15.61 1016.31,-12.2 1030,-9.94 1133.05,7.06 1160.86,-1.94 1265,-9.94 1273.37,-10.58 1282.1,-11.53 1290.75,-12.65"/>
<polygon fill="#666666" stroke="#666666" points="1290.47,-16.14 1300.85,-14.03 1291.41,-9.21 1290.47,-16.14"/>
</g>
<!-- RaftCore_append_entry&#45;&gt;RaftLog_last_index -->
<g id="edge10" class="edge">
<title>RaftCore_append_entry&#45;&gt;RaftLog_last_index</title>
<path fill="none" stroke="#666666" d="M1241.21,-43.61C1257.74,-41.06 1274.72,-38.43 1290.53,-35.99"/>
<polygon fill="#666666" stroke="#666666" points="1291.39,-39.39 1300.74,-34.41 1290.33,-32.48 1291.39,-39.39"/>
</g>
<!-- RaftCore_commit_to_current_term -->
<g id="node12" class="node">
<title>RaftCore_commit_to_current_term</title>
<path fill="none" stroke="#1c2123" d="M1042,-169.94C1042,-169.94 1253,-169.94 1253,-169.94 1259,-169.94 1265,-175.94 1265,-181.94 1265,-181.94 1265,-203.94 1265,-203.94 1265,-209.94 1259,-215.94 1253,-215.94 1253,-215.94 1042,-215.94 1042,-215.94 1036,-215.94 1030,-209.94 1030,-203.94 1030,-203.94 1030,-181.94 1030,-181.94 1030,-175.94 1036,-169.94 1042,-169.94"/>
<text text-anchor="middle" x="1147.5" y="-200.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore_commit_to_current_term</text>
<polyline fill="none" stroke="#1c2123" points="1030,-192.94 1265,-192.94 "/>
<text text-anchor="middle" x="1147.5" y="-177.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">checks if logs are committed to its term</text>
</g>
<!-- RaftCore_commit_to_current_term&#45;&gt;RaftLog_term -->
<g id="edge11" class="edge">
<title>RaftCore_commit_to_current_term&#45;&gt;RaftLog_term</title>
<path fill="none" stroke="#666666" d="M1265.24,-209.89C1279.24,-211.92 1293,-213.92 1305.56,-215.75"/>
<polygon fill="#666666" stroke="#666666" points="1305.41,-219.26 1315.81,-217.23 1306.41,-212.33 1305.41,-219.26"/>
</g>
<!-- RaftCore_apply_to_current_term -->
<g id="node13" class="node">
<title>RaftCore_apply_to_current_term</title>
<path fill="none" stroke="#1c2123" d="M1234,-150.94C1234,-150.94 1061,-150.94 1061,-150.94 1055,-150.94 1049,-144.94 1049,-138.94 1049,-138.94 1049,-126.94 1049,-126.94 1049,-120.94 1055,-114.94 1061,-114.94 1061,-114.94 1234,-114.94 1234,-114.94 1240,-114.94 1246,-120.94 1246,-126.94 1246,-126.94 1246,-138.94 1246,-138.94 1246,-144.94 1240,-150.94 1234,-150.94"/>
<text text-anchor="middle" x="1147.5" y="-129.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore_apply_to_current_term</text>
</g>
<!-- RaftCore_apply_to_current_term&#45;&gt;RaftLog_term -->
<g id="edge12" class="edge">
<title>RaftCore_apply_to_current_term&#45;&gt;RaftLog_term</title>
<path fill="none" stroke="#666666" d="M1240.44,-150.98C1248.87,-153.61 1257.18,-156.58 1265,-159.94 1288.58,-170.06 1312.67,-185.92 1330.95,-199.32"/>
<polygon fill="#666666" stroke="#666666" points="1329.32,-202.48 1339.43,-205.67 1333.52,-196.87 1329.32,-202.48"/>
</g>
<!-- RaftCore_step -->
<g id="node14" class="node">
<title>RaftCore_step</title>
<path fill="#a2dbfa" stroke="#8a8898" d="M811.5,-546.44C811.5,-546.44 963.5,-546.44 963.5,-546.44 969.5,-546.44 975.5,-552.44 975.5,-558.44 975.5,-558.44 975.5,-595.44 975.5,-595.44 975.5,-601.44 969.5,-607.44 963.5,-607.44 963.5,-607.44 811.5,-607.44 811.5,-607.44 805.5,-607.44 799.5,-601.44 799.5,-595.44 799.5,-595.44 799.5,-558.44 799.5,-558.44 799.5,-552.44 805.5,-546.44 811.5,-546.44"/>
<text text-anchor="middle" x="887.5" y="-592.24" font-family="Times,serif" font-size="14.00" fill="#5d6179">RaftCore_step</text>
<polyline fill="none" stroke="#8a8898" points="799.5,-584.44 975.5,-584.44 "/>
<text text-anchor="start" x="807.5" y="-569.24" font-family="Times,serif" font-size="14.00" fill="#5d6179">raft along via a message</text>
<text text-anchor="start" x="807.5" y="-554.24" font-family="Times,serif" font-size="14.00" fill="#5d6179"> 处理raft从peer收到的消息</text>
</g>
<!-- RaftCore_on_persist_entries -->
<g id="node15" class="node">
<title>RaftCore_on_persist_entries</title>
<path fill="none" stroke="#1c2123" d="M793,-202.44C793,-202.44 982,-202.44 982,-202.44 988,-202.44 994,-208.44 994,-214.44 994,-214.44 994,-251.44 994,-251.44 994,-257.44 988,-263.44 982,-263.44 982,-263.44 793,-263.44 793,-263.44 787,-263.44 781,-257.44 781,-251.44 781,-251.44 781,-214.44 781,-214.44 781,-208.44 787,-202.44 793,-202.44"/>
<text text-anchor="middle" x="887.5" y="-248.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore_on_persist_entries</text>
<polyline fill="none" stroke="#1c2123" points="781,-240.44 994,-240.44 "/>
<text text-anchor="start" x="789" y="-225.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">Notifies that the raft logs</text>
<text text-anchor="start" x="789" y="-210.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> or the snapshot have been persisted</text>
</g>
<!-- RaftCore_on_persist_entries&#45;&gt;RaftLog_maybe_persist -->
<g id="edge13" class="edge">
<title>RaftCore_on_persist_entries&#45;&gt;RaftLog_maybe_persist</title>
<path fill="none" stroke="#666666" d="M994.18,-243.18C1016.53,-245.35 1039.84,-247.6 1061.31,-249.69"/>
<polygon fill="#666666" stroke="#666666" points="1061.07,-253.18 1071.36,-250.66 1061.75,-246.21 1061.07,-253.18"/>
</g>
<!-- RawNode_on_persist_ready -->
<g id="node16" class="node">
<title>RawNode_on_persist_ready</title>
<path fill="none" stroke="#1c2123" d="M686.5,-236.94C686.5,-236.94 540.5,-236.94 540.5,-236.94 534.5,-236.94 528.5,-230.94 528.5,-224.94 528.5,-224.94 528.5,-212.94 528.5,-212.94 528.5,-206.94 534.5,-200.94 540.5,-200.94 540.5,-200.94 686.5,-200.94 686.5,-200.94 692.5,-200.94 698.5,-206.94 698.5,-212.94 698.5,-212.94 698.5,-224.94 698.5,-224.94 698.5,-230.94 692.5,-236.94 686.5,-236.94"/>
<text text-anchor="middle" x="613.5" y="-215.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_on_persist_ready</text>
</g>
<!-- RawNode_on_persist_ready&#45;&gt;RaftCore_on_persist_entries -->
<g id="edge14" class="edge">
<title>RawNode_on_persist_ready&#45;&gt;RaftCore_on_persist_entries</title>
<path fill="none" stroke="#666666" d="M698.7,-223.27C721.36,-224.44 746.28,-225.72 770.35,-226.96"/>
<polygon fill="#666666" stroke="#666666" points="770.44,-230.47 780.61,-227.49 770.8,-223.48 770.44,-230.47"/>
</g>
<!-- RawNode_advance_append -->
<g id="node17" class="node">
<title>RawNode_advance_append</title>
<path fill="none" stroke="#1c2123" d="M251.5,-180.94C251.5,-180.94 425.5,-180.94 425.5,-180.94 431.5,-180.94 437.5,-186.94 437.5,-192.94 437.5,-192.94 437.5,-244.94 437.5,-244.94 437.5,-250.94 431.5,-256.94 425.5,-256.94 425.5,-256.94 251.5,-256.94 251.5,-256.94 245.5,-256.94 239.5,-250.94 239.5,-244.94 239.5,-244.94 239.5,-192.94 239.5,-192.94 239.5,-186.94 245.5,-180.94 251.5,-180.94"/>
<text text-anchor="middle" x="338.5" y="-241.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_advance_append</text>
<polyline fill="none" stroke="#1c2123" points="239.5,-233.94 437.5,-233.94 "/>
<text text-anchor="start" x="247.5" y="-218.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">Returns LightReady that</text>
<text text-anchor="start" x="247.5" y="-203.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> contains commit index</text>
<text text-anchor="start" x="247.5" y="-188.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> committed entries and messages</text>
</g>
<!-- RawNode_advance_append&#45;&gt;RawNode_on_persist_ready -->
<g id="edge15" class="edge">
<title>RawNode_advance_append&#45;&gt;RawNode_on_persist_ready</title>
<path fill="none" stroke="#666666" d="M437.67,-218.94C463.85,-218.94 492.08,-218.94 518.06,-218.94"/>
<polygon fill="#666666" stroke="#666666" points="518.27,-222.44 528.27,-218.94 518.27,-215.44 518.27,-222.44"/>
</g>
<!-- RawNode_gen_light_ready -->
<g id="node18" class="node">
<title>RawNode_gen_light_ready</title>
<path fill="#feed9b" stroke="#f7e495" d="M494,-255.94C494,-255.94 733,-255.94 733,-255.94 739,-255.94 745,-261.94 745,-267.94 745,-267.94 745,-357.94 745,-357.94 745,-363.94 739,-369.94 733,-369.94 733,-369.94 494,-369.94 494,-369.94 488,-369.94 482,-363.94 482,-357.94 482,-357.94 482,-267.94 482,-267.94 482,-261.94 488,-255.94 494,-255.94"/>
<text text-anchor="middle" x="613.5" y="-354.74" font-family="Times,serif" font-size="14.00" fill="#40575d">RawNode_gen_light_ready</text>
<polyline fill="none" stroke="#f7e495" points="482,-346.94 745,-346.94 "/>
<text text-anchor="start" x="490" y="-331.74" font-family="Times,serif" font-size="14.00" fill="#40575d">Generates a LightReady</text>
<text text-anchor="start" x="490" y="-316.74" font-family="Times,serif" font-size="14.00" fill="#40575d"> that has the committed entries </text>
<text text-anchor="start" x="490" y="-301.74" font-family="Times,serif" font-size="14.00" fill="#40575d"> and messages but no commit index</text>
<text text-anchor="start" x="490" y="-286.74" font-family="Times,serif" font-size="14.00" fill="#40575d"> 获取从commit_since_index后的log entries</text>
<polyline fill="none" stroke="#f7e495" points="482,-278.94 745,-278.94 "/>
<text text-anchor="start" x="490" y="-263.74" font-family="Times,serif" font-size="14.00" fill="#40575d">更新RawNode的commit_since_index变量</text>
</g>
<!-- RawNode_advance_append&#45;&gt;RawNode_gen_light_ready -->
<g id="edge16" class="edge">
<title>RawNode_advance_append&#45;&gt;RawNode_gen_light_ready</title>
<path fill="none" stroke="#666666" d="M437.67,-252.74C448.9,-256.61 460.5,-260.6 472.14,-264.61"/>
<polygon fill="#666666" stroke="#666666" points="471.33,-268.03 481.92,-267.98 473.6,-261.41 471.33,-268.03"/>
</g>
<!-- RawNode_gen_light_ready&#45;&gt;RaftLog_next_entries_since -->
<g id="edge24" class="edge">
<title>RawNode_gen_light_ready&#45;&gt;RaftLog_next_entries_since</title>
<path fill="none" stroke="#666666" d="M745.32,-312.94C761.24,-312.94 777.26,-312.94 792.5,-312.94"/>
<polygon fill="#666666" stroke="#666666" points="792.92,-316.44 802.92,-312.94 792.92,-309.44 792.92,-316.44"/>
</g>
<!-- RawNode_advance -->
<g id="node19" class="node">
<title>RawNode_advance</title>
<path fill="none" stroke="#1c2123" d="M14.5,-117.94C14.5,-117.94 180.5,-117.94 180.5,-117.94 186.5,-117.94 192.5,-123.94 192.5,-129.94 192.5,-129.94 192.5,-181.94 192.5,-181.94 192.5,-187.94 186.5,-193.94 180.5,-193.94 180.5,-193.94 14.5,-193.94 14.5,-193.94 8.5,-193.94 2.5,-187.94 2.5,-181.94 2.5,-181.94 2.5,-129.94 2.5,-129.94 2.5,-123.94 8.5,-117.94 14.5,-117.94"/>
<text text-anchor="middle" x="97.5" y="-178.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_advance(Ready)</text>
<polyline fill="none" stroke="#1c2123" points="2.5,-170.94 192.5,-170.94 "/>
<text text-anchor="start" x="10.5" y="-155.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">advance the ready </text>
<text text-anchor="start" x="10.5" y="-140.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> after full procssing it</text>
<text text-anchor="start" x="10.5" y="-125.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> applied = commit_since_index</text>
</g>
<!-- RawNode_advance&#45;&gt;RawNode_advance_append -->
<g id="edge17" class="edge">
<title>RawNode_advance&#45;&gt;RawNode_advance_append</title>
<path fill="none" stroke="#666666" d="M192.62,-180.75C204.68,-183.93 217.1,-187.2 229.36,-190.43"/>
<polygon fill="#666666" stroke="#666666" points="228.58,-193.85 239.15,-193.01 230.37,-187.08 228.58,-193.85"/>
</g>
<!-- RawNode_advance_apply_to -->
<g id="node20" class="node">
<title>RawNode_advance_apply_to</title>
<path fill="none" stroke="#1c2123" d="M262.5,-83.44C262.5,-83.44 414.5,-83.44 414.5,-83.44 420.5,-83.44 426.5,-89.44 426.5,-95.44 426.5,-95.44 426.5,-132.44 426.5,-132.44 426.5,-138.44 420.5,-144.44 414.5,-144.44 414.5,-144.44 262.5,-144.44 262.5,-144.44 256.5,-144.44 250.5,-138.44 250.5,-132.44 250.5,-132.44 250.5,-95.44 250.5,-95.44 250.5,-89.44 256.5,-83.44 262.5,-83.44"/>
<text text-anchor="middle" x="338.5" y="-129.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_advance_apply_to</text>
<polyline fill="none" stroke="#1c2123" points="250.5,-121.44 426.5,-121.44 "/>
<text text-anchor="start" x="258.5" y="-106.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_to到</text>
<text text-anchor="start" x="258.5" y="-91.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> commit_since_index</text>
</g>
<!-- RawNode_advance&#45;&gt;RawNode_advance_apply_to -->
<g id="edge18" class="edge">
<title>RawNode_advance&#45;&gt;RawNode_advance_apply_to</title>
<path fill="none" stroke="#666666" d="M192.62,-139.4C208.26,-136.65 224.51,-133.8 240.23,-131.03"/>
<polygon fill="#666666" stroke="#666666" points="241.23,-134.41 250.48,-129.23 240.02,-127.52 241.23,-134.41"/>
</g>
<!-- RawNode_commit_apply -->
<g id="node21" class="node">
<title>RawNode_commit_apply</title>
<path fill="none" stroke="#1c2123" d="M680,-96.94C680,-96.94 547,-96.94 547,-96.94 541,-96.94 535,-90.94 535,-84.94 535,-84.94 535,-72.94 535,-72.94 535,-66.94 541,-60.94 547,-60.94 547,-60.94 680,-60.94 680,-60.94 686,-60.94 692,-66.94 692,-72.94 692,-72.94 692,-84.94 692,-84.94 692,-90.94 686,-96.94 680,-96.94"/>
<text text-anchor="middle" x="613.5" y="-75.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_commit_apply</text>
</g>
<!-- RawNode_advance_apply_to&#45;&gt;RawNode_commit_apply -->
<g id="edge20" class="edge">
<title>RawNode_advance_apply_to&#45;&gt;RawNode_commit_apply</title>
<path fill="none" stroke="#666666" d="M426.63,-102.77C458.03,-98.74 493.46,-94.2 524.9,-90.17"/>
<polygon fill="#666666" stroke="#666666" points="525.48,-93.63 534.96,-88.88 524.59,-86.68 525.48,-93.63"/>
</g>
<!-- RawNode_commit_apply&#45;&gt;RaftCore_commit_apply -->
<g id="edge19" class="edge">
<title>RawNode_commit_apply&#45;&gt;RaftCore_commit_apply</title>
<path fill="none" stroke="#666666" d="M692.08,-72.95C718.49,-70.91 748.52,-68.59 776.95,-66.4"/>
<polygon fill="#666666" stroke="#666666" points="777.23,-69.89 786.93,-65.63 776.69,-62.91 777.23,-69.89"/>
</g>
<!-- RawNode_has_ready -->
<g id="node22" class="node">
<title>RawNode_has_ready</title>
<path fill="none" stroke="#1c2123" d="M43.5,-408.44C43.5,-408.44 151.5,-408.44 151.5,-408.44 157.5,-408.44 163.5,-414.44 163.5,-420.44 163.5,-420.44 163.5,-457.44 163.5,-457.44 163.5,-463.44 157.5,-469.44 151.5,-469.44 151.5,-469.44 43.5,-469.44 43.5,-469.44 37.5,-469.44 31.5,-463.44 31.5,-457.44 31.5,-457.44 31.5,-420.44 31.5,-420.44 31.5,-414.44 37.5,-408.44 43.5,-408.44"/>
<text text-anchor="middle" x="97.5" y="-454.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_has_ready</text>
<polyline fill="none" stroke="#1c2123" points="31.5,-446.44 163.5,-446.44 "/>
<text text-anchor="start" x="39.5" y="-431.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">检查是否</text>
<text text-anchor="start" x="39.5" y="-416.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 需要调用ready</text>
</g>
<!-- RawNode_has_ready&#45;&gt;RaftLog_has_next_entries_since -->
<g id="edge21" class="edge">
<title>RawNode_has_ready&#45;&gt;RaftLog_has_next_entries_since</title>
<path fill="none" stroke="#666666" d="M163.81,-428.83C184.64,-425.61 208.25,-421.95 231.21,-418.4"/>
<polygon fill="#666666" stroke="#666666" points="232,-421.81 241.34,-416.83 230.93,-414.9 232,-421.81"/>
</g>
<!-- RawNode_ready -->
<g id="node23" class="node">
<title>RawNode_ready</title>
<path fill="none" stroke="#1c2123" d="M13,-236.94C13,-236.94 182,-236.94 182,-236.94 188,-236.94 194,-242.94 194,-248.94 194,-248.94 194,-376.94 194,-376.94 194,-382.94 188,-388.94 182,-388.94 182,-388.94 13,-388.94 13,-388.94 7,-388.94 1,-382.94 1,-376.94 1,-376.94 1,-248.94 1,-248.94 1,-242.94 7,-236.94 13,-236.94"/>
<text text-anchor="middle" x="97.5" y="-373.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_ready</text>
<polyline fill="none" stroke="#1c2123" points="1,-365.94 194,-365.94 "/>
<text text-anchor="start" x="9" y="-350.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">Returns the outstanding worker</text>
<text text-anchor="start" x="9" y="-335.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> that application needs to handle</text>
<polyline fill="none" stroke="#1c2123" points="1,-327.94 194,-327.94 "/>
<text text-anchor="start" x="9" y="-312.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">返回Ready</text>
<polyline fill="none" stroke="#1c2123" points="1,-304.94 194,-304.94 "/>
<text text-anchor="start" x="9" y="-289.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">1.需要发送的Raft Message</text>
<text text-anchor="start" x="9" y="-274.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.需要持久化的log entries</text>
<text text-anchor="start" x="9" y="-259.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3.需要apply 的snapshot</text>
<text text-anchor="start" x="9" y="-244.74" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 4.需要保存的hardstate</text>
</g>
<!-- RawNode_ready&#45;&gt;RaftLog_has_next_entries_since -->
<g id="edge22" class="edge">
<title>RawNode_ready&#45;&gt;RaftLog_has_next_entries_since</title>
<path fill="none" stroke="#666666" d="M194.33,-348.63C223.12,-359.35 253.82,-370.78 279.38,-380.3"/>
<polygon fill="#666666" stroke="#666666" points="278.31,-383.63 288.91,-383.84 280.76,-377.07 278.31,-383.63"/>
</g>
<!-- RawNode_ready&#45;&gt;RawNode_gen_light_ready -->
<g id="edge23" class="edge">
<title>RawNode_ready&#45;&gt;RawNode_gen_light_ready</title>
<path fill="none" stroke="#666666" d="M194.28,-312.94C272.3,-312.94 383.59,-312.94 471.75,-312.94"/>
<polygon fill="#666666" stroke="#666666" points="471.84,-316.44 481.84,-312.94 471.84,-309.44 471.84,-316.44"/>
</g>
<!-- RawNode_tick -->
<g id="node24" class="node">
<title>RawNode_tick</title>
<path fill="none" stroke="#1c2123" d="M12,-624.44C12,-624.44 183,-624.44 183,-624.44 189,-624.44 195,-630.44 195,-636.44 195,-636.44 195,-673.44 195,-673.44 195,-679.44 189,-685.44 183,-685.44 183,-685.44 12,-685.44 12,-685.44 6,-685.44 0,-679.44 0,-673.44 0,-673.44 0,-636.44 0,-636.44 0,-630.44 6,-624.44 12,-624.44"/>
<text text-anchor="middle" x="97.5" y="-670.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_tick</text>
<polyline fill="none" stroke="#1c2123" points="0,-662.44 195,-662.44 "/>
<text text-anchor="start" x="8" y="-647.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">Tick advance the internal logical</text>
<text text-anchor="start" x="8" y="-632.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> clock by a single tick</text>
</g>
<!-- RaftCore_tick -->
<g id="node25" class="node">
<title>RaftCore_tick</title>
<path fill="none" stroke="#1c2123" d="M243,-605.44C243,-605.44 434,-605.44 434,-605.44 440,-605.44 446,-611.44 446,-617.44 446,-617.44 446,-692.44 446,-692.44 446,-698.44 440,-704.44 434,-704.44 434,-704.44 243,-704.44 243,-704.44 237,-704.44 231,-698.44 231,-692.44 231,-692.44 231,-617.44 231,-617.44 231,-611.44 237,-605.44 243,-605.44"/>
<text text-anchor="middle" x="338.5" y="-689.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore_tick</text>
<polyline fill="none" stroke="#1c2123" points="231,-681.44 446,-681.44 "/>
<text text-anchor="start" x="239" y="-666.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果是leader就调用 tick_heartbeat</text>
<polyline fill="none" stroke="#1c2123" points="231,-658.44 446,-658.44 "/>
<text text-anchor="start" x="239" y="-643.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果是Follower,PreCandidate,</text>
<text text-anchor="start" x="239" y="-628.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Candidate,就调用</text>
<text text-anchor="start" x="239" y="-613.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> tick_election</text>
</g>
<!-- RawNode_tick&#45;&gt;RaftCore_tick -->
<g id="edge26" class="edge">
<title>RawNode_tick&#45;&gt;RaftCore_tick</title>
<path fill="none" stroke="#666666" d="M195.02,-654.94C203.5,-654.94 212.13,-654.94 220.74,-654.94"/>
<polygon fill="#666666" stroke="#666666" points="220.84,-658.44 230.84,-654.94 220.84,-651.44 220.84,-658.44"/>
</g>
<!-- RaftCore_tick_election -->
<g id="node26" class="node">
<title>RaftCore_tick_election</title>
<path fill="none" stroke="#1c2123" d="M534.5,-605.44C534.5,-605.44 692.5,-605.44 692.5,-605.44 698.5,-605.44 704.5,-611.44 704.5,-617.44 704.5,-617.44 704.5,-692.44 704.5,-692.44 704.5,-698.44 698.5,-704.44 692.5,-704.44 692.5,-704.44 534.5,-704.44 534.5,-704.44 528.5,-704.44 522.5,-698.44 522.5,-692.44 522.5,-692.44 522.5,-617.44 522.5,-617.44 522.5,-611.44 528.5,-605.44 534.5,-605.44"/>
<text text-anchor="middle" x="613.5" y="-689.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore_tick_election</text>
<polyline fill="none" stroke="#1c2123" points="522.5,-681.44 704.5,-681.44 "/>
<text text-anchor="start" x="530.5" y="-666.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">Follower, PreCandidate</text>
<text text-anchor="start" x="530.5" y="-651.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Candidate 角色</text>
<polyline fill="none" stroke="#1c2123" points="522.5,-643.44 704.5,-643.44 "/>
<text text-anchor="start" x="530.5" y="-628.24" font-family="Times,serif" font-size="14.00" fill="#2f3638">Run by follwers and cndidates</text>
<text text-anchor="start" x="530.5" y="-613.24" font-family="Times,serif" font-size="14.00" fill="#2f3638"> after self.election_timeout</text>
</g>
<!-- RaftCore_tick&#45;&gt;RaftCore_tick_election -->
<g id="edge27" class="edge">
<title>RaftCore_tick&#45;&gt;RaftCore_tick_election</title>
<path fill="none" stroke="#666666" d="M446.22,-654.94C467.91,-654.94 490.65,-654.94 512.11,-654.94"/>
<polygon fill="#666666" stroke="#666666" points="512.21,-658.44 522.21,-654.94 512.21,-651.44 512.21,-658.44"/>
</g>
<!-- RaftCore_tick_election&#45;&gt;RaftCore_step -->
<g id="edge28" class="edge">
<title>RaftCore_tick_election&#45;&gt;RaftCore_step</title>
<path fill="none" stroke="#666666" d="M704.69,-629.08C731.95,-621.26 761.98,-612.65 789.64,-604.72"/>
<polygon fill="#666666" stroke="#666666" points="790.67,-608.06 799.32,-601.94 788.74,-601.33 790.67,-608.06"/>
</g>
<!-- RawNode_propose -->
<g id="node27" class="node">
<title>RawNode_propose</title>
<path fill="none" stroke="#1c2123" d="M13.5,-553.94C13.5,-553.94 181.5,-553.94 181.5,-553.94 187.5,-553.94 193.5,-559.94 193.5,-565.94 193.5,-565.94 193.5,-587.94 193.5,-587.94 193.5,-593.94 187.5,-599.94 181.5,-599.94 181.5,-599.94 13.5,-599.94 13.5,-599.94 7.5,-599.94 1.5,-593.94 1.5,-587.94 1.5,-587.94 1.5,-565.94 1.5,-565.94 1.5,-559.94 7.5,-553.94 13.5,-553.94"/>
<text text-anchor="middle" x="97.5" y="-584.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_propose</text>
<polyline fill="none" stroke="#1c2123" points="1.5,-576.94 193.5,-576.94 "/>
<text text-anchor="start" x="9.5" y="-561.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">应用propose data to the raft log</text>
</g>
<!-- RawNode_propose&#45;&gt;RaftCore_step -->
<g id="edge29" class="edge">
<title>RawNode_propose&#45;&gt;RaftCore_step</title>
<path fill="none" stroke="#666666" d="M193.55,-576.94C344.31,-576.94 636.72,-576.94 789,-576.94"/>
<polygon fill="#666666" stroke="#666666" points="789.27,-580.44 799.27,-576.94 789.27,-573.44 789.27,-580.44"/>
</g>
<!-- RawNode_step -->
<g id="node28" class="node">
<title>RawNode_step</title>
<path fill="none" stroke="#1c2123" d="M25.5,-488.94C25.5,-488.94 169.5,-488.94 169.5,-488.94 175.5,-488.94 181.5,-494.94 181.5,-500.94 181.5,-500.94 181.5,-522.94 181.5,-522.94 181.5,-528.94 175.5,-534.94 169.5,-534.94 169.5,-534.94 25.5,-534.94 25.5,-534.94 19.5,-534.94 13.5,-528.94 13.5,-522.94 13.5,-522.94 13.5,-500.94 13.5,-500.94 13.5,-494.94 19.5,-488.94 25.5,-488.94"/>
<text text-anchor="middle" x="97.5" y="-519.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode_step</text>
<polyline fill="none" stroke="#1c2123" points="13.5,-511.94 181.5,-511.94 "/>
<text text-anchor="start" x="21.5" y="-496.74" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理其他peer发来的消息</text>
</g>
<!-- RawNode_step&#45;&gt;RaftCore_step -->
<g id="edge25" class="edge">
<title>RawNode_step&#45;&gt;RaftCore_step</title>
<path fill="none" stroke="#666666" d="M181.71,-518.8C328.63,-530.92 633.18,-556.04 789.42,-568.93"/>
<polygon fill="#666666" stroke="#666666" points="789.24,-572.43 799.49,-569.76 789.81,-565.45 789.24,-572.43"/>
</g>
</g>
</svg>
