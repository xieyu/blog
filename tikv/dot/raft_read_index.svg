<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: raft_read_index Pages: 1 -->
<svg width="1772pt" height="434pt"
 viewBox="0.00 0.00 1772.00 433.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 429.5)">
<title>raft_read_index</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-429.5 1768,-429.5 1768,4 -4,4"/>
<!-- RawNode__read_index -->
<g id="node1" class="node">
<title>RawNode__read_index</title>
<path fill="none" stroke="#1c2123" d="M12,-213.5C12,-213.5 149,-213.5 149,-213.5 155,-213.5 161,-219.5 161,-225.5 161,-225.5 161,-262.5 161,-262.5 161,-268.5 155,-274.5 149,-274.5 149,-274.5 12,-274.5 12,-274.5 6,-274.5 0,-268.5 0,-262.5 0,-262.5 0,-225.5 0,-225.5 0,-219.5 6,-213.5 12,-213.5"/>
<text text-anchor="middle" x="80.5" y="-259.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode__read_index</text>
<polyline fill="none" stroke="#1c2123" points="0,-251.5 161,-251.5 "/>
<text text-anchor="start" x="8" y="-236.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用时候需要传入</text>
<text text-anchor="start" x="8" y="-221.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 一个ctx 类型为vec&lt;u8&gt;</text>
</g>
<!-- MsgReadIndex -->
<g id="node2" class="node">
<title>MsgReadIndex</title>
<path fill="none" stroke="#1c2123" d="M352.5,-305C352.5,-305 276.5,-305 276.5,-305 270.5,-305 264.5,-299 264.5,-293 264.5,-293 264.5,-281 264.5,-281 264.5,-275 270.5,-269 276.5,-269 276.5,-269 352.5,-269 352.5,-269 358.5,-269 364.5,-275 364.5,-281 364.5,-281 364.5,-293 364.5,-293 364.5,-299 358.5,-305 352.5,-305"/>
<text text-anchor="middle" x="314.5" y="-283.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">MsgReadIndex</text>
</g>
<!-- RawNode__read_index&#45;&gt;MsgReadIndex -->
<g id="edge1" class="edge">
<title>RawNode__read_index&#45;&gt;MsgReadIndex</title>
<path fill="none" stroke="#666666" d="M161.02,-258.74C191.51,-264.39 225.74,-270.73 254.04,-275.98"/>
<polygon fill="#666666" stroke="#666666" points="253.7,-279.48 264.18,-277.86 254.98,-272.59 253.7,-279.48"/>
</g>
<!-- RaftCore__step -->
<g id="node3" class="node">
<title>RaftCore__step</title>
<path fill="none" stroke="#1c2123" d="M209,-151.5C209,-151.5 420,-151.5 420,-151.5 426,-151.5 432,-157.5 432,-163.5 432,-163.5 432,-238.5 432,-238.5 432,-244.5 426,-250.5 420,-250.5 420,-250.5 209,-250.5 209,-250.5 203,-250.5 197,-244.5 197,-238.5 197,-238.5 197,-163.5 197,-163.5 197,-157.5 203,-151.5 209,-151.5"/>
<text text-anchor="middle" x="314.5" y="-235.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__step</text>
<polyline fill="none" stroke="#1c2123" points="197,-227.5 432,-227.5 "/>
<text text-anchor="start" x="205" y="-212.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">leader节点直接处理该消息</text>
<polyline fill="none" stroke="#1c2123" points="197,-204.5 432,-204.5 "/>
<text text-anchor="start" x="205" y="-189.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">follower节点将MsgReadIndex</text>
<text text-anchor="start" x="205" y="-174.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 转发给leader</text>
<text text-anchor="start" x="205" y="-159.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后等leader发送MsgReadIndexResp</text>
</g>
<!-- RawNode__read_index&#45;&gt;RaftCore__step -->
<g id="edge2" class="edge">
<title>RawNode__read_index&#45;&gt;RaftCore__step</title>
<path fill="none" stroke="#666666" d="M161.02,-229.26C169.4,-227.71 178.07,-226.1 186.83,-224.48"/>
<polygon fill="#666666" stroke="#666666" points="187.54,-227.91 196.73,-222.64 186.26,-221.02 187.54,-227.91"/>
</g>
<!-- RaftCore__step_leader -->
<g id="node4" class="node">
<title>RaftCore__step_leader</title>
<path fill="none" stroke="#1c2123" d="M634,-219C634,-219 517,-219 517,-219 511,-219 505,-213 505,-207 505,-207 505,-195 505,-195 505,-189 511,-183 517,-183 517,-183 634,-183 634,-183 640,-183 646,-189 646,-195 646,-195 646,-207 646,-207 646,-213 640,-219 634,-219"/>
<text text-anchor="middle" x="575.5" y="-197.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__step_leader</text>
</g>
<!-- RaftCore__step&#45;&gt;RaftCore__step_leader -->
<g id="edge3" class="edge">
<title>RaftCore__step&#45;&gt;RaftCore__step_leader</title>
<path fill="none" stroke="#666666" d="M432.12,-201C453.27,-201 474.89,-201 494.68,-201"/>
<polygon fill="#666666" stroke="#666666" points="494.85,-204.5 504.85,-201 494.85,-197.5 494.85,-204.5"/>
</g>
<!-- RaftCore__step_follower -->
<g id="node5" class="node">
<title>RaftCore__step_follower</title>
<path fill="none" stroke="#1c2123" d="M510.5,-103.5C510.5,-103.5 640.5,-103.5 640.5,-103.5 646.5,-103.5 652.5,-109.5 652.5,-115.5 652.5,-115.5 652.5,-152.5 652.5,-152.5 652.5,-158.5 646.5,-164.5 640.5,-164.5 640.5,-164.5 510.5,-164.5 510.5,-164.5 504.5,-164.5 498.5,-158.5 498.5,-152.5 498.5,-152.5 498.5,-115.5 498.5,-115.5 498.5,-109.5 504.5,-103.5 510.5,-103.5"/>
<text text-anchor="middle" x="575.5" y="-149.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__step_follower</text>
<polyline fill="none" stroke="#1c2123" points="498.5,-141.5 652.5,-141.5 "/>
<text text-anchor="start" x="506.5" y="-126.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将MsgReadIndex</text>
<text text-anchor="start" x="506.5" y="-111.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 转发给leader</text>
</g>
<!-- RaftCore__step&#45;&gt;RaftCore__step_follower -->
<g id="edge4" class="edge">
<title>RaftCore__step&#45;&gt;RaftCore__step_follower</title>
<path fill="none" stroke="#666666" d="M432.12,-170.83C451.04,-165.94 470.33,-160.95 488.35,-156.29"/>
<polygon fill="#666666" stroke="#666666" points="489.42,-159.62 498.22,-153.73 487.67,-152.85 489.42,-159.62"/>
</g>
<!-- RaftCore__bcast_heartbeat -->
<g id="node6" class="node">
<title>RaftCore__bcast_heartbeat</title>
<path fill="none" stroke="#1c2123" d="M480,-312C480,-312 671,-312 671,-312 677,-312 683,-318 683,-324 683,-324 683,-376 683,-376 683,-382 677,-388 671,-388 671,-388 480,-388 480,-388 474,-388 468,-382 468,-376 468,-376 468,-324 468,-324 468,-318 474,-312 480,-312"/>
<text text-anchor="middle" x="575.5" y="-372.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__bcast_heartbeat</text>
<polyline fill="none" stroke="#1c2123" points="468,-365 683,-365 "/>
<text text-anchor="start" x="476" y="-349.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">leader发送心跳时</text>
<text text-anchor="start" x="476" y="-334.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 也会带上last_pending_request_ctx</text>
<text text-anchor="start" x="476" y="-319.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 为ctx发给各个follower</text>
</g>
<!-- RaftCore__step&#45;&gt;RaftCore__bcast_heartbeat -->
<g id="edge5" class="edge">
<title>RaftCore__step&#45;&gt;RaftCore__bcast_heartbeat</title>
<path fill="none" stroke="#666666" d="M414.98,-250.58C420.77,-253.71 426.48,-256.87 432,-260 457.39,-274.4 484.62,-291.25 508.42,-306.44"/>
<polygon fill="#666666" stroke="#666666" points="506.71,-309.5 517.02,-311.96 510.49,-303.61 506.71,-309.5"/>
</g>
<!-- RaftCore__bcast_heartbeat_with_ctx -->
<g id="node7" class="node">
<title>RaftCore__bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#1c2123" d="M1020.5,-311C1020.5,-311 1214.5,-311 1214.5,-311 1220.5,-311 1226.5,-317 1226.5,-323 1226.5,-323 1226.5,-413 1226.5,-413 1226.5,-419 1220.5,-425 1214.5,-425 1214.5,-425 1020.5,-425 1020.5,-425 1014.5,-425 1008.5,-419 1008.5,-413 1008.5,-413 1008.5,-323 1008.5,-323 1008.5,-317 1014.5,-311 1020.5,-311"/>
<text text-anchor="middle" x="1117.5" y="-409.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__bcast_heartbeat_with_ctx</text>
<polyline fill="none" stroke="#1c2123" points="1008.5,-402 1226.5,-402 "/>
<text text-anchor="start" x="1016.5" y="-386.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向集群中其他成员广播</text>
<text text-anchor="start" x="1016.5" y="-371.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送心跳信息(会附带上ctx)</text>
<text text-anchor="start" x="1016.5" y="-356.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 确认自己为leader</text>
<polyline fill="none" stroke="#1c2123" points="1008.5,-349 1226.5,-349 "/>
<text text-anchor="start" x="1016.5" y="-333.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">follower的heatbeat resp</text>
<text text-anchor="start" x="1016.5" y="-318.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 中会回传ctx</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftCore__bcast_heartbeat_with_ctx -->
<g id="edge7" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftCore__bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#666666" d="M597.37,-219.35C619.48,-239.17 655,-272.06 683,-303 700.42,-322.25 695.94,-337.07 719,-349 765.95,-373.28 898.75,-375.32 998.03,-373.04"/>
<polygon fill="#666666" stroke="#666666" points="998.22,-376.53 1008.13,-372.79 998.05,-369.54 998.22,-376.53"/>
</g>
<!-- Progress__is_singoleton -->
<g id="node8" class="node">
<title>Progress__is_singoleton</title>
<path fill="none" stroke="#1c2123" d="M894,-116C894,-116 769,-116 769,-116 763,-116 757,-110 757,-104 757,-104 757,-92 757,-92 757,-86 763,-80 769,-80 769,-80 894,-80 894,-80 900,-80 906,-86 906,-92 906,-92 906,-104 906,-104 906,-110 900,-116 894,-116"/>
<text text-anchor="middle" x="831.5" y="-94.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Progress__is_singoleton</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;Progress__is_singoleton -->
<g id="edge8" class="edge">
<title>RaftCore__step_leader&#45;&gt;Progress__is_singoleton</title>
<path fill="none" stroke="#666666" d="M646.18,-190.14C659.04,-186.28 671.9,-181.07 683,-174 704.32,-160.44 697.9,-143.89 719,-130 727.67,-124.29 737.36,-119.59 747.32,-115.71"/>
<polygon fill="#666666" stroke="#666666" points="748.71,-118.93 756.93,-112.24 746.33,-112.35 748.71,-118.93"/>
</g>
<!-- RaftCore__handle_ready_read_index -->
<g id="node9" class="node">
<title>RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="#1c2123" d="M992,-67.5C992,-67.5 1243,-67.5 1243,-67.5 1249,-67.5 1255,-73.5 1255,-79.5 1255,-79.5 1255,-116.5 1255,-116.5 1255,-122.5 1249,-128.5 1243,-128.5 1243,-128.5 992,-128.5 992,-128.5 986,-128.5 980,-122.5 980,-116.5 980,-116.5 980,-79.5 980,-79.5 980,-73.5 986,-67.5 992,-67.5"/>
<text text-anchor="middle" x="1117.5" y="-113.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__handle_ready_read_index</text>
<polyline fill="none" stroke="#1c2123" points="980,-105.5 1255,-105.5 "/>
<text text-anchor="start" x="988" y="-90.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">1.如果是自己发起的则放入read_states</text>
<text text-anchor="start" x="988" y="-75.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.否则就向req.from发送MsgReadIndexResp</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftCore__handle_ready_read_index -->
<g id="edge9" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="#666666" d="M646.27,-187.69C727.68,-172.16 864.54,-146.06 969.68,-126.01"/>
<polygon fill="#666666" stroke="#666666" points="970.58,-129.4 979.75,-124.08 969.27,-122.52 970.58,-129.4"/>
</g>
<!-- ReadOnlyOption__Safe -->
<g id="node10" class="node">
<title>ReadOnlyOption__Safe</title>
<path fill="none" stroke="#1c2123" d="M731,-248.5C731,-248.5 932,-248.5 932,-248.5 938,-248.5 944,-254.5 944,-260.5 944,-260.5 944,-327.5 944,-327.5 944,-333.5 938,-339.5 932,-339.5 932,-339.5 731,-339.5 731,-339.5 725,-339.5 719,-333.5 719,-327.5 719,-327.5 719,-260.5 719,-260.5 719,-254.5 725,-248.5 731,-248.5"/>
<text text-anchor="middle" x="831.5" y="-324.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnlyOption__Safe</text>
<polyline fill="none" stroke="#1c2123" points="719,-316.5 944,-316.5 "/>
<text text-anchor="start" x="727" y="-301.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Safe guarantees the linearizability</text>
<text text-anchor="start" x="727" y="-286.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> of the read only request by</text>
<text text-anchor="start" x="727" y="-271.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> communicating with the quorum.</text>
<text text-anchor="start" x="727" y="-256.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> It is the default and suggested option.</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;ReadOnlyOption__Safe -->
<g id="edge10" class="edge">
<title>RaftCore__step_leader&#45;&gt;ReadOnlyOption__Safe</title>
<path fill="none" stroke="#666666" d="M625.77,-219.04C649.73,-227.81 679.67,-238.78 709.21,-249.59"/>
<polygon fill="#666666" stroke="#666666" points="708.18,-252.94 718.77,-253.09 710.59,-246.37 708.18,-252.94"/>
</g>
<!-- ReadOnlyOption__LeaseBased -->
<g id="node11" class="node">
<title>ReadOnlyOption__LeaseBased</title>
<path fill="none" stroke="#1c2123" d="M750,-0.5C750,-0.5 913,-0.5 913,-0.5 919,-0.5 925,-6.5 925,-12.5 925,-12.5 925,-49.5 925,-49.5 925,-55.5 919,-61.5 913,-61.5 913,-61.5 750,-61.5 750,-61.5 744,-61.5 738,-55.5 738,-49.5 738,-49.5 738,-12.5 738,-12.5 738,-6.5 744,-0.5 750,-0.5"/>
<text text-anchor="middle" x="831.5" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnlyOption__LeaseBased</text>
<polyline fill="none" stroke="#1c2123" points="738,-38.5 925,-38.5 "/>
<text text-anchor="start" x="746" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">realying on leader lease</text>
<text text-anchor="start" x="746" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> can be affected by clock draft</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;ReadOnlyOption__LeaseBased -->
<g id="edge11" class="edge">
<title>RaftCore__step_leader&#45;&gt;ReadOnlyOption__LeaseBased</title>
<path fill="none" stroke="#666666" d="M646.22,-193.75C659.66,-189.64 672.73,-183.4 683,-174 718.76,-141.25 684.85,-105.43 719,-71 722.22,-67.75 725.73,-64.76 729.44,-62.02"/>
<polygon fill="#666666" stroke="#666666" points="731.51,-64.85 737.88,-56.38 727.62,-59.03 731.51,-64.85"/>
</g>
<!-- RaftLog__committed -->
<g id="node12" class="node">
<title>RaftLog__committed</title>
<path fill="none" stroke="#1c2123" d="M1172.5,-254C1172.5,-254 1062.5,-254 1062.5,-254 1056.5,-254 1050.5,-248 1050.5,-242 1050.5,-242 1050.5,-230 1050.5,-230 1050.5,-224 1056.5,-218 1062.5,-218 1062.5,-218 1172.5,-218 1172.5,-218 1178.5,-218 1184.5,-224 1184.5,-230 1184.5,-230 1184.5,-242 1184.5,-242 1184.5,-248 1178.5,-254 1172.5,-254"/>
<text text-anchor="middle" x="1117.5" y="-232.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftLog__committed</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;RaftLog__committed -->
<g id="edge12" class="edge">
<title>RaftCore__step_leader&#45;&gt;RaftLog__committed</title>
<path fill="none" stroke="#666666" d="M646.27,-205.52C747.67,-212.09 935.1,-224.24 1040.1,-231.05"/>
<polygon fill="#666666" stroke="#666666" points="1040.11,-234.56 1050.31,-231.71 1040.56,-227.57 1040.11,-234.56"/>
</g>
<!-- ReadOnly__add_request -->
<g id="node13" class="node">
<title>ReadOnly__add_request</title>
<path fill="none" stroke="#1c2123" d="M1180.5,-200C1180.5,-200 1054.5,-200 1054.5,-200 1048.5,-200 1042.5,-194 1042.5,-188 1042.5,-188 1042.5,-176 1042.5,-176 1042.5,-170 1048.5,-164 1054.5,-164 1054.5,-164 1180.5,-164 1180.5,-164 1186.5,-164 1192.5,-170 1192.5,-176 1192.5,-176 1192.5,-188 1192.5,-188 1192.5,-194 1186.5,-200 1180.5,-200"/>
<text text-anchor="middle" x="1117.5" y="-178.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly__add_request</text>
</g>
<!-- RaftCore__step_leader&#45;&gt;ReadOnly__add_request -->
<g id="edge13" class="edge">
<title>RaftCore__step_leader&#45;&gt;ReadOnly__add_request</title>
<path fill="none" stroke="#666666" d="M646.27,-198.55C745.15,-195.07 925.83,-188.71 1032.12,-184.97"/>
<polygon fill="#666666" stroke="#666666" points="1032.3,-188.46 1042.17,-184.62 1032.05,-181.47 1032.3,-188.46"/>
</g>
<!-- RaftCore__bcast_heartbeat&#45;&gt;RaftCore__bcast_heartbeat_with_ctx -->
<g id="edge6" class="edge">
<title>RaftCore__bcast_heartbeat&#45;&gt;RaftCore__bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#666666" d="M683.06,-376.61C695.12,-378.82 707.28,-380.7 719,-382 812.46,-392.36 918.97,-387.74 998.19,-381.14"/>
<polygon fill="#666666" stroke="#666666" points="998.54,-384.63 1008.21,-380.29 997.94,-377.65 998.54,-384.63"/>
</g>
<!-- Progress__is_singoleton&#45;&gt;RaftCore__handle_ready_read_index -->
<g id="edge21" class="edge">
<title>Progress__is_singoleton&#45;&gt;RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="#666666" d="M906.01,-98C925.67,-98 947.65,-98 969.78,-98"/>
<polygon fill="#666666" stroke="#666666" points="969.94,-101.5 979.94,-98 969.94,-94.5 969.94,-101.5"/>
</g>
<!-- RaftCore__read_states -->
<g id="node17" class="node">
<title>RaftCore__read_states</title>
<path fill="#feed9b" stroke="#f7e495" d="M1332,-6.5C1332,-6.5 1523,-6.5 1523,-6.5 1529,-6.5 1535,-12.5 1535,-18.5 1535,-18.5 1535,-55.5 1535,-55.5 1535,-61.5 1529,-67.5 1523,-67.5 1523,-67.5 1332,-67.5 1332,-67.5 1326,-67.5 1320,-61.5 1320,-55.5 1320,-55.5 1320,-18.5 1320,-18.5 1320,-12.5 1326,-6.5 1332,-6.5"/>
<text text-anchor="middle" x="1427.5" y="-52.3" font-family="Times,serif" font-size="14.00" fill="#40575d">RaftCore__read_states</text>
<polyline fill="none" stroke="#f7e495" points="1320,-44.5 1535,-44.5 "/>
<text text-anchor="start" x="1328" y="-29.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pub read_states: Vec&lt;ReadState&gt;,</text>
<text text-anchor="start" x="1328" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> App调用ready时，会返回该字段</text>
</g>
<!-- RaftCore__handle_ready_read_index&#45;&gt;RaftCore__read_states -->
<g id="edge22" class="edge">
<title>RaftCore__handle_ready_read_index&#45;&gt;RaftCore__read_states</title>
<path fill="none" stroke="#666666" d="M1255.39,-70.89C1273.38,-67.32 1291.7,-63.7 1309.32,-60.21"/>
<polygon fill="#666666" stroke="#666666" points="1310.49,-63.54 1319.62,-58.17 1309.13,-56.68 1310.49,-63.54"/>
</g>
<!-- RaftCore__send -->
<g id="node18" class="node">
<title>RaftCore__send</title>
<path fill="none" stroke="#1c2123" d="M1467.5,-122C1467.5,-122 1387.5,-122 1387.5,-122 1381.5,-122 1375.5,-116 1375.5,-110 1375.5,-110 1375.5,-98 1375.5,-98 1375.5,-92 1381.5,-86 1387.5,-86 1387.5,-86 1467.5,-86 1467.5,-86 1473.5,-86 1479.5,-92 1479.5,-98 1479.5,-98 1479.5,-110 1479.5,-110 1479.5,-116 1473.5,-122 1467.5,-122"/>
<text text-anchor="middle" x="1427.5" y="-100.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send</text>
</g>
<!-- RaftCore__handle_ready_read_index&#45;&gt;RaftCore__send -->
<g id="edge23" class="edge">
<title>RaftCore__handle_ready_read_index&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M1255.39,-100.67C1293.64,-101.41 1333.32,-102.18 1364.82,-102.8"/>
<polygon fill="#666666" stroke="#666666" points="1365.11,-106.3 1375.18,-103 1365.25,-99.31 1365.11,-106.3"/>
</g>
<!-- ReadOnlyOption__Safe&#45;&gt;RaftCore__bcast_heartbeat_with_ctx -->
<g id="edge14" class="edge">
<title>ReadOnlyOption__Safe&#45;&gt;RaftCore__bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M944.34,-323.14C962.15,-327.78 980.62,-332.6 998.57,-337.27"/>
<polygon fill="green" stroke="green" points="997.92,-340.72 1008.48,-339.85 999.69,-333.95 997.92,-340.72"/>
</g>
<!-- ReadOnlyOption__Safe&#45;&gt;ReadOnly__add_request -->
<g id="edge15" class="edge">
<title>ReadOnlyOption__Safe&#45;&gt;ReadOnly__add_request</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M900.71,-248.46C924.91,-234.02 952.88,-219.18 980,-209 996.45,-202.83 1014.57,-197.98 1032.08,-194.21"/>
<polygon fill="green" stroke="green" points="1033.21,-197.55 1042.3,-192.11 1031.81,-190.69 1033.21,-197.55"/>
</g>
<!-- ReadOnlyOption__LeaseBased&#45;&gt;RaftCore__handle_ready_read_index -->
<g id="edge16" class="edge">
<title>ReadOnlyOption__LeaseBased&#45;&gt;RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M925.1,-52.85C941.83,-56.79 959.61,-60.99 977.32,-65.17"/>
<polygon fill="green" stroke="green" points="976.62,-68.6 987.15,-67.48 978.22,-61.78 976.62,-68.6"/>
</g>
<!-- ReadIndexStatus -->
<g id="node16" class="node">
<title>ReadIndexStatus</title>
<path fill="none" stroke="#1c2123" d="M1615,-222C1615,-222 1749,-222 1749,-222 1755,-222 1761,-228 1761,-234 1761,-234 1761,-302 1761,-302 1761,-308 1755,-314 1749,-314 1749,-314 1615,-314 1615,-314 1609,-314 1603,-308 1603,-302 1603,-302 1603,-234 1603,-234 1603,-228 1609,-222 1615,-222"/>
<text text-anchor="middle" x="1682" y="-298.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexStatus</text>
<polyline fill="none" stroke="#1c2123" points="1603,-291 1761,-291 "/>
<text text-anchor="start" x="1611" y="-275.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub req: Message,</text>
<polyline fill="none" stroke="#1c2123" points="1603,-268 1761,-268 "/>
<text text-anchor="start" x="1611" y="-252.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub index: u64,</text>
<polyline fill="none" stroke="#1c2123" points="1603,-245 1761,-245 "/>
<text text-anchor="start" x="1611" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub acks: HashSet&lt;u64&gt;,</text>
</g>
<!-- RaftLog__committed&#45;&gt;ReadIndexStatus -->
<g id="edge19" class="edge">
<title>RaftLog__committed&#45;&gt;ReadIndexStatus:index</title>
<path fill="none" stroke="#666666" d="M1184.55,-240.46C1275.52,-246.23 1444.84,-255.57 1591.9,-255.99"/>
<polygon fill="#666666" stroke="#666666" points="1591.99,-259.49 1602,-256 1592.01,-252.49 1591.99,-259.49"/>
</g>
<!-- ReadOnly__pending_read_index -->
<g id="node14" class="node">
<title>ReadOnly__pending_read_index</title>
<path fill="#feed9b" stroke="#f7e495" d="M1320,-265C1320,-265 1535,-265 1535,-265 1541,-265 1547,-271 1547,-277 1547,-277 1547,-299 1547,-299 1547,-305 1541,-311 1535,-311 1535,-311 1320,-311 1320,-311 1314,-311 1308,-305 1308,-299 1308,-299 1308,-277 1308,-277 1308,-271 1314,-265 1320,-265"/>
<text text-anchor="middle" x="1427.5" y="-295.8" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadOnly__pending_read_index</text>
<polyline fill="none" stroke="#f7e495" points="1308,-288 1547,-288 "/>
<text text-anchor="start" x="1316" y="-272.8" font-family="Times,serif" font-size="14.00" fill="#40575d">HashMap&lt;Vec&lt;u8&gt;, ReadIndexStatus&gt;,</text>
</g>
<!-- ReadOnly__add_request&#45;&gt;ReadOnly__pending_read_index -->
<g id="edge17" class="edge">
<title>ReadOnly__add_request&#45;&gt;ReadOnly__pending_read_index</title>
<path fill="none" stroke="#666666" d="M1192.64,-193.36C1213.09,-197.38 1235.12,-202.56 1255,-209 1296.62,-222.49 1341.45,-243.38 1374.84,-260.3"/>
<polygon fill="#666666" stroke="#666666" points="1373.44,-263.51 1383.94,-264.95 1376.63,-257.28 1373.44,-263.51"/>
</g>
<!-- ReadOnly__read_index_queue -->
<g id="node15" class="node">
<title>ReadOnly__read_index_queue</title>
<path fill="#feed9b" stroke="#f7e495" d="M1303,-146.5C1303,-146.5 1552,-146.5 1552,-146.5 1558,-146.5 1564,-152.5 1564,-158.5 1564,-158.5 1564,-195.5 1564,-195.5 1564,-201.5 1558,-207.5 1552,-207.5 1552,-207.5 1303,-207.5 1303,-207.5 1297,-207.5 1291,-201.5 1291,-195.5 1291,-195.5 1291,-158.5 1291,-158.5 1291,-152.5 1297,-146.5 1303,-146.5"/>
<text text-anchor="middle" x="1427.5" y="-192.3" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadOnly__read_index_queue</text>
<polyline fill="none" stroke="#f7e495" points="1291,-184.5 1564,-184.5 "/>
<text text-anchor="start" x="1299" y="-169.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pub read_index_queue: VecDeque&lt;Vec&lt;u8&gt;&gt;,</text>
<text text-anchor="start" x="1299" y="-154.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 队列中的内容为app传过来的ctx</text>
</g>
<!-- ReadOnly__add_request&#45;&gt;ReadOnly__read_index_queue -->
<g id="edge18" class="edge">
<title>ReadOnly__add_request&#45;&gt;ReadOnly__read_index_queue</title>
<path fill="none" stroke="#666666" d="M1192.67,-180.8C1219.21,-180.37 1250.14,-179.86 1280.63,-179.37"/>
<polygon fill="#666666" stroke="#666666" points="1281.01,-182.86 1290.95,-179.2 1280.89,-175.86 1281.01,-182.86"/>
</g>
<!-- ReadOnly__pending_read_index&#45;&gt;ReadIndexStatus -->
<g id="edge20" class="edge">
<title>ReadOnly__pending_read_index&#45;&gt;ReadIndexStatus</title>
<path fill="none" stroke="#666666" d="M1547.36,-278.59C1562.63,-277.38 1578.06,-276.15 1592.72,-274.99"/>
<polygon fill="#666666" stroke="#666666" points="1593.06,-278.48 1602.75,-274.2 1592.5,-271.5 1593.06,-278.48"/>
</g>
<!-- ReadState -->
<g id="node19" class="node">
<title>ReadState</title>
<path fill="none" stroke="#1c2123" d="M1612,-2.5C1612,-2.5 1752,-2.5 1752,-2.5 1758,-2.5 1764,-8.5 1764,-14.5 1764,-14.5 1764,-59.5 1764,-59.5 1764,-65.5 1758,-71.5 1752,-71.5 1752,-71.5 1612,-71.5 1612,-71.5 1606,-71.5 1600,-65.5 1600,-59.5 1600,-59.5 1600,-14.5 1600,-14.5 1600,-8.5 1606,-2.5 1612,-2.5"/>
<text text-anchor="middle" x="1682" y="-56.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadState</text>
<polyline fill="none" stroke="#1c2123" points="1600,-48.5 1764,-48.5 "/>
<text text-anchor="start" x="1608" y="-33.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub index: u64,</text>
<polyline fill="none" stroke="#1c2123" points="1600,-25.5 1764,-25.5 "/>
<text text-anchor="start" x="1608" y="-10.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub request_ctx: Vec&lt;u8&gt;,</text>
</g>
<!-- RaftCore__read_states&#45;&gt;ReadState -->
<g id="edge24" class="edge">
<title>RaftCore__read_states&#45;&gt;ReadState</title>
<path fill="none" stroke="#666666" d="M1535.22,-37C1553.33,-37 1572,-37 1589.67,-37"/>
<polygon fill="#666666" stroke="#666666" points="1589.95,-40.5 1599.95,-37 1589.95,-33.5 1589.95,-40.5"/>
</g>
</g>
</svg>
