<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: heartbeat_resp Pages: 1 -->
<svg width="1363pt" height="261pt"
 viewBox="0.00 0.00 1363.00 260.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 256.5)">
<title>heartbeat_resp</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-256.5 1359,-256.5 1359,4 -4,4"/>
<!-- RaftCore__handle_heartbeat_response -->
<g id="node1" class="node">
<title>RaftCore__handle_heartbeat_response</title>
<path fill="none" stroke="#1c2123" d="M12,-0.5C12,-0.5 155,-0.5 155,-0.5 161,-0.5 167,-6.5 167,-12.5 167,-12.5 167,-102.5 167,-102.5 167,-108.5 161,-114.5 155,-114.5 155,-114.5 12,-114.5 12,-114.5 6,-114.5 0,-108.5 0,-102.5 0,-102.5 0,-12.5 0,-12.5 0,-6.5 6,-0.5 12,-0.5"/>
<text text-anchor="start" x="8" y="-99.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore</text>
<text text-anchor="start" x="8" y="-84.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_heartbeat_response</text>
<polyline fill="none" stroke="#1c2123" points="0,-76.5 167,-76.5 "/>
<text text-anchor="start" x="8" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理follower的heartbeat</text>
<text text-anchor="start" x="8" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> response</text>
<polyline fill="none" stroke="#1c2123" points="0,-38.5 167,-38.5 "/>
<text text-anchor="start" x="8" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">根据ctx找到对应的</text>
<text text-anchor="start" x="8" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ReadIndexStatus</text>
</g>
<!-- RaftCore__handle_ready_read_index -->
<g id="node2" class="node">
<title>RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="#1c2123" d="M1003,-96.5C1003,-96.5 1167,-96.5 1167,-96.5 1173,-96.5 1179,-102.5 1179,-108.5 1179,-108.5 1179,-190.5 1179,-190.5 1179,-196.5 1173,-202.5 1167,-202.5 1167,-202.5 1003,-202.5 1003,-202.5 997,-202.5 991,-196.5 991,-190.5 991,-190.5 991,-108.5 991,-108.5 991,-102.5 997,-96.5 1003,-96.5"/>
<text text-anchor="start" x="999" y="-187.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore</text>
<text text-anchor="start" x="999" y="-172.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> handle_ready_read_index</text>
<polyline fill="none" stroke="#1c2123" points="991,-164.5 1179,-164.5 "/>
<text text-anchor="start" x="999" y="-149.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ready index ok了</text>
<text text-anchor="start" x="999" y="-134.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 放入read_states</text>
<text text-anchor="start" x="999" y="-119.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 或者发MsgReadIndexResp给</text>
<text text-anchor="start" x="999" y="-104.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> MgsReadIndex发送者</text>
</g>
<!-- RaftCore__handle_heartbeat_response&#45;&gt;RaftCore__handle_ready_read_index -->
<g id="edge1" class="edge">
<title>RaftCore__handle_heartbeat_response&#45;&gt;RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="#666666" d="M149.99,-114.69C222.8,-172.23 346.44,-252.5 469.5,-252.5 469.5,-252.5 469.5,-252.5 698,-252.5 796.44,-252.5 904.37,-220.84 981.02,-192.63"/>
<polygon fill="#666666" stroke="#666666" points="982.53,-195.8 990.68,-189.03 980.08,-189.24 982.53,-195.8"/>
</g>
<!-- ReadOnly__recv_ack -->
<g id="node3" class="node">
<title>ReadOnly__recv_ack</title>
<path fill="none" stroke="#1c2123" d="M215,-53.5C215,-53.5 325,-53.5 325,-53.5 331,-53.5 337,-59.5 337,-65.5 337,-65.5 337,-117.5 337,-117.5 337,-123.5 331,-129.5 325,-129.5 325,-129.5 215,-129.5 215,-129.5 209,-129.5 203,-123.5 203,-117.5 203,-117.5 203,-65.5 203,-65.5 203,-59.5 209,-53.5 215,-53.5"/>
<text text-anchor="middle" x="270" y="-114.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly__recv_ack</text>
<polyline fill="none" stroke="#1c2123" points="203,-106.5 337,-106.5 "/>
<text text-anchor="start" x="211" y="-91.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">根据ctx找对应的</text>
<text text-anchor="start" x="211" y="-76.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ReadIndexStatus</text>
<text text-anchor="start" x="211" y="-61.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 更新其中的acks</text>
</g>
<!-- RaftCore__handle_heartbeat_response&#45;&gt;ReadOnly__recv_ack -->
<g id="edge2" class="edge">
<title>RaftCore__handle_heartbeat_response&#45;&gt;ReadOnly__recv_ack</title>
<path fill="none" stroke="#666666" d="M167.04,-72.71C175.66,-74.3 184.39,-75.91 192.93,-77.48"/>
<polygon fill="#666666" stroke="#666666" points="192.39,-80.94 202.86,-79.31 193.66,-74.06 192.39,-80.94"/>
</g>
<!-- ProgressTracker__has_quorum -->
<g id="node4" class="node">
<title>ProgressTracker__has_quorum</title>
<path fill="none" stroke="#1c2123" d="M616,-52C616,-52 778,-52 778,-52 784,-52 790,-58 790,-64 790,-64 790,-101 790,-101 790,-107 784,-113 778,-113 778,-113 616,-113 616,-113 610,-113 604,-107 604,-101 604,-101 604,-64 604,-64 604,-58 610,-52 616,-52"/>
<text text-anchor="middle" x="697" y="-97.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ProgressTracker__has_quorum</text>
<polyline fill="none" stroke="#1c2123" points="604,-90 790,-90 "/>
<text text-anchor="start" x="612" y="-74.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">查看是否收到了大部的</text>
<text text-anchor="start" x="612" y="-59.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> hearbeat resp</text>
</g>
<!-- RaftCore__handle_heartbeat_response&#45;&gt;ProgressTracker__has_quorum -->
<g id="edge3" class="edge">
<title>RaftCore__handle_heartbeat_response&#45;&gt;ProgressTracker__has_quorum</title>
<path fill="none" stroke="#666666" d="M167.15,-46.31C263.84,-35.24 428.46,-22.71 568,-43.5 577.82,-44.96 587.93,-47.03 597.96,-49.45"/>
<polygon fill="#666666" stroke="#666666" points="597.4,-52.91 607.95,-51.98 599.12,-46.13 597.4,-52.91"/>
</g>
<!-- ReadOnly__advance -->
<g id="node5" class="node">
<title>ReadOnly__advance</title>
<path fill="none" stroke="#1c2123" d="M943,-100.5C943,-100.5 838,-100.5 838,-100.5 832,-100.5 826,-94.5 826,-88.5 826,-88.5 826,-76.5 826,-76.5 826,-70.5 832,-64.5 838,-64.5 838,-64.5 943,-64.5 943,-64.5 949,-64.5 955,-70.5 955,-76.5 955,-76.5 955,-88.5 955,-88.5 955,-94.5 949,-100.5 943,-100.5"/>
<text text-anchor="middle" x="890.5" y="-78.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly__advance</text>
</g>
<!-- RaftCore__handle_heartbeat_response&#45;&gt;ReadOnly__advance -->
<g id="edge4" class="edge">
<title>RaftCore__handle_heartbeat_response&#45;&gt;ReadOnly__advance</title>
<path fill="none" stroke="#666666" d="M167.31,-36.29C179.21,-33.93 191.37,-31.88 203,-30.5 462.13,0.19 535.5,15.11 790,-42.5 807.91,-46.55 826.79,-53.42 843.24,-60.34"/>
<polygon fill="#666666" stroke="#666666" points="842.04,-63.63 852.61,-64.39 844.82,-57.21 842.04,-63.63"/>
</g>
<!-- RaftCore__read_states -->
<g id="node8" class="node">
<title>RaftCore__read_states</title>
<path fill="none" stroke="#1c2123" d="M1343,-221.5C1343,-221.5 1227,-221.5 1227,-221.5 1221,-221.5 1215,-215.5 1215,-209.5 1215,-209.5 1215,-197.5 1215,-197.5 1215,-191.5 1221,-185.5 1227,-185.5 1227,-185.5 1343,-185.5 1343,-185.5 1349,-185.5 1355,-191.5 1355,-197.5 1355,-197.5 1355,-209.5 1355,-209.5 1355,-215.5 1349,-221.5 1343,-221.5"/>
<text text-anchor="middle" x="1285" y="-199.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__read_states</text>
</g>
<!-- RaftCore__handle_ready_read_index&#45;&gt;RaftCore__read_states -->
<g id="edge10" class="edge">
<title>RaftCore__handle_ready_read_index&#45;&gt;RaftCore__read_states</title>
<path fill="none" stroke="#666666" d="M1179.2,-174.92C1188.88,-177.56 1198.63,-180.22 1208.09,-182.8"/>
<polygon fill="#666666" stroke="#666666" points="1207.25,-186.2 1217.82,-185.45 1209.09,-179.44 1207.25,-186.2"/>
</g>
<!-- MsgReadIndexResp -->
<g id="node9" class="node">
<title>MsgReadIndexResp</title>
<path fill="none" stroke="#1c2123" d="M1336.5,-167.5C1336.5,-167.5 1233.5,-167.5 1233.5,-167.5 1227.5,-167.5 1221.5,-161.5 1221.5,-155.5 1221.5,-155.5 1221.5,-143.5 1221.5,-143.5 1221.5,-137.5 1227.5,-131.5 1233.5,-131.5 1233.5,-131.5 1336.5,-131.5 1336.5,-131.5 1342.5,-131.5 1348.5,-137.5 1348.5,-143.5 1348.5,-143.5 1348.5,-155.5 1348.5,-155.5 1348.5,-161.5 1342.5,-167.5 1336.5,-167.5"/>
<text text-anchor="middle" x="1285" y="-145.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">MsgReadIndexResp</text>
</g>
<!-- RaftCore__handle_ready_read_index&#45;&gt;MsgReadIndexResp -->
<g id="edge11" class="edge">
<title>RaftCore__handle_ready_read_index&#45;&gt;MsgReadIndexResp</title>
<path fill="none" stroke="#666666" d="M1179.2,-149.5C1189.88,-149.5 1200.66,-149.5 1211.02,-149.5"/>
<polygon fill="#666666" stroke="#666666" points="1211.23,-153 1221.23,-149.5 1211.23,-146 1211.23,-153"/>
</g>
<!-- RaftCore__send -->
<g id="node10" class="node">
<title>RaftCore__send</title>
<path fill="none" stroke="#1c2123" d="M1325,-113.5C1325,-113.5 1245,-113.5 1245,-113.5 1239,-113.5 1233,-107.5 1233,-101.5 1233,-101.5 1233,-89.5 1233,-89.5 1233,-83.5 1239,-77.5 1245,-77.5 1245,-77.5 1325,-77.5 1325,-77.5 1331,-77.5 1337,-83.5 1337,-89.5 1337,-89.5 1337,-101.5 1337,-101.5 1337,-107.5 1331,-113.5 1325,-113.5"/>
<text text-anchor="middle" x="1285" y="-91.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCore__send</text>
</g>
<!-- RaftCore__handle_ready_read_index&#45;&gt;RaftCore__send -->
<g id="edge12" class="edge">
<title>RaftCore__handle_ready_read_index&#45;&gt;RaftCore__send</title>
<path fill="none" stroke="#666666" d="M1179.2,-124.08C1194.05,-120.03 1209.08,-115.93 1222.94,-112.15"/>
<polygon fill="#666666" stroke="#666666" points="1224.07,-115.47 1232.8,-109.46 1222.23,-108.72 1224.07,-115.47"/>
</g>
<!-- ReadIndexStatus -->
<g id="node6" class="node">
<title>ReadIndexStatus</title>
<path fill="none" stroke="#1c2123" d="M403.5,-107.5C403.5,-107.5 537.5,-107.5 537.5,-107.5 543.5,-107.5 549.5,-113.5 549.5,-119.5 549.5,-119.5 549.5,-211.5 549.5,-211.5 549.5,-217.5 543.5,-223.5 537.5,-223.5 537.5,-223.5 403.5,-223.5 403.5,-223.5 397.5,-223.5 391.5,-217.5 391.5,-211.5 391.5,-211.5 391.5,-119.5 391.5,-119.5 391.5,-113.5 397.5,-107.5 403.5,-107.5"/>
<text text-anchor="middle" x="470.5" y="-208.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadIndexStatus</text>
<polyline fill="none" stroke="#1c2123" points="391.5,-200.5 549.5,-200.5 "/>
<polyline fill="none" stroke="#1c2123" points="391.5,-176.5 549.5,-176.5 "/>
<text text-anchor="start" x="399.5" y="-161.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub req: Message,</text>
<polyline fill="none" stroke="#1c2123" points="391.5,-153.5 549.5,-153.5 "/>
<text text-anchor="start" x="399.5" y="-138.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub index: u64,</text>
<polyline fill="none" stroke="#1c2123" points="391.5,-130.5 549.5,-130.5 "/>
<text text-anchor="start" x="399.5" y="-115.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub acks: HashSet&lt;u64&gt;,</text>
</g>
<!-- ReadOnly__recv_ack&#45;&gt;ReadIndexStatus -->
<g id="edge5" class="edge">
<title>ReadOnly__recv_ack&#45;&gt;ReadIndexStatus:acks</title>
<path fill="none" stroke="#666666" d="M337.09,-111.9C350.94,-114.95 365.72,-117.37 380.11,-118.19"/>
<polygon fill="#666666" stroke="#666666" points="380.4,-121.7 390.5,-118.5 380.61,-114.71 380.4,-121.7"/>
</g>
<!-- ReadOnly__pending_read_index -->
<g id="node7" class="node">
<title>ReadOnly__pending_read_index</title>
<path fill="none" stroke="#1c2123" d="M556,-88.5C556,-88.5 385,-88.5 385,-88.5 379,-88.5 373,-82.5 373,-76.5 373,-76.5 373,-64.5 373,-64.5 373,-58.5 379,-52.5 385,-52.5 385,-52.5 556,-52.5 556,-52.5 562,-52.5 568,-58.5 568,-64.5 568,-64.5 568,-76.5 568,-76.5 568,-82.5 562,-88.5 556,-88.5"/>
<text text-anchor="middle" x="470.5" y="-66.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly__pending_read_index</text>
</g>
<!-- ReadOnly__recv_ack&#45;&gt;ReadOnly__pending_read_index -->
<g id="edge7" class="edge">
<title>ReadOnly__recv_ack&#45;&gt;ReadOnly__pending_read_index</title>
<path fill="none" stroke="#666666" d="M337.1,-84.51C345.37,-83.63 353.98,-82.72 362.67,-81.8"/>
<polygon fill="#666666" stroke="#666666" points="363.32,-85.25 372.9,-80.72 362.59,-78.29 363.32,-85.25"/>
</g>
<!-- ProgressTracker__has_quorum&#45;&gt;ReadOnly__advance -->
<g id="edge8" class="edge">
<title>ProgressTracker__has_quorum&#45;&gt;ReadOnly__advance</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M790.1,-82.5C798.69,-82.5 807.31,-82.5 815.69,-82.5"/>
<polygon fill="green" stroke="green" points="815.79,-86 825.79,-82.5 815.79,-79 815.79,-86"/>
</g>
<!-- ReadOnly__advance&#45;&gt;RaftCore__handle_ready_read_index -->
<g id="edge9" class="edge">
<title>ReadOnly__advance&#45;&gt;RaftCore__handle_ready_read_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M943.34,-100.54C955.17,-104.66 968.14,-109.18 981.28,-113.75"/>
<polygon fill="green" stroke="green" points="980.26,-117.1 990.86,-117.08 982.56,-110.49 980.26,-117.1"/>
</g>
<!-- ReadIndexStatus&#45;&gt;ProgressTracker__has_quorum -->
<g id="edge6" class="edge">
<title>ReadIndexStatus:acks&#45;&gt;ProgressTracker__has_quorum</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M550.5,-118.5C564.67,-118.5 579.39,-116.87 593.78,-114.31"/>
<polygon fill="green" stroke="green" points="594.54,-117.73 603.69,-112.39 593.21,-110.86 594.54,-117.73"/>
</g>
</g>
</svg>
