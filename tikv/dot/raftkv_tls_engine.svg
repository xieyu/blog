<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: tls_engine Pages: 1 -->
<svg width="1525pt" height="470pt"
 viewBox="0.00 0.00 1525.00 469.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 465.53)">
<title>tls_engine</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-465.53 1521,-465.53 1521,4 -4,4"/>
<!-- TiKVServer__init_servers -->
<g id="node1" class="node">
<title>TiKVServer__init_servers</title>
<path fill="none" stroke="#1c2123" d="M12,-309C12,-309 71,-309 71,-309 77,-309 83,-315 83,-321 83,-321 83,-335 83,-335 83,-341 77,-347 71,-347 71,-347 12,-347 12,-347 6,-347 0,-341 0,-335 0,-335 0,-321 0,-321 0,-315 6,-309 12,-309"/>
<text text-anchor="start" x="8" y="-331.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">TiKVServer</text>
<text text-anchor="start" x="8" y="-316.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> init_servers</text>
</g>
<!-- build_read_pool -->
<g id="node10" class="node">
<title>build_read_pool</title>
<path fill="none" stroke="#1c2123" d="M808,-389.5C808,-389.5 970,-389.5 970,-389.5 976,-389.5 982,-395.5 982,-401.5 982,-401.5 982,-438.5 982,-438.5 982,-444.5 976,-450.5 970,-450.5 970,-450.5 808,-450.5 808,-450.5 802,-450.5 796,-444.5 796,-438.5 796,-438.5 796,-401.5 796,-401.5 796,-395.5 802,-389.5 808,-389.5"/>
<text text-anchor="middle" x="889" y="-435.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">build_read_pool</text>
<polyline fill="none" stroke="#1c2123" points="796,-427.5 982,-427.5 "/>
<text text-anchor="start" x="804" y="-412.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果没使用unified_read_pool</text>
<text text-anchor="start" x="804" y="-397.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> storage创建自己的read pool</text>
</g>
<!-- TiKVServer__init_servers&#45;&gt;build_read_pool -->
<g id="edge6" class="edge">
<title>TiKVServer__init_servers&#45;&gt;build_read_pool</title>
<path fill="none" stroke="#666666" d="M66.4,-347.1C112.42,-381.89 217.73,-452 319,-452 319,-452 319,-452 464,-452 574.24,-452 700.15,-441.11 785.93,-432.04"/>
<polygon fill="#666666" stroke="#666666" points="786.36,-435.51 795.93,-430.97 785.61,-428.55 786.36,-435.51"/>
</g>
<!-- build_yatp_read_pool -->
<g id="node11" class="node">
<title>build_yatp_read_pool</title>
<path fill="none" stroke="#1c2123" d="M832.5,-134C832.5,-134 945.5,-134 945.5,-134 951.5,-134 957.5,-140 957.5,-146 957.5,-146 957.5,-168 957.5,-168 957.5,-174 951.5,-180 945.5,-180 945.5,-180 832.5,-180 832.5,-180 826.5,-180 820.5,-174 820.5,-168 820.5,-168 820.5,-146 820.5,-146 820.5,-140 826.5,-134 832.5,-134"/>
<text text-anchor="middle" x="889" y="-164.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">build_yatp_read_pool</text>
<polyline fill="none" stroke="#1c2123" points="820.5,-157 957.5,-157 "/>
<text text-anchor="start" x="828.5" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建unified read pool</text>
</g>
<!-- TiKVServer__init_servers&#45;&gt;build_yatp_read_pool -->
<g id="edge7" class="edge">
<title>TiKVServer__init_servers&#45;&gt;build_yatp_read_pool</title>
<path fill="none" stroke="#666666" d="M52.52,-308.93C83.7,-252.45 185.04,-90 319,-90 319,-90 319,-90 464,-90 588.73,-90 621.63,-84.86 744,-109 769.45,-114.02 796.62,-122.28 820.42,-130.54"/>
<polygon fill="#666666" stroke="#666666" points="819.46,-133.91 830.06,-133.95 821.8,-127.31 819.46,-133.91"/>
</g>
<!-- create_raft_storage -->
<g id="node12" class="node">
<title>create_raft_storage</title>
<path fill="none" stroke="#1c2123" d="M227,-369C227,-369 131,-369 131,-369 125,-369 119,-363 119,-357 119,-357 119,-345 119,-345 119,-339 125,-333 131,-333 131,-333 227,-333 227,-333 233,-333 239,-339 239,-345 239,-345 239,-357 239,-357 239,-363 233,-369 227,-369"/>
<text text-anchor="middle" x="179" y="-347.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">create_raft_storage</text>
</g>
<!-- TiKVServer__init_servers&#45;&gt;create_raft_storage -->
<g id="edge8" class="edge">
<title>TiKVServer__init_servers&#45;&gt;create_raft_storage</title>
<path fill="none" stroke="#666666" d="M83.15,-334.9C91.31,-336.29 100.09,-337.78 108.91,-339.27"/>
<polygon fill="#666666" stroke="#666666" points="108.39,-342.73 118.84,-340.96 109.57,-335.83 108.39,-342.73"/>
</g>
<!-- coprocessor__readpool_impl__build_read_pool -->
<g id="node21" class="node">
<title>coprocessor__readpool_impl__build_read_pool</title>
<path fill="none" stroke="#1c2123" d="M792,-199.5C792,-199.5 986,-199.5 986,-199.5 992,-199.5 998,-205.5 998,-211.5 998,-211.5 998,-278.5 998,-278.5 998,-284.5 992,-290.5 986,-290.5 986,-290.5 792,-290.5 792,-290.5 786,-290.5 780,-284.5 780,-278.5 780,-278.5 780,-211.5 780,-211.5 780,-205.5 786,-199.5 792,-199.5"/>
<text text-anchor="start" x="788" y="-275.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">coprocessor</text>
<text text-anchor="start" x="788" y="-260.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> readpool_impl</text>
<text text-anchor="start" x="788" y="-245.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> build_read_pool</text>
<polyline fill="none" stroke="#1c2123" points="780,-237.5 998,-237.5 "/>
<text text-anchor="start" x="788" y="-222.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果没有使用unified pool</text>
<text text-anchor="start" x="788" y="-207.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 就创建coprocessor自己的readPool</text>
</g>
<!-- TiKVServer__init_servers&#45;&gt;coprocessor__readpool_impl__build_read_pool -->
<g id="edge32" class="edge">
<title>TiKVServer__init_servers&#45;&gt;coprocessor__readpool_impl__build_read_pool</title>
<path fill="none" stroke="#666666" d="M83.16,-322.25C136.99,-315.15 234.92,-304 319,-304 319,-304 319,-304 464,-304 588.73,-304 621.05,-306.02 744,-285 752.45,-283.55 761.13,-281.81 769.82,-279.88"/>
<polygon fill="#666666" stroke="#666666" points="770.67,-283.28 779.63,-277.62 769.1,-276.46 770.67,-283.28"/>
</g>
<!-- RaftKv__clone -->
<g id="node2" class="node">
<title>RaftKv__clone</title>
<path fill="none" stroke="#1c2123" d="M1241,-334.5C1241,-334.5 1334,-334.5 1334,-334.5 1340,-334.5 1346,-340.5 1346,-346.5 1346,-346.5 1346,-413.5 1346,-413.5 1346,-419.5 1340,-425.5 1334,-425.5 1334,-425.5 1241,-425.5 1241,-425.5 1235,-425.5 1229,-419.5 1229,-413.5 1229,-413.5 1229,-346.5 1229,-346.5 1229,-340.5 1235,-334.5 1241,-334.5"/>
<text text-anchor="start" x="1237" y="-410.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftKv</text>
<text text-anchor="start" x="1237" y="-395.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> clone</text>
<polyline fill="none" stroke="#1c2123" points="1229,-387.5 1346,-387.5 "/>
<text text-anchor="start" x="1237" y="-372.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">clone后每个线程</text>
<text text-anchor="start" x="1237" y="-357.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 有自己的</text>
<text text-anchor="start" x="1237" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> LocalReader</text>
</g>
<!-- SchedPool -->
<g id="node3" class="node">
<title>SchedPool</title>
<path fill="none" stroke="#1c2123" d="M842.5,-309.5C842.5,-309.5 935.5,-309.5 935.5,-309.5 941.5,-309.5 947.5,-315.5 947.5,-321.5 947.5,-321.5 947.5,-358.5 947.5,-358.5 947.5,-364.5 941.5,-370.5 935.5,-370.5 935.5,-370.5 842.5,-370.5 842.5,-370.5 836.5,-370.5 830.5,-364.5 830.5,-358.5 830.5,-358.5 830.5,-321.5 830.5,-321.5 830.5,-315.5 836.5,-309.5 842.5,-309.5"/>
<text text-anchor="middle" x="889" y="-355.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">SchedPool</text>
<polyline fill="none" stroke="#1c2123" points="830.5,-347.5 947.5,-347.5 "/>
<text text-anchor="start" x="838.5" y="-332.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">sched worker pool</text>
<text text-anchor="start" x="838.5" y="-317.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 读写事务</text>
</g>
<!-- SchedPool&#45;&gt;RaftKv__clone -->
<g id="edge3" class="edge">
<title>SchedPool&#45;&gt;RaftKv__clone</title>
<path fill="none" stroke="#666666" d="M947.65,-345.82C1019.6,-353.07 1142.44,-365.47 1218.78,-373.17"/>
<polygon fill="#666666" stroke="#666666" points="1218.48,-376.66 1228.78,-374.18 1219.18,-369.69 1218.48,-376.66"/>
</g>
<!-- YatpPoolBuilder__after_start -->
<g id="node8" class="node">
<title>YatpPoolBuilder__after_start</title>
<path fill="none" stroke="#1c2123" d="M1046,-253.5C1046,-253.5 1180,-253.5 1180,-253.5 1186,-253.5 1192,-259.5 1192,-265.5 1192,-265.5 1192,-332.5 1192,-332.5 1192,-338.5 1186,-344.5 1180,-344.5 1180,-344.5 1046,-344.5 1046,-344.5 1040,-344.5 1034,-338.5 1034,-332.5 1034,-332.5 1034,-265.5 1034,-265.5 1034,-259.5 1040,-253.5 1046,-253.5"/>
<text text-anchor="start" x="1042" y="-329.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">YatpPoolBuilder</text>
<text text-anchor="start" x="1042" y="-314.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> after_start</text>
<polyline fill="none" stroke="#1c2123" points="1034,-306.5 1192,-306.5 "/>
<text text-anchor="start" x="1042" y="-291.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">在thread启动后</text>
<text text-anchor="start" x="1042" y="-276.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> clone一份RaftKv engine</text>
<text text-anchor="start" x="1042" y="-261.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 初始化tls engine</text>
</g>
<!-- SchedPool&#45;&gt;YatpPoolBuilder__after_start -->
<g id="edge4" class="edge">
<title>SchedPool&#45;&gt;YatpPoolBuilder__after_start</title>
<path fill="none" stroke="#666666" d="M947.75,-329.33C970.89,-325.06 998.07,-320.04 1023.59,-315.33"/>
<polygon fill="#666666" stroke="#666666" points="1024.45,-318.73 1033.65,-313.47 1023.18,-311.84 1024.45,-318.73"/>
</g>
<!-- YatpPoolBuilder__before_stop -->
<g id="node9" class="node">
<title>YatpPoolBuilder__before_stop</title>
<path fill="none" stroke="#1c2123" d="M1056,-143.5C1056,-143.5 1170,-143.5 1170,-143.5 1176,-143.5 1182,-149.5 1182,-155.5 1182,-155.5 1182,-222.5 1182,-222.5 1182,-228.5 1176,-234.5 1170,-234.5 1170,-234.5 1056,-234.5 1056,-234.5 1050,-234.5 1044,-228.5 1044,-222.5 1044,-222.5 1044,-155.5 1044,-155.5 1044,-149.5 1050,-143.5 1056,-143.5"/>
<text text-anchor="start" x="1052" y="-219.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">YatpPoolBuilder</text>
<text text-anchor="start" x="1052" y="-204.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> before_stop</text>
<polyline fill="none" stroke="#1c2123" points="1044,-196.5 1182,-196.5 "/>
<text text-anchor="start" x="1052" y="-181.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">线程停止前</text>
<text text-anchor="start" x="1052" y="-166.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将thread local engine</text>
<text text-anchor="start" x="1052" y="-151.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 指针设为nullptr</text>
</g>
<!-- SchedPool&#45;&gt;YatpPoolBuilder__before_stop -->
<g id="edge5" class="edge">
<title>SchedPool&#45;&gt;YatpPoolBuilder__before_stop</title>
<path fill="none" stroke="#666666" d="M947.69,-326.27C965.09,-320.21 983.43,-311.71 998,-300 1021.06,-281.46 1013.53,-265.37 1034,-244 1034.77,-243.19 1035.56,-242.39 1036.36,-241.59"/>
<polygon fill="#666666" stroke="#666666" points="1038.97,-243.94 1043.85,-234.54 1034.17,-238.85 1038.97,-243.94"/>
</g>
<!-- Storage__from_engine -->
<g id="node4" class="node">
<title>Storage__from_engine</title>
<path fill="none" stroke="#1c2123" d="M287,-333C287,-333 353,-333 353,-333 359,-333 365,-339 365,-345 365,-345 365,-359 365,-359 365,-365 359,-371 353,-371 353,-371 287,-371 287,-371 281,-371 275,-365 275,-359 275,-359 275,-345 275,-345 275,-339 281,-333 287,-333"/>
<text text-anchor="start" x="283" y="-355.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Storage</text>
<text text-anchor="start" x="283" y="-340.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> from_engine</text>
</g>
<!-- Storage__new -->
<g id="node5" class="node">
<title>Storage__new</title>
<path fill="none" stroke="#1c2123" d="M446,-333C446,-333 480,-333 480,-333 486,-333 492,-339 492,-345 492,-345 492,-359 492,-359 492,-365 486,-371 480,-371 480,-371 446,-371 446,-371 440,-371 434,-365 434,-359 434,-359 434,-345 434,-345 434,-339 440,-333 446,-333"/>
<text text-anchor="start" x="442" y="-355.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Storage</text>
<text text-anchor="start" x="442" y="-340.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> new</text>
</g>
<!-- Storage__from_engine&#45;&gt;Storage__new -->
<g id="edge10" class="edge">
<title>Storage__from_engine&#45;&gt;Storage__new</title>
<path fill="none" stroke="#666666" d="M365.23,-352C383.99,-352 405.66,-352 423.73,-352"/>
<polygon fill="#666666" stroke="#666666" points="423.9,-355.5 433.9,-352 423.9,-348.5 423.9,-355.5"/>
</g>
<!-- Storage__read_pool -->
<g id="node6" class="node">
<title>Storage__read_pool</title>
<path fill="#feed9b" stroke="#f7e495" d="M573,-214.5C573,-214.5 732,-214.5 732,-214.5 738,-214.5 744,-220.5 744,-226.5 744,-226.5 744,-263.5 744,-263.5 744,-269.5 738,-275.5 732,-275.5 732,-275.5 573,-275.5 573,-275.5 567,-275.5 561,-269.5 561,-263.5 561,-263.5 561,-226.5 561,-226.5 561,-220.5 567,-214.5 573,-214.5"/>
<text text-anchor="middle" x="652.5" y="-260.3" font-family="Times,serif" font-size="14.00" fill="#40575d">Storage__read_pool</text>
<polyline fill="none" stroke="#f7e495" points="561,-252.5 744,-252.5 "/>
<text text-anchor="start" x="569" y="-237.3" font-family="Times,serif" font-size="14.00" fill="#40575d">handler 指向底层的read pool</text>
<text text-anchor="start" x="569" y="-222.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> 根据是否使用unified pool</text>
</g>
<!-- Storage__new&#45;&gt;Storage__read_pool -->
<g id="edge1" class="edge">
<title>Storage__new&#45;&gt;Storage__read_pool</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M492.07,-335.98C517.56,-321.43 556.08,-299.45 588.87,-280.74"/>
<polygon fill="green" stroke="green" points="590.99,-283.56 597.95,-275.56 587.53,-277.48 590.99,-283.56"/>
</g>
<!-- TxnScheduler__new -->
<g id="node7" class="node">
<title>TxnScheduler__new</title>
<path fill="none" stroke="#1c2123" d="M582,-332.5C582,-332.5 723,-332.5 723,-332.5 729,-332.5 735,-338.5 735,-344.5 735,-344.5 735,-411.5 735,-411.5 735,-417.5 729,-423.5 723,-423.5 723,-423.5 582,-423.5 582,-423.5 576,-423.5 570,-417.5 570,-411.5 570,-411.5 570,-344.5 570,-344.5 570,-338.5 576,-332.5 582,-332.5"/>
<text text-anchor="start" x="578" y="-408.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">TxnScheduler</text>
<text text-anchor="start" x="578" y="-393.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> new</text>
<polyline fill="none" stroke="#1c2123" points="570,-385.5 735,-385.5 "/>
<text text-anchor="start" x="578" y="-370.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建了两个worker pool</text>
<text text-anchor="start" x="578" y="-355.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 一个sched&#45;high&#45;pri&#45;pool</text>
<text text-anchor="start" x="578" y="-340.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 一个是sched&#45;worker&#45;pool</text>
</g>
<!-- Storage__new&#45;&gt;TxnScheduler__new -->
<g id="edge29" class="edge">
<title>Storage__new&#45;&gt;TxnScheduler__new</title>
<path fill="none" stroke="#666666" d="M492.07,-355.89C510.21,-358.41 534.94,-361.84 559.5,-365.24"/>
<polygon fill="#666666" stroke="#666666" points="559.25,-368.74 569.63,-366.65 560.21,-361.81 559.25,-368.74"/>
</g>
<!-- Storage__read_pool&#45;&gt;build_read_pool -->
<g id="edge17" class="edge">
<title>Storage__read_pool&#45;&gt;build_read_pool</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M694.15,-275.68C710.64,-289.19 729.24,-305.87 744,-323 763.56,-345.7 756.72,-361.13 780,-380 782.29,-381.86 784.68,-383.64 787.15,-385.34"/>
<polygon fill="green" stroke="green" points="785.47,-388.42 795.79,-390.82 789.22,-382.51 785.47,-388.42"/>
</g>
<!-- Storage__read_pool&#45;&gt;build_yatp_read_pool -->
<g id="edge18" class="edge">
<title>Storage__read_pool&#45;&gt;build_yatp_read_pool</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M719.89,-214.45C739.1,-206.07 760.23,-197.29 780,-190 789.93,-186.34 800.47,-182.75 810.93,-179.38"/>
<polygon fill="green" stroke="green" points="812.02,-182.7 820.49,-176.34 809.9,-176.03 812.02,-182.7"/>
</g>
<!-- TxnScheduler__new&#45;&gt;SchedPool -->
<g id="edge2" class="edge">
<title>TxnScheduler__new&#45;&gt;SchedPool</title>
<path fill="none" stroke="#666666" d="M735.19,-364.76C762.97,-360.26 793.69,-355.28 820.25,-350.98"/>
<polygon fill="#666666" stroke="#666666" points="820.9,-354.42 830.22,-349.36 819.78,-347.51 820.9,-354.42"/>
</g>
<!-- YatpPoolBuilder__after_start&#45;&gt;RaftKv__clone -->
<g id="edge23" class="edge">
<title>YatpPoolBuilder__after_start&#45;&gt;RaftKv__clone</title>
<path fill="none" stroke="#666666" d="M1192.17,-335.71C1201.37,-340.03 1210.69,-344.4 1219.71,-348.64"/>
<polygon fill="#666666" stroke="#666666" points="1218.45,-351.91 1228.99,-352.99 1221.42,-345.57 1218.45,-351.91"/>
</g>
<!-- set_tls_engine -->
<g id="node18" class="node">
<title>set_tls_engine</title>
<path fill="none" stroke="#1c2123" d="M1322.5,-316C1322.5,-316 1252.5,-316 1252.5,-316 1246.5,-316 1240.5,-310 1240.5,-304 1240.5,-304 1240.5,-292 1240.5,-292 1240.5,-286 1246.5,-280 1252.5,-280 1252.5,-280 1322.5,-280 1322.5,-280 1328.5,-280 1334.5,-286 1334.5,-292 1334.5,-292 1334.5,-304 1334.5,-304 1334.5,-310 1328.5,-316 1322.5,-316"/>
<text text-anchor="middle" x="1287.5" y="-294.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_tls_engine</text>
</g>
<!-- YatpPoolBuilder__after_start&#45;&gt;set_tls_engine -->
<g id="edge24" class="edge">
<title>YatpPoolBuilder__after_start&#45;&gt;set_tls_engine</title>
<path fill="none" stroke="#666666" d="M1192.17,-298.55C1204.86,-298.47 1217.78,-298.4 1229.83,-298.33"/>
<polygon fill="#666666" stroke="#666666" points="1230.18,-301.83 1240.16,-298.27 1230.14,-294.83 1230.18,-301.83"/>
</g>
<!-- set_io_type -->
<g id="node19" class="node">
<title>set_io_type</title>
<path fill="none" stroke="#1c2123" d="M1315,-262C1315,-262 1260,-262 1260,-262 1254,-262 1248,-256 1248,-250 1248,-250 1248,-238 1248,-238 1248,-232 1254,-226 1260,-226 1260,-226 1315,-226 1315,-226 1321,-226 1327,-232 1327,-238 1327,-238 1327,-250 1327,-250 1327,-256 1321,-262 1315,-262"/>
<text text-anchor="middle" x="1287.5" y="-240.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_io_type</text>
</g>
<!-- YatpPoolBuilder__after_start&#45;&gt;set_io_type -->
<g id="edge25" class="edge">
<title>YatpPoolBuilder__after_start&#45;&gt;set_io_type</title>
<path fill="none" stroke="#666666" d="M1192.17,-274.07C1207.82,-269.09 1223.82,-263.98 1238.1,-259.43"/>
<polygon fill="#666666" stroke="#666666" points="1239.22,-262.75 1247.68,-256.38 1237.09,-256.08 1239.22,-262.75"/>
</g>
<!-- destroy_tls_engine -->
<g id="node17" class="node">
<title>destroy_tls_engine</title>
<path fill="none" stroke="#1c2123" d="M1335,-207C1335,-207 1240,-207 1240,-207 1234,-207 1228,-201 1228,-195 1228,-195 1228,-183 1228,-183 1228,-177 1234,-171 1240,-171 1240,-171 1335,-171 1335,-171 1341,-171 1347,-177 1347,-183 1347,-183 1347,-195 1347,-195 1347,-201 1341,-207 1335,-207"/>
<text text-anchor="middle" x="1287.5" y="-185.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">destroy_tls_engine</text>
</g>
<!-- YatpPoolBuilder__before_stop&#45;&gt;destroy_tls_engine -->
<g id="edge22" class="edge">
<title>YatpPoolBuilder__before_stop&#45;&gt;destroy_tls_engine</title>
<path fill="none" stroke="#666666" d="M1182.18,-189C1193.83,-189 1205.95,-189 1217.62,-189"/>
<polygon fill="#666666" stroke="#666666" points="1217.74,-192.5 1227.74,-189 1217.74,-185.5 1217.74,-192.5"/>
</g>
<!-- build_read_pool&#45;&gt;RaftKv__clone -->
<g id="edge11" class="edge">
<title>build_read_pool&#45;&gt;RaftKv__clone</title>
<path fill="none" stroke="#666666" d="M982.27,-447.25C1043.17,-460.73 1123.97,-469.93 1192,-448 1203.99,-444.13 1215.75,-438.12 1226.67,-431.23"/>
<polygon fill="#666666" stroke="#666666" points="1228.84,-433.99 1235.24,-425.54 1224.97,-428.16 1228.84,-433.99"/>
</g>
<!-- build_read_pool&#45;&gt;YatpPoolBuilder__after_start -->
<g id="edge12" class="edge">
<title>build_read_pool&#45;&gt;YatpPoolBuilder__after_start</title>
<path fill="none" stroke="#666666" d="M978.38,-389.48C985.11,-386.48 991.72,-383.32 998,-380 1014.12,-371.48 1030.59,-360.99 1045.82,-350.42"/>
<polygon fill="#666666" stroke="#666666" points="1047.99,-353.17 1054.14,-344.55 1043.96,-347.45 1047.99,-353.17"/>
</g>
<!-- build_read_pool&#45;&gt;YatpPoolBuilder__before_stop -->
<g id="edge13" class="edge">
<title>build_read_pool&#45;&gt;YatpPoolBuilder__before_stop</title>
<path fill="none" stroke="#666666" d="M982.23,-393.45C988.01,-389.56 993.36,-385.11 998,-380 1040.04,-333.72 998.3,-295.33 1034,-244 1035.01,-242.55 1036.07,-241.13 1037.17,-239.73"/>
<polygon fill="#666666" stroke="#666666" points="1039.99,-241.83 1043.95,-232 1034.72,-237.21 1039.99,-241.83"/>
</g>
<!-- storage_read_pools -->
<g id="node13" class="node">
<title>storage_read_pools</title>
<path fill="none" stroke="#1c2123" d="M1064,-402C1064,-402 1162,-402 1162,-402 1168,-402 1174,-408 1174,-414 1174,-414 1174,-426 1174,-426 1174,-432 1168,-438 1162,-438 1162,-438 1064,-438 1064,-438 1058,-438 1052,-432 1052,-426 1052,-426 1052,-414 1052,-414 1052,-408 1058,-402 1064,-402"/>
<text text-anchor="middle" x="1113" y="-416.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">storage_read_pools</text>
</g>
<!-- build_read_pool&#45;&gt;storage_read_pools -->
<g id="edge14" class="edge">
<title>build_read_pool&#45;&gt;storage_read_pools</title>
<path fill="none" stroke="#666666" d="M982.22,-420C1002.02,-420 1022.64,-420 1041.47,-420"/>
<polygon fill="#666666" stroke="#666666" points="1041.72,-423.5 1051.72,-420 1041.72,-416.5 1041.72,-423.5"/>
</g>
<!-- build_yatp_read_pool&#45;&gt;YatpPoolBuilder__after_start -->
<g id="edge20" class="edge">
<title>build_yatp_read_pool&#45;&gt;YatpPoolBuilder__after_start</title>
<path fill="none" stroke="#666666" d="M957.65,-169.9C971.86,-174.67 986.12,-181.16 998,-190 1021.14,-207.22 1013.87,-223.34 1034,-244 1034.78,-244.8 1035.57,-245.6 1036.38,-246.39"/>
<polygon fill="#666666" stroke="#666666" points="1034.21,-249.15 1043.91,-253.4 1038.98,-244.03 1034.21,-249.15"/>
</g>
<!-- build_yatp_read_pool&#45;&gt;YatpPoolBuilder__before_stop -->
<g id="edge21" class="edge">
<title>build_yatp_read_pool&#45;&gt;YatpPoolBuilder__before_stop</title>
<path fill="none" stroke="#666666" d="M957.51,-166.73C981.5,-170.19 1008.72,-174.11 1033.55,-177.69"/>
<polygon fill="#666666" stroke="#666666" points="1033.26,-181.19 1043.66,-179.15 1034.26,-174.26 1033.26,-181.19"/>
</g>
<!-- Server__yatp_read_pool -->
<g id="node16" class="node">
<title>Server__yatp_read_pool</title>
<path fill="#feed9b" stroke="#f7e495" d="M1073,-86C1073,-86 1153,-86 1153,-86 1159,-86 1165,-92 1165,-98 1165,-98 1165,-112 1165,-112 1165,-118 1159,-124 1153,-124 1153,-124 1073,-124 1073,-124 1067,-124 1061,-118 1061,-112 1061,-112 1061,-98 1061,-98 1061,-92 1067,-86 1073,-86"/>
<text text-anchor="start" x="1069" y="-108.8" font-family="Times,serif" font-size="14.00" fill="#40575d">Server</text>
<text text-anchor="start" x="1069" y="-93.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> yatp_read_pool</text>
</g>
<!-- build_yatp_read_pool&#45;&gt;Server__yatp_read_pool -->
<g id="edge19" class="edge">
<title>build_yatp_read_pool&#45;&gt;Server__yatp_read_pool</title>
<path fill="none" stroke="#666666" d="M957.51,-141.19C987.18,-134.24 1021.77,-126.13 1050.69,-119.36"/>
<polygon fill="#666666" stroke="#666666" points="1051.73,-122.71 1060.67,-117.02 1050.14,-115.9 1051.73,-122.71"/>
</g>
<!-- create_raft_storage&#45;&gt;Storage__from_engine -->
<g id="edge9" class="edge">
<title>create_raft_storage&#45;&gt;Storage__from_engine</title>
<path fill="none" stroke="#666666" d="M239.35,-351.43C247.85,-351.49 256.56,-351.55 264.94,-351.61"/>
<polygon fill="#666666" stroke="#666666" points="264.96,-355.11 274.99,-351.68 265.01,-348.11 264.96,-355.11"/>
</g>
<!-- Storage__scan -->
<g id="node14" class="node">
<title>Storage__scan</title>
<path fill="none" stroke="#1c2123" d="M413,-0.5C413,-0.5 513,-0.5 513,-0.5 519,-0.5 525,-6.5 525,-12.5 525,-12.5 525,-49.5 525,-49.5 525,-55.5 519,-61.5 513,-61.5 513,-61.5 413,-61.5 413,-61.5 407,-61.5 401,-55.5 401,-49.5 401,-49.5 401,-12.5 401,-12.5 401,-6.5 407,-0.5 413,-0.5"/>
<text text-anchor="start" x="409" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Storage</text>
<text text-anchor="start" x="409" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> scan</text>
<polyline fill="none" stroke="#1c2123" points="401,-23.5 525,-23.5 "/>
<text text-anchor="middle" x="463" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftStorage读请求</text>
</g>
<!-- Storage__scan&#45;&gt;Storage__read_pool -->
<g id="edge15" class="edge">
<title>Storage__scan&#45;&gt;Storage__read_pool</title>
<path fill="none" stroke="#666666" d="M474.38,-61.72C488.58,-99.62 517.37,-163.95 561,-204 562.65,-205.52 564.37,-206.98 566.14,-208.4"/>
<polygon fill="#666666" stroke="#666666" points="564.09,-211.24 574.23,-214.33 568.23,-205.6 564.09,-211.24"/>
</g>
<!-- with_tls_engine -->
<g id="node15" class="node">
<title>with_tls_engine</title>
<path fill="none" stroke="#1c2123" d="M610,-0.5C610,-0.5 695,-0.5 695,-0.5 701,-0.5 707,-6.5 707,-12.5 707,-12.5 707,-49.5 707,-49.5 707,-55.5 701,-61.5 695,-61.5 695,-61.5 610,-61.5 610,-61.5 604,-61.5 598,-55.5 598,-49.5 598,-49.5 598,-12.5 598,-12.5 598,-6.5 604,-0.5 610,-0.5"/>
<text text-anchor="middle" x="652.5" y="-46.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">with_tls_engine</text>
<polyline fill="none" stroke="#1c2123" points="598,-38.5 707,-38.5 "/>
<text text-anchor="start" x="606" y="-23.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用thread local</text>
<text text-anchor="start" x="606" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> engine</text>
</g>
<!-- Storage__scan&#45;&gt;with_tls_engine -->
<g id="edge16" class="edge">
<title>Storage__scan&#45;&gt;with_tls_engine</title>
<path fill="none" stroke="#666666" d="M525.14,-31C545.16,-31 567.44,-31 587.66,-31"/>
<polygon fill="#666666" stroke="#666666" points="587.71,-34.5 597.71,-31 587.71,-27.5 587.71,-34.5"/>
</g>
<!-- TLS_ENGINE_ANY -->
<g id="node20" class="node">
<title>TLS_ENGINE_ANY</title>
<path fill="#feed9b" stroke="#f7e495" d="M1395,-151C1395,-151 1505,-151 1505,-151 1511,-151 1517,-157 1517,-163 1517,-163 1517,-215 1517,-215 1517,-221 1511,-227 1505,-227 1505,-227 1395,-227 1395,-227 1389,-227 1383,-221 1383,-215 1383,-215 1383,-163 1383,-163 1383,-157 1389,-151 1395,-151"/>
<text text-anchor="middle" x="1450" y="-211.8" font-family="Times,serif" font-size="14.00" fill="#40575d">TLS_ENGINE_ANY</text>
<polyline fill="none" stroke="#f7e495" points="1383,-204 1517,-204 "/>
<text text-anchor="start" x="1391" y="-188.8" font-family="Times,serif" font-size="14.00" fill="#40575d">thread local!</text>
<text text-anchor="start" x="1391" y="-173.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> A pointer to thread</text>
<text text-anchor="start" x="1391" y="-158.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> local engine</text>
</g>
<!-- with_tls_engine&#45;&gt;TLS_ENGINE_ANY -->
<g id="edge28" class="edge">
<title>with_tls_engine&#45;&gt;TLS_ENGINE_ANY</title>
<path fill="none" stroke="#666666" d="M707.2,-29.69C805.17,-28.56 1018.78,-31.99 1192,-76 1255.71,-92.19 1323.61,-122.68 1373.61,-147.91"/>
<polygon fill="#666666" stroke="#666666" points="1372.24,-151.14 1382.74,-152.55 1375.41,-144.9 1372.24,-151.14"/>
</g>
<!-- destroy_tls_engine&#45;&gt;TLS_ENGINE_ANY -->
<g id="edge26" class="edge">
<title>destroy_tls_engine&#45;&gt;TLS_ENGINE_ANY</title>
<path fill="none" stroke="#666666" d="M1347.35,-189C1355.56,-189 1364.08,-189 1372.56,-189"/>
<polygon fill="#666666" stroke="#666666" points="1372.83,-192.5 1382.83,-189 1372.83,-185.5 1372.83,-192.5"/>
</g>
<!-- set_tls_engine&#45;&gt;TLS_ENGINE_ANY -->
<g id="edge27" class="edge">
<title>set_tls_engine&#45;&gt;TLS_ENGINE_ANY</title>
<path fill="none" stroke="#666666" d="M1331.01,-279.88C1336.5,-277.11 1341.96,-274.12 1347,-271 1364.43,-260.2 1382.25,-246.82 1398.02,-234.02"/>
<polygon fill="#666666" stroke="#666666" points="1400.57,-236.46 1406.07,-227.4 1396.12,-231.05 1400.57,-236.46"/>
</g>
<!-- coprocessor__readpool_impl__build_read_pool&#45;&gt;YatpPoolBuilder__after_start -->
<g id="edge30" class="edge">
<title>coprocessor__readpool_impl__build_read_pool&#45;&gt;YatpPoolBuilder__after_start</title>
<path fill="none" stroke="#666666" d="M998.07,-271.29C1006.71,-273.39 1015.38,-275.5 1023.85,-277.56"/>
<polygon fill="#666666" stroke="#666666" points="1023.16,-280.99 1033.7,-279.96 1024.82,-274.19 1023.16,-280.99"/>
</g>
<!-- coprocessor__readpool_impl__build_read_pool&#45;&gt;YatpPoolBuilder__before_stop -->
<g id="edge31" class="edge">
<title>coprocessor__readpool_impl__build_read_pool&#45;&gt;YatpPoolBuilder__before_stop</title>
<path fill="none" stroke="#666666" d="M998.07,-217.74C1010.1,-214.7 1022.17,-211.66 1033.72,-208.75"/>
<polygon fill="#666666" stroke="#666666" points="1034.89,-212.06 1043.73,-206.22 1033.17,-205.27 1034.89,-212.06"/>
</g>
<!-- Endpoint__read_pool -->
<g id="node22" class="node">
<title>Endpoint__read_pool</title>
<path fill="#feed9b" stroke="#f7e495" d="M595.5,-119C595.5,-119 709.5,-119 709.5,-119 715.5,-119 721.5,-125 721.5,-131 721.5,-131 721.5,-183 721.5,-183 721.5,-189 715.5,-195 709.5,-195 709.5,-195 595.5,-195 595.5,-195 589.5,-195 583.5,-189 583.5,-183 583.5,-183 583.5,-131 583.5,-131 583.5,-125 589.5,-119 595.5,-119"/>
<text text-anchor="start" x="591.5" y="-179.8" font-family="Times,serif" font-size="14.00" fill="#40575d">Endpoint</text>
<text text-anchor="start" x="591.5" y="-164.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> read_pool</text>
<polyline fill="none" stroke="#f7e495" points="583.5,-157 721.5,-157 "/>
<text text-anchor="start" x="591.5" y="-141.8" font-family="Times,serif" font-size="14.00" fill="#40575d">处理coprocessor请求</text>
<text text-anchor="start" x="591.5" y="-126.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 的read pool</text>
</g>
<!-- Endpoint__read_pool&#45;&gt;build_yatp_read_pool -->
<g id="edge33" class="edge">
<title>Endpoint__read_pool&#45;&gt;build_yatp_read_pool</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M721.64,-157C749.34,-157 781.51,-157 810.13,-157"/>
<polygon fill="green" stroke="green" points="810.5,-160.5 820.5,-157 810.5,-153.5 810.5,-160.5"/>
</g>
<!-- Endpoint__read_pool&#45;&gt;coprocessor__readpool_impl__build_read_pool -->
<g id="edge34" class="edge">
<title>Endpoint__read_pool&#45;&gt;coprocessor__readpool_impl__build_read_pool</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M721.64,-182.57C736.9,-188.3 753.52,-194.53 770.15,-200.77"/>
<polygon fill="green" stroke="green" points="769.34,-204.21 779.93,-204.45 771.8,-197.66 769.34,-204.21"/>
</g>
</g>
</svg>
