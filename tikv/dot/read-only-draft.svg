<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: read_only Pages: 1 -->
<svg width="2536pt" height="728pt"
 viewBox="0.00 0.00 2536.00 728.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 724)">
<title>read_only</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-724 2532,-724 2532,4 -4,4"/>
<!-- post_conf_change -->
<g id="node1" class="node">
<title>post_conf_change</title>
<path fill="none" stroke="#1c2123" d="M814,-464C814,-464 723,-464 723,-464 717,-464 711,-458 711,-452 711,-452 711,-440 711,-440 711,-434 717,-428 723,-428 723,-428 814,-428 814,-428 820,-428 826,-434 826,-440 826,-440 826,-452 826,-452 826,-458 820,-464 814,-464"/>
<text text-anchor="middle" x="768.5" y="-442.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">post_conf_change</text>
</g>
<!-- read_only_last_pending_request_ctx -->
<g id="node2" class="node">
<title>read_only_last_pending_request_ctx</title>
<path fill="none" stroke="#1c2123" d="M1159,-666C1159,-666 968,-666 968,-666 962,-666 956,-660 956,-654 956,-654 956,-642 956,-642 956,-636 962,-630 968,-630 968,-630 1159,-630 1159,-630 1165,-630 1171,-636 1171,-642 1171,-642 1171,-654 1171,-654 1171,-660 1165,-666 1159,-666"/>
<text text-anchor="middle" x="1063.5" y="-644.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_only_last_pending_request_ctx</text>
</g>
<!-- post_conf_change&#45;&gt;read_only_last_pending_request_ctx -->
<g id="edge1" class="edge">
<title>post_conf_change&#45;&gt;read_only_last_pending_request_ctx</title>
<path fill="none" stroke="#666666" d="M826.12,-442.11C857.53,-443.07 895.16,-449.82 920,-473 967.92,-517.71 910.72,-568.62 956,-616 958.96,-619.1 962.22,-621.9 965.68,-624.44"/>
<polygon fill="#666666" stroke="#666666" points="963.83,-627.41 974.13,-629.88 967.62,-621.52 963.83,-627.41"/>
</g>
<!-- r_read_only_recv_ack -->
<g id="node3" class="node">
<title>r_read_only_recv_ack</title>
<path fill="none" stroke="#1c2123" d="M1839,-517C1839,-517 2050,-517 2050,-517 2056,-517 2062,-523 2062,-529 2062,-529 2062,-611 2062,-611 2062,-617 2056,-623 2050,-623 2050,-623 1839,-623 1839,-623 1833,-623 1827,-617 1827,-611 1827,-611 1827,-529 1827,-529 1827,-523 1833,-517 1839,-517"/>
<text text-anchor="start" x="1835" y="-607.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly.recv_ack</text>
<polyline fill="none" stroke="#1c2123" points="1827,-600 2062,-600 "/>
<text text-anchor="start" x="1835" y="-584.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Notifies the ReadOnly struct that the</text>
<text text-anchor="start" x="1835" y="-569.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> raft state machine received</text>
<text text-anchor="start" x="1835" y="-554.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> an acknowledgment of the heartbeat</text>
<text text-anchor="start" x="1835" y="-539.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> that attached with the read only request</text>
<text text-anchor="start" x="1835" y="-524.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> context.</text>
</g>
<!-- post_conf_change&#45;&gt;r_read_only_recv_ack -->
<g id="edge2" class="edge">
<title>post_conf_change&#45;&gt;r_read_only_recv_ack</title>
<path fill="none" stroke="#666666" d="M826.14,-442.94C857.17,-444.23 894.41,-451.05 920,-473 957.44,-505.12 915.86,-549.33 956,-578 1024.29,-626.78 1565.72,-596.27 1816.64,-579.21"/>
<polygon fill="#666666" stroke="#666666" points="1817.16,-582.69 1826.9,-578.51 1816.69,-575.7 1817.16,-582.69"/>
</g>
<!-- r_read_only_advance -->
<g id="node4" class="node">
<title>r_read_only_advance</title>
<path fill="none" stroke="#1c2123" d="M968,-387C968,-387 1159,-387 1159,-387 1165,-387 1171,-393 1171,-399 1171,-399 1171,-481 1171,-481 1171,-487 1165,-493 1159,-493 1159,-493 968,-493 968,-493 962,-493 956,-487 956,-481 956,-481 956,-399 956,-399 956,-393 962,-387 968,-387"/>
<text text-anchor="start" x="964" y="-477.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly.advance</text>
<polyline fill="none" stroke="#1c2123" points="956,-470 1171,-470 "/>
<text text-anchor="start" x="964" y="-454.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Advances the read only request</text>
<text text-anchor="start" x="964" y="-439.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> queue kept by the ReadOnly struct.</text>
<text text-anchor="start" x="964" y="-424.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> It dequeues the requests until it</text>
<text text-anchor="start" x="964" y="-409.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> finds the read only request that has</text>
<text text-anchor="start" x="964" y="-394.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> the same context as the given `ctx`.</text>
</g>
<!-- post_conf_change&#45;&gt;r_read_only_advance -->
<g id="edge3" class="edge">
<title>post_conf_change&#45;&gt;r_read_only_advance</title>
<path fill="none" stroke="#666666" d="M826.34,-444.84C860.32,-444.14 904.75,-443.23 945.89,-442.39"/>
<polygon fill="#666666" stroke="#666666" points="946.07,-445.89 956,-442.18 945.93,-438.89 946.07,-445.89"/>
</g>
<!-- pending_read_index -->
<g id="node8" class="node">
<title>pending_read_index</title>
<path fill="#feed9b" stroke="#f7e495" d="M2110,-461.5C2110,-461.5 2322,-461.5 2322,-461.5 2328,-461.5 2334,-467.5 2334,-473.5 2334,-473.5 2334,-518.5 2334,-518.5 2334,-524.5 2328,-530.5 2322,-530.5 2322,-530.5 2110,-530.5 2110,-530.5 2104,-530.5 2098,-524.5 2098,-518.5 2098,-518.5 2098,-473.5 2098,-473.5 2098,-467.5 2104,-461.5 2110,-461.5"/>
<text text-anchor="middle" x="2216" y="-515.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pending_read_index</text>
<polyline fill="none" stroke="#f7e495" points="2098,-507.5 2334,-507.5 "/>
<text text-anchor="start" x="2106" y="-492.3" font-family="Times,serif" font-size="14.00" fill="#40575d">HashMap&lt;Vec&lt;u8&gt;, ReadIndexStatus&gt;</text>
<polyline fill="none" stroke="#f7e495" points="2098,-484.5 2334,-484.5 "/>
<text text-anchor="start" x="2106" y="-469.3" font-family="Times,serif" font-size="14.00" fill="#40575d">是使用ctx &amp;[u8] 作为key</text>
</g>
<!-- r_read_only_recv_ack&#45;&gt;pending_read_index -->
<g id="edge8" class="edge">
<title>r_read_only_recv_ack&#45;&gt;pending_read_index</title>
<path fill="none" stroke="#666666" d="M2062.14,-537.97C2070.72,-535.62 2079.4,-533.23 2088.03,-530.86"/>
<polygon fill="#666666" stroke="#666666" points="2089.04,-534.22 2097.76,-528.19 2087.19,-527.47 2089.04,-534.22"/>
</g>
<!-- rs_acks_insert -->
<g id="node9" class="node">
<title>rs_acks_insert</title>
<path fill="#feed9b" stroke="#f7e495" d="M2382,-504.5C2382,-504.5 2516,-504.5 2516,-504.5 2522,-504.5 2528,-510.5 2528,-516.5 2528,-516.5 2528,-561.5 2528,-561.5 2528,-567.5 2522,-573.5 2516,-573.5 2516,-573.5 2382,-573.5 2382,-573.5 2376,-573.5 2370,-567.5 2370,-561.5 2370,-561.5 2370,-516.5 2370,-516.5 2370,-510.5 2376,-504.5 2382,-504.5"/>
<text text-anchor="start" x="2378" y="-558.3" font-family="Times,serif" font-size="14.00" fill="#40575d">struct ReadIndexStatus</text>
<polyline fill="none" stroke="#f7e495" points="2370,-550.5 2528,-550.5 "/>
<text text-anchor="start" x="2378" y="-535.3" font-family="Times,serif" font-size="14.00" fill="#40575d">pub acks: HashSet&lt;u64&gt;,</text>
<polyline fill="none" stroke="#f7e495" points="2370,-527.5 2528,-527.5 "/>
<text text-anchor="start" x="2378" y="-512.3" font-family="Times,serif" font-size="14.00" fill="#40575d">向acks插入id</text>
</g>
<!-- r_read_only_recv_ack&#45;&gt;rs_acks_insert -->
<g id="edge9" class="edge">
<title>r_read_only_recv_ack&#45;&gt;rs_acks_insert</title>
<path fill="none" stroke="#666666" d="M2062.05,-562.81C2152.78,-557.21 2276.79,-549.56 2359.49,-544.46"/>
<polygon fill="#666666" stroke="#666666" points="2359.86,-547.94 2369.62,-543.84 2359.43,-540.96 2359.86,-547.94"/>
</g>
<!-- acks -->
<g id="node32" class="node">
<title>acks</title>
<path fill="none" stroke="#1c2123" d="M2231,-632C2231,-632 2201,-632 2201,-632 2195,-632 2189,-626 2189,-620 2189,-620 2189,-608 2189,-608 2189,-602 2195,-596 2201,-596 2201,-596 2231,-596 2231,-596 2237,-596 2243,-602 2243,-608 2243,-608 2243,-620 2243,-620 2243,-626 2237,-632 2231,-632"/>
<text text-anchor="middle" x="2216" y="-610.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">acks</text>
</g>
<!-- r_read_only_recv_ack&#45;&gt;acks -->
<g id="edge42" class="edge">
<title>r_read_only_recv_ack&#45;&gt;acks</title>
<path fill="none" stroke="#666666" d="M2062.14,-589.04C2104.26,-595.92 2148.79,-603.19 2178.85,-608.1"/>
<polygon fill="#666666" stroke="#666666" points="2178.42,-611.57 2188.85,-609.73 2179.54,-604.66 2178.42,-611.57"/>
</g>
<!-- r_read_only_advance&#45;&gt;pending_read_index -->
<g id="edge11" class="edge">
<title>r_read_only_advance&#45;&gt;pending_read_index</title>
<path fill="none" stroke="#666666" d="M1171.21,-463.48C1183.24,-465.6 1195.36,-467.51 1207,-469 1361.3,-488.79 1400.94,-488 1556.5,-488 1556.5,-488 1556.5,-488 1716,-488 1842.38,-488 1986.75,-490.6 2087.57,-492.83"/>
<polygon fill="#666666" stroke="#666666" points="2087.73,-496.34 2097.8,-493.06 2087.88,-489.34 2087.73,-496.34"/>
</g>
<!-- read_index_queue -->
<g id="node10" class="node">
<title>read_index_queue</title>
<path fill="#feed9b" stroke="#f7e495" d="M1219,-413C1219,-413 1464,-413 1464,-413 1470,-413 1476,-419 1476,-425 1476,-425 1476,-447 1476,-447 1476,-453 1470,-459 1464,-459 1464,-459 1219,-459 1219,-459 1213,-459 1207,-453 1207,-447 1207,-447 1207,-425 1207,-425 1207,-419 1213,-413 1219,-413"/>
<text text-anchor="middle" x="1341.5" y="-443.8" font-family="Times,serif" font-size="14.00" fill="#40575d">read_index_queue</text>
<polyline fill="none" stroke="#f7e495" points="1207,-436 1476,-436 "/>
<text text-anchor="middle" x="1341.5" y="-420.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pub read_index_queue: VecDeque&lt;Vec&lt;u8&gt;&gt;</text>
</g>
<!-- r_read_only_advance&#45;&gt;read_index_queue -->
<g id="edge12" class="edge">
<title>r_read_only_advance&#45;&gt;read_index_queue</title>
<path fill="none" stroke="#666666" d="M1171.21,-438.45C1179.6,-438.33 1188.16,-438.21 1196.75,-438.08"/>
<polygon fill="#666666" stroke="#666666" points="1196.89,-441.58 1206.84,-437.94 1196.79,-434.58 1196.89,-441.58"/>
</g>
<!-- handle_heartbeat_response -->
<g id="node5" class="node">
<title>handle_heartbeat_response</title>
<path fill="none" stroke="#1c2123" d="M838,-410C838,-410 699,-410 699,-410 693,-410 687,-404 687,-398 687,-398 687,-386 687,-386 687,-380 693,-374 699,-374 699,-374 838,-374 838,-374 844,-374 850,-380 850,-386 850,-386 850,-398 850,-398 850,-404 844,-410 838,-410"/>
<text text-anchor="middle" x="768.5" y="-388.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_heartbeat_response</text>
</g>
<!-- handle_heartbeat_response&#45;&gt;r_read_only_recv_ack -->
<g id="edge4" class="edge">
<title>handle_heartbeat_response&#45;&gt;r_read_only_recv_ack</title>
<path fill="none" stroke="#666666" d="M850.17,-392.04C874.72,-395.62 900.36,-403.39 920,-419 951.79,-444.28 922.77,-479.64 956,-503 1026.02,-552.23 1254.9,-526 1340.5,-526 1340.5,-526 1340.5,-526 1558.5,-526 1645.1,-526 1741.95,-537.12 1816.84,-548.19"/>
<polygon fill="#666666" stroke="#666666" points="1816.39,-551.66 1826.8,-549.67 1817.42,-544.73 1816.39,-551.66"/>
</g>
<!-- handle_heartbeat_response&#45;&gt;r_read_only_advance -->
<g id="edge5" class="edge">
<title>handle_heartbeat_response&#45;&gt;r_read_only_advance</title>
<path fill="none" stroke="#666666" d="M850.34,-405.24C879.89,-410.08 913.93,-415.66 945.98,-420.91"/>
<polygon fill="#666666" stroke="#666666" points="945.42,-424.37 955.85,-422.53 946.55,-417.46 945.42,-424.37"/>
</g>
<!-- prs_has_quorum -->
<g id="node6" class="node">
<title>prs_has_quorum</title>
<path fill="none" stroke="#1c2123" d="M1986,-678C1986,-678 1903,-678 1903,-678 1897,-678 1891,-672 1891,-666 1891,-666 1891,-654 1891,-654 1891,-648 1897,-642 1903,-642 1903,-642 1986,-642 1986,-642 1992,-642 1998,-648 1998,-654 1998,-654 1998,-666 1998,-666 1998,-672 1992,-678 1986,-678"/>
<text text-anchor="middle" x="1944.5" y="-656.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">prs_has_quorum</text>
</g>
<!-- handle_heartbeat_response&#45;&gt;prs_has_quorum -->
<g id="edge6" class="edge">
<title>handle_heartbeat_response&#45;&gt;prs_has_quorum</title>
<path fill="none" stroke="#666666" d="M850.29,-390.85C875.13,-394.31 900.92,-402.31 920,-419 959.36,-453.42 915.84,-497.52 956,-531 991.83,-560.87 1669.22,-632.07 1880.86,-653.68"/>
<polygon fill="#666666" stroke="#666666" points="1880.58,-657.17 1890.88,-654.7 1881.29,-650.2 1880.58,-657.17"/>
</g>
<!-- handle_ready_read_index -->
<g id="node7" class="node">
<title>handle_ready_read_index</title>
<path fill="none" stroke="#1c2123" d="M1129.5,-352C1129.5,-352 997.5,-352 997.5,-352 991.5,-352 985.5,-346 985.5,-340 985.5,-340 985.5,-328 985.5,-328 985.5,-322 991.5,-316 997.5,-316 997.5,-316 1129.5,-316 1129.5,-316 1135.5,-316 1141.5,-322 1141.5,-328 1141.5,-328 1141.5,-340 1141.5,-340 1141.5,-346 1135.5,-352 1129.5,-352"/>
<text text-anchor="middle" x="1063.5" y="-330.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_ready_read_index</text>
</g>
<!-- handle_heartbeat_response&#45;&gt;handle_ready_read_index -->
<g id="edge7" class="edge">
<title>handle_heartbeat_response&#45;&gt;handle_ready_read_index</title>
<path fill="none" stroke="#666666" d="M850.34,-376C889.22,-368.3 935.88,-359.06 975.54,-351.21"/>
<polygon fill="#666666" stroke="#666666" points="976.33,-354.63 985.46,-349.25 974.97,-347.76 976.33,-354.63"/>
</g>
<!-- prs_has_quorum&#45;&gt;acks -->
<g id="edge43" class="edge">
<title>prs_has_quorum&#45;&gt;acks</title>
<path fill="none" stroke="#666666" d="M1998.1,-651.02C2051.36,-641.93 2132.32,-628.11 2178.78,-620.18"/>
<polygon fill="#666666" stroke="#666666" points="2179.44,-623.62 2188.71,-618.49 2178.26,-616.72 2179.44,-623.62"/>
</g>
<!-- vote_result -->
<g id="node33" class="node">
<title>vote_result</title>
<path fill="none" stroke="#1c2123" d="M2475.5,-655C2475.5,-655 2422.5,-655 2422.5,-655 2416.5,-655 2410.5,-649 2410.5,-643 2410.5,-643 2410.5,-631 2410.5,-631 2410.5,-625 2416.5,-619 2422.5,-619 2422.5,-619 2475.5,-619 2475.5,-619 2481.5,-619 2487.5,-625 2487.5,-631 2487.5,-631 2487.5,-643 2487.5,-643 2487.5,-649 2481.5,-655 2475.5,-655"/>
<text text-anchor="middle" x="2449" y="-633.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">vote_result</text>
</g>
<!-- prs_has_quorum&#45;&gt;vote_result -->
<g id="edge44" class="edge">
<title>prs_has_quorum&#45;&gt;vote_result</title>
<path fill="none" stroke="#666666" d="M1998.33,-657.58C2096.57,-653.09 2305.94,-643.5 2400.23,-639.19"/>
<polygon fill="#666666" stroke="#666666" points="2400.5,-642.68 2410.33,-638.72 2400.18,-635.68 2400.5,-642.68"/>
</g>
<!-- MsgReadIndexResp -->
<g id="node15" class="node">
<title>MsgReadIndexResp</title>
<path fill="none" stroke="#1c2123" d="M1393,-286C1393,-286 1290,-286 1290,-286 1284,-286 1278,-280 1278,-274 1278,-274 1278,-262 1278,-262 1278,-256 1284,-250 1290,-250 1290,-250 1393,-250 1393,-250 1399,-250 1405,-256 1405,-262 1405,-262 1405,-274 1405,-274 1405,-280 1399,-286 1393,-286"/>
<text text-anchor="middle" x="1341.5" y="-264.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">MsgReadIndexResp</text>
</g>
<!-- handle_ready_read_index&#45;&gt;MsgReadIndexResp -->
<g id="edge17" class="edge">
<title>handle_ready_read_index&#45;&gt;MsgReadIndexResp</title>
<path fill="none" stroke="#666666" d="M1126.69,-316C1151.57,-309.05 1180.55,-301.29 1207,-295 1226.68,-290.32 1248.12,-285.76 1267.93,-281.75"/>
<polygon fill="#666666" stroke="#666666" points="1268.71,-285.16 1277.83,-279.77 1267.33,-278.3 1268.71,-285.16"/>
</g>
<!-- self_read_states -->
<g id="node16" class="node">
<title>self_read_states</title>
<path fill="none" stroke="#1c2123" d="M1381,-340C1381,-340 1302,-340 1302,-340 1296,-340 1290,-334 1290,-328 1290,-328 1290,-316 1290,-316 1290,-310 1296,-304 1302,-304 1302,-304 1381,-304 1381,-304 1387,-304 1393,-310 1393,-316 1393,-316 1393,-328 1393,-328 1393,-334 1387,-340 1381,-340"/>
<text text-anchor="middle" x="1341.5" y="-318.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">self_read_states</text>
</g>
<!-- handle_ready_read_index&#45;&gt;self_read_states -->
<g id="edge18" class="edge">
<title>handle_ready_read_index&#45;&gt;self_read_states</title>
<path fill="none" stroke="#666666" d="M1141.75,-330.64C1185.41,-328.74 1239.21,-326.4 1279.82,-324.64"/>
<polygon fill="#666666" stroke="#666666" points="1280.01,-328.13 1289.85,-324.2 1279.71,-321.14 1280.01,-328.13"/>
</g>
<!-- pending_read_index&#45;&gt;rs_acks_insert -->
<g id="edge10" class="edge">
<title>pending_read_index&#45;&gt;rs_acks_insert</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M2334.19,-517.81C2342.77,-519.41 2351.33,-521.01 2359.69,-522.56"/>
<polygon fill="green" stroke="green" points="2359.3,-526.05 2369.78,-524.44 2360.59,-519.17 2359.3,-526.05"/>
</g>
<!-- step_leader -->
<g id="node11" class="node">
<title>step_leader</title>
<path fill="none" stroke="#1c2123" d="M432,-323C432,-323 569,-323 569,-323 575,-323 581,-329 581,-335 581,-335 581,-357 581,-357 581,-363 575,-369 569,-369 569,-369 432,-369 432,-369 426,-369 420,-363 420,-357 420,-357 420,-335 420,-335 420,-329 426,-323 432,-323"/>
<text text-anchor="middle" x="500.5" y="-353.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">step_leader</text>
<polyline fill="none" stroke="#1c2123" points="420,-346 581,-346 "/>
<text text-anchor="middle" x="500.5" y="-330.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">leader处理MsgReadIndex</text>
</g>
<!-- step_leader&#45;&gt;handle_heartbeat_response -->
<g id="edge28" class="edge">
<title>step_leader&#45;&gt;handle_heartbeat_response</title>
<path fill="none" stroke="#666666" d="M581.31,-359.8C611.41,-365.01 645.87,-370.97 676.89,-376.33"/>
<polygon fill="#666666" stroke="#666666" points="676.38,-379.79 686.83,-378.05 677.57,-372.9 676.38,-379.79"/>
</g>
<!-- step_leader&#45;&gt;handle_ready_read_index -->
<g id="edge13" class="edge">
<title>step_leader&#45;&gt;handle_ready_read_index</title>
<path fill="none" stroke="#666666" d="M581.28,-344.29C685.46,-342.06 867.21,-338.18 975.05,-335.87"/>
<polygon fill="#666666" stroke="#666666" points="975.32,-339.37 985.25,-335.65 975.17,-332.37 975.32,-339.37"/>
</g>
<!-- commit_to_current_term -->
<g id="node12" class="node">
<title>commit_to_current_term</title>
<path fill="none" stroke="#1c2123" d="M703.5,-482.5C703.5,-482.5 833.5,-482.5 833.5,-482.5 839.5,-482.5 845.5,-488.5 845.5,-494.5 845.5,-494.5 845.5,-531.5 845.5,-531.5 845.5,-537.5 839.5,-543.5 833.5,-543.5 833.5,-543.5 703.5,-543.5 703.5,-543.5 697.5,-543.5 691.5,-537.5 691.5,-531.5 691.5,-531.5 691.5,-494.5 691.5,-494.5 691.5,-488.5 697.5,-482.5 703.5,-482.5"/>
<text text-anchor="middle" x="768.5" y="-528.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">commit_to_current_term</text>
<polyline fill="none" stroke="#1c2123" points="691.5,-520.5 845.5,-520.5 "/>
<text text-anchor="start" x="699.5" y="-505.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Checks if logs are </text>
<text text-anchor="start" x="699.5" y="-490.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> committed to its term.</text>
</g>
<!-- step_leader&#45;&gt;commit_to_current_term -->
<g id="edge14" class="edge">
<title>step_leader&#45;&gt;commit_to_current_term</title>
<path fill="none" stroke="#666666" d="M519.93,-369.25C546.29,-401.94 594.08,-459.07 617,-473 636.52,-484.87 659.55,-493.26 681.65,-499.18"/>
<polygon fill="#666666" stroke="#666666" points="680.83,-502.58 691.38,-501.64 682.55,-495.79 680.83,-502.58"/>
</g>
<!-- prs_is_singleton -->
<g id="node13" class="node">
<title>prs_is_singleton</title>
<path fill="none" stroke="#1c2123" d="M809,-598C809,-598 728,-598 728,-598 722,-598 716,-592 716,-586 716,-586 716,-574 716,-574 716,-568 722,-562 728,-562 728,-562 809,-562 809,-562 815,-562 821,-568 821,-574 821,-574 821,-586 821,-586 821,-592 815,-598 809,-598"/>
<text text-anchor="middle" x="768.5" y="-576.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">prs_is_singleton</text>
</g>
<!-- step_leader&#45;&gt;prs_is_singleton -->
<g id="edge15" class="edge">
<title>step_leader&#45;&gt;prs_is_singleton</title>
<path fill="none" stroke="#666666" d="M507.29,-369.06C519.53,-412.64 552.34,-506.87 617,-553 642.52,-571.2 676.51,-578.36 705.74,-580.79"/>
<polygon fill="#666666" stroke="#666666" points="705.64,-584.29 715.85,-581.46 706.11,-577.3 705.64,-584.29"/>
</g>
<!-- bcast_heartbeat_with_ctx -->
<g id="node14" class="node">
<title>bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#1c2123" d="M692,-153C692,-153 845,-153 845,-153 851,-153 857,-159 857,-165 857,-165 857,-187 857,-187 857,-193 851,-199 845,-199 845,-199 692,-199 692,-199 686,-199 680,-193 680,-187 680,-187 680,-165 680,-165 680,-159 686,-153 692,-153"/>
<text text-anchor="middle" x="768.5" y="-183.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">bcast_heartbeat_with_ctx</text>
<polyline fill="none" stroke="#1c2123" points="680,-176 857,-176 "/>
<text text-anchor="start" x="688" y="-160.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">向prs所有peer发送heartbeat</text>
</g>
<!-- step_leader&#45;&gt;bcast_heartbeat_with_ctx -->
<g id="edge16" class="edge">
<title>step_leader&#45;&gt;bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#666666" d="M547.7,-322.95C559.71,-315.32 571.83,-305.93 581,-295 607.64,-263.27 585.18,-235.54 617,-209 632.11,-196.4 650.97,-188.31 670.17,-183.19"/>
<polygon fill="#666666" stroke="#666666" points="671.01,-186.59 679.91,-180.84 669.37,-179.78 671.01,-186.59"/>
</g>
<!-- add_request -->
<g id="node24" class="node">
<title>add_request</title>
<path fill="none" stroke="#1c2123" d="M629,-218.5C629,-218.5 908,-218.5 908,-218.5 914,-218.5 920,-224.5 920,-230.5 920,-230.5 920,-305.5 920,-305.5 920,-311.5 914,-317.5 908,-317.5 908,-317.5 629,-317.5 629,-317.5 623,-317.5 617,-311.5 617,-305.5 617,-305.5 617,-230.5 617,-230.5 617,-224.5 623,-218.5 629,-218.5"/>
<text text-anchor="middle" x="768.5" y="-302.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">add_request</text>
<polyline fill="none" stroke="#1c2123" points="617,-294.5 920,-294.5 "/>
<text text-anchor="start" x="625" y="-279.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnly.add_request Adds a read only request into</text>
<text text-anchor="start" x="625" y="-264.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> readonly struct.</text>
<polyline fill="none" stroke="#1c2123" points="617,-256.5 920,-256.5 "/>
<text text-anchor="start" x="625" y="-241.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">将ctx插入pending_read_index</text>
<text text-anchor="start" x="625" y="-226.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 和read_index_queue中</text>
</g>
<!-- step_leader&#45;&gt;add_request -->
<g id="edge29" class="edge">
<title>step_leader&#45;&gt;add_request</title>
<path fill="none" stroke="#666666" d="M580.23,-322.91C588.87,-320.38 597.88,-317.74 607.07,-315.04"/>
<polygon fill="#666666" stroke="#666666" points="608.1,-318.39 616.71,-312.22 606.13,-311.67 608.1,-318.39"/>
</g>
<!-- raft_log_committed -->
<g id="node26" class="node">
<title>raft_log_committed</title>
<path fill="none" stroke="#1c2123" d="M1114,-720C1114,-720 1013,-720 1013,-720 1007,-720 1001,-714 1001,-708 1001,-708 1001,-696 1001,-696 1001,-690 1007,-684 1013,-684 1013,-684 1114,-684 1114,-684 1120,-684 1126,-690 1126,-696 1126,-696 1126,-708 1126,-708 1126,-714 1120,-720 1114,-720"/>
<text text-anchor="middle" x="1063.5" y="-698.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_log_committed</text>
</g>
<!-- commit_to_current_term&#45;&gt;raft_log_committed -->
<g id="edge32" class="edge">
<title>commit_to_current_term&#45;&gt;raft_log_committed</title>
<path fill="none" stroke="#666666" d="M845.52,-518.05C872.06,-523.41 900.14,-533.67 920,-553 960.51,-592.43 915.26,-635.8 956,-675 965.64,-684.27 977.99,-690.49 990.84,-694.63"/>
<polygon fill="#666666" stroke="#666666" points="990.16,-698.08 1000.73,-697.41 992.05,-691.34 990.16,-698.08"/>
</g>
<!-- send_heartbeat -->
<g id="node27" class="node">
<title>send_heartbeat</title>
<path fill="none" stroke="#1c2123" d="M1100.5,-140C1100.5,-140 1026.5,-140 1026.5,-140 1020.5,-140 1014.5,-134 1014.5,-128 1014.5,-128 1014.5,-116 1014.5,-116 1014.5,-110 1020.5,-104 1026.5,-104 1026.5,-104 1100.5,-104 1100.5,-104 1106.5,-104 1112.5,-110 1112.5,-116 1112.5,-116 1112.5,-128 1112.5,-128 1112.5,-134 1106.5,-140 1100.5,-140"/>
<text text-anchor="middle" x="1063.5" y="-118.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">send_heartbeat</text>
</g>
<!-- bcast_heartbeat_with_ctx&#45;&gt;send_heartbeat -->
<g id="edge35" class="edge">
<title>bcast_heartbeat_with_ctx&#45;&gt;send_heartbeat</title>
<path fill="none" stroke="#666666" d="M857.01,-159.87C904.53,-151.11 961.98,-140.53 1004.04,-132.77"/>
<polygon fill="#666666" stroke="#666666" points="1004.92,-136.17 1014.12,-130.92 1003.65,-129.29 1004.92,-136.17"/>
</g>
<!-- ctx_clone -->
<g id="node28" class="node">
<title>ctx_clone</title>
<path fill="none" stroke="#1c2123" d="M1086,-194C1086,-194 1041,-194 1041,-194 1035,-194 1029,-188 1029,-182 1029,-182 1029,-170 1029,-170 1029,-164 1035,-158 1041,-158 1041,-158 1086,-158 1086,-158 1092,-158 1098,-164 1098,-170 1098,-170 1098,-182 1098,-182 1098,-188 1092,-194 1086,-194"/>
<text text-anchor="middle" x="1063.5" y="-172.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ctx_clone</text>
</g>
<!-- bcast_heartbeat_with_ctx&#45;&gt;ctx_clone -->
<g id="edge36" class="edge">
<title>bcast_heartbeat_with_ctx&#45;&gt;ctx_clone</title>
<path fill="none" stroke="#666666" d="M857.01,-176C910.29,-176 976.06,-176 1018.62,-176"/>
<polygon fill="#666666" stroke="#666666" points="1018.66,-179.5 1028.66,-176 1018.66,-172.5 1018.66,-179.5"/>
</g>
<!-- step_follower -->
<g id="node21" class="node">
<title>step_follower</title>
<path fill="none" stroke="#1c2123" d="M1591,-144C1591,-144 1524,-144 1524,-144 1518,-144 1512,-138 1512,-132 1512,-132 1512,-120 1512,-120 1512,-114 1518,-108 1524,-108 1524,-108 1591,-108 1591,-108 1597,-108 1603,-114 1603,-120 1603,-120 1603,-132 1603,-132 1603,-138 1597,-144 1591,-144"/>
<text text-anchor="middle" x="1557.5" y="-122.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">step_follower</text>
</g>
<!-- MsgReadIndexResp&#45;&gt;step_follower -->
<g id="edge25" class="edge">
<title>MsgReadIndexResp&#45;&gt;step_follower</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1384.09,-249.93C1411.26,-237.31 1446.96,-219.16 1476,-199 1496.06,-185.07 1516.41,-166.57 1531.64,-151.67"/>
<polygon fill="green" stroke="green" points="1534.47,-153.79 1539.1,-144.26 1529.54,-148.82 1534.47,-153.79"/>
</g>
<!-- read_states -->
<g id="node34" class="node">
<title>read_states</title>
<path fill="none" stroke="#1c2123" d="M1584,-342C1584,-342 1531,-342 1531,-342 1525,-342 1519,-336 1519,-330 1519,-330 1519,-318 1519,-318 1519,-312 1525,-306 1531,-306 1531,-306 1584,-306 1584,-306 1590,-306 1596,-312 1596,-318 1596,-318 1596,-330 1596,-330 1596,-336 1590,-342 1584,-342"/>
<text text-anchor="middle" x="1557.5" y="-320.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_states</text>
</g>
<!-- MsgReadIndexResp&#45;&gt;read_states -->
<g id="edge49" class="edge">
<title>MsgReadIndexResp&#45;&gt;read_states</title>
<path fill="none" stroke="#666666" d="M1405.1,-278.7C1427.62,-283.06 1453.11,-288.6 1476,-295 1486.84,-298.03 1498.32,-301.81 1509.11,-305.63"/>
<polygon fill="#666666" stroke="#666666" points="1508.19,-309.02 1518.79,-309.13 1510.57,-302.43 1508.19,-309.02"/>
</g>
<!-- RawNode_read_index -->
<g id="node17" class="node">
<title>RawNode_read_index</title>
<path fill="none" stroke="#1c2123" d="M12,-97.5C12,-97.5 236,-97.5 236,-97.5 242,-97.5 248,-103.5 248,-109.5 248,-109.5 248,-274.5 248,-274.5 248,-280.5 242,-286.5 236,-286.5 236,-286.5 12,-286.5 12,-286.5 6,-286.5 0,-280.5 0,-274.5 0,-274.5 0,-109.5 0,-109.5 0,-103.5 6,-97.5 12,-97.5"/>
<text text-anchor="middle" x="124" y="-271.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RawNode.read_index</text>
<polyline fill="none" stroke="#1c2123" points="0,-263.5 248,-263.5 "/>
<text text-anchor="start" x="8" y="-248.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">app通过该接口发起read_index请求</text>
<polyline fill="none" stroke="#1c2123" points="0,-240.5 248,-240.5 "/>
<text text-anchor="start" x="8" y="-225.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">follower向leader发送ReadIndex消息</text>
<text text-anchor="start" x="8" y="-210.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ReadIndex requests a read state</text>
<text text-anchor="start" x="8" y="-195.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> the read state will be set in ready</text>
<text text-anchor="start" x="8" y="-180.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Read State has a read index. Once the</text>
<text text-anchor="start" x="8" y="-165.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> application advances further than the read</text>
<text text-anchor="start" x="8" y="-150.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> index, any linearizable read requests</text>
<text text-anchor="start" x="8" y="-135.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> issued before the read request can be</text>
<text text-anchor="start" x="8" y="-120.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> processed safely. The read state will</text>
<text text-anchor="start" x="8" y="-105.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> have the same rctx attached.</text>
</g>
<!-- MsgReadIndex -->
<g id="node18" class="node">
<title>MsgReadIndex</title>
<path fill="none" stroke="#1c2123" d="M372,-325C372,-325 296,-325 296,-325 290,-325 284,-319 284,-313 284,-313 284,-301 284,-301 284,-295 290,-289 296,-289 296,-289 372,-289 372,-289 378,-289 384,-295 384,-301 384,-301 384,-313 384,-313 384,-319 378,-325 372,-325"/>
<text text-anchor="middle" x="334" y="-303.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">MsgReadIndex</text>
</g>
<!-- RawNode_read_index&#45;&gt;MsgReadIndex -->
<g id="edge19" class="edge">
<title>RawNode_read_index&#45;&gt;MsgReadIndex</title>
<path fill="none" stroke="#666666" d="M248.1,-260.06C263.49,-268.57 278.3,-276.75 291.12,-283.84"/>
<polygon fill="#666666" stroke="#666666" points="289.64,-287.02 300.08,-288.8 293.02,-280.9 289.64,-287.02"/>
</g>
<!-- step -->
<g id="node19" class="node">
<title>step</title>
<path fill="none" stroke="#1c2123" d="M349,-183C349,-183 319,-183 319,-183 313,-183 307,-177 307,-171 307,-171 307,-159 307,-159 307,-153 313,-147 319,-147 319,-147 349,-147 349,-147 355,-147 361,-153 361,-159 361,-159 361,-171 361,-171 361,-177 355,-183 349,-183"/>
<text text-anchor="middle" x="334" y="-161.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">step</text>
</g>
<!-- RawNode_read_index&#45;&gt;step -->
<g id="edge20" class="edge">
<title>RawNode_read_index&#45;&gt;step</title>
<path fill="none" stroke="#666666" d="M248.1,-176.02C265.71,-173.73 282.57,-171.55 296.56,-169.73"/>
<polygon fill="#666666" stroke="#666666" points="297.19,-173.18 306.66,-168.42 296.29,-166.24 297.19,-173.18"/>
</g>
<!-- MsgReadIndex&#45;&gt;step_leader -->
<g id="edge22" class="edge">
<title>MsgReadIndex&#45;&gt;step_leader</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M384.36,-318.7C392.47,-320.62 401.09,-322.67 409.83,-324.74"/>
<polygon fill="green" stroke="green" points="409.19,-328.19 419.72,-327.09 410.8,-321.37 409.19,-328.19"/>
</g>
<!-- MsgReadIndex&#45;&gt;commit_to_current_term -->
<g id="edge46" class="edge">
<title>MsgReadIndex&#45;&gt;commit_to_current_term</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M353.46,-325.09C369.98,-340.65 395.31,-363.04 420,-379 501.46,-431.68 525.95,-439.51 617,-473 637.57,-480.57 660.21,-487.35 681.54,-493.1"/>
<polygon fill="green" stroke="green" points="680.68,-496.49 691.24,-495.66 682.47,-489.72 680.68,-496.49"/>
</g>
<!-- MsgReadIndex&#45;&gt;prs_is_singleton -->
<g id="edge47" class="edge">
<title>MsgReadIndex&#45;&gt;prs_is_singleton</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M344.22,-325.32C358,-351.37 386.02,-399.56 420,-432 494.32,-502.95 520.99,-516.4 617,-553 645.17,-563.74 677.96,-570.26 705.73,-574.2"/>
<polygon fill="green" stroke="green" points="705.34,-577.68 715.71,-575.53 706.27,-570.74 705.34,-577.68"/>
</g>
<!-- send -->
<g id="node20" class="node">
<title>send</title>
<path fill="none" stroke="#1c2123" d="M1730,-36C1730,-36 1700,-36 1700,-36 1694,-36 1688,-30 1688,-24 1688,-24 1688,-12 1688,-12 1688,-6 1694,0 1700,0 1700,0 1730,0 1730,0 1736,0 1742,-6 1742,-12 1742,-12 1742,-24 1742,-24 1742,-30 1736,-36 1730,-36"/>
<text text-anchor="middle" x="1715" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">send</text>
</g>
<!-- MsgReadIndex&#45;&gt;send -->
<g id="edge21" class="edge">
<title>MsgReadIndex&#45;&gt;send</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M355.8,-288.95C372.5,-274.94 396.9,-255.51 420,-241 502.81,-188.98 523.61,-172.01 617,-143 1018.42,-18.33 1537.06,-15.52 1677.55,-17.28"/>
<polygon fill="green" stroke="green" points="1677.71,-20.79 1687.76,-17.43 1677.81,-13.79 1677.71,-20.79"/>
</g>
<!-- ReadOnlyOption_Safe -->
<g id="node25" class="node">
<title>ReadOnlyOption_Safe</title>
<path fill="none" stroke="#1c2123" d="M558.5,-286C558.5,-286 442.5,-286 442.5,-286 436.5,-286 430.5,-280 430.5,-274 430.5,-274 430.5,-262 430.5,-262 430.5,-256 436.5,-250 442.5,-250 442.5,-250 558.5,-250 558.5,-250 564.5,-250 570.5,-256 570.5,-262 570.5,-262 570.5,-274 570.5,-274 570.5,-280 564.5,-286 558.5,-286"/>
<text text-anchor="middle" x="500.5" y="-264.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadOnlyOption_Safe</text>
</g>
<!-- MsgReadIndex&#45;&gt;ReadOnlyOption_Safe -->
<g id="edge48" class="edge">
<title>MsgReadIndex&#45;&gt;ReadOnlyOption_Safe</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M384.36,-295.3C395.78,-292.59 408.22,-289.64 420.56,-286.72"/>
<polygon fill="green" stroke="green" points="421.49,-290.09 430.41,-284.38 419.88,-283.28 421.49,-290.09"/>
</g>
<!-- step&#45;&gt;step_follower -->
<g id="edge23" class="edge">
<title>step&#45;&gt;step_follower</title>
<path fill="none" stroke="#666666" d="M343.68,-146.63C356.46,-122.04 382.88,-79.5 420,-62 484.73,-31.49 509.46,-60.64 581,-62 978.99,-69.56 1085.66,-17.95 1476,-96 1485.98,-98 1496.36,-101.06 1506.22,-104.48"/>
<polygon fill="#666666" stroke="#666666" points="1505.28,-107.86 1515.87,-107.99 1507.67,-101.28 1505.28,-107.86"/>
</g>
<!-- step_follower&#45;&gt;send -->
<g id="edge24" class="edge">
<title>step_follower&#45;&gt;send</title>
<path fill="none" stroke="#666666" d="M1572.41,-107.9C1587.18,-89.76 1612.08,-62.15 1639,-45 1650.79,-37.49 1664.95,-31.71 1677.78,-27.45"/>
<polygon fill="#666666" stroke="#666666" points="1679.2,-30.68 1687.71,-24.36 1677.12,-23.99 1679.2,-30.68"/>
</g>
<!-- self_read_states_push -->
<g id="node22" class="node">
<title>self_read_states_push</title>
<path fill="none" stroke="#1c2123" d="M1770.5,-144C1770.5,-144 1659.5,-144 1659.5,-144 1653.5,-144 1647.5,-138 1647.5,-132 1647.5,-132 1647.5,-120 1647.5,-120 1647.5,-114 1653.5,-108 1659.5,-108 1659.5,-108 1770.5,-108 1770.5,-108 1776.5,-108 1782.5,-114 1782.5,-120 1782.5,-120 1782.5,-132 1782.5,-132 1782.5,-138 1776.5,-144 1770.5,-144"/>
<text text-anchor="middle" x="1715" y="-122.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">self_read_states_push</text>
</g>
<!-- step_follower&#45;&gt;self_read_states_push -->
<g id="edge26" class="edge">
<title>step_follower&#45;&gt;self_read_states_push</title>
<path fill="none" stroke="#666666" d="M1603.06,-126C1613.75,-126 1625.47,-126 1637.16,-126"/>
<polygon fill="#666666" stroke="#666666" points="1637.4,-129.5 1647.4,-126 1637.4,-122.5 1637.4,-129.5"/>
</g>
<!-- raft_log_maybe_commit -->
<g id="node23" class="node">
<title>raft_log_maybe_commit</title>
<path fill="none" stroke="#1c2123" d="M1779,-90C1779,-90 1651,-90 1651,-90 1645,-90 1639,-84 1639,-78 1639,-78 1639,-66 1639,-66 1639,-60 1645,-54 1651,-54 1651,-54 1779,-54 1779,-54 1785,-54 1791,-60 1791,-66 1791,-66 1791,-78 1791,-78 1791,-84 1785,-90 1779,-90"/>
<text text-anchor="middle" x="1715" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_log_maybe_commit</text>
</g>
<!-- step_follower&#45;&gt;raft_log_maybe_commit -->
<g id="edge27" class="edge">
<title>step_follower&#45;&gt;raft_log_maybe_commit</title>
<path fill="none" stroke="#666666" d="M1603.06,-110.53C1618.44,-105.18 1635.95,-99.1 1652.45,-93.38"/>
<polygon fill="#666666" stroke="#666666" points="1653.72,-96.64 1662.02,-90.05 1651.42,-90.03 1653.72,-96.64"/>
</g>
<!-- msgHeartBeatResponse -->
<g id="node30" class="node">
<title>msgHeartBeatResponse</title>
<path fill="none" stroke="#1c2123" d="M1776,-198C1776,-198 1654,-198 1654,-198 1648,-198 1642,-192 1642,-186 1642,-186 1642,-174 1642,-174 1642,-168 1648,-162 1654,-162 1654,-162 1776,-162 1776,-162 1782,-162 1788,-168 1788,-174 1788,-174 1788,-186 1788,-186 1788,-192 1782,-198 1776,-198"/>
<text text-anchor="middle" x="1715" y="-176.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">msgHeartBeatResponse</text>
</g>
<!-- step_follower&#45;&gt;msgHeartBeatResponse -->
<g id="edge39" class="edge">
<title>step_follower&#45;&gt;msgHeartBeatResponse</title>
<path fill="none" stroke="#666666" d="M1603.06,-141.47C1618.44,-146.82 1635.95,-152.9 1652.45,-158.62"/>
<polygon fill="#666666" stroke="#666666" points="1651.42,-161.97 1662.02,-161.95 1653.72,-155.36 1651.42,-161.97"/>
</g>
<!-- add_request&#45;&gt;pending_read_index -->
<g id="edge33" class="edge">
<title>add_request&#45;&gt;pending_read_index</title>
<path fill="none" stroke="#666666" d="M920.2,-244.3C932.29,-242.97 944.33,-241.84 956,-241 1326.98,-214.29 1436.49,-184.46 1791,-297 1921.23,-338.34 2063.16,-411.14 2145.33,-456.29"/>
<polygon fill="#666666" stroke="#666666" points="2144.12,-459.62 2154.56,-461.39 2147.5,-453.49 2144.12,-459.62"/>
</g>
<!-- add_request&#45;&gt;read_index_queue -->
<g id="edge34" class="edge">
<title>add_request&#45;&gt;read_index_queue</title>
<path fill="none" stroke="#666666" d="M920.31,-246.42C1002.24,-242.96 1100.85,-253.18 1171,-307 1207.15,-334.74 1172.96,-372.71 1207,-403 1208.54,-404.37 1210.12,-405.68 1211.75,-406.94"/>
<polygon fill="#666666" stroke="#666666" points="1210.02,-410 1220.23,-412.82 1214.01,-404.25 1210.02,-410"/>
</g>
<!-- ReadOnlyOption_Safe&#45;&gt;bcast_heartbeat_with_ctx -->
<g id="edge30" class="edge">
<title>ReadOnlyOption_Safe&#45;&gt;bcast_heartbeat_with_ctx</title>
<path fill="none" stroke="#666666" d="M531.91,-249.74C554.66,-236.76 586.9,-219.79 617,-209 633.79,-202.99 652.03,-197.87 669.84,-193.58"/>
<polygon fill="#666666" stroke="#666666" points="670.74,-196.97 679.68,-191.29 669.15,-190.15 670.74,-196.97"/>
</g>
<!-- ReadOnlyOption_Safe&#45;&gt;add_request -->
<g id="edge31" class="edge">
<title>ReadOnlyOption_Safe&#45;&gt;add_request</title>
<path fill="none" stroke="#666666" d="M570.69,-268C582.05,-268 594.22,-268 606.73,-268"/>
<polygon fill="#666666" stroke="#666666" points="606.84,-271.5 616.84,-268 606.83,-264.5 606.84,-271.5"/>
</g>
<!-- msgHeartBeat -->
<g id="node29" class="node">
<title>msgHeartBeat</title>
<path fill="#feed9b" stroke="#f7e495" d="M1221,-106C1221,-106 1462,-106 1462,-106 1468,-106 1474,-112 1474,-118 1474,-118 1474,-178 1474,-178 1474,-184 1468,-190 1462,-190 1462,-190 1221,-190 1221,-190 1215,-190 1209,-184 1209,-178 1209,-178 1209,-118 1209,-118 1209,-112 1215,-106 1221,-106"/>
<text text-anchor="middle" x="1341.5" y="-174.8" font-family="Times,serif" font-size="14.00" fill="#40575d">msgHeartBeat</text>
<polyline fill="none" stroke="#f7e495" points="1209,-167 1474,-167 "/>
<text text-anchor="middle" x="1341.5" y="-151.8" font-family="Times,serif" font-size="14.00" fill="#40575d">m.context = context</text>
<polyline fill="none" stroke="#f7e495" points="1209,-144 1474,-144 "/>
<text text-anchor="start" x="1217" y="-128.8" font-family="Times,serif" font-size="14.00" fill="#40575d">follower处理该消息时候，</text>
<text text-anchor="start" x="1217" y="-113.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 会把context通过msgHeartBeatResp带回来</text>
</g>
<!-- ctx_clone&#45;&gt;msgHeartBeat -->
<g id="edge37" class="edge">
<title>ctx_clone&#45;&gt;msgHeartBeat</title>
<path fill="none" stroke="#666666" d="M1098.07,-172.59C1123.78,-169.99 1161.15,-166.19 1198.88,-162.37"/>
<polygon fill="#666666" stroke="#666666" points="1199.4,-165.83 1208.99,-161.34 1198.69,-158.87 1199.4,-165.83"/>
</g>
<!-- msgHeartBeat&#45;&gt;step_follower -->
<g id="edge38" class="edge">
<title>msgHeartBeat&#45;&gt;step_follower</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1474.07,-134.47C1483.74,-133.48 1493.13,-132.51 1501.9,-131.61"/>
<polygon fill="green" stroke="green" points="1502.29,-135.09 1511.88,-130.59 1501.58,-128.13 1502.29,-135.09"/>
</g>
<!-- msgHeartBeatResponse&#45;&gt;r_read_only_recv_ack -->
<g id="edge41" class="edge">
<title>msgHeartBeatResponse&#45;&gt;r_read_only_recv_ack</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1728.04,-198.03C1743.15,-220.82 1769.67,-261.4 1791,-297 1833.75,-368.36 1879.95,-452.09 1910.17,-507.83"/>
<polygon fill="green" stroke="green" points="1907.22,-509.74 1915.06,-516.87 1913.38,-506.41 1907.22,-509.74"/>
</g>
<!-- handle_heartbeat -->
<g id="node31" class="node">
<title>handle_heartbeat</title>
<path fill="none" stroke="#1c2123" d="M1987,-198C1987,-198 1902,-198 1902,-198 1896,-198 1890,-192 1890,-186 1890,-186 1890,-174 1890,-174 1890,-168 1896,-162 1902,-162 1902,-162 1987,-162 1987,-162 1993,-162 1999,-168 1999,-174 1999,-174 1999,-186 1999,-186 1999,-192 1993,-198 1987,-198"/>
<text text-anchor="middle" x="1944.5" y="-176.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle_heartbeat</text>
</g>
<!-- msgHeartBeatResponse&#45;&gt;handle_heartbeat -->
<g id="edge40" class="edge">
<title>msgHeartBeatResponse&#45;&gt;handle_heartbeat</title>
<path fill="none" stroke="#666666" d="M1788.3,-180C1817.61,-180 1851.19,-180 1879.59,-180"/>
<polygon fill="#666666" stroke="#666666" points="1879.8,-183.5 1889.8,-180 1879.8,-176.5 1879.8,-183.5"/>
</g>
<!-- acks&#45;&gt;vote_result -->
<g id="edge45" class="edge">
<title>acks&#45;&gt;vote_result</title>
<path fill="none" stroke="#666666" d="M2243.05,-616.59C2281.08,-620.38 2352.46,-627.49 2400.13,-632.23"/>
<polygon fill="#666666" stroke="#666666" points="2399.91,-635.73 2410.21,-633.24 2400.61,-628.76 2399.91,-635.73"/>
</g>
<!-- Ready -->
<g id="node36" class="node">
<title>Ready</title>
<path fill="none" stroke="#1c2123" d="M1730,-342C1730,-342 1700,-342 1700,-342 1694,-342 1688,-336 1688,-330 1688,-330 1688,-318 1688,-318 1688,-312 1694,-306 1700,-306 1700,-306 1730,-306 1730,-306 1736,-306 1742,-312 1742,-318 1742,-318 1742,-330 1742,-330 1742,-336 1736,-342 1730,-342"/>
<text text-anchor="middle" x="1715" y="-320.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Ready</text>
</g>
<!-- read_states&#45;&gt;Ready -->
<g id="edge51" class="edge">
<title>read_states&#45;&gt;Ready</title>
<path fill="none" stroke="#666666" d="M1596.14,-324C1620.88,-324 1653.09,-324 1677.58,-324"/>
<polygon fill="#666666" stroke="#666666" points="1677.9,-327.5 1687.9,-324 1677.9,-320.5 1677.9,-327.5"/>
</g>
<!-- ready -->
<g id="node35" class="node">
<title>ready</title>
<path fill="none" stroke="#1c2123" d="M1356.5,-394C1356.5,-394 1326.5,-394 1326.5,-394 1320.5,-394 1314.5,-388 1314.5,-382 1314.5,-382 1314.5,-370 1314.5,-370 1314.5,-364 1320.5,-358 1326.5,-358 1326.5,-358 1356.5,-358 1356.5,-358 1362.5,-358 1368.5,-364 1368.5,-370 1368.5,-370 1368.5,-382 1368.5,-382 1368.5,-388 1362.5,-394 1356.5,-394"/>
<text text-anchor="middle" x="1341.5" y="-372.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ready</text>
</g>
<!-- ready&#45;&gt;read_states -->
<g id="edge50" class="edge">
<title>ready&#45;&gt;read_states</title>
<path fill="none" stroke="#666666" d="M1368.52,-371.55C1395.55,-366.73 1439,-358.46 1476,-349 1486.75,-346.25 1498.19,-342.94 1508.97,-339.64"/>
<polygon fill="#666666" stroke="#666666" points="1510.14,-342.94 1518.64,-336.63 1508.05,-336.26 1510.14,-342.94"/>
</g>
</g>
</svg>
