<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: router_send_control Pages: 1 -->
<svg width="1181pt" height="620pt"
 viewBox="0.00 0.00 1181.00 620.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 616)">
<title>router_send_control</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-616 1177,-616 1177,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Fsm</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M660,-8C660,-8 1122.5,-8 1122.5,-8 1128.5,-8 1134.5,-14 1134.5,-20 1134.5,-20 1134.5,-128 1134.5,-128 1134.5,-134 1128.5,-140 1122.5,-140 1122.5,-140 660,-140 660,-140 654,-140 648,-134 648,-128 648,-128 648,-20 648,-20 648,-14 654,-8 660,-8"/>
<text text-anchor="middle" x="891.25" y="-120" font-family="Times,serif" font-size="20.00">Fsm</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_mailbox</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M142,-148C142,-148 840,-148 840,-148 846,-148 852,-154 852,-160 852,-160 852,-444 852,-444 852,-450 846,-456 840,-456 840,-456 142,-456 142,-456 136,-456 130,-450 130,-444 130,-444 130,-160 130,-160 130,-154 136,-148 142,-148"/>
<text text-anchor="middle" x="491" y="-436" font-family="Times,serif" font-size="20.00">mailbox</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_FsmState</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M413,-256C413,-256 832,-256 832,-256 838,-256 844,-262 844,-268 844,-268 844,-406 844,-406 844,-412 838,-418 832,-418 832,-418 413,-418 413,-418 407,-418 401,-412 401,-406 401,-406 401,-268 401,-268 401,-262 407,-256 413,-256"/>
<text text-anchor="middle" x="622.5" y="-398" font-family="Times,serif" font-size="20.00">FsmState</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_Router</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-464C20,-464 1153,-464 1153,-464 1159,-464 1165,-470 1165,-476 1165,-476 1165,-592 1165,-592 1165,-598 1159,-604 1153,-604 1153,-604 20,-604 20,-604 14,-604 8,-598 8,-592 8,-592 8,-476 8,-476 8,-470 14,-464 20,-464"/>
<text text-anchor="middle" x="586.5" y="-584" font-family="Times,serif" font-size="20.00">Router</text>
</g>
<!-- set_mailbox -->
<g id="node1" class="node">
<title>set_mailbox</title>
<path fill="none" stroke="#1c2123" d="M668,-34.5C668,-34.5 799,-34.5 799,-34.5 805,-34.5 811,-40.5 811,-46.5 811,-46.5 811,-83.5 811,-83.5 811,-89.5 805,-95.5 799,-95.5 799,-95.5 668,-95.5 668,-95.5 662,-95.5 656,-89.5 656,-83.5 656,-83.5 656,-46.5 656,-46.5 656,-40.5 662,-34.5 668,-34.5"/>
<text text-anchor="middle" x="733.5" y="-80.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_mailbox</text>
<polyline fill="none" stroke="#1c2123" points="656,-72.5 811,-72.5 "/>
<text text-anchor="start" x="664" y="-57.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">store fsm用不到mailbox</text>
<text text-anchor="start" x="664" y="-42.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 该函数为空</text>
</g>
<!-- StoreFsm -->
<g id="node2" class="node">
<title>StoreFsm</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M914.5,-16.5C914.5,-16.5 1114.5,-16.5 1114.5,-16.5 1120.5,-16.5 1126.5,-22.5 1126.5,-28.5 1126.5,-28.5 1126.5,-89.5 1126.5,-89.5 1126.5,-95.5 1120.5,-101.5 1114.5,-101.5 1114.5,-101.5 914.5,-101.5 914.5,-101.5 908.5,-101.5 902.5,-95.5 902.5,-89.5 902.5,-89.5 902.5,-28.5 902.5,-28.5 902.5,-22.5 908.5,-16.5 914.5,-16.5"/>
<text text-anchor="middle" x="1014.5" y="-86.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">StoreFsm</text>
<polyline fill="none" stroke="#60b5ac" points="902.5,-78.5 1126.5,-78.5 "/>
<text text-anchor="start" x="910.5" y="-63.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">store: Store,</text>
<polyline fill="none" stroke="#60b5ac" points="902.5,-55.5 1126.5,-55.5 "/>
<text text-anchor="start" x="910.5" y="-40.3" font-family="Times,serif" font-size="14.00" fill="#5d6179">receiver: Receiver&lt;StoreMsg&lt;EK&gt;&gt;,</text>
</g>
<!-- set_mailbox&#45;&gt;StoreFsm -->
<g id="edge1" class="edge">
<title>set_mailbox&#45;&gt;StoreFsm</title>
<path fill="none" stroke="#666666" d="M811.11,-63.35C836.18,-62.81 864.68,-62.2 892.21,-61.61"/>
<polygon fill="#666666" stroke="#666666" points="892.38,-65.11 902.31,-61.39 892.23,-58.11 892.38,-65.11"/>
</g>
<!-- control_box -->
<g id="node3" class="node">
<title>control_box</title>
<path fill="none" stroke="#1c2123" d="M284.5,-508C284.5,-508 226.5,-508 226.5,-508 220.5,-508 214.5,-502 214.5,-496 214.5,-496 214.5,-484 214.5,-484 214.5,-478 220.5,-472 226.5,-472 226.5,-472 284.5,-472 284.5,-472 290.5,-472 296.5,-478 296.5,-484 296.5,-484 296.5,-496 296.5,-496 296.5,-502 290.5,-508 284.5,-508"/>
<text text-anchor="middle" x="255.5" y="-486.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">control_box</text>
</g>
<!-- sender_try_send -->
<g id="node4" class="node">
<title>sender_try_send</title>
<path fill="none" stroke="#1c2123" d="M428,-156.5C428,-156.5 576,-156.5 576,-156.5 582,-156.5 588,-162.5 588,-168.5 588,-168.5 588,-235.5 588,-235.5 588,-241.5 582,-247.5 576,-247.5 576,-247.5 428,-247.5 428,-247.5 422,-247.5 416,-241.5 416,-235.5 416,-235.5 416,-168.5 416,-168.5 416,-162.5 422,-156.5 428,-156.5"/>
<text text-anchor="middle" x="502" y="-232.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.sender.try_send</text>
<polyline fill="none" stroke="#1c2123" points="416,-224.5 588,-224.5 "/>
<text text-anchor="start" x="424" y="-209.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">mailbox自己的sender</text>
<text text-anchor="start" x="424" y="-194.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发消息给fsm的reciver</text>
<text text-anchor="start" x="424" y="-179.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> poller在handle_control时</text>
<text text-anchor="start" x="424" y="-164.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 会从该reciver中接收消息</text>
</g>
<!-- control_box&#45;&gt;sender_try_send -->
<g id="edge2" class="edge">
<title>control_box&#45;&gt;sender_try_send</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M296.58,-490.43C322.2,-488.43 354.07,-481.31 373,-460 434.95,-390.26 346.77,-327.89 401,-252 403.22,-248.9 405.69,-245.97 408.35,-243.22"/>
<polygon fill="green" stroke="green" points="410.84,-245.69 415.83,-236.34 406.1,-240.54 410.84,-245.69"/>
</g>
<!-- sender_try_send&#45;&gt;StoreFsm -->
<g id="edge3" class="edge">
<title>sender_try_send&#45;&gt;StoreFsm</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M588.03,-178.53C658.72,-158.98 761.95,-130.34 852,-105 865.1,-101.31 878.79,-97.44 892.42,-93.58"/>
<polygon fill="green" stroke="green" points="893.66,-96.86 902.32,-90.77 891.75,-90.13 893.66,-96.86"/>
</g>
<!-- mailbox_try_send -->
<g id="node5" class="node">
<title>mailbox_try_send</title>
<path fill="none" stroke="#1c2123" d="M150,-266.5C150,-266.5 361,-266.5 361,-266.5 367,-266.5 373,-272.5 373,-278.5 373,-278.5 373,-345.5 373,-345.5 373,-351.5 367,-357.5 361,-357.5 361,-357.5 150,-357.5 150,-357.5 144,-357.5 138,-351.5 138,-345.5 138,-345.5 138,-278.5 138,-278.5 138,-272.5 144,-266.5 150,-266.5"/>
<text text-anchor="middle" x="255.5" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">try_send</text>
<polyline fill="none" stroke="#1c2123" points="138,-334.5 373,-334.5 "/>
<text text-anchor="start" x="146" y="-319.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">发送消息给fsm的reciver</text>
<text text-anchor="start" x="146" y="-304.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 并且使用state notify</text>
<text text-anchor="start" x="146" y="-289.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送消息给BatchSystem.reciver</text>
<text text-anchor="start" x="146" y="-274.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 这样poller fetch_fsm 能够取到该fsm</text>
</g>
<!-- mailbox_try_send&#45;&gt;sender_try_send -->
<g id="edge4" class="edge">
<title>mailbox_try_send&#45;&gt;sender_try_send</title>
<path fill="none" stroke="#666666" d="M357.71,-266.46C373.86,-259.2 390.5,-251.71 406.49,-244.52"/>
<polygon fill="#666666" stroke="#666666" points="408.12,-247.62 415.81,-240.33 405.25,-241.24 408.12,-247.62"/>
</g>
<!-- notify -->
<g id="node6" class="node">
<title>notify</title>
<path fill="none" stroke="#1c2123" d="M421,-266.5C421,-266.5 583,-266.5 583,-266.5 589,-266.5 595,-272.5 595,-278.5 595,-278.5 595,-345.5 595,-345.5 595,-351.5 589,-357.5 583,-357.5 583,-357.5 421,-357.5 421,-357.5 415,-357.5 409,-351.5 409,-345.5 409,-345.5 409,-278.5 409,-278.5 409,-272.5 415,-266.5 421,-266.5"/>
<text text-anchor="middle" x="502" y="-342.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">notify</text>
<polyline fill="none" stroke="#1c2123" points="409,-334.5 595,-334.5 "/>
<text text-anchor="start" x="417" y="-319.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果为IDLE状态，</text>
<text text-anchor="start" x="417" y="-304.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 将状态改为NOTIFIED</text>
<text text-anchor="start" x="417" y="-289.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后使用传过来的scheduler</text>
<text text-anchor="start" x="417" y="-274.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发消息</text>
</g>
<!-- mailbox_try_send&#45;&gt;notify -->
<g id="edge5" class="edge">
<title>mailbox_try_send&#45;&gt;notify</title>
<path fill="none" stroke="#666666" d="M373.02,-312C381.59,-312 390.2,-312 398.67,-312"/>
<polygon fill="#666666" stroke="#666666" points="398.94,-315.5 408.94,-312 398.94,-308.5 398.94,-315.5"/>
</g>
<!-- notify&#45;&gt;set_mailbox -->
<g id="edge6" class="edge">
<title>notify&#45;&gt;set_mailbox</title>
<path fill="none" stroke="#666666" d="M589.98,-266.28C591.7,-264.88 593.37,-263.45 595,-262 646.27,-216.15 688.54,-147.63 712.13,-104.67"/>
<polygon fill="#666666" stroke="#666666" points="715.34,-106.1 717.02,-95.64 709.18,-102.77 715.34,-106.1"/>
</g>
<!-- take_fsm -->
<g id="node7" class="node">
<title>take_fsm</title>
<path fill="none" stroke="#1c2123" d="M755,-300C755,-300 712,-300 712,-300 706,-300 700,-294 700,-288 700,-288 700,-276 700,-276 700,-270 706,-264 712,-264 712,-264 755,-264 755,-264 761,-264 767,-270 767,-276 767,-276 767,-288 767,-288 767,-294 761,-300 755,-300"/>
<text text-anchor="middle" x="733.5" y="-278.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">take_fsm</text>
</g>
<!-- notify&#45;&gt;take_fsm -->
<g id="edge7" class="edge">
<title>notify&#45;&gt;take_fsm</title>
<path fill="none" stroke="#666666" d="M595.02,-299.97C627.72,-295.7 662.98,-291.09 689.61,-287.61"/>
<polygon fill="#666666" stroke="#666666" points="690.26,-291.05 699.73,-286.28 689.36,-284.11 690.26,-291.05"/>
</g>
<!-- scheduler_schedule -->
<g id="node8" class="node">
<title>scheduler_schedule</title>
<path fill="none" stroke="#1c2123" d="M643,-318.5C643,-318.5 824,-318.5 824,-318.5 830,-318.5 836,-324.5 836,-330.5 836,-330.5 836,-367.5 836,-367.5 836,-373.5 830,-379.5 824,-379.5 824,-379.5 643,-379.5 643,-379.5 637,-379.5 631,-373.5 631,-367.5 631,-367.5 631,-330.5 631,-330.5 631,-324.5 637,-318.5 643,-318.5"/>
<text text-anchor="middle" x="733.5" y="-364.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">scheduler.schdule</text>
<polyline fill="none" stroke="#1c2123" points="631,-356.5 836,-356.5 "/>
<text text-anchor="start" x="639" y="-341.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用FsmTypes包装fsm box指针</text>
<text text-anchor="start" x="639" y="-326.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发送消息给BatchSystem.reciver</text>
</g>
<!-- notify&#45;&gt;scheduler_schedule -->
<g id="edge8" class="edge">
<title>notify&#45;&gt;scheduler_schedule</title>
<path fill="none" stroke="#666666" d="M595.02,-326.84C603.45,-328.19 612.05,-329.58 620.62,-330.96"/>
<polygon fill="#666666" stroke="#666666" points="620.23,-334.45 630.66,-332.58 621.35,-327.53 620.23,-334.45"/>
</g>
<!-- BatchSystem -->
<g id="node11" class="node">
<title>BatchSystem</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M884,-473C884,-473 1145,-473 1145,-473 1151,-473 1157,-479 1157,-485 1157,-485 1157,-553 1157,-553 1157,-559 1151,-565 1145,-565 1145,-565 884,-565 884,-565 878,-565 872,-559 872,-553 872,-553 872,-485 872,-485 872,-479 878,-473 884,-473"/>
<text text-anchor="middle" x="1014.5" y="-549.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">BatchSystem</text>
<polyline fill="none" stroke="#60b5ac" points="872,-542 1157,-542 "/>
<text text-anchor="start" x="880" y="-526.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">router: BatchRouter&lt;N, C&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="872,-519 1157,-519 "/>
<text text-anchor="start" x="880" y="-503.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">receiver: channel::Receiver&lt;FsmTypes&lt;N, C&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="872,-496 1157,-496 "/>
<text text-anchor="middle" x="1014.5" y="-480.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">...</text>
</g>
<!-- scheduler_schedule&#45;&gt;BatchSystem -->
<g id="edge13" class="edge">
<title>scheduler_schedule&#45;&gt;BatchSystem:reciever</title>
<path fill="none" stroke="#666666" d="M761.17,-379.51C785.24,-405.48 822.96,-442.47 863.14,-467.67"/>
<polygon fill="#666666" stroke="#666666" points="861.37,-470.69 871.75,-472.85 864.99,-464.69 861.37,-470.69"/>
</g>
<!-- control_scheduler -->
<g id="node9" class="node">
<title>control_scheduler</title>
<path fill="none" stroke="#1c2123" d="M546.5,-526C546.5,-526 457.5,-526 457.5,-526 451.5,-526 445.5,-520 445.5,-514 445.5,-514 445.5,-502 445.5,-502 445.5,-496 451.5,-490 457.5,-490 457.5,-490 546.5,-490 546.5,-490 552.5,-490 558.5,-496 558.5,-502 558.5,-502 558.5,-514 558.5,-514 558.5,-520 552.5,-526 546.5,-526"/>
<text text-anchor="middle" x="502" y="-504.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">control_scheduler</text>
</g>
<!-- control_scheduler&#45;&gt;scheduler_schedule -->
<g id="edge9" class="edge">
<title>control_scheduler&#45;&gt;scheduler_schedule</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M529.33,-489.76C565.98,-464.37 633.17,-417.81 680.22,-385.22"/>
<polygon fill="green" stroke="green" points="682.24,-388.08 688.46,-379.51 678.25,-382.33 682.24,-388.08"/>
</g>
<!-- send_control -->
<g id="node10" class="node">
<title>send_control</title>
<path fill="none" stroke="#1c2123" d="M90,-508C90,-508 28,-508 28,-508 22,-508 16,-502 16,-496 16,-496 16,-484 16,-484 16,-478 22,-472 28,-472 28,-472 90,-472 90,-472 96,-472 102,-478 102,-484 102,-484 102,-496 102,-496 102,-502 96,-508 90,-508"/>
<text text-anchor="middle" x="59" y="-486.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">send_control</text>
</g>
<!-- send_control&#45;&gt;control_box -->
<g id="edge10" class="edge">
<title>send_control&#45;&gt;control_box</title>
<path fill="none" stroke="#666666" d="M102.2,-490C132.12,-490 172.39,-490 204.01,-490"/>
<polygon fill="#666666" stroke="#666666" points="204.37,-493.5 214.37,-490 204.37,-486.5 204.37,-493.5"/>
</g>
<!-- send_control&#45;&gt;mailbox_try_send -->
<g id="edge11" class="edge">
<title>send_control&#45;&gt;mailbox_try_send</title>
<path fill="none" stroke="#666666" d="M79.72,-471.95C106.97,-447.01 157.28,-400.98 196.94,-364.67"/>
<polygon fill="#666666" stroke="#666666" points="199.71,-366.88 204.73,-357.55 194.99,-361.72 199.71,-366.88"/>
</g>
<!-- send_control&#45;&gt;control_scheduler -->
<g id="edge12" class="edge">
<title>send_control&#45;&gt;control_scheduler</title>
<path fill="none" stroke="#666666" d="M99.24,-508.03C109.08,-511.74 119.76,-515.09 130,-517 235.41,-536.62 360.56,-526.93 435.23,-517.74"/>
<polygon fill="#666666" stroke="#666666" points="435.95,-521.18 445.43,-516.45 435.07,-514.24 435.95,-521.18"/>
</g>
</g>
</svg>
