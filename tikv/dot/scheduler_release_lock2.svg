<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: release_lock Pages: 1 -->
<svg width="1943pt" height="289pt"
 viewBox="0.00 0.00 1943.00 288.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 284.76)">
<title>release_lock</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-284.76 1939,-284.76 1939,4 -4,4"/>
<!-- release_lock -->
<g id="node1" class="node">
<title>release_lock</title>
<path fill="none" stroke="#1c2123" d="M12,-15.26C12,-15.26 148,-15.26 148,-15.26 154,-15.26 160,-21.26 160,-27.26 160,-27.26 160,-64.26 160,-64.26 160,-70.26 154,-76.26 148,-76.26 148,-76.26 12,-76.26 12,-76.26 6,-76.26 0,-70.26 0,-64.26 0,-64.26 0,-27.26 0,-27.26 0,-21.26 6,-15.26 12,-15.26"/>
<text text-anchor="middle" x="80" y="-61.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">Scheduler::release_lock</text>
<polyline fill="none" stroke="#1c2123" points="0,-53.26 160,-53.26 "/>
<text text-anchor="start" x="8" y="-38.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">释放掉cid 拥有的latches</text>
<text text-anchor="start" x="8" y="-23.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 唤醒等待的task</text>
</g>
<!-- Latches_release -->
<g id="node2" class="node">
<title>Latches_release</title>
<path fill="none" stroke="#1c2123" d="M208,-77.26C208,-77.26 412,-77.26 412,-77.26 418,-77.26 424,-83.26 424,-89.26 424,-89.26 424,-164.26 424,-164.26 424,-170.26 418,-176.26 412,-176.26 412,-176.26 208,-176.26 208,-176.26 202,-176.26 196,-170.26 196,-164.26 196,-164.26 196,-89.26 196,-89.26 196,-83.26 202,-77.26 208,-77.26"/>
<text text-anchor="middle" x="310" y="-161.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latches::release</text>
<polyline fill="none" stroke="#1c2123" points="196,-153.26 424,-153.26 "/>
<text text-anchor="start" x="204" y="-138.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">releases all alatches owned by the lock</text>
<text text-anchor="start" x="204" y="-123.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> of command with ID `who`,</text>
<text text-anchor="start" x="204" y="-108.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> return the wakeup list</text>
<polyline fill="none" stroke="#1c2123" points="196,-100.26 424,-100.26 "/>
<text text-anchor="start" x="204" y="-85.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历cid owned的required_hashes</text>
</g>
<!-- release_lock&#45;&gt;Latches_release -->
<g id="edge1" class="edge">
<title>release_lock&#45;&gt;Latches_release</title>
<path fill="none" stroke="#666666" d="M160.1,-73.87C168.6,-76.89 177.39,-80.01 186.25,-83.15"/>
<polygon fill="#666666" stroke="#666666" points="185.28,-86.53 195.88,-86.58 187.63,-79.93 185.28,-86.53"/>
</g>
<!-- try_to_wake_up -->
<g id="node3" class="node">
<title>try_to_wake_up</title>
<path fill="none" stroke="#1c2123" d="M739,-52.76C739,-52.76 881,-52.76 881,-52.76 887,-52.76 893,-58.76 893,-64.76 893,-64.76 893,-116.76 893,-116.76 893,-122.76 887,-128.76 881,-128.76 881,-128.76 739,-128.76 739,-128.76 733,-128.76 727,-122.76 727,-116.76 727,-116.76 727,-64.76 727,-64.76 727,-58.76 733,-52.76 739,-52.76"/>
<text text-anchor="middle" x="810" y="-113.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">Scheduler::try_to_wake_up</text>
<polyline fill="none" stroke="#1c2123" points="727,-105.76 893,-105.76 "/>
<text text-anchor="start" x="735" y="-90.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历wakeup list</text>
<text text-anchor="start" x="735" y="-75.56" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 对于每个wid 调用</text>
<text text-anchor="start" x="735" y="-60.56" font-family="Times,serif" font-size="14.00" fill="#2f3638"> try_to_wake_up</text>
</g>
<!-- release_lock&#45;&gt;try_to_wake_up -->
<g id="edge2" class="edge">
<title>release_lock&#45;&gt;try_to_wake_up</title>
<path fill="none" stroke="#666666" d="M160.05,-29.23C277.86,-7.69 505.51,21.94 691,-25.76 709.25,-30.46 727.7,-38.64 744.42,-47.64"/>
<polygon fill="#666666" stroke="#666666" points="743.08,-50.9 753.52,-52.71 746.49,-44.79 743.08,-50.9"/>
</g>
<!-- Latch_pop_front -->
<g id="node6" class="node">
<title>Latch_pop_front</title>
<path fill="none" stroke="#1c2123" d="M472,-219.26C472,-219.26 679,-219.26 679,-219.26 685,-219.26 691,-225.26 691,-231.26 691,-231.26 691,-268.26 691,-268.26 691,-274.26 685,-280.26 679,-280.26 679,-280.26 472,-280.26 472,-280.26 466,-280.26 460,-274.26 460,-268.26 460,-268.26 460,-231.26 460,-231.26 460,-225.26 466,-219.26 472,-219.26"/>
<text text-anchor="middle" x="575.5" y="-265.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latch::pop_front</text>
<polyline fill="none" stroke="#1c2123" points="460,-257.26 691,-257.26 "/>
<text text-anchor="start" x="468" y="-242.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">remove the first cid in the queue</text>
<text text-anchor="start" x="468" y="-227.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> whose hash value is equal to hash_key</text>
</g>
<!-- Latches_release&#45;&gt;Latch_pop_front -->
<g id="edge5" class="edge">
<title>Latches_release&#45;&gt;Latch_pop_front</title>
<path fill="none" stroke="#666666" d="M394.02,-176.32C415.17,-188.02 438.12,-199.94 460,-209.76 464.16,-211.63 468.44,-213.47 472.79,-215.28"/>
<polygon fill="#666666" stroke="#666666" points="471.81,-218.66 482.39,-219.16 474.43,-212.17 471.81,-218.66"/>
</g>
<!-- Latch_get_first_req_by_hash -->
<g id="node7" class="node">
<title>Latch_get_first_req_by_hash</title>
<path fill="none" stroke="#1c2123" d="M500,-139.26C500,-139.26 651,-139.26 651,-139.26 657,-139.26 663,-145.26 663,-151.26 663,-151.26 663,-188.26 663,-188.26 663,-194.26 657,-200.26 651,-200.26 651,-200.26 500,-200.26 500,-200.26 494,-200.26 488,-194.26 488,-188.26 488,-188.26 488,-151.26 488,-151.26 488,-145.26 494,-139.26 500,-139.26"/>
<text text-anchor="middle" x="575.5" y="-185.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latch::get_first_req_by_hash</text>
<polyline fill="none" stroke="#1c2123" points="488,-177.26 663,-177.26 "/>
<text text-anchor="start" x="496" y="-162.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">将等待key hash的cid</text>
<text text-anchor="start" x="496" y="-147.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 加入到wakeuplist中</text>
</g>
<!-- Latches_release&#45;&gt;Latch_get_first_req_by_hash -->
<g id="edge6" class="edge">
<title>Latches_release&#45;&gt;Latch_get_first_req_by_hash</title>
<path fill="none" stroke="#666666" d="M424.28,-145.25C442.12,-148.16 460.42,-151.15 477.84,-153.99"/>
<polygon fill="#666666" stroke="#666666" points="477.55,-157.49 487.98,-155.64 478.68,-150.58 477.55,-157.49"/>
</g>
<!-- Latches_lock_latch -->
<g id="node8" class="node">
<title>Latches_lock_latch</title>
<path fill="none" stroke="#1c2123" d="M489.5,-35.76C489.5,-35.76 661.5,-35.76 661.5,-35.76 667.5,-35.76 673.5,-41.76 673.5,-47.76 673.5,-47.76 673.5,-107.76 673.5,-107.76 673.5,-113.76 667.5,-119.76 661.5,-119.76 661.5,-119.76 489.5,-119.76 489.5,-119.76 483.5,-119.76 477.5,-113.76 477.5,-107.76 477.5,-107.76 477.5,-47.76 477.5,-47.76 477.5,-41.76 483.5,-35.76 489.5,-35.76"/>
<text text-anchor="middle" x="575.5" y="-104.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latches::lock_latch</text>
<polyline fill="none" stroke="#1c2123" points="477.5,-96.76 673.5,-96.76 "/>
<text text-anchor="start" x="485.5" y="-81.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.slots[(hash as usize)</text>
<text text-anchor="start" x="485.5" y="-66.56" font-family="Times,serif" font-size="14.00" fill="#2f3638"> &amp; (self.size &#45; 1)].lock()</text>
<polyline fill="none" stroke="#1c2123" points="477.5,-58.76 673.5,-58.76 "/>
<text text-anchor="middle" x="575.5" y="-43.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取对Latch操作的Mutex lock</text>
</g>
<!-- Latches_release&#45;&gt;Latches_lock_latch -->
<g id="edge7" class="edge">
<title>Latches_release&#45;&gt;Latches_lock_latch</title>
<path fill="none" stroke="#666666" d="M424.28,-105.7C438.53,-103.05 453.08,-100.34 467.24,-97.71"/>
<polygon fill="#666666" stroke="#666666" points="468.28,-101.08 477.47,-95.81 467,-94.19 468.28,-101.08"/>
</g>
<!-- SchedulerInner_acquire_lock -->
<g id="node4" class="node">
<title>SchedulerInner_acquire_lock</title>
<path fill="none" stroke="#1c2123" d="M941,-139.76C941,-139.76 1093,-139.76 1093,-139.76 1099,-139.76 1105,-145.76 1105,-151.76 1105,-151.76 1105,-173.76 1105,-173.76 1105,-179.76 1099,-185.76 1093,-185.76 1093,-185.76 941,-185.76 941,-185.76 935,-185.76 929,-179.76 929,-173.76 929,-173.76 929,-151.76 929,-151.76 929,-145.76 935,-139.76 941,-139.76"/>
<text text-anchor="middle" x="1017" y="-170.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">SchedulerInner::acquire_lock</text>
<polyline fill="none" stroke="#1c2123" points="929,-162.76 1105,-162.76 "/>
<text text-anchor="start" x="937" y="-147.56" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取cid要的latches</text>
</g>
<!-- try_to_wake_up&#45;&gt;SchedulerInner_acquire_lock -->
<g id="edge3" class="edge">
<title>try_to_wake_up&#45;&gt;SchedulerInner_acquire_lock</title>
<path fill="none" stroke="#666666" d="M893.2,-119.63C908.97,-125.17 925.42,-130.95 940.95,-136.4"/>
<polygon fill="#666666" stroke="#666666" points="939.9,-139.74 950.49,-139.76 942.22,-133.14 939.9,-139.74"/>
</g>
<!-- execute -->
<g id="node5" class="node">
<title>execute</title>
<path fill="none" stroke="#1c2123" d="M1774,-60.26C1774,-60.26 1923,-60.26 1923,-60.26 1929,-60.26 1935,-66.26 1935,-72.26 1935,-72.26 1935,-109.26 1935,-109.26 1935,-115.26 1929,-121.26 1923,-121.26 1923,-121.26 1774,-121.26 1774,-121.26 1768,-121.26 1762,-115.26 1762,-109.26 1762,-109.26 1762,-72.26 1762,-72.26 1762,-66.26 1768,-60.26 1774,-60.26"/>
<text text-anchor="middle" x="1848.5" y="-106.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">Scheduler::execute</text>
<polyline fill="none" stroke="#1c2123" points="1762,-98.26 1935,-98.26 "/>
<text text-anchor="start" x="1770" y="-83.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取cid key的所有latchs后</text>
<text text-anchor="start" x="1770" y="-68.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 执行cid 的task</text>
</g>
<!-- try_to_wake_up&#45;&gt;execute -->
<g id="edge4" class="edge">
<title>try_to_wake_up&#45;&gt;execute</title>
<path fill="none" stroke="#666666" d="M893.38,-81.98C980.69,-73.45 1122.65,-61.76 1245.5,-61.76 1245.5,-61.76 1245.5,-61.76 1487.5,-61.76 1577.33,-61.76 1679.36,-70.85 1751.8,-78.84"/>
<polygon fill="#666666" stroke="#666666" points="1751.5,-82.33 1761.83,-79.96 1752.28,-75.38 1751.5,-82.33"/>
</g>
<!-- Latches_acquire -->
<g id="node10" class="node">
<title>Latches_acquire</title>
<path fill="none" stroke="#1c2123" d="M1714,-138.76C1714,-138.76 1633,-138.76 1633,-138.76 1627,-138.76 1621,-132.76 1621,-126.76 1621,-126.76 1621,-114.76 1621,-114.76 1621,-108.76 1627,-102.76 1633,-102.76 1633,-102.76 1714,-102.76 1714,-102.76 1720,-102.76 1726,-108.76 1726,-114.76 1726,-114.76 1726,-126.76 1726,-126.76 1726,-132.76 1720,-138.76 1714,-138.76"/>
<text text-anchor="middle" x="1673.5" y="-117.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">Latches_acquire</text>
</g>
<!-- SchedulerInner_acquire_lock&#45;&gt;Latches_acquire -->
<g id="edge11" class="edge">
<title>SchedulerInner_acquire_lock&#45;&gt;Latches_acquire</title>
<path fill="none" stroke="#666666" d="M1041.45,-185.89C1064.56,-206.91 1101.98,-236.48 1141,-248.76 1230.45,-276.93 1259.75,-265.6 1352,-248.76 1457.18,-229.56 1571.46,-174.93 1631.05,-143.6"/>
<polygon fill="#666666" stroke="#666666" points="1632.94,-146.56 1640.13,-138.78 1629.65,-140.37 1632.94,-146.56"/>
</g>
<!-- get_task_slot -->
<g id="node11" class="node">
<title>get_task_slot</title>
<path fill="none" stroke="#1c2123" d="M1153,-170.26C1153,-170.26 1340,-170.26 1340,-170.26 1346,-170.26 1352,-176.26 1352,-182.26 1352,-182.26 1352,-227.26 1352,-227.26 1352,-233.26 1346,-239.26 1340,-239.26 1340,-239.26 1153,-239.26 1153,-239.26 1147,-239.26 1141,-233.26 1141,-227.26 1141,-227.26 1141,-182.26 1141,-182.26 1141,-176.26 1147,-170.26 1153,-170.26"/>
<text text-anchor="middle" x="1246.5" y="-224.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_task_slot</text>
<polyline fill="none" stroke="#1c2123" points="1141,-216.26 1352,-216.26 "/>
<text text-anchor="start" x="1149" y="-201.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.task_slots[id_index(cid)].lock()</text>
<polyline fill="none" stroke="#1c2123" points="1141,-193.26 1352,-193.26 "/>
<text text-anchor="start" x="1149" y="-178.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">获取cid对应的task_slots</text>
</g>
<!-- SchedulerInner_acquire_lock&#45;&gt;get_task_slot -->
<g id="edge12" class="edge">
<title>SchedulerInner_acquire_lock&#45;&gt;get_task_slot</title>
<path fill="none" stroke="#666666" d="M1105.31,-178.88C1113.68,-180.43 1122.26,-182.01 1130.85,-183.6"/>
<polygon fill="#666666" stroke="#666666" points="1130.45,-187.08 1140.92,-185.46 1131.72,-180.2 1130.45,-187.08"/>
</g>
<!-- task_slot_get_mut -->
<g id="node12" class="node">
<title>task_slot_get_mut</title>
<path fill="none" stroke="#1c2123" d="M1197.5,-90.26C1197.5,-90.26 1295.5,-90.26 1295.5,-90.26 1301.5,-90.26 1307.5,-96.26 1307.5,-102.26 1307.5,-102.26 1307.5,-139.26 1307.5,-139.26 1307.5,-145.26 1301.5,-151.26 1295.5,-151.26 1295.5,-151.26 1197.5,-151.26 1197.5,-151.26 1191.5,-151.26 1185.5,-145.26 1185.5,-139.26 1185.5,-139.26 1185.5,-102.26 1185.5,-102.26 1185.5,-96.26 1191.5,-90.26 1197.5,-90.26"/>
<text text-anchor="middle" x="1246.5" y="-136.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">task_slot.get_mut</text>
<polyline fill="none" stroke="#1c2123" points="1185.5,-128.26 1307.5,-128.26 "/>
<text text-anchor="start" x="1193.5" y="-113.06" font-family="Times,serif" font-size="14.00" fill="#2f3638">从task_slot中获取</text>
<text text-anchor="start" x="1193.5" y="-98.06" font-family="Times,serif" font-size="14.00" fill="#2f3638"> cid对应的Task</text>
</g>
<!-- SchedulerInner_acquire_lock&#45;&gt;task_slot_get_mut -->
<g id="edge13" class="edge">
<title>SchedulerInner_acquire_lock&#45;&gt;task_slot_get_mut</title>
<path fill="none" stroke="#666666" d="M1105.31,-146.65C1128.45,-142.37 1153.14,-137.81 1175.25,-133.73"/>
<polygon fill="#666666" stroke="#666666" points="1176.02,-137.15 1185.22,-131.89 1174.75,-130.27 1176.02,-137.15"/>
</g>
<!-- waitting -->
<g id="node9" class="node">
<title>waitting</title>
<path fill="#feed9b" stroke="#f7e495" d="M791.5,-191.76C791.5,-191.76 828.5,-191.76 828.5,-191.76 834.5,-191.76 840.5,-197.76 840.5,-203.76 840.5,-203.76 840.5,-215.76 840.5,-215.76 840.5,-221.76 834.5,-227.76 828.5,-227.76 828.5,-227.76 791.5,-227.76 791.5,-227.76 785.5,-227.76 779.5,-221.76 779.5,-215.76 779.5,-215.76 779.5,-203.76 779.5,-203.76 779.5,-197.76 785.5,-191.76 791.5,-191.76"/>
<text text-anchor="middle" x="810" y="-206.06" font-family="Times,serif" font-size="14.00" fill="#40575d">waitting</text>
</g>
<!-- Latch_pop_front&#45;&gt;waitting -->
<g id="edge8" class="edge">
<title>Latch_pop_front&#45;&gt;waitting</title>
<path fill="none" stroke="#666666" d="M691.05,-230.06C719.02,-225.24 747.13,-220.41 768.89,-216.66"/>
<polygon fill="#666666" stroke="#666666" points="769.77,-220.06 779.03,-214.92 768.58,-213.17 769.77,-220.06"/>
</g>
<!-- Latch_get_first_req_by_hash&#45;&gt;try_to_wake_up -->
<g id="edge10" class="edge">
<title>Latch_get_first_req_by_hash&#45;&gt;try_to_wake_up</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M663.07,-140.35C680.72,-134.35 699.35,-128.02 717.17,-121.97"/>
<polygon fill="green" stroke="green" points="718.64,-125.16 726.98,-118.63 716.38,-118.54 718.64,-125.16"/>
</g>
<!-- Latch_get_first_req_by_hash&#45;&gt;waitting -->
<g id="edge9" class="edge">
<title>Latch_get_first_req_by_hash&#45;&gt;waitting</title>
<path fill="none" stroke="#666666" d="M663.07,-184.66C699.53,-190.93 740.15,-197.92 769.26,-202.93"/>
<polygon fill="#666666" stroke="#666666" points="768.98,-206.43 779.43,-204.68 770.17,-199.53 768.98,-206.43"/>
</g>
<!-- Latches_acquire&#45;&gt;execute -->
<g id="edge16" class="edge">
<title>Latches_acquire&#45;&gt;execute</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1726.41,-111.76C1734.58,-110.35 1743.24,-108.84 1752.03,-107.32"/>
<polygon fill="green" stroke="green" points="1752.73,-110.75 1761.99,-105.59 1751.54,-103.85 1752.73,-110.75"/>
</g>
<!-- Lock -->
<g id="node13" class="node">
<title>Lock</title>
<path fill="#feed9b" stroke="#f7e495" d="M1400,-90.26C1400,-90.26 1573,-90.26 1573,-90.26 1579,-90.26 1585,-96.26 1585,-102.26 1585,-102.26 1585,-139.26 1585,-139.26 1585,-145.26 1579,-151.26 1573,-151.26 1573,-151.26 1400,-151.26 1400,-151.26 1394,-151.26 1388,-145.26 1388,-139.26 1388,-139.26 1388,-102.26 1388,-102.26 1388,-96.26 1394,-90.26 1400,-90.26"/>
<text text-anchor="middle" x="1486.5" y="-136.06" font-family="Times,serif" font-size="14.00" fill="#40575d">Lock</text>
<polyline fill="none" stroke="#f7e495" points="1388,-128.26 1585,-128.26 "/>
<text text-anchor="start" x="1396" y="-113.06" font-family="Times,serif" font-size="14.00" fill="#40575d">pub required_hashes: Vec&lt;u64&gt;,</text>
<text text-anchor="start" x="1396" y="-98.06" font-family="Times,serif" font-size="14.00" fill="#40575d"> pub owned_count: usize,</text>
</g>
<!-- task_slot_get_mut&#45;&gt;Lock -->
<g id="edge14" class="edge">
<title>task_slot_get_mut&#45;&gt;Lock</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1307.56,-120.76C1328.88,-120.76 1353.59,-120.76 1377.68,-120.76"/>
<polygon fill="green" stroke="green" points="1377.96,-124.26 1387.96,-120.76 1377.96,-117.26 1377.96,-124.26"/>
</g>
<!-- Lock&#45;&gt;Latches_acquire -->
<g id="edge15" class="edge">
<title>Lock&#45;&gt;Latches_acquire</title>
<path fill="none" stroke="#666666" d="M1585.15,-120.76C1593.82,-120.76 1602.43,-120.76 1610.68,-120.76"/>
<polygon fill="#666666" stroke="#666666" points="1610.9,-124.26 1620.9,-120.76 1610.9,-117.26 1610.9,-124.26"/>
</g>
</g>
</svg>
