<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: actionPessimisticLock_handleSingleBatch Pages: 1 -->
<svg width="1533pt" height="1040pt"
 viewBox="0.00 0.00 1533.00 1040.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1036.4)">
<title>actionPessimisticLock_handleSingleBatch</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1036.4 1529,-1036.4 1529,4 -4,4"/>
<g id="clust2" class="cluster">
<title>cluster_ForLoop</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M195,-398.4C195,-398.4 1505,-398.4 1505,-398.4 1511,-398.4 1517,-404.4 1517,-410.4 1517,-410.4 1517,-820.4 1517,-820.4 1517,-826.4 1511,-832.4 1505,-832.4 1505,-832.4 195,-832.4 195,-832.4 189,-832.4 183,-826.4 183,-820.4 183,-820.4 183,-410.4 183,-410.4 183,-404.4 189,-398.4 195,-398.4"/>
<text text-anchor="middle" x="850" y="-812.4" font-family="Times,serif" font-size="20.00">ForLoop</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_actionPessimisticLock</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-840.4C20,-840.4 334,-840.4 334,-840.4 340,-840.4 346,-846.4 346,-852.4 346,-852.4 346,-922.4 346,-922.4 346,-928.4 340,-934.4 334,-934.4 334,-934.4 20,-934.4 20,-934.4 14,-934.4 8,-928.4 8,-922.4 8,-922.4 8,-852.4 8,-852.4 8,-846.4 14,-840.4 20,-840.4"/>
<text text-anchor="middle" x="177" y="-914.4" font-family="Times,serif" font-size="20.00">actionPessimisticLock</text>
</g>
<!-- handleSingleBatch -->
<g id="node1" class="node">
<title>handleSingleBatch</title>
<path fill="none" stroke="#1c2123" d="M112.5,-255.4C112.5,-255.4 17.5,-255.4 17.5,-255.4 11.5,-255.4 5.5,-249.4 5.5,-243.4 5.5,-243.4 5.5,-231.4 5.5,-231.4 5.5,-225.4 11.5,-219.4 17.5,-219.4 17.5,-219.4 112.5,-219.4 112.5,-219.4 118.5,-219.4 124.5,-225.4 124.5,-231.4 124.5,-231.4 124.5,-243.4 124.5,-243.4 124.5,-249.4 118.5,-255.4 112.5,-255.4"/>
<text text-anchor="middle" x="65" y="-233.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">handleSingleBatch</text>
</g>
<!-- HasPresumeKeyNotExists -->
<g id="node2" class="node">
<title>HasPresumeKeyNotExists</title>
<path fill="none" stroke="#1c2123" d="M320,-390.4C320,-390.4 183,-390.4 183,-390.4 177,-390.4 171,-384.4 171,-378.4 171,-378.4 171,-366.4 171,-366.4 171,-360.4 177,-354.4 183,-354.4 183,-354.4 320,-354.4 320,-354.4 326,-354.4 332,-360.4 332,-366.4 332,-366.4 332,-378.4 332,-378.4 332,-384.4 326,-390.4 320,-390.4"/>
<text text-anchor="middle" x="251.5" y="-368.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">HasPresumeKeyNotExists</text>
</g>
<!-- handleSingleBatch&#45;&gt;HasPresumeKeyNotExists -->
<g id="edge1" class="edge">
<title>handleSingleBatch&#45;&gt;HasPresumeKeyNotExists</title>
<path fill="none" stroke="#666666" d="M79.17,-255.43C96.54,-278.08 129.15,-316.83 165,-340.4 170.3,-343.89 176.04,-347.07 181.94,-349.95"/>
<polygon fill="#666666" stroke="#666666" points="180.76,-353.26 191.31,-354.24 183.67,-346.89 180.76,-353.26"/>
</g>
<!-- PessimisticLockRequest -->
<g id="node3" class="node">
<title>PessimisticLockRequest</title>
<path fill="none" stroke="#1c2123" d="M187,-236.9C187,-236.9 316,-236.9 316,-236.9 322,-236.9 328,-242.9 328,-248.9 328,-248.9 328,-285.9 328,-285.9 328,-291.9 322,-297.9 316,-297.9 316,-297.9 187,-297.9 187,-297.9 181,-297.9 175,-291.9 175,-285.9 175,-285.9 175,-248.9 175,-248.9 175,-242.9 181,-236.9 187,-236.9"/>
<text text-anchor="middle" x="251.5" y="-282.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">PessimisticLockRequest</text>
<polyline fill="none" stroke="#1c2123" points="175,-274.9 328,-274.9 "/>
<text text-anchor="start" x="183" y="-259.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">构造发送给TIKV的</text>
<text text-anchor="start" x="183" y="-244.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> PessimisticLockRequest</text>
</g>
<!-- handleSingleBatch&#45;&gt;PessimisticLockRequest -->
<g id="edge2" class="edge">
<title>handleSingleBatch&#45;&gt;PessimisticLockRequest</title>
<path fill="none" stroke="#666666" d="M124.63,-246.94C137.45,-249.02 151.28,-251.27 164.91,-253.49"/>
<polygon fill="#666666" stroke="#666666" points="164.35,-256.94 174.78,-255.09 165.47,-250.03 164.35,-256.94"/>
</g>
<!-- SendReq -->
<g id="node4" class="node">
<title>SendReq</title>
<path fill="none" stroke="#1c2123" d="M386,-458.4C386,-458.4 481,-458.4 481,-458.4 487,-458.4 493,-464.4 493,-470.4 493,-470.4 493,-492.4 493,-492.4 493,-498.4 487,-504.4 481,-504.4 481,-504.4 386,-504.4 386,-504.4 380,-504.4 374,-498.4 374,-492.4 374,-492.4 374,-470.4 374,-470.4 374,-464.4 380,-458.4 386,-458.4"/>
<text text-anchor="middle" x="433.5" y="-489.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">SendReq</text>
<polyline fill="none" stroke="#1c2123" points="374,-481.4 493,-481.4 "/>
<text text-anchor="start" x="382" y="-466.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">发送请求给TiKV</text>
</g>
<!-- handleSingleBatch&#45;&gt;SendReq -->
<g id="edge3" class="edge">
<title>handleSingleBatch&#45;&gt;SendReq</title>
<path fill="none" stroke="#666666" d="M86.1,-255.4C105.11,-271.45 135.09,-294.36 165,-307.4 240.35,-340.26 278.42,-298.61 346,-345.4 382.64,-370.77 407.17,-417.21 420.48,-448.69"/>
<polygon fill="#666666" stroke="#666666" points="417.39,-450.39 424.4,-458.34 423.87,-447.76 417.39,-450.39"/>
</g>
<!-- regionErr -->
<g id="node5" class="node">
<title>regionErr</title>
<path fill="none" stroke="#1c2123" d="M541,-677.4C541,-677.4 710,-677.4 710,-677.4 716,-677.4 722,-683.4 722,-689.4 722,-689.4 722,-741.4 722,-741.4 722,-747.4 716,-753.4 710,-753.4 710,-753.4 541,-753.4 541,-753.4 535,-753.4 529,-747.4 529,-741.4 529,-741.4 529,-689.4 529,-689.4 529,-683.4 535,-677.4 541,-677.4"/>
<text text-anchor="middle" x="625.5" y="-738.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">regionErr</text>
<polyline fill="none" stroke="#1c2123" points="529,-730.4 722,-730.4 "/>
<text text-anchor="start" x="537" y="-715.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">遇到了regionErr 需要重试</text>
<text text-anchor="start" x="537" y="-700.2" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用pessimisticLockMutations</text>
<text text-anchor="start" x="537" y="-685.2" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 并退出forLoop</text>
</g>
<!-- handleSingleBatch&#45;&gt;regionErr -->
<g id="edge4" class="edge">
<title>handleSingleBatch&#45;&gt;regionErr</title>
<path fill="none" stroke="#666666" d="M123.18,-219.34C182.61,-204.07 276.47,-190.06 346,-227.4 450.25,-283.41 449.78,-339.24 493,-449.4 529.03,-541.23 470.24,-589.18 529,-668.4 529.29,-668.79 529.58,-669.18 529.88,-669.56"/>
<polygon fill="#666666" stroke="#666666" points="527.4,-672.04 536.67,-677.18 532.63,-667.39 527.4,-672.04"/>
</g>
<!-- pessimisticLockMutations -->
<g id="node6" class="node">
<title>pessimisticLockMutations</title>
<path fill="none" stroke="#1c2123" d="M907,-622.4C907,-622.4 770,-622.4 770,-622.4 764,-622.4 758,-616.4 758,-610.4 758,-610.4 758,-598.4 758,-598.4 758,-592.4 764,-586.4 770,-586.4 770,-586.4 907,-586.4 907,-586.4 913,-586.4 919,-592.4 919,-598.4 919,-598.4 919,-610.4 919,-610.4 919,-616.4 913,-622.4 907,-622.4"/>
<text text-anchor="middle" x="838.5" y="-600.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">pessimisticLockMutations</text>
</g>
<!-- handleSingleBatch&#45;&gt;pessimisticLockMutations -->
<g id="edge5" class="edge">
<title>handleSingleBatch&#45;&gt;pessimisticLockMutations</title>
<path fill="none" stroke="#666666" d="M71.7,-219.15C83.19,-185.94 112.58,-116.51 165,-88.4 293.48,-19.52 362.8,-22.84 493,-88.4 645.67,-165.29 633.73,-251.02 722,-397.4 741.09,-429.07 740.44,-439.86 758,-472.4 778.11,-509.68 803.76,-551.34 820.4,-577.7"/>
<polygon fill="#666666" stroke="#666666" points="817.57,-579.78 825.88,-586.36 823.49,-576.04 817.57,-579.78"/>
</g>
<!-- extractKeyExistsErr -->
<g id="node7" class="node">
<title>extractKeyExistsErr</title>
<path fill="none" stroke="#1c2123" d="M569,-582.4C569,-582.4 682,-582.4 682,-582.4 688,-582.4 694,-588.4 694,-594.4 694,-594.4 694,-646.4 694,-646.4 694,-652.4 688,-658.4 682,-658.4 682,-658.4 569,-658.4 569,-658.4 563,-658.4 557,-652.4 557,-646.4 557,-646.4 557,-594.4 557,-594.4 557,-588.4 563,-582.4 569,-582.4"/>
<text text-anchor="middle" x="625.5" y="-643.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">extractKeyExistsErr</text>
<polyline fill="none" stroke="#1c2123" points="557,-635.4 694,-635.4 "/>
<text text-anchor="start" x="565" y="-620.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">检查key exists错误</text>
<text text-anchor="start" x="565" y="-605.2" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果有z退出forloop</text>
<text text-anchor="start" x="565" y="-590.2" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 返回ErrKeyExist</text>
</g>
<!-- handleSingleBatch&#45;&gt;extractKeyExistsErr -->
<g id="edge6" class="edge">
<title>handleSingleBatch&#45;&gt;extractKeyExistsErr</title>
<path fill="none" stroke="#666666" d="M98.33,-219.34C117.15,-209.87 141.7,-199.25 165,-194.4 236.36,-179.58 439.08,-145.36 493,-194.4 555.59,-251.33 480.95,-503.78 529,-573.4 534.05,-580.73 540.59,-586.96 547.86,-592.25"/>
<polygon fill="#666666" stroke="#666666" points="546.42,-595.49 556.7,-598.04 550.25,-589.63 546.42,-595.49"/>
</g>
<!-- ErrDeadlock -->
<g id="node8" class="node">
<title>ErrDeadlock</title>
<path fill="none" stroke="#1c2123" d="M555.5,-487.4C555.5,-487.4 695.5,-487.4 695.5,-487.4 701.5,-487.4 707.5,-493.4 707.5,-499.4 707.5,-499.4 707.5,-551.4 707.5,-551.4 707.5,-557.4 701.5,-563.4 695.5,-563.4 695.5,-563.4 555.5,-563.4 555.5,-563.4 549.5,-563.4 543.5,-557.4 543.5,-551.4 543.5,-551.4 543.5,-499.4 543.5,-499.4 543.5,-493.4 549.5,-487.4 555.5,-487.4"/>
<text text-anchor="middle" x="625.5" y="-548.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">ErrDeadlock</text>
<polyline fill="none" stroke="#1c2123" points="543.5,-540.4 707.5,-540.4 "/>
<text text-anchor="start" x="551.5" y="-525.2" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果有keyErr为deadLock</text>
<text text-anchor="start" x="551.5" y="-510.2" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 退出forLoop</text>
<text text-anchor="start" x="551.5" y="-495.2" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 返回ErrDeadLock</text>
</g>
<!-- handleSingleBatch&#45;&gt;ErrDeadlock -->
<g id="edge7" class="edge">
<title>handleSingleBatch&#45;&gt;ErrDeadlock</title>
<path fill="none" stroke="#666666" d="M80.91,-219.36C98.58,-199.54 130.07,-168.87 165,-156.4 233.65,-131.9 438.66,-107.82 493,-156.4 546.51,-204.25 487.98,-418.5 529,-477.4 531.02,-480.3 533.26,-483.03 535.68,-485.6"/>
<polygon fill="#666666" stroke="#666666" points="533.76,-488.59 543.46,-492.85 538.53,-483.47 533.76,-488.59"/>
</g>
<!-- extractLockFromKeyErr -->
<g id="node9" class="node">
<title>extractLockFromKeyErr</title>
<path fill="none" stroke="#1c2123" d="M562,-406.9C562,-406.9 689,-406.9 689,-406.9 695,-406.9 701,-412.9 701,-418.9 701,-418.9 701,-455.9 701,-455.9 701,-461.9 695,-467.9 689,-467.9 689,-467.9 562,-467.9 562,-467.9 556,-467.9 550,-461.9 550,-455.9 550,-455.9 550,-418.9 550,-418.9 550,-412.9 556,-406.9 562,-406.9"/>
<text text-anchor="middle" x="625.5" y="-452.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">extractLockFromKeyErr</text>
<polyline fill="none" stroke="#1c2123" points="550,-444.9 701,-444.9 "/>
<text text-anchor="start" x="558" y="-429.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">提取可以locked error</text>
<text text-anchor="start" x="558" y="-414.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 加入到locks中</text>
</g>
<!-- handleSingleBatch&#45;&gt;extractLockFromKeyErr -->
<g id="edge8" class="edge">
<title>handleSingleBatch&#45;&gt;extractLockFromKeyErr</title>
<path fill="none" stroke="#666666" d="M74.7,-218.99C89.02,-191.12 120.47,-139.28 165,-118.4 230.99,-87.46 432.43,-77.86 493,-118.4 587.22,-181.48 614,-325.68 621.56,-396.55"/>
<polygon fill="#666666" stroke="#666666" points="618.11,-397.26 622.58,-406.87 625.08,-396.57 618.11,-397.26"/>
</g>
<!-- ResolveLocks -->
<g id="node10" class="node">
<title>ResolveLocks</title>
<path fill="none" stroke="#1c2123" d="M967,-406.9C967,-406.9 1209,-406.9 1209,-406.9 1215,-406.9 1221,-412.9 1221,-418.9 1221,-418.9 1221,-485.9 1221,-485.9 1221,-491.9 1215,-497.9 1209,-497.9 1209,-497.9 967,-497.9 967,-497.9 961,-497.9 955,-491.9 955,-485.9 955,-485.9 955,-418.9 955,-418.9 955,-412.9 961,-406.9 967,-406.9"/>
<text text-anchor="middle" x="1088" y="-482.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">ResolveLocks</text>
<polyline fill="none" stroke="#1c2123" points="955,-474.9 1221,-474.9 "/>
<text text-anchor="start" x="963" y="-459.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">尝试resolve locks</text>
<text text-anchor="start" x="963" y="-444.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 1. 使用lock.TTL 处理expired locks</text>
<text text-anchor="start" x="963" y="-429.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2. 获取primary lock状态</text>
<text text-anchor="start" x="963" y="-414.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3.发送ResolveLock cmd to the lock&#39;s region</text>
</g>
<!-- handleSingleBatch&#45;&gt;ResolveLocks -->
<g id="edge9" class="edge">
<title>handleSingleBatch&#45;&gt;ResolveLocks</title>
<path fill="none" stroke="#666666" d="M68.67,-219.38C75.8,-178.34 99.44,-78.15 165,-34.4 264.07,31.7 313.4,-18.4 432.5,-18.4 432.5,-18.4 432.5,-18.4 626.5,-18.4 845.24,-18.4 1002.29,-280.94 1061.29,-397.63"/>
<polygon fill="#666666" stroke="#666666" points="1058.26,-399.4 1065.86,-406.78 1064.52,-396.27 1058.26,-399.4"/>
</g>
<!-- LockWaitTime -->
<g id="node11" class="node">
<title>LockWaitTime</title>
<path fill="none" stroke="#1c2123" d="M289.5,-794.4C289.5,-794.4 213.5,-794.4 213.5,-794.4 207.5,-794.4 201.5,-788.4 201.5,-782.4 201.5,-782.4 201.5,-770.4 201.5,-770.4 201.5,-764.4 207.5,-758.4 213.5,-758.4 213.5,-758.4 289.5,-758.4 289.5,-758.4 295.5,-758.4 301.5,-764.4 301.5,-770.4 301.5,-770.4 301.5,-782.4 301.5,-782.4 301.5,-788.4 295.5,-794.4 289.5,-794.4"/>
<text text-anchor="middle" x="251.5" y="-772.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">LockWaitTime</text>
</g>
<!-- handleSingleBatch&#45;&gt;LockWaitTime -->
<g id="edge10" class="edge">
<title>handleSingleBatch&#45;&gt;LockWaitTime</title>
<path fill="none" stroke="#666666" d="M67.07,-255.58C72.28,-337.73 97.46,-673.62 165,-749.4 172.14,-757.42 181.64,-763.07 191.71,-767.06"/>
<polygon fill="#666666" stroke="#666666" points="190.88,-770.48 201.48,-770.39 193.14,-763.85 190.88,-770.48"/>
</g>
<!-- lockWaitStartTime -->
<g id="node12" class="node">
<title>lockWaitStartTime</title>
<path fill="none" stroke="#1c2123" d="M300,-740.4C300,-740.4 203,-740.4 203,-740.4 197,-740.4 191,-734.4 191,-728.4 191,-728.4 191,-716.4 191,-716.4 191,-710.4 197,-704.4 203,-704.4 203,-704.4 300,-704.4 300,-704.4 306,-704.4 312,-710.4 312,-716.4 312,-716.4 312,-728.4 312,-728.4 312,-734.4 306,-740.4 300,-740.4"/>
<text text-anchor="middle" x="251.5" y="-718.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">lockWaitStartTime</text>
</g>
<!-- handleSingleBatch&#45;&gt;lockWaitStartTime -->
<g id="edge11" class="edge">
<title>handleSingleBatch&#45;&gt;lockWaitStartTime</title>
<path fill="none" stroke="#666666" d="M72.9,-255.53C100.9,-329.13 206.19,-605.94 239.99,-694.77"/>
<polygon fill="#666666" stroke="#666666" points="236.74,-696.08 243.57,-704.19 243.29,-693.59 236.74,-696.08"/>
</g>
<!-- Killed -->
<g id="node13" class="node">
<title>Killed</title>
<path fill="#feed9b" stroke="#f7e495" d="M177,-849.4C177,-849.4 326,-849.4 326,-849.4 332,-849.4 338,-855.4 338,-861.4 338,-861.4 338,-883.4 338,-883.4 338,-889.4 332,-895.4 326,-895.4 326,-895.4 177,-895.4 177,-895.4 171,-895.4 165,-889.4 165,-883.4 165,-883.4 165,-861.4 165,-861.4 165,-855.4 171,-849.4 177,-849.4"/>
<text text-anchor="middle" x="251.5" y="-880.2" font-family="Times,serif" font-size="14.00" fill="#40575d">Killed</text>
<polyline fill="none" stroke="#f7e495" points="165,-872.4 338,-872.4 "/>
<text text-anchor="middle" x="251.5" y="-857.2" font-family="Times,serif" font-size="14.00" fill="#40575d">如果被killed会退出forloop</text>
</g>
<!-- handleSingleBatch&#45;&gt;Killed -->
<g id="edge12" class="edge">
<title>handleSingleBatch&#45;&gt;Killed</title>
<path fill="none" stroke="#666666" d="M66.7,-255.7C70.46,-345.9 91.06,-742.69 165,-836.4 166.82,-838.72 168.82,-840.88 170.96,-842.91"/>
<polygon fill="#666666" stroke="#666666" points="168.78,-845.65 178.74,-849.29 173.23,-840.24 168.78,-845.65"/>
</g>
<!-- PessimisticLockRequest&#45;&gt;SendReq -->
<g id="edge16" class="edge">
<title>PessimisticLockRequest&#45;&gt;SendReq</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M327.92,-298.09C334.43,-302.36 340.58,-307.12 346,-312.4 385.46,-350.91 410.28,-411.25 422.75,-448.45"/>
<polygon fill="green" stroke="green" points="419.53,-449.86 425.94,-458.29 426.19,-447.7 419.53,-449.86"/>
</g>
<!-- SendReq&#45;&gt;regionErr -->
<g id="edge17" class="edge">
<title>SendReq&#45;&gt;regionErr</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M440.86,-504.41C452.51,-542.83 480.65,-620.56 529,-668.4 529.79,-669.18 530.59,-669.95 531.41,-670.71"/>
<polygon fill="green" stroke="green" points="529.24,-673.46 539.13,-677.25 533.76,-668.12 529.24,-673.46"/>
</g>
<!-- SendReq&#45;&gt;extractKeyExistsErr -->
<g id="edge18" class="edge">
<title>SendReq&#45;&gt;extractKeyExistsErr</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M454.54,-504.68C472.58,-524.66 500.57,-553.33 529,-573.4 534.97,-577.62 541.37,-581.65 547.93,-585.46"/>
<polygon fill="green" stroke="green" points="546.51,-588.67 556.95,-590.5 549.93,-582.57 546.51,-588.67"/>
</g>
<!-- SendReq&#45;&gt;ErrDeadlock -->
<g id="edge19" class="edge">
<title>SendReq&#45;&gt;ErrDeadlock</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M493.06,-494.96C505.87,-497.93 519.72,-501.14 533.46,-504.32"/>
<polygon fill="green" stroke="green" points="532.9,-507.78 543.43,-506.63 534.48,-500.96 532.9,-507.78"/>
</g>
<!-- SendReq&#45;&gt;extractLockFromKeyErr -->
<g id="edge20" class="edge">
<title>SendReq&#45;&gt;extractLockFromKeyErr</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M493.06,-467.84C507.87,-464.41 524.07,-460.66 539.88,-457"/>
<polygon fill="green" stroke="green" points="540.71,-460.4 549.66,-454.74 539.13,-453.58 540.71,-460.4"/>
</g>
<!-- regionErr&#45;&gt;pessimisticLockMutations -->
<g id="edge23" class="edge">
<title>regionErr&#45;&gt;pessimisticLockMutations</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M704.58,-677.37C710.49,-674.37 716.35,-671.36 722,-668.4 747.18,-655.24 775.04,-639.83 797.1,-627.42"/>
<polygon fill="green" stroke="green" points="798.87,-630.44 805.86,-622.48 795.43,-624.34 798.87,-630.44"/>
</g>
<!-- locks -->
<g id="node14" class="node">
<title>locks</title>
<path fill="#feed9b" stroke="#f7e495" d="M823.5,-426.4C823.5,-426.4 853.5,-426.4 853.5,-426.4 859.5,-426.4 865.5,-432.4 865.5,-438.4 865.5,-438.4 865.5,-450.4 865.5,-450.4 865.5,-456.4 859.5,-462.4 853.5,-462.4 853.5,-462.4 823.5,-462.4 823.5,-462.4 817.5,-462.4 811.5,-456.4 811.5,-450.4 811.5,-450.4 811.5,-438.4 811.5,-438.4 811.5,-432.4 817.5,-426.4 823.5,-426.4"/>
<text text-anchor="middle" x="838.5" y="-440.7" font-family="Times,serif" font-size="14.00" fill="#40575d">locks</text>
</g>
<!-- extractLockFromKeyErr&#45;&gt;locks -->
<g id="edge24" class="edge">
<title>extractLockFromKeyErr&#45;&gt;locks</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M701.19,-439.88C735.1,-441.01 773.66,-442.29 801.1,-443.2"/>
<polygon fill="green" stroke="green" points="801.29,-446.7 811.4,-443.54 801.52,-439.71 801.29,-446.7"/>
</g>
<!-- ErrLockWaitTimeout -->
<g id="node15" class="node">
<title>ErrLockWaitTimeout</title>
<path fill="none" stroke="#1c2123" d="M1269,-740.9C1269,-740.9 1497,-740.9 1497,-740.9 1503,-740.9 1509,-746.9 1509,-752.9 1509,-752.9 1509,-781.9 1509,-781.9 1509,-787.9 1503,-793.9 1497,-793.9 1497,-793.9 1269,-793.9 1269,-793.9 1263,-793.9 1257,-787.9 1257,-781.9 1257,-781.9 1257,-752.9 1257,-752.9 1257,-746.9 1263,-740.9 1269,-740.9"/>
<text text-anchor="start" x="1265" y="-778.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">检查time.Since(lockWaitStartTime)</text>
<text text-anchor="start" x="1265" y="-763.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> &gt;= action.LockWaitTime</text>
<text text-anchor="start" x="1265" y="-748.7" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果超时了，返回ErrLockWaitTimeout</text>
</g>
<!-- ResolveLocks&#45;&gt;ErrLockWaitTimeout -->
<g id="edge13" class="edge">
<title>ResolveLocks&#45;&gt;ErrLockWaitTimeout</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1131.6,-498.21C1190.88,-561.93 1296.89,-675.9 1349.93,-732.93"/>
<polygon fill="green" stroke="green" points="1347.68,-735.65 1357.05,-740.58 1352.81,-730.88 1347.68,-735.65"/>
</g>
<!-- LockWaitTime&#45;&gt;ErrLockWaitTimeout -->
<g id="edge14" class="edge">
<title>LockWaitTime&#45;&gt;ErrLockWaitTimeout</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M301.51,-780.07C372.63,-785.07 508.61,-793.4 624.5,-793.4 624.5,-793.4 624.5,-793.4 839.5,-793.4 978.37,-793.4 1137.01,-784.8 1246.71,-777.49"/>
<polygon fill="green" stroke="green" points="1247.09,-780.97 1256.84,-776.81 1246.62,-773.99 1247.09,-780.97"/>
</g>
<!-- lockWaitStartTime&#45;&gt;ErrLockWaitTimeout -->
<g id="edge15" class="edge">
<title>lockWaitStartTime&#45;&gt;ErrLockWaitTimeout</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M312.07,-735.67C385.25,-750.78 513.36,-773.4 624.5,-773.4 624.5,-773.4 624.5,-773.4 839.5,-773.4 978.22,-773.4 1136.88,-771.42 1246.63,-769.73"/>
<polygon fill="green" stroke="green" points="1246.81,-773.23 1256.76,-769.57 1246.71,-766.23 1246.81,-773.23"/>
</g>
<!-- locks&#45;&gt;ResolveLocks -->
<g id="edge25" class="edge">
<title>locks&#45;&gt;ResolveLocks</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M865.52,-445.25C885.26,-445.88 914.1,-446.82 944.49,-447.8"/>
<polygon fill="green" stroke="green" points="944.73,-451.31 954.84,-448.13 944.96,-444.31 944.73,-451.31"/>
</g>
<!-- WaitStartTime -->
<g id="node16" class="node">
<title>WaitStartTime</title>
<path fill="#feed9b" stroke="#f7e495" d="M28,-849.4C28,-849.4 102,-849.4 102,-849.4 108,-849.4 114,-855.4 114,-861.4 114,-861.4 114,-873.4 114,-873.4 114,-879.4 108,-885.4 102,-885.4 102,-885.4 28,-885.4 28,-885.4 22,-885.4 16,-879.4 16,-873.4 16,-873.4 16,-861.4 16,-861.4 16,-855.4 22,-849.4 28,-849.4"/>
<text text-anchor="middle" x="65" y="-863.7" font-family="Times,serif" font-size="14.00" fill="#40575d">WaitStartTime</text>
</g>
<!-- WaitStartTime&#45;&gt;LockWaitTime -->
<g id="edge21" class="edge">
<title>WaitStartTime&#45;&gt;LockWaitTime</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M102.89,-849.21C132.28,-834.72 173.55,-814.36 204.99,-798.85"/>
<polygon fill="green" stroke="green" points="206.57,-801.98 213.99,-794.41 203.47,-795.7 206.57,-801.98"/>
</g>
<!-- WaitStartTime&#45;&gt;lockWaitStartTime -->
<g id="edge22" class="edge">
<title>WaitStartTime&#45;&gt;lockWaitStartTime</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M76.68,-849.02C92.66,-823.1 125.21,-776.01 165,-749.4 170.18,-745.94 175.83,-742.9 181.68,-740.24"/>
<polygon fill="green" stroke="green" points="183.11,-743.43 190.99,-736.35 180.41,-736.97 183.11,-743.43"/>
</g>
<!-- clientConn_dispatch -->
<g id="node17" class="node">
<title>clientConn_dispatch</title>
<path fill="none" stroke="#1c2123" d="M117,-1032.4C117,-1032.4 13,-1032.4 13,-1032.4 7,-1032.4 1,-1026.4 1,-1020.4 1,-1020.4 1,-1008.4 1,-1008.4 1,-1002.4 7,-996.4 13,-996.4 13,-996.4 117,-996.4 117,-996.4 123,-996.4 129,-1002.4 129,-1008.4 129,-1008.4 129,-1020.4 129,-1020.4 129,-1026.4 123,-1032.4 117,-1032.4"/>
<text text-anchor="middle" x="65" y="-1010.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">clientConn_dispatch</text>
</g>
<!-- clientConn_dispatch&#45;&gt;Killed -->
<g id="edge26" class="edge">
<title>clientConn_dispatch&#45;&gt;Killed</title>
<path fill="none" stroke="#666666" d="M113.4,-996.27C118.81,-993.57 124.13,-990.61 129,-987.4 165.29,-963.55 200.64,-928.33 223.77,-903.16"/>
<polygon fill="#666666" stroke="#666666" points="226.41,-905.45 230.54,-895.69 221.23,-900.75 226.41,-905.45"/>
</g>
<!-- killConn -->
<g id="node18" class="node">
<title>killConn</title>
<path fill="none" stroke="#1c2123" d="M85,-978.4C85,-978.4 45,-978.4 45,-978.4 39,-978.4 33,-972.4 33,-966.4 33,-966.4 33,-954.4 33,-954.4 33,-948.4 39,-942.4 45,-942.4 45,-942.4 85,-942.4 85,-942.4 91,-942.4 97,-948.4 97,-954.4 97,-954.4 97,-966.4 97,-966.4 97,-972.4 91,-978.4 85,-978.4"/>
<text text-anchor="middle" x="65" y="-956.7" font-family="Times,serif" font-size="14.00" fill="#2f3638">killConn</text>
</g>
<!-- killConn&#45;&gt;Killed -->
<g id="edge27" class="edge">
<title>killConn&#45;&gt;Killed</title>
<path fill="none" stroke="#666666" d="M97.15,-950.64C107.43,-947.13 118.83,-942.91 129,-938.4 154.08,-927.3 180.98,-912.96 203.07,-900.49"/>
<polygon fill="#666666" stroke="#666666" points="204.95,-903.44 211.91,-895.45 201.49,-897.36 204.95,-903.44"/>
</g>
</g>
</svg>
