<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: read_index Pages: 1 -->
<svg width="1742pt" height="1063pt"
 viewBox="0.00 0.00 1742.00 1063.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1059)">
<title>read_index</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1059 1738,-1059 1738,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ReadIndexRequest</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M461,-155C461,-155 719,-155 719,-155 725,-155 731,-161 731,-167 731,-167 731,-363 731,-363 731,-369 725,-375 719,-375 719,-375 461,-375 461,-375 455,-375 449,-369 449,-363 449,-363 449,-167 449,-167 449,-161 455,-155 461,-155"/>
<text text-anchor="middle" x="590" y="-355" font-family="Times,serif" font-size="20.00">ReadIndexRequest</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_RaftRs</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M252,-8C252,-8 655,-8 655,-8 661,-8 667,-14 667,-20 667,-20 667,-135 667,-135 667,-141 661,-147 655,-147 655,-147 252,-147 252,-147 246,-147 240,-141 240,-135 240,-135 240,-20 240,-20 240,-14 246,-8 252,-8"/>
<text text-anchor="middle" x="453.5" y="-127" font-family="Times,serif" font-size="20.00">raft&#45;rs</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ReadIndexQueue</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M763,-179C763,-179 1378,-179 1378,-179 1384,-179 1390,-185 1390,-191 1390,-191 1390,-353 1390,-353 1390,-359 1384,-365 1378,-365 1378,-365 763,-365 763,-365 757,-365 751,-359 751,-353 751,-353 751,-191 751,-191 751,-185 757,-179 763,-179"/>
<text text-anchor="middle" x="1070.5" y="-345" font-family="Times,serif" font-size="20.00">ReadIndexQueue</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Peer</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-383C20,-383 1714,-383 1714,-383 1720,-383 1726,-389 1726,-395 1726,-395 1726,-1035 1726,-1035 1726,-1041 1720,-1047 1714,-1047 1714,-1047 20,-1047 20,-1047 14,-1047 8,-1041 8,-1035 8,-1035 8,-395 8,-395 8,-389 14,-383 20,-383"/>
<text text-anchor="middle" x="867" y="-1027" font-family="Times,serif" font-size="20.00">Peer</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_leader</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M294,-469C294,-469 664,-469 664,-469 670,-469 676,-475 676,-481 676,-481 676,-647 676,-647 676,-653 670,-659 664,-659 664,-659 294,-659 294,-659 288,-659 282,-653 282,-647 282,-647 282,-481 282,-481 282,-475 288,-469 294,-469"/>
<text text-anchor="middle" x="479" y="-639" font-family="Times,serif" font-size="20.00">if is_leader</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_not_leader</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M239.5,-667C239.5,-667 405.5,-667 405.5,-667 411.5,-667 417.5,-673 417.5,-679 417.5,-679 417.5,-921 417.5,-921 417.5,-927 411.5,-933 405.5,-933 405.5,-933 239.5,-933 239.5,-933 233.5,-933 227.5,-927 227.5,-921 227.5,-921 227.5,-679 227.5,-679 227.5,-673 233.5,-667 239.5,-667"/>
<text text-anchor="start" x="263.5" y="-913" font-family="Times,serif" font-size="20.00">not_leader and</text>
<text text-anchor="middle" x="322.5" y="-891" font-family="Times,serif" font-size="20.00"> no_leader_id</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_pending_reads</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1422,-481C1422,-481 1706,-481 1706,-481 1712,-481 1718,-487 1718,-493 1718,-493 1718,-563 1718,-563 1718,-569 1712,-575 1706,-575 1706,-575 1422,-575 1422,-575 1416,-575 1410,-569 1410,-563 1410,-563 1410,-493 1410,-493 1410,-487 1416,-481 1422,-481"/>
<text text-anchor="middle" x="1564" y="-555" font-family="Times,serif" font-size="20.00">pending_reads</text>
</g>
<!-- read_push_command -->
<g id="node1" class="node">
<title>read_push_command</title>
<path fill="none" stroke="#1c2123" d="M469,-290C469,-290 711,-290 711,-290 717,-290 723,-296 723,-302 723,-302 723,-324 723,-324 723,-330 717,-336 711,-336 711,-336 469,-336 469,-336 463,-336 457,-330 457,-324 457,-324 457,-302 457,-302 457,-296 463,-290 469,-290"/>
<text text-anchor="middle" x="590" y="-320.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">push_command</text>
<polyline fill="none" stroke="#1c2123" points="457,-313 723,-313 "/>
<text text-anchor="middle" x="590" y="-297.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.cmds.push((req, cb, Some(read_index)));</text>
</g>
<!-- ReadIndexRequest -->
<g id="node2" class="node">
<title>ReadIndexRequest</title>
<path fill="#feed9b" stroke="#f7e495" d="M511,-163.5C511,-163.5 669,-163.5 669,-163.5 675,-163.5 681,-169.5 681,-175.5 681,-175.5 681,-258.5 681,-258.5 681,-264.5 675,-270.5 669,-270.5 669,-270.5 511,-270.5 511,-270.5 505,-270.5 499,-264.5 499,-258.5 499,-258.5 499,-175.5 499,-175.5 499,-169.5 505,-163.5 511,-163.5"/>
<text text-anchor="middle" x="590" y="-255.3" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadIndexRequest</text>
<polyline fill="none" stroke="#f7e495" points="499,-247.5 681,-247.5 "/>
<text text-anchor="start" x="507" y="-232.3" font-family="Times,serif" font-size="14.00" fill="#40575d">id</text>
<polyline fill="none" stroke="#f7e495" points="499,-224.5 681,-224.5 "/>
<text text-anchor="start" x="507" y="-209.3" font-family="Times,serif" font-size="14.00" fill="#40575d">req: RaftCmdRequest</text>
<polyline fill="none" stroke="#f7e495" points="499,-201.5 681,-201.5 "/>
<text text-anchor="start" x="507" y="-186.3" font-family="Times,serif" font-size="14.00" fill="#40575d">cb: Callback</text>
<text text-anchor="start" x="507" y="-171.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> renew_lease_time: TimeSpec</text>
</g>
<!-- reads_push_back -->
<g id="node8" class="node">
<title>reads_push_back</title>
<path fill="none" stroke="#1c2123" d="M771,-188C771,-188 951,-188 951,-188 957,-188 963,-194 963,-200 963,-200 963,-252 963,-252 963,-258 957,-264 951,-264 951,-264 771,-264 771,-264 765,-264 759,-258 759,-252 759,-252 759,-200 759,-200 759,-194 765,-188 771,-188"/>
<text text-anchor="middle" x="861" y="-248.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pending_reads_push_back</text>
<polyline fill="none" stroke="#1c2123" points="759,-241 963,-241 "/>
<text text-anchor="start" x="767" y="-225.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将ReadIndexRequest放入队列中</text>
<text text-anchor="start" x="767" y="-210.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 并且放入ctx Hashmap中</text>
<text text-anchor="start" x="767" y="-195.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> key为id</text>
</g>
<!-- ReadIndexRequest&#45;&gt;reads_push_back -->
<g id="edge21" class="edge">
<title>ReadIndexRequest&#45;&gt;reads_push_back</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M681.32,-220.02C702.9,-220.74 726.18,-221.52 748.58,-222.27"/>
<polygon fill="green" stroke="green" points="748.69,-225.78 758.8,-222.61 748.92,-218.78 748.69,-225.78"/>
</g>
<!-- raft_group_raft_pending_read_count -->
<g id="node3" class="node">
<title>raft_group_raft_pending_read_count</title>
<path fill="none" stroke="#1c2123" d="M260,-72C260,-72 385,-72 385,-72 391,-72 397,-78 397,-84 397,-84 397,-96 397,-96 397,-102 391,-108 385,-108 385,-108 260,-108 260,-108 254,-108 248,-102 248,-96 248,-96 248,-84 248,-84 248,-78 254,-72 260,-72"/>
<text text-anchor="middle" x="322.5" y="-86.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft.pending_read_count</text>
</g>
<!-- raft_group_raft_ready_read_count -->
<g id="node4" class="node">
<title>raft_group_raft_ready_read_count</title>
<path fill="none" stroke="#1c2123" d="M266.5,-17C266.5,-17 378.5,-17 378.5,-17 384.5,-17 390.5,-23 390.5,-29 390.5,-29 390.5,-41 390.5,-41 390.5,-47 384.5,-53 378.5,-53 378.5,-53 266.5,-53 266.5,-53 260.5,-53 254.5,-47 254.5,-41 254.5,-41 254.5,-29 254.5,-29 254.5,-23 260.5,-17 266.5,-17"/>
<text text-anchor="middle" x="322.5" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft.ready_read_count</text>
</g>
<!-- raft_group_read_index -->
<g id="node5" class="node">
<title>raft_group_read_index</title>
<path fill="none" stroke="#1c2123" d="M533,-17.5C533,-17.5 647,-17.5 647,-17.5 653,-17.5 659,-23.5 659,-29.5 659,-29.5 659,-96.5 659,-96.5 659,-102.5 653,-108.5 647,-108.5 647,-108.5 533,-108.5 533,-108.5 527,-108.5 521,-102.5 521,-96.5 521,-96.5 521,-29.5 521,-29.5 521,-23.5 527,-17.5 533,-17.5"/>
<text text-anchor="start" x="529" y="-93.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_index</text>
<polyline fill="none" stroke="#1c2123" points="521,-85.5 659,-85.5 "/>
<text text-anchor="start" x="529" y="-70.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用raft的read_index</text>
<text text-anchor="start" x="529" y="-55.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 后面调用ready</text>
<text text-anchor="start" x="529" y="-40.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 根据read_states字段</text>
<text text-anchor="start" x="529" y="-25.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 获取可以read的id</text>
</g>
<!-- ReadIndexQueue -->
<g id="node6" class="node">
<title>ReadIndexQueue</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1140,-188C1140,-188 1370,-188 1370,-188 1376,-188 1382,-194 1382,-200 1382,-200 1382,-314 1382,-314 1382,-320 1376,-326 1370,-326 1370,-326 1140,-326 1140,-326 1134,-326 1128,-320 1128,-314 1128,-314 1128,-200 1128,-200 1128,-194 1134,-188 1140,-188"/>
<text text-anchor="middle" x="1255" y="-310.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadIndexQueue</text>
<polyline fill="none" stroke="#60b5ac" points="1128,-303 1382,-303 "/>
<text text-anchor="start" x="1136" y="-287.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">reads: VecDeque&lt;ReadIndexRequest&lt;S&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="1128,-280 1382,-280 "/>
<text text-anchor="start" x="1136" y="-264.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ready_cnt: usize,</text>
<polyline fill="none" stroke="#60b5ac" points="1128,-257 1382,-257 "/>
<text text-anchor="start" x="1136" y="-241.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">handled_cnt: usize,</text>
<polyline fill="none" stroke="#60b5ac" points="1128,-234 1382,-234 "/>
<text text-anchor="start" x="1136" y="-218.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">contexts: HashMap&lt;Uuid, usize&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="1128,-211 1382,-211 "/>
<text text-anchor="start" x="1136" y="-195.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">retry_countdown: usize,</text>
</g>
<!-- pending_reads -->
<g id="node21" class="node">
<title>pending_reads</title>
<path fill="#feed9b" stroke="#f7e495" d="M1430,-490C1430,-490 1698,-490 1698,-490 1704,-490 1710,-496 1710,-502 1710,-502 1710,-524 1710,-524 1710,-530 1704,-536 1698,-536 1698,-536 1430,-536 1430,-536 1424,-536 1418,-530 1418,-524 1418,-524 1418,-502 1418,-502 1418,-496 1424,-490 1430,-490"/>
<text text-anchor="middle" x="1564" y="-520.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pending_reads</text>
<polyline fill="none" stroke="#f7e495" points="1418,-513 1710,-513 "/>
<text text-anchor="start" x="1426" y="-497.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pending_reads: ReadIndexQueue&lt;EK::Snapshot&gt;,</text>
</g>
<!-- ReadIndexQueue&#45;&gt;pending_reads -->
<g id="edge26" class="edge">
<title>ReadIndexQueue&#45;&gt;pending_reads</title>
<path fill="none" stroke="#666666" d="M1339.08,-326.28C1400.73,-377.68 1481.72,-445.22 1527.48,-483.38"/>
<polygon fill="#666666" stroke="#666666" points="1525.41,-486.21 1535.33,-489.93 1529.89,-480.84 1525.41,-486.21"/>
</g>
<!-- context_insert -->
<g id="node7" class="node">
<title>context_insert</title>
<path fill="none" stroke="#1c2123" d="M1080,-242C1080,-242 1011,-242 1011,-242 1005,-242 999,-236 999,-230 999,-230 999,-218 999,-218 999,-212 1005,-206 1011,-206 1011,-206 1080,-206 1080,-206 1086,-206 1092,-212 1092,-218 1092,-218 1092,-230 1092,-230 1092,-236 1086,-242 1080,-242"/>
<text text-anchor="middle" x="1045.5" y="-220.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">context_insert</text>
</g>
<!-- context_insert&#45;&gt;ReadIndexQueue -->
<g id="edge1" class="edge">
<title>context_insert&#45;&gt;ReadIndexQueue:context</title>
<path fill="none" stroke="#666666" d="M1092.19,-222.48C1100.49,-222.29 1109.22,-222.12 1117.75,-222.05"/>
<polygon fill="#666666" stroke="#666666" points="1118.02,-225.55 1128,-222 1117.98,-218.55 1118.02,-225.55"/>
</g>
<!-- reads_push_back&#45;&gt;ReadIndexQueue -->
<g id="edge2" class="edge">
<title>reads_push_back&#45;&gt;ReadIndexQueue:reads</title>
<path fill="none" stroke="#666666" d="M963.18,-263.34C1009.27,-277.37 1065.2,-290.33 1117.86,-291.85"/>
<polygon fill="#666666" stroke="#666666" points="1117.95,-295.35 1128,-292 1118.05,-288.35 1117.95,-295.35"/>
</g>
<!-- reads_push_back&#45;&gt;context_insert -->
<g id="edge27" class="edge">
<title>reads_push_back&#45;&gt;context_insert</title>
<path fill="none" stroke="#666666" d="M963.12,-224.89C971.91,-224.8 980.58,-224.7 988.79,-224.61"/>
<polygon fill="#666666" stroke="#666666" points="988.96,-228.11 998.92,-224.5 988.88,-221.11 988.96,-228.11"/>
</g>
<!-- propose -->
<g id="node9" class="node">
<title>propose</title>
<path fill="none" stroke="#1c2123" d="M63,-552C63,-552 28,-552 28,-552 22,-552 16,-546 16,-540 16,-540 16,-528 16,-528 16,-522 22,-516 28,-516 28,-516 63,-516 63,-516 69,-516 75,-522 75,-528 75,-528 75,-540 75,-540 75,-546 69,-552 63,-552"/>
<text text-anchor="middle" x="45.5" y="-530.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">propose</text>
</g>
<!-- read_index -->
<g id="node10" class="node">
<title>read_index</title>
<path fill="none" stroke="#1c2123" d="M176,-552C176,-552 123,-552 123,-552 117,-552 111,-546 111,-540 111,-540 111,-528 111,-528 111,-522 117,-516 123,-516 123,-516 176,-516 176,-516 182,-516 188,-522 188,-528 188,-528 188,-540 188,-540 188,-546 182,-552 176,-552"/>
<text text-anchor="middle" x="149.5" y="-530.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_index</text>
</g>
<!-- propose&#45;&gt;read_index -->
<g id="edge3" class="edge">
<title>propose&#45;&gt;read_index</title>
<path fill="none" stroke="#666666" d="M75.18,-534C83.15,-534 92.01,-534 100.75,-534"/>
<polygon fill="#666666" stroke="#666666" points="100.89,-537.5 110.89,-534 100.89,-530.5 100.89,-537.5"/>
</g>
<!-- read_index&#45;&gt;read_push_command -->
<g id="edge4" class="edge">
<title>read_index&#45;&gt;read_push_command</title>
<path fill="none" stroke="#b83b5e" d="M153.87,-515.78C160.84,-483.55 180.02,-416.69 224,-383 286.99,-334.75 373.68,-316.71 446.77,-310.98"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="447.26,-314.45 456.99,-310.25 446.76,-307.47 447.26,-314.45"/>
</g>
<!-- read_index&#45;&gt;ReadIndexRequest -->
<g id="edge5" class="edge">
<title>read_index&#45;&gt;ReadIndexRequest</title>
<path fill="none" stroke="#b83b5e" d="M150.83,-515.75C152.64,-472.99 163.32,-365.64 224,-309 295.24,-242.5 407.33,-222.26 488.51,-216.95"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="488.98,-220.43 498.75,-216.34 488.57,-213.44 488.98,-220.43"/>
</g>
<!-- read_index&#45;&gt;raft_group_raft_pending_read_count -->
<g id="edge6" class="edge">
<title>read_index&#45;&gt;raft_group_raft_pending_read_count</title>
<path fill="none" stroke="#b83b5e" d="M150.69,-515.67C151.97,-461.56 161.17,-299.2 224,-185 239.56,-156.72 266.26,-131.58 287.79,-114.28"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="290.04,-116.96 295.75,-108.04 285.72,-111.45 290.04,-116.96"/>
</g>
<!-- read_index&#45;&gt;raft_group_raft_ready_read_count -->
<g id="edge7" class="edge">
<title>read_index&#45;&gt;raft_group_raft_ready_read_count</title>
<path fill="none" stroke="#b83b5e" d="M150.81,-515.99C152.49,-438.24 162.95,-132.19 224,-63 229.84,-56.38 237.13,-51.28 245.09,-47.36"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="246.49,-50.56 254.3,-43.41 243.73,-44.13 246.49,-50.56"/>
</g>
<!-- read_index&#45;&gt;raft_group_read_index -->
<g id="edge8" class="edge">
<title>read_index&#45;&gt;raft_group_read_index</title>
<path fill="none" stroke="#b83b5e" d="M152.64,-515.61C159.95,-455.63 185.6,-266.92 224,-221 262.38,-175.1 416.06,-118.94 511.35,-87.44"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="512.55,-90.74 520.95,-84.29 510.36,-84.09 512.55,-90.74"/>
</g>
<!-- is_leader -->
<g id="node11" class="node">
<title>is_leader</title>
<path fill="none" stroke="#1c2123" d="M343,-515C343,-515 302,-515 302,-515 296,-515 290,-509 290,-503 290,-503 290,-491 290,-491 290,-485 296,-479 302,-479 302,-479 343,-479 343,-479 349,-479 355,-485 355,-491 355,-491 355,-503 355,-503 355,-509 349,-515 343,-515"/>
<text text-anchor="middle" x="322.5" y="-493.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">is_leader</text>
</g>
<!-- read_index&#45;&gt;is_leader -->
<g id="edge9" class="edge">
<title>read_index&#45;&gt;is_leader</title>
<path fill="none" stroke="#b83b5e" d="M188.03,-525.88C215.17,-520.01 251.85,-512.07 279.89,-506"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="280.76,-509.4 289.8,-503.86 279.28,-502.55 280.76,-509.4"/>
</g>
<!-- inspect_lease -->
<g id="node12" class="node">
<title>inspect_lease</title>
<path fill="none" stroke="#1c2123" d="M622.5,-513C622.5,-513 557.5,-513 557.5,-513 551.5,-513 545.5,-507 545.5,-501 545.5,-501 545.5,-489 545.5,-489 545.5,-483 551.5,-477 557.5,-477 557.5,-477 622.5,-477 622.5,-477 628.5,-477 634.5,-483 634.5,-489 634.5,-489 634.5,-501 634.5,-501 634.5,-507 628.5,-513 622.5,-513"/>
<text text-anchor="middle" x="590" y="-491.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">inspect_lease</text>
</g>
<!-- read_index&#45;&gt;inspect_lease -->
<g id="edge10" class="edge">
<title>read_index&#45;&gt;inspect_lease</title>
<path fill="none" stroke="#b83b5e" d="M188.25,-534.2C240.63,-534.11 338.27,-532.63 421,-524 459.55,-519.98 502.62,-512.48 535.5,-506.12"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="536.22,-509.55 545.36,-504.19 534.87,-502.68 536.22,-509.55"/>
</g>
<!-- get_store_commit_index -->
<g id="node13" class="node">
<title>get_store_commit_index</title>
<path fill="none" stroke="#1c2123" d="M654,-567C654,-567 526,-567 526,-567 520,-567 514,-561 514,-555 514,-555 514,-543 514,-543 514,-537 520,-531 526,-531 526,-531 654,-531 654,-531 660,-531 666,-537 666,-543 666,-543 666,-555 666,-555 666,-561 660,-567 654,-567"/>
<text text-anchor="middle" x="590" y="-545.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_store_commit_index</text>
</g>
<!-- read_index&#45;&gt;get_store_commit_index -->
<g id="edge11" class="edge">
<title>read_index&#45;&gt;get_store_commit_index</title>
<path fill="none" stroke="#b83b5e" d="M188.25,-536.86C199.73,-537.65 212.37,-538.45 224,-539 319.7,-543.56 429.63,-546.22 503.62,-547.64"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="503.76,-551.14 513.82,-547.83 503.89,-544.14 503.76,-551.14"/>
</g>
<!-- pending_reads_back_mut -->
<g id="node14" class="node">
<title>pending_reads_back_mut</title>
<path fill="none" stroke="#1c2123" d="M656,-621C656,-621 524,-621 524,-621 518,-621 512,-615 512,-609 512,-609 512,-597 512,-597 512,-591 518,-585 524,-585 524,-585 656,-585 656,-585 662,-585 668,-591 668,-597 668,-597 668,-609 668,-609 668,-615 662,-621 656,-621"/>
<text text-anchor="middle" x="590" y="-599.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pending_reads_back_mut</text>
</g>
<!-- read_index&#45;&gt;pending_reads_back_mut -->
<g id="edge12" class="edge">
<title>read_index&#45;&gt;pending_reads_back_mut</title>
<path fill="none" stroke="#b83b5e" d="M150.87,-552.2C152.77,-624.09 163.79,-886.78 224,-937 240.81,-951.02 404.85,-951.77 421,-937 472.38,-890.03 401.44,-675.83 449,-625 462.73,-610.32 481.96,-602.77 501.77,-599.3"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="502.43,-602.74 511.84,-597.87 501.45,-595.81 502.43,-602.74"/>
</g>
<!-- bcast_wake_up_message -->
<g id="node15" class="node">
<title>bcast_wake_up_message</title>
<path fill="none" stroke="#1c2123" d="M387,-765C387,-765 258,-765 258,-765 252,-765 246,-759 246,-753 246,-753 246,-741 246,-741 246,-735 252,-729 258,-729 258,-729 387,-729 387,-729 393,-729 399,-735 399,-741 399,-741 399,-753 399,-753 399,-759 393,-765 387,-765"/>
<text text-anchor="middle" x="322.5" y="-743.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">bcast_wake_up_message</text>
</g>
<!-- read_index&#45;&gt;bcast_wake_up_message -->
<g id="edge13" class="edge">
<title>read_index&#45;&gt;bcast_wake_up_message</title>
<path fill="none" stroke="#b83b5e" d="M152.34,-552.08C157.11,-589.21 173.26,-674.38 224,-720 227.9,-723.51 232.22,-726.56 236.8,-729.22"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="235.4,-732.44 245.9,-733.88 238.59,-726.21 235.4,-732.44"/>
</g>
<!-- PdTask_QueryRegionLeader -->
<g id="node16" class="node">
<title>PdTask_QueryRegionLeader</title>
<path fill="none" stroke="#1c2123" d="M397.5,-711C397.5,-711 247.5,-711 247.5,-711 241.5,-711 235.5,-705 235.5,-699 235.5,-699 235.5,-687 235.5,-687 235.5,-681 241.5,-675 247.5,-675 247.5,-675 397.5,-675 397.5,-675 403.5,-675 409.5,-681 409.5,-687 409.5,-687 409.5,-699 409.5,-699 409.5,-705 403.5,-711 397.5,-711"/>
<text text-anchor="middle" x="322.5" y="-689.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PdTask_QueryRegionLeader</text>
</g>
<!-- read_index&#45;&gt;PdTask_QueryRegionLeader -->
<g id="edge14" class="edge">
<title>read_index&#45;&gt;PdTask_QueryRegionLeader</title>
<path fill="none" stroke="#b83b5e" d="M155.02,-552.31C163.35,-582.06 184.04,-640.61 224,-671 224.76,-671.57 225.52,-672.13 226.3,-672.68"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="224.68,-675.79 235.04,-678 228.32,-669.81 224.68,-675.79"/>
</g>
<!-- pd_scheduler_schedule -->
<g id="node17" class="node">
<title>pd_scheduler_schedule</title>
<path fill="none" stroke="#1c2123" d="M382,-873C382,-873 263,-873 263,-873 257,-873 251,-867 251,-861 251,-861 251,-849 251,-849 251,-843 257,-837 263,-837 263,-837 382,-837 382,-837 388,-837 394,-843 394,-849 394,-849 394,-861 394,-861 394,-867 388,-873 382,-873"/>
<text text-anchor="middle" x="322.5" y="-851.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pd_scheduler_schedule</text>
</g>
<!-- read_index&#45;&gt;pd_scheduler_schedule -->
<g id="edge15" class="edge">
<title>read_index&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#b83b5e" d="M152.66,-552.29C159.86,-610.16 184.79,-787.79 224,-828 229.14,-833.27 235.22,-837.54 241.78,-841"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="240.44,-844.23 250.99,-845.22 243.36,-837.87 240.44,-844.23"/>
</g>
<!-- should_wake_up -->
<g id="node18" class="node">
<title>should_wake_up</title>
<path fill="none" stroke="#1c2123" d="M364.5,-819C364.5,-819 280.5,-819 280.5,-819 274.5,-819 268.5,-813 268.5,-807 268.5,-807 268.5,-795 268.5,-795 268.5,-789 274.5,-783 280.5,-783 280.5,-783 364.5,-783 364.5,-783 370.5,-783 376.5,-789 376.5,-795 376.5,-795 376.5,-807 376.5,-807 376.5,-813 370.5,-819 364.5,-819"/>
<text text-anchor="middle" x="322.5" y="-797.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">should_wake_up</text>
</g>
<!-- read_index&#45;&gt;should_wake_up -->
<g id="edge16" class="edge">
<title>read_index&#45;&gt;should_wake_up</title>
<path fill="none" stroke="#b83b5e" d="M150.48,-552.01C151.45,-596.41 160.3,-712 224,-774 233.48,-783.23 245.82,-789.36 258.51,-793.42"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="257.68,-796.82 268.25,-796.14 259.56,-790.08 257.68,-796.82"/>
</g>
<!-- pre_read_index -->
<g id="node19" class="node">
<title>pre_read_index</title>
<path fill="none" stroke="#1c2123" d="M284,-962C284,-962 361,-962 361,-962 367,-962 373,-968 373,-974 373,-974 373,-996 373,-996 373,-1002 367,-1008 361,-1008 361,-1008 284,-1008 284,-1008 278,-1008 272,-1002 272,-996 272,-996 272,-974 272,-974 272,-968 278,-962 284,-962"/>
<text text-anchor="middle" x="322.5" y="-992.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pre_read_index</text>
<polyline fill="none" stroke="#1c2123" points="272,-985 373,-985 "/>
<text text-anchor="middle" x="322.5" y="-969.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">做一些检查</text>
</g>
<!-- read_index&#45;&gt;pre_read_index -->
<g id="edge17" class="edge">
<title>read_index&#45;&gt;pre_read_index</title>
<path fill="none" stroke="#b83b5e" d="M151.41,-552.04C155.34,-623.39 173.04,-884.95 224,-947 233.84,-958.98 247.95,-967.19 262.39,-972.82"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="261.29,-976.14 271.88,-976.16 263.61,-969.54 261.29,-976.14"/>
</g>
<!-- Uuid_new_v4 -->
<g id="node20" class="node">
<title>Uuid_new_v4</title>
<path fill="#feed9b" stroke="#f7e495" d="M236,-392C236,-392 409,-392 409,-392 415,-392 421,-398 421,-404 421,-404 421,-448 421,-448 421,-454 415,-460 409,-460 409,-460 236,-460 236,-460 230,-460 224,-454 224,-448 224,-448 224,-404 224,-404 224,-398 230,-392 236,-392"/>
<text text-anchor="start" x="232" y="-444.8" font-family="Times,serif" font-size="14.00" fill="#40575d">id = Uuid::new_v4()</text>
<text text-anchor="start" x="232" y="-429.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 生成唯一的id</text>
<text text-anchor="start" x="232" y="-414.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 作为readctx传入raft中</text>
<text text-anchor="start" x="232" y="-399.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 在ready时候，raft会回传回来</text>
</g>
<!-- read_index&#45;&gt;Uuid_new_v4 -->
<g id="edge18" class="edge">
<title>read_index&#45;&gt;Uuid_new_v4</title>
<path fill="none" stroke="#b83b5e" d="M166.2,-515.86C178.78,-502.14 197.57,-483.33 223.42,-465.79"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="225.61,-468.55 232.07,-460.15 221.78,-462.69 225.61,-468.55"/>
</g>
<!-- is_leader&#45;&gt;read_push_command -->
<g id="edge22" class="edge">
<title>is_leader&#45;&gt;read_push_command</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M355.33,-494.23C375.16,-491.46 400.69,-485.95 421,-475 481.84,-442.19 536.2,-381.17 565.7,-344.1"/>
<polygon fill="green" stroke="green" points="568.54,-346.16 571.96,-336.13 563.03,-341.84 568.54,-346.16"/>
</g>
<!-- is_leader&#45;&gt;inspect_lease -->
<g id="edge23" class="edge">
<title>is_leader&#45;&gt;inspect_lease</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M355.26,-496.76C399.74,-496.43 481.19,-495.81 535.22,-495.41"/>
<polygon fill="green" stroke="green" points="535.34,-498.9 545.31,-495.33 535.29,-491.9 535.34,-498.9"/>
</g>
<!-- is_leader&#45;&gt;get_store_commit_index -->
<g id="edge24" class="edge">
<title>is_leader&#45;&gt;get_store_commit_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M355.21,-503.37C380.58,-508.46 417.06,-515.74 449,-522 466.73,-525.48 485.73,-529.16 503.83,-532.66"/>
<polygon fill="green" stroke="green" points="503.3,-536.12 513.78,-534.58 504.63,-529.25 503.3,-536.12"/>
</g>
<!-- is_leader&#45;&gt;pending_reads_back_mut -->
<g id="edge25" class="edge">
<title>is_leader&#45;&gt;pending_reads_back_mut</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M346.59,-515.27C370.75,-533.45 410.45,-560.77 449,-576 465.71,-582.6 484.19,-587.63 502.1,-591.44"/>
<polygon fill="green" stroke="green" points="501.48,-594.89 511.98,-593.44 502.87,-588.03 501.48,-594.89"/>
</g>
<!-- pending_reads_back_mut&#45;&gt;pending_reads -->
<g id="edge28" class="edge">
<title>pending_reads_back_mut&#45;&gt;pending_reads</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M668.08,-595.86C827.57,-581.1 1196.45,-546.94 1407.45,-527.4"/>
<polygon fill="green" stroke="green" points="1408.06,-530.86 1417.69,-526.45 1407.41,-523.89 1408.06,-530.86"/>
</g>
<!-- is_splitting -->
<g id="node22" class="node">
<title>is_splitting</title>
<path fill="none" stroke="#1c2123" d="M517,-932C517,-932 663,-932 663,-932 669,-932 675,-938 675,-944 675,-944 675,-996 675,-996 675,-1002 669,-1008 663,-1008 663,-1008 517,-1008 517,-1008 511,-1008 505,-1002 505,-996 505,-996 505,-944 505,-944 505,-938 511,-932 517,-932"/>
<text text-anchor="middle" x="590" y="-992.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">if is_splitting()</text>
<polyline fill="none" stroke="#1c2123" points="505,-985 675,-985 "/>
<text text-anchor="start" x="513" y="-969.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果正在splitting</text>
<text text-anchor="start" x="513" y="-954.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 返回错误</text>
<text text-anchor="middle" x="590" y="-939.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Error::ReadIndexNotReady</text>
</g>
<!-- pre_read_index&#45;&gt;is_splitting -->
<g id="edge29" class="edge">
<title>pre_read_index&#45;&gt;is_splitting</title>
<path fill="none" stroke="#666666" d="M373.13,-982.2C407.31,-980.27 453.79,-977.64 494.86,-975.32"/>
<polygon fill="#666666" stroke="#666666" points="495.12,-978.81 504.9,-974.75 494.72,-971.82 495.12,-978.81"/>
</g>
<!-- is_merging -->
<g id="node23" class="node">
<title>is_merging</title>
<path fill="none" stroke="#1c2123" d="M517,-837C517,-837 663,-837 663,-837 669,-837 675,-843 675,-849 675,-849 675,-901 675,-901 675,-907 669,-913 663,-913 663,-913 517,-913 517,-913 511,-913 505,-907 505,-901 505,-901 505,-849 505,-849 505,-843 511,-837 517,-837"/>
<text text-anchor="middle" x="590" y="-897.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">if self.is_merging()</text>
<polyline fill="none" stroke="#1c2123" points="505,-890 675,-890 "/>
<text text-anchor="start" x="513" y="-874.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果正在splitting</text>
<text text-anchor="start" x="513" y="-859.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 返回错误</text>
<text text-anchor="start" x="513" y="-844.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Error::ReadIndexNotReady</text>
</g>
<!-- pre_read_index&#45;&gt;is_merging -->
<g id="edge30" class="edge">
<title>pre_read_index&#45;&gt;is_merging</title>
<path fill="none" stroke="#666666" d="M373.12,-969.35C388.96,-963.4 406.2,-955.88 421,-947 435.06,-938.57 434.77,-931.14 449,-923 463.45,-914.74 479.55,-907.58 495.55,-901.5"/>
<polygon fill="#666666" stroke="#666666" points="496.76,-904.79 504.94,-898.05 494.34,-898.22 496.76,-904.79"/>
</g>
<!-- Uuid_new_v4&#45;&gt;ReadIndexRequest -->
<g id="edge20" class="edge">
<title>Uuid_new_v4&#45;&gt;ReadIndexRequest</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M346.52,-391.78C369.45,-359.78 407.17,-312.34 449,-281 461.37,-271.73 475.29,-263.39 489.44,-256.02"/>
<polygon fill="green" stroke="green" points="491.4,-258.95 498.75,-251.32 488.25,-252.7 491.4,-258.95"/>
</g>
<!-- Uuid_new_v4&#45;&gt;raft_group_read_index -->
<g id="edge19" class="edge">
<title>Uuid_new_v4&#45;&gt;raft_group_read_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M339.26,-391.72C358.58,-349.65 392.3,-276.12 421,-213 433.51,-185.48 429.13,-173.79 449,-151 466.4,-131.03 489.44,-114.03 511.8,-100.45"/>
<polygon fill="green" stroke="green" points="513.82,-103.32 520.65,-95.22 510.26,-97.29 513.82,-103.32"/>
</g>
</g>
</svg>
