<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: one_pc_commit_execute Pages: 1 -->
<svg width="1385pt" height="380pt"
 viewBox="0.00 0.00 1385.00 380.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 376)">
<title>one_pc_commit_execute</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-376 1381,-376 1381,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_twoPhaseCommitter</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-8C20,-8 1357,-8 1357,-8 1363,-8 1369,-14 1369,-20 1369,-20 1369,-352 1369,-352 1369,-358 1363,-364 1357,-364 1357,-364 20,-364 20,-364 14,-364 8,-358 8,-352 8,-352 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="688.5" y="-344" font-family="Times,serif" font-size="20.00">twoPhaseCommitter</text>
</g>
<!-- execute -->
<g id="node1" class="node">
<title>execute</title>
<path fill="none" stroke="#1c2123" d="M62,-205C62,-205 28,-205 28,-205 22,-205 16,-199 16,-193 16,-193 16,-181 16,-181 16,-175 22,-169 28,-169 28,-169 62,-169 62,-169 68,-169 74,-175 74,-181 74,-181 74,-193 74,-193 74,-199 68,-205 62,-205"/>
<text text-anchor="middle" x="45" y="-183.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">execute</text>
</g>
<!-- checkOnePC -->
<g id="node2" class="node">
<title>checkOnePC</title>
<path fill="none" stroke="#1c2123" d="M239.5,-52C239.5,-52 176.5,-52 176.5,-52 170.5,-52 164.5,-46 164.5,-40 164.5,-40 164.5,-28 164.5,-28 164.5,-22 170.5,-16 176.5,-16 176.5,-16 239.5,-16 239.5,-16 245.5,-16 251.5,-22 251.5,-28 251.5,-28 251.5,-40 251.5,-40 251.5,-46 245.5,-52 239.5,-52"/>
<text text-anchor="middle" x="208" y="-30.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">checkOnePC</text>
</g>
<!-- execute&#45;&gt;checkOnePC -->
<g id="edge1" class="edge">
<title>execute&#45;&gt;checkOnePC</title>
<path fill="none" stroke="#666666" d="M50.29,-168.59C57.68,-141.04 75.45,-89.29 110,-61 122.54,-50.73 138.71,-44.36 154.25,-40.41"/>
<polygon fill="#666666" stroke="#666666" points="155.33,-43.76 164.32,-38.15 153.8,-36.93 155.33,-43.76"/>
</g>
<!-- setOnePC -->
<g id="node3" class="node">
<title>setOnePC</title>
<path fill="none" stroke="#1c2123" d="M231.5,-106C231.5,-106 184.5,-106 184.5,-106 178.5,-106 172.5,-100 172.5,-94 172.5,-94 172.5,-82 172.5,-82 172.5,-76 178.5,-70 184.5,-70 184.5,-70 231.5,-70 231.5,-70 237.5,-70 243.5,-76 243.5,-82 243.5,-82 243.5,-94 243.5,-94 243.5,-100 237.5,-106 231.5,-106"/>
<text text-anchor="middle" x="208" y="-84.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">setOnePC</text>
</g>
<!-- execute&#45;&gt;setOnePC -->
<g id="edge2" class="edge">
<title>execute&#45;&gt;setOnePC</title>
<path fill="none" stroke="#666666" d="M57.53,-168.95C68.94,-152.53 87.86,-128.81 110,-115 125.74,-105.18 145.11,-98.86 162.39,-94.83"/>
<polygon fill="#666666" stroke="#666666" points="163.23,-98.22 172.28,-92.71 161.77,-91.38 163.23,-98.22"/>
</g>
<!-- hasTriedOnePC -->
<g id="node4" class="node">
<title>hasTriedOnePC</title>
<path fill="none" stroke="#1c2123" d="M247.5,-160C247.5,-160 168.5,-160 168.5,-160 162.5,-160 156.5,-154 156.5,-148 156.5,-148 156.5,-136 156.5,-136 156.5,-130 162.5,-124 168.5,-124 168.5,-124 247.5,-124 247.5,-124 253.5,-124 259.5,-130 259.5,-136 259.5,-136 259.5,-148 259.5,-148 259.5,-154 253.5,-160 247.5,-160"/>
<text text-anchor="middle" x="208" y="-138.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">hasTriedOnePC</text>
</g>
<!-- execute&#45;&gt;hasTriedOnePC -->
<g id="edge3" class="edge">
<title>execute&#45;&gt;hasTriedOnePC</title>
<path fill="none" stroke="#666666" d="M74.04,-179.16C94.01,-173.58 121.59,-165.87 146.47,-158.92"/>
<polygon fill="#666666" stroke="#666666" points="147.51,-162.26 156.2,-156.2 145.63,-155.52 147.51,-162.26"/>
</g>
<!-- GetTimestamp -->
<g id="node5" class="node">
<title>GetTimestamp</title>
<path fill="none" stroke="#1c2123" d="M122,-179C122,-179 294,-179 294,-179 300,-179 306,-185 306,-191 306,-191 306,-273 306,-273 306,-279 300,-285 294,-285 294,-285 122,-285 122,-285 116,-285 110,-279 110,-273 110,-273 110,-191 110,-191 110,-185 116,-179 122,-179"/>
<text text-anchor="middle" x="208" y="-269.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">GetTimestamp</text>
<polyline fill="none" stroke="#1c2123" points="110,-262 306,-262 "/>
<text text-anchor="start" x="118" y="-246.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">为了保证linearizability</text>
<text text-anchor="start" x="118" y="-231.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">提交前</text>
<text text-anchor="start" x="118" y="-216.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 先从time stamp oracle服务</text>
<text text-anchor="start" x="118" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 获取一个时间戳</text>
<text text-anchor="start" x="118" y="-186.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> c.minCommitTS = latestTS + 1</text>
</g>
<!-- execute&#45;&gt;GetTimestamp -->
<g id="edge4" class="edge">
<title>execute&#45;&gt;GetTimestamp</title>
<path fill="none" stroke="#666666" d="M74.04,-194.84C81.73,-196.99 90.55,-199.45 99.92,-202.07"/>
<polygon fill="#666666" stroke="#666666" points="99.27,-205.52 109.84,-204.84 101.15,-198.78 99.27,-205.52"/>
</g>
<!-- prewriteMutations -->
<g id="node6" class="node">
<title>prewriteMutations</title>
<path fill="none" stroke="#1c2123" d="M447,-250C447,-250 354,-250 354,-250 348,-250 342,-244 342,-238 342,-238 342,-226 342,-226 342,-220 348,-214 354,-214 354,-214 447,-214 447,-214 453,-214 459,-220 459,-226 459,-226 459,-238 459,-238 459,-244 453,-250 447,-250"/>
<text text-anchor="middle" x="400.5" y="-228.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">prewriteMutations</text>
</g>
<!-- execute&#45;&gt;prewriteMutations -->
<g id="edge5" class="edge">
<title>execute&#45;&gt;prewriteMutations</title>
<path fill="none" stroke="#666666" d="M50.69,-205.19C58.32,-230.58 76.1,-275.69 110,-295 147.84,-316.56 264.34,-307.72 306,-295 330.61,-287.48 354.61,-271.07 372.13,-256.88"/>
<polygon fill="#666666" stroke="#666666" points="374.76,-259.24 380.18,-250.14 370.27,-253.87 374.76,-259.24"/>
</g>
<!-- onePCCommitTS -->
<g id="node7" class="node">
<title>onePCCommitTS</title>
<path fill="#feed9b" stroke="#f7e495" d="M1150,-240C1150,-240 1240,-240 1240,-240 1246,-240 1252,-246 1252,-252 1252,-252 1252,-274 1252,-274 1252,-280 1246,-286 1240,-286 1240,-286 1150,-286 1150,-286 1144,-286 1138,-280 1138,-274 1138,-274 1138,-252 1138,-252 1138,-246 1144,-240 1150,-240"/>
<text text-anchor="middle" x="1195" y="-270.8" font-family="Times,serif" font-size="14.00" fill="#40575d">onePCCommitTS</text>
<polyline fill="none" stroke="#f7e495" points="1138,-263 1252,-263 "/>
<text text-anchor="middle" x="1195" y="-247.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> </text>
</g>
<!-- execute&#45;&gt;onePCCommitTS -->
<g id="edge6" class="edge">
<title>execute&#45;&gt;onePCCommitTS</title>
<path fill="none" stroke="#666666" d="M49.95,-205.29C56.89,-232.5 74.09,-282.91 110,-306 218.46,-375.74 270.56,-325 399.5,-325 399.5,-325 399.5,-325 753.5,-325 908.45,-325 952.73,-356.56 1102,-315 1119.88,-310.02 1137.99,-300.86 1153.36,-291.6"/>
<polygon fill="#666666" stroke="#666666" points="1155.44,-294.43 1162.07,-286.16 1151.74,-288.49 1155.44,-294.43"/>
</g>
<!-- GetTimestamp&#45;&gt;prewriteMutations -->
<g id="edge7" class="edge">
<title>GetTimestamp&#45;&gt;prewriteMutations</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M306.2,-232C314.88,-232 323.53,-232 331.87,-232"/>
<polygon fill="green" stroke="green" points="331.87,-235.5 341.87,-232 331.87,-228.5 331.87,-235.5"/>
</g>
<!-- prewriteMutations&#45;&gt;onePCCommitTS -->
<g id="edge8" class="edge">
<title>prewriteMutations&#45;&gt;onePCCommitTS</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M437.1,-213.81C454.22,-205.74 475.27,-196.78 495,-191 754.31,-115.05 856.17,-44.85 1102,-157 1135.12,-172.11 1160.91,-205.68 1176.65,-231.02"/>
<polygon fill="green" stroke="green" points="1173.65,-232.82 1181.8,-239.6 1179.66,-229.22 1173.65,-232.82"/>
</g>
<!-- doActionOnMuations -->
<g id="node10" class="node">
<title>doActionOnMuations</title>
<path fill="none" stroke="#1c2123" d="M618,-236C618,-236 507,-236 507,-236 501,-236 495,-230 495,-224 495,-224 495,-212 495,-212 495,-206 501,-200 507,-200 507,-200 618,-200 618,-200 624,-200 630,-206 630,-212 630,-212 630,-224 630,-224 630,-230 624,-236 618,-236"/>
<text text-anchor="middle" x="562.5" y="-214.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">doActionOnMuations</text>
</g>
<!-- prewriteMutations&#45;&gt;doActionOnMuations -->
<g id="edge9" class="edge">
<title>prewriteMutations&#45;&gt;doActionOnMuations</title>
<path fill="none" stroke="#666666" d="M459.26,-226.95C467.56,-226.22 476.21,-225.46 484.8,-224.71"/>
<polygon fill="#666666" stroke="#666666" points="485.19,-228.19 494.85,-223.83 484.58,-221.22 485.19,-228.19"/>
</g>
<!-- actionPrewrite_handleSingleBatch -->
<g id="node13" class="node">
<title>actionPrewrite_handleSingleBatch</title>
<path fill="none" stroke="#1c2123" d="M887,-221C887,-221 1090,-221 1090,-221 1096,-221 1102,-227 1102,-233 1102,-233 1102,-293 1102,-293 1102,-299 1096,-305 1090,-305 1090,-305 887,-305 887,-305 881,-305 875,-299 875,-293 875,-293 875,-233 875,-233 875,-227 881,-221 887,-221"/>
<text text-anchor="start" x="883" y="-289.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">actionPrewrite</text>
<polyline fill="none" stroke="#1c2123" points="875,-282 1102,-282 "/>
<text text-anchor="middle" x="988.5" y="-266.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">handleSingleBatch</text>
<polyline fill="none" stroke="#1c2123" points="875,-259 1102,-259 "/>
<text text-anchor="start" x="883" y="-243.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用prewriteResp的OnePcCommitTs</text>
<text text-anchor="start" x="883" y="-228.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 设置c.onePcCommitTs</text>
</g>
<!-- prewriteMutations&#45;&gt;actionPrewrite_handleSingleBatch -->
<g id="edge15" class="edge">
<title>prewriteMutations&#45;&gt;actionPrewrite_handleSingleBatch</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M459.01,-247.52C512.24,-261.03 593.8,-279.57 666,-287 742.49,-294.87 762.36,-293.15 839,-287 847.33,-286.33 855.89,-285.46 864.5,-284.43"/>
<polygon fill="green" stroke="green" points="865.13,-287.88 874.62,-283.17 864.27,-280.94 865.13,-287.88"/>
</g>
<!-- commitTs -->
<g id="node8" class="node">
<title>commitTs</title>
<path fill="#feed9b" stroke="#f7e495" d="M1300,-240C1300,-240 1349,-240 1349,-240 1355,-240 1361,-246 1361,-252 1361,-252 1361,-274 1361,-274 1361,-280 1355,-286 1349,-286 1349,-286 1300,-286 1300,-286 1294,-286 1288,-280 1288,-274 1288,-274 1288,-252 1288,-252 1288,-246 1294,-240 1300,-240"/>
<text text-anchor="middle" x="1324.5" y="-270.8" font-family="Times,serif" font-size="14.00" fill="#40575d">commitTs</text>
<polyline fill="none" stroke="#f7e495" points="1288,-263 1361,-263 "/>
<text text-anchor="middle" x="1324.5" y="-247.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> </text>
</g>
<!-- onePCCommitTS&#45;&gt;commitTs -->
<g id="edge17" class="edge">
<title>onePCCommitTS&#45;&gt;commitTs</title>
<path fill="none" stroke="#666666" d="M1252.29,-263C1260.74,-263 1269.36,-263 1277.55,-263"/>
<polygon fill="#666666" stroke="#666666" points="1277.66,-266.5 1287.66,-263 1277.66,-259.5 1277.66,-266.5"/>
</g>
<!-- checkOnePCFallBack -->
<g id="node9" class="node">
<title>checkOnePCFallBack</title>
<path fill="none" stroke="#1c2123" d="M932.5,-166C932.5,-166 1044.5,-166 1044.5,-166 1050.5,-166 1056.5,-172 1056.5,-178 1056.5,-178 1056.5,-190 1056.5,-190 1056.5,-196 1050.5,-202 1044.5,-202 1044.5,-202 932.5,-202 932.5,-202 926.5,-202 920.5,-196 920.5,-190 920.5,-190 920.5,-178 920.5,-178 920.5,-172 926.5,-166 932.5,-166"/>
<text text-anchor="middle" x="988.5" y="-180.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">checkOnePCFallBack</text>
</g>
<!-- doActionOnMuations&#45;&gt;checkOnePCFallBack -->
<g id="edge10" class="edge">
<title>doActionOnMuations&#45;&gt;checkOnePCFallBack</title>
<path fill="none" stroke="#666666" d="M601,-199.97C620,-191.81 643.72,-183.1 666,-179 748.34,-163.86 844.55,-168.18 910.11,-174.35"/>
<polygon fill="#666666" stroke="#666666" points="910.07,-177.86 920.37,-175.35 910.75,-170.9 910.07,-177.86"/>
</g>
<!-- groupMutations -->
<g id="node11" class="node">
<title>groupMutations</title>
<path fill="none" stroke="#1c2123" d="M792.5,-224C792.5,-224 712.5,-224 712.5,-224 706.5,-224 700.5,-218 700.5,-212 700.5,-212 700.5,-200 700.5,-200 700.5,-194 706.5,-188 712.5,-188 712.5,-188 792.5,-188 792.5,-188 798.5,-188 804.5,-194 804.5,-200 804.5,-200 804.5,-212 804.5,-212 804.5,-218 798.5,-224 792.5,-224"/>
<text text-anchor="middle" x="752.5" y="-202.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">groupMutations</text>
</g>
<!-- doActionOnMuations&#45;&gt;groupMutations -->
<g id="edge11" class="edge">
<title>doActionOnMuations&#45;&gt;groupMutations</title>
<path fill="none" stroke="#666666" d="M630.05,-213.75C649.65,-212.5 671.01,-211.14 690.27,-209.91"/>
<polygon fill="#666666" stroke="#666666" points="690.67,-213.39 700.43,-209.26 690.22,-206.4 690.67,-213.39"/>
</g>
<!-- doActionOnGroupMutations -->
<g id="node12" class="node">
<title>doActionOnGroupMutations</title>
<path fill="none" stroke="#1c2123" d="M827,-278C827,-278 678,-278 678,-278 672,-278 666,-272 666,-266 666,-266 666,-254 666,-254 666,-248 672,-242 678,-242 678,-242 827,-242 827,-242 833,-242 839,-248 839,-254 839,-254 839,-266 839,-266 839,-272 833,-278 827,-278"/>
<text text-anchor="middle" x="752.5" y="-256.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">doActionOnGroupMutations</text>
</g>
<!-- doActionOnMuations&#45;&gt;doActionOnGroupMutations -->
<g id="edge12" class="edge">
<title>doActionOnMuations&#45;&gt;doActionOnGroupMutations</title>
<path fill="none" stroke="#666666" d="M630.05,-232.87C640.05,-235.1 650.51,-237.44 660.92,-239.76"/>
<polygon fill="#666666" stroke="#666666" points="660.34,-243.22 670.86,-241.98 661.86,-236.39 660.34,-243.22"/>
</g>
<!-- doActionOnGroupMutations&#45;&gt;checkOnePCFallBack -->
<g id="edge14" class="edge">
<title>doActionOnGroupMutations&#45;&gt;checkOnePCFallBack</title>
<path fill="none" stroke="#666666" d="M816.21,-241.97C823.98,-239.22 831.74,-236.22 839,-233 855.94,-225.5 857.84,-218.97 875,-212 886.33,-207.4 898.62,-203.4 910.77,-199.98"/>
<polygon fill="#666666" stroke="#666666" points="911.73,-203.35 920.47,-197.37 909.9,-196.59 911.73,-203.35"/>
</g>
<!-- doActionOnGroupMutations&#45;&gt;actionPrewrite_handleSingleBatch -->
<g id="edge13" class="edge">
<title>doActionOnGroupMutations&#45;&gt;actionPrewrite_handleSingleBatch</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M839.3,-261.1C847.65,-261.21 856.22,-261.32 864.83,-261.43"/>
<polygon fill="green" stroke="green" points="864.91,-264.93 874.95,-261.56 865,-257.93 864.91,-264.93"/>
</g>
<!-- actionPrewrite_handleSingleBatch&#45;&gt;onePCCommitTS -->
<g id="edge16" class="edge">
<title>actionPrewrite_handleSingleBatch&#45;&gt;onePCCommitTS</title>
<path fill="none" stroke="#666666" d="M1102.22,-263C1110.88,-263 1119.43,-263 1127.64,-263"/>
<polygon fill="#666666" stroke="#666666" points="1127.82,-266.5 1137.82,-263 1127.82,-259.5 1127.82,-266.5"/>
</g>
</g>
</svg>
