<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: worker_thread_run Pages: 1 -->
<svg width="1661pt" height="832pt"
 viewBox="0.00 0.00 1661.00 831.63" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 827.63)">
<title>worker_thread_run</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-827.63 1657,-827.63 1657,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Runner</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M714.5,-68.63C714.5,-68.63 1359.5,-68.63 1359.5,-68.63 1365.5,-68.63 1371.5,-74.63 1371.5,-80.63 1371.5,-80.63 1371.5,-244.63 1371.5,-244.63 1371.5,-250.63 1365.5,-256.63 1359.5,-256.63 1359.5,-256.63 714.5,-256.63 714.5,-256.63 708.5,-256.63 702.5,-250.63 702.5,-244.63 702.5,-244.63 702.5,-80.63 702.5,-80.63 702.5,-74.63 708.5,-68.63 714.5,-68.63"/>
<text text-anchor="middle" x="1037" y="-236.63" font-family="Times,serif" font-size="20.00">Runner</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_crossbeam_deque</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1443,-513.63C1443,-513.63 1633,-513.63 1633,-513.63 1639,-513.63 1645,-519.63 1645,-525.63 1645,-525.63 1645,-609.63 1645,-609.63 1645,-615.63 1639,-621.63 1633,-621.63 1633,-621.63 1443,-621.63 1443,-621.63 1437,-621.63 1431,-615.63 1431,-609.63 1431,-609.63 1431,-525.63 1431,-525.63 1431,-519.63 1437,-513.63 1443,-513.63"/>
<text text-anchor="middle" x="1538" y="-601.63" font-family="Times,serif" font-size="20.00">crossbeam&#45;deque</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_LocalQueue</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1279,-526.63C1279,-526.63 1381,-526.63 1381,-526.63 1387,-526.63 1393,-532.63 1393,-538.63 1393,-538.63 1393,-596.63 1393,-596.63 1393,-602.63 1387,-608.63 1381,-608.63 1381,-608.63 1279,-608.63 1279,-608.63 1273,-608.63 1267,-602.63 1267,-596.63 1267,-596.63 1267,-538.63 1267,-538.63 1267,-532.63 1273,-526.63 1279,-526.63"/>
<text text-anchor="middle" x="1330" y="-588.63" font-family="Times,serif" font-size="20.00">LocalQueue</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_parking_lot_core</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1006.5,-637.63C1006.5,-637.63 1399,-637.63 1399,-637.63 1405,-637.63 1411,-643.63 1411,-649.63 1411,-649.63 1411,-803.63 1411,-803.63 1411,-809.63 1405,-815.63 1399,-815.63 1399,-815.63 1006.5,-815.63 1006.5,-815.63 1000.5,-815.63 994.5,-809.63 994.5,-803.63 994.5,-803.63 994.5,-649.63 994.5,-649.63 994.5,-643.63 1000.5,-637.63 1006.5,-637.63"/>
<text text-anchor="middle" x="1202.75" y="-795.63" font-family="Times,serif" font-size="20.00">parking_lot_core</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_QueueCore</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1289,-436.63C1289,-436.63 1372,-436.63 1372,-436.63 1378,-436.63 1384,-442.63 1384,-448.63 1384,-448.63 1384,-506.63 1384,-506.63 1384,-512.63 1378,-518.63 1372,-518.63 1372,-518.63 1289,-518.63 1289,-518.63 1283,-518.63 1277,-512.63 1277,-506.63 1277,-506.63 1277,-448.63 1277,-448.63 1277,-442.63 1283,-436.63 1289,-436.63"/>
<text text-anchor="middle" x="1330.5" y="-498.63" font-family="Times,serif" font-size="20.00">QueueCore</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_Local</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M950,-410.63C950,-410.63 1217,-410.63 1217,-410.63 1223,-410.63 1229,-416.63 1229,-422.63 1229,-422.63 1229,-617.63 1229,-617.63 1229,-623.63 1223,-629.63 1217,-629.63 1217,-629.63 950,-629.63 950,-629.63 944,-629.63 938,-623.63 938,-617.63 938,-617.63 938,-422.63 938,-422.63 938,-416.63 944,-410.63 950,-410.63"/>
<text text-anchor="middle" x="1083.5" y="-609.63" font-family="Times,serif" font-size="20.00">Local</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_WorkerThread</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M464,-264.63C464,-264.63 1106.5,-264.63 1106.5,-264.63 1112.5,-264.63 1118.5,-270.63 1118.5,-276.63 1118.5,-276.63 1118.5,-390.63 1118.5,-390.63 1118.5,-396.63 1112.5,-402.63 1106.5,-402.63 1106.5,-402.63 464,-402.63 464,-402.63 458,-402.63 452,-396.63 452,-390.63 452,-390.63 452,-276.63 452,-276.63 452,-270.63 458,-264.63 464,-264.63"/>
<text text-anchor="middle" x="785.25" y="-382.63" font-family="Times,serif" font-size="20.00">WorkerThread</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_LazyBuilder</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-293.63C20,-293.63 428,-293.63 428,-293.63 434,-293.63 440,-299.63 440,-305.63 440,-305.63 440,-553.63 440,-553.63 440,-559.63 434,-565.63 428,-565.63 428,-565.63 20,-565.63 20,-565.63 14,-565.63 8,-559.63 8,-553.63 8,-553.63 8,-305.63 8,-305.63 8,-299.63 14,-293.63 20,-293.63"/>
<text text-anchor="middle" x="224" y="-545.63" font-family="Times,serif" font-size="20.00">LazyBuilder</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_thread_Builder</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M110,-301.63C110,-301.63 420,-301.63 420,-301.63 426,-301.63 432,-307.63 432,-313.63 432,-313.63 432,-397.63 432,-397.63 432,-403.63 426,-409.63 420,-409.63 420,-409.63 110,-409.63 110,-409.63 104,-409.63 98,-403.63 98,-397.63 98,-397.63 98,-313.63 98,-313.63 98,-307.63 104,-301.63 110,-301.63"/>
<text text-anchor="middle" x="265" y="-389.63" font-family="Times,serif" font-size="20.00">thread::Builder</text>
</g>
<!-- handle -->
<g id="node1" class="node">
<title>handle</title>
<path fill="none" stroke="#1c2123" d="M1308.5,-124.63C1308.5,-124.63 1351.5,-124.63 1351.5,-124.63 1357.5,-124.63 1363.5,-130.63 1363.5,-136.63 1363.5,-136.63 1363.5,-158.63 1363.5,-158.63 1363.5,-164.63 1357.5,-170.63 1351.5,-170.63 1351.5,-170.63 1308.5,-170.63 1308.5,-170.63 1302.5,-170.63 1296.5,-164.63 1296.5,-158.63 1296.5,-158.63 1296.5,-136.63 1296.5,-136.63 1296.5,-130.63 1302.5,-124.63 1308.5,-124.63"/>
<text text-anchor="middle" x="1330" y="-155.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">handle</text>
<polyline fill="none" stroke="#1c2123" points="1296.5,-147.63 1363.5,-147.63 "/>
<text text-anchor="middle" x="1330" y="-132.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理task</text>
</g>
<!-- end -->
<g id="node2" class="node">
<title>end</title>
<path fill="none" stroke="#1c2123" d="M729.5,-157.13C729.5,-157.13 843.5,-157.13 843.5,-157.13 849.5,-157.13 855.5,-163.13 855.5,-169.13 855.5,-169.13 855.5,-206.13 855.5,-206.13 855.5,-212.13 849.5,-218.13 843.5,-218.13 843.5,-218.13 729.5,-218.13 729.5,-218.13 723.5,-218.13 717.5,-212.13 717.5,-206.13 717.5,-206.13 717.5,-169.13 717.5,-169.13 717.5,-163.13 723.5,-157.13 729.5,-157.13"/>
<text text-anchor="middle" x="786.5" y="-202.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">end</text>
<polyline fill="none" stroke="#1c2123" points="717.5,-195.13 855.5,-195.13 "/>
<text text-anchor="start" x="725.5" y="-179.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">退出处理task循环后</text>
<text text-anchor="start" x="725.5" y="-164.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用runner.end</text>
</g>
<!-- pause -->
<g id="node3" class="node">
<title>pause</title>
<path fill="none" stroke="#1c2123" d="M1000,-171.63C1000,-171.63 1167,-171.63 1167,-171.63 1173,-171.63 1179,-177.63 1179,-183.63 1179,-183.63 1179,-205.63 1179,-205.63 1179,-211.63 1173,-217.63 1167,-217.63 1167,-217.63 1000,-217.63 1000,-217.63 994,-217.63 988,-211.63 988,-205.63 988,-205.63 988,-183.63 988,-183.63 988,-177.63 994,-171.63 1000,-171.63"/>
<text text-anchor="middle" x="1083.5" y="-202.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">pause</text>
<polyline fill="none" stroke="#1c2123" points="988,-194.63 1179,-194.63 "/>
<text text-anchor="start" x="996" y="-179.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用pop_or_sleep前调用pause</text>
</g>
<!-- resume -->
<g id="node4" class="node">
<title>resume</title>
<path fill="none" stroke="#1c2123" d="M988,-106.63C988,-106.63 1179,-106.63 1179,-106.63 1185,-106.63 1191,-112.63 1191,-118.63 1191,-118.63 1191,-140.63 1191,-140.63 1191,-146.63 1185,-152.63 1179,-152.63 1179,-152.63 988,-152.63 988,-152.63 982,-152.63 976,-146.63 976,-140.63 976,-140.63 976,-118.63 976,-118.63 976,-112.63 982,-106.63 988,-106.63"/>
<text text-anchor="middle" x="1083.5" y="-137.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">resume</text>
<polyline fill="none" stroke="#1c2123" points="976,-129.63 1191,-129.63 "/>
<text text-anchor="middle" x="1083.5" y="-114.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用pop_or_sleep之后调用resume</text>
</g>
<!-- start -->
<g id="node5" class="node">
<title>start</title>
<path fill="none" stroke="#1c2123" d="M722.5,-77.13C722.5,-77.13 850.5,-77.13 850.5,-77.13 856.5,-77.13 862.5,-83.13 862.5,-89.13 862.5,-89.13 862.5,-126.13 862.5,-126.13 862.5,-132.13 856.5,-138.13 850.5,-138.13 850.5,-138.13 722.5,-138.13 722.5,-138.13 716.5,-138.13 710.5,-132.13 710.5,-126.13 710.5,-126.13 710.5,-89.13 710.5,-89.13 710.5,-83.13 716.5,-77.13 722.5,-77.13"/>
<text text-anchor="middle" x="786.5" y="-122.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">start</text>
<polyline fill="none" stroke="#1c2123" points="710.5,-115.13 862.5,-115.13 "/>
<text text-anchor="start" x="718.5" y="-99.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">在进入处理task循环前</text>
<text text-anchor="start" x="718.5" y="-84.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用runner.start</text>
</g>
<!-- steal_batch_and_pop -->
<g id="node6" class="node">
<title>steal_batch_and_pop</title>
<path fill="none" stroke="#1c2123" d="M1451,-522.13C1451,-522.13 1625,-522.13 1625,-522.13 1631,-522.13 1637,-528.13 1637,-534.13 1637,-534.13 1637,-571.13 1637,-571.13 1637,-577.13 1631,-583.13 1625,-583.13 1625,-583.13 1451,-583.13 1451,-583.13 1445,-583.13 1439,-577.13 1439,-571.13 1439,-571.13 1439,-534.13 1439,-534.13 1439,-528.13 1445,-522.13 1451,-522.13"/>
<text text-anchor="middle" x="1538" y="-567.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">steal_batch_and_pop</text>
<polyline fill="none" stroke="#1c2123" points="1439,-560.13 1637,-560.13 "/>
<text text-anchor="start" x="1447" y="-544.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">从另一个worker的task queue中</text>
<text text-anchor="start" x="1447" y="-529.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 偷一些task过来</text>
</g>
<!-- LocalQueue_pop -->
<g id="node7" class="node">
<title>LocalQueue_pop</title>
<path fill="none" stroke="#1c2123" d="M1373,-570.63C1373,-570.63 1287,-570.63 1287,-570.63 1281,-570.63 1275,-564.63 1275,-558.63 1275,-558.63 1275,-546.63 1275,-546.63 1275,-540.63 1281,-534.63 1287,-534.63 1287,-534.63 1373,-534.63 1373,-534.63 1379,-534.63 1385,-540.63 1385,-546.63 1385,-546.63 1385,-558.63 1385,-558.63 1385,-564.63 1379,-570.63 1373,-570.63"/>
<text text-anchor="middle" x="1330" y="-548.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">LocalQueue_pop</text>
</g>
<!-- LocalQueue_pop&#45;&gt;steal_batch_and_pop -->
<g id="edge1" class="edge">
<title>LocalQueue_pop&#45;&gt;steal_batch_and_pop</title>
<path fill="none" stroke="#666666" d="M1385.12,-552.63C1398.49,-552.63 1413.29,-552.63 1428.24,-552.63"/>
<polygon fill="#666666" stroke="#666666" points="1428.61,-556.13 1438.61,-552.63 1428.61,-549.13 1428.61,-556.13"/>
</g>
<!-- parking_lot_core_park -->
<g id="node8" class="node">
<title>parking_lot_core_park</title>
<path fill="none" stroke="#1c2123" d="M1269,-700.63C1269,-700.63 1391,-700.63 1391,-700.63 1397,-700.63 1403,-706.63 1403,-712.63 1403,-712.63 1403,-764.63 1403,-764.63 1403,-770.63 1397,-776.63 1391,-776.63 1391,-776.63 1269,-776.63 1269,-776.63 1263,-776.63 1257,-770.63 1257,-764.63 1257,-764.63 1257,-712.63 1257,-712.63 1257,-706.63 1263,-700.63 1269,-700.63"/>
<text text-anchor="middle" x="1330" y="-761.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">park</text>
<polyline fill="none" stroke="#1c2123" points="1257,-753.63 1403,-753.63 "/>
<text text-anchor="start" x="1265" y="-738.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">Parks the current thread</text>
<text text-anchor="start" x="1265" y="-723.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> in the queue associated</text>
<text text-anchor="start" x="1265" y="-708.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> with the given key.</text>
</g>
<!-- ParkToken -->
<g id="node9" class="node">
<title>ParkToken</title>
<path fill="none" stroke="#1c2123" d="M1356,-681.63C1356,-681.63 1304,-681.63 1304,-681.63 1298,-681.63 1292,-675.63 1292,-669.63 1292,-669.63 1292,-657.63 1292,-657.63 1292,-651.63 1298,-645.63 1304,-645.63 1304,-645.63 1356,-645.63 1356,-645.63 1362,-645.63 1368,-651.63 1368,-657.63 1368,-657.63 1368,-669.63 1368,-669.63 1368,-675.63 1362,-681.63 1356,-681.63"/>
<text text-anchor="middle" x="1330" y="-659.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">ParkToken</text>
</g>
<!-- SpinWait_spin -->
<g id="node10" class="node">
<title>SpinWait_spin</title>
<path fill="none" stroke="#1c2123" d="M1014.5,-646.13C1014.5,-646.13 1152.5,-646.13 1152.5,-646.13 1158.5,-646.13 1164.5,-652.13 1164.5,-658.13 1164.5,-658.13 1164.5,-695.13 1164.5,-695.13 1164.5,-701.13 1158.5,-707.13 1152.5,-707.13 1152.5,-707.13 1014.5,-707.13 1014.5,-707.13 1008.5,-707.13 1002.5,-701.13 1002.5,-695.13 1002.5,-695.13 1002.5,-658.13 1002.5,-658.13 1002.5,-652.13 1008.5,-646.13 1014.5,-646.13"/>
<text text-anchor="middle" x="1083.5" y="-691.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">SpinWait::spin</text>
<polyline fill="none" stroke="#1c2123" points="1002.5,-684.13 1164.5,-684.13 "/>
<text text-anchor="start" x="1010.5" y="-668.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">Spins until the sleep</text>
<text text-anchor="middle" x="1083.5" y="-653.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> threhold has been reached</text>
</g>
<!-- mark_sleep -->
<g id="node11" class="node">
<title>mark_sleep</title>
<path fill="none" stroke="#1c2123" d="M1358,-480.63C1358,-480.63 1302,-480.63 1302,-480.63 1296,-480.63 1290,-474.63 1290,-468.63 1290,-468.63 1290,-456.63 1290,-456.63 1290,-450.63 1296,-444.63 1302,-444.63 1302,-444.63 1358,-444.63 1358,-444.63 1364,-444.63 1370,-450.63 1370,-456.63 1370,-456.63 1370,-468.63 1370,-468.63 1370,-474.63 1364,-480.63 1358,-480.63"/>
<text text-anchor="middle" x="1330" y="-458.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">mark_sleep</text>
</g>
<!-- local_pop -->
<g id="node12" class="node">
<title>local_pop</title>
<path fill="none" stroke="#1c2123" d="M1004,-419.63C1004,-419.63 1163,-419.63 1163,-419.63 1169,-419.63 1175,-425.63 1175,-431.63 1175,-431.63 1175,-483.63 1175,-483.63 1175,-489.63 1169,-495.63 1163,-495.63 1163,-495.63 1004,-495.63 1004,-495.63 998,-495.63 992,-489.63 992,-483.63 992,-483.63 992,-431.63 992,-431.63 992,-425.63 998,-419.63 1004,-419.63"/>
<text text-anchor="middle" x="1083.5" y="-480.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">self.local.pop</text>
<polyline fill="none" stroke="#1c2123" points="992,-472.63 1175,-472.63 "/>
<text text-anchor="start" x="1000" y="-457.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">先从local队列中获取task</text>
<text text-anchor="start" x="1000" y="-442.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 如果没有task</text>
<text text-anchor="start" x="1000" y="-427.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 会使用SpinWait.spin等一会</text>
</g>
<!-- local_pop&#45;&gt;LocalQueue_pop -->
<g id="edge2" class="edge">
<title>local_pop&#45;&gt;LocalQueue_pop</title>
<path fill="none" stroke="#666666" d="M1175.13,-484.26C1193.26,-490.55 1211.96,-497.76 1229,-505.63 1242.21,-511.74 1244.02,-516.04 1257,-522.63 1262.26,-525.31 1267.81,-527.94 1273.41,-530.47"/>
<polygon fill="#666666" stroke="#666666" points="1272.26,-533.78 1282.82,-534.61 1275.08,-527.38 1272.26,-533.78"/>
</g>
<!-- local_pop_or_sleep -->
<g id="node13" class="node">
<title>local_pop_or_sleep</title>
<path fill="none" stroke="#1c2123" d="M958,-514.63C958,-514.63 1209,-514.63 1209,-514.63 1215,-514.63 1221,-520.63 1221,-526.63 1221,-526.63 1221,-578.63 1221,-578.63 1221,-584.63 1215,-590.63 1209,-590.63 1209,-590.63 958,-590.63 958,-590.63 952,-590.63 946,-584.63 946,-578.63 946,-578.63 946,-526.63 946,-526.63 946,-520.63 952,-514.63 958,-514.63"/>
<text text-anchor="middle" x="1083.5" y="-575.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">local_pop_or_sleep</text>
<polyline fill="none" stroke="#1c2123" points="946,-567.63 1221,-567.63 "/>
<text text-anchor="start" x="954" y="-552.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">Pops a task from the queue</text>
<text text-anchor="start" x="954" y="-537.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> if there are no tasks at the moment</text>
<text text-anchor="start" x="954" y="-522.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> it will go to sleep until woken by other threads</text>
</g>
<!-- local_pop_or_sleep&#45;&gt;LocalQueue_pop -->
<g id="edge3" class="edge">
<title>local_pop_or_sleep&#45;&gt;LocalQueue_pop</title>
<path fill="none" stroke="#666666" d="M1221.05,-552.63C1236.21,-552.63 1251.08,-552.63 1264.7,-552.63"/>
<polygon fill="#666666" stroke="#666666" points="1264.86,-556.13 1274.86,-552.63 1264.86,-549.13 1264.86,-556.13"/>
</g>
<!-- local_pop_or_sleep&#45;&gt;parking_lot_core_park -->
<g id="edge4" class="edge">
<title>local_pop_or_sleep&#45;&gt;parking_lot_core_park</title>
<path fill="none" stroke="#666666" d="M1172.3,-590.73C1192.63,-602.4 1212.98,-616.72 1229,-633.63 1248.41,-654.13 1238.4,-669.41 1257,-690.63 1257.74,-691.48 1258.5,-692.32 1259.28,-693.15"/>
<polygon fill="#666666" stroke="#666666" points="1257.08,-695.89 1266.68,-700.38 1261.97,-690.89 1257.08,-695.89"/>
</g>
<!-- local_pop_or_sleep&#45;&gt;ParkToken -->
<g id="edge5" class="edge">
<title>local_pop_or_sleep&#45;&gt;ParkToken</title>
<path fill="none" stroke="#666666" d="M1168.3,-590.68C1206.55,-608.04 1250.39,-627.95 1282.61,-642.57"/>
<polygon fill="#666666" stroke="#666666" points="1281.24,-645.79 1291.79,-646.74 1284.13,-639.42 1281.24,-645.79"/>
</g>
<!-- local_pop_or_sleep&#45;&gt;mark_sleep -->
<g id="edge6" class="edge">
<title>local_pop_or_sleep&#45;&gt;mark_sleep</title>
<path fill="none" stroke="#666666" d="M1204.26,-514.63C1212.66,-511.67 1220.98,-508.66 1229,-505.63 1246,-499.23 1264.33,-491.57 1280.6,-484.5"/>
<polygon fill="#666666" stroke="#666666" points="1282.16,-487.64 1289.92,-480.42 1279.35,-481.23 1282.16,-487.64"/>
</g>
<!-- run -->
<g id="node14" class="node">
<title>run</title>
<path fill="none" stroke="#1c2123" d="M472,-273.63C472,-273.63 615,-273.63 615,-273.63 621,-273.63 627,-279.63 627,-285.63 627,-285.63 627,-337.63 627,-337.63 627,-343.63 621,-349.63 615,-349.63 615,-349.63 472,-349.63 472,-349.63 466,-349.63 460,-343.63 460,-337.63 460,-337.63 460,-285.63 460,-285.63 460,-279.63 466,-273.63 472,-273.63"/>
<text text-anchor="middle" x="543.5" y="-334.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">run</text>
<polyline fill="none" stroke="#1c2123" points="460,-326.63 627,-326.63 "/>
<text text-anchor="start" x="468" y="-311.43" font-family="Times,serif" font-size="14.00" fill="#2f3638">WorkerThread主循环</text>
<text text-anchor="start" x="468" y="-296.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 从local/core队列中取task</text>
<text text-anchor="start" x="468" y="-281.43" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后 handle task</text>
</g>
<!-- run&#45;&gt;handle -->
<g id="edge7" class="edge">
<title>run&#45;&gt;handle</title>
<path fill="none" stroke="#666666" d="M550.36,-273.19C561.27,-216.68 590.55,-112.99 663,-67.63 876.52,66.04 986.81,-28.33 1229,-97.63 1249.18,-103.41 1270.16,-113.23 1287.66,-122.64"/>
<polygon fill="#666666" stroke="#666666" points="1286.02,-125.74 1296.47,-127.51 1289.4,-119.61 1286.02,-125.74"/>
</g>
<!-- run&#45;&gt;end -->
<g id="edge8" class="edge">
<title>run&#45;&gt;end</title>
<path fill="none" stroke="#666666" d="M618.45,-273.59C649.93,-257.39 686.42,-238.61 717.26,-222.75"/>
<polygon fill="#666666" stroke="#666666" points="718.92,-225.83 726.21,-218.14 715.72,-219.6 718.92,-225.83"/>
</g>
<!-- run&#45;&gt;start -->
<g id="edge9" class="edge">
<title>run&#45;&gt;start</title>
<path fill="none" stroke="#666666" d="M563.03,-273.37C582.88,-236.19 617.74,-180.66 663,-147.63 674.27,-139.41 687.32,-132.82 700.61,-127.55"/>
<polygon fill="#666666" stroke="#666666" points="702.16,-130.71 710.31,-123.95 699.72,-124.15 702.16,-130.71"/>
</g>
<!-- pop -->
<g id="node15" class="node">
<title>pop</title>
<path fill="none" stroke="#1c2123" d="M675,-273.13C675,-273.13 898,-273.13 898,-273.13 904,-273.13 910,-279.13 910,-285.13 910,-285.13 910,-352.13 910,-352.13 910,-358.13 904,-364.13 898,-364.13 898,-364.13 675,-364.13 675,-364.13 669,-364.13 663,-358.13 663,-352.13 663,-352.13 663,-285.13 663,-285.13 663,-279.13 669,-273.13 675,-273.13"/>
<text text-anchor="middle" x="786.5" y="-348.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">pop</text>
<polyline fill="none" stroke="#1c2123" points="663,-341.13 910,-341.13 "/>
<text text-anchor="start" x="671" y="-325.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">从队列中获取可handle的task</text>
<text text-anchor="start" x="671" y="-310.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 1.先从Local队列中获取</text>
<text text-anchor="start" x="671" y="-295.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 2.如果没有就spin wait后重新尝试</text>
<text text-anchor="start" x="671" y="-280.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 3.尝试后还没有task, 调用pop_or_sleep</text>
</g>
<!-- run&#45;&gt;pop -->
<g id="edge10" class="edge">
<title>run&#45;&gt;pop</title>
<path fill="none" stroke="#666666" d="M627.1,-314.03C635.43,-314.27 644.02,-314.52 652.7,-314.78"/>
<polygon fill="#666666" stroke="#666666" points="652.82,-318.28 662.92,-315.07 653.02,-311.28 652.82,-318.28"/>
</g>
<!-- pop&#45;&gt;pause -->
<g id="edge11" class="edge">
<title>pop&#45;&gt;pause</title>
<path fill="none" stroke="#666666" d="M896.09,-272.99C937.11,-255.75 982.45,-236.69 1018.15,-221.68"/>
<polygon fill="#666666" stroke="#666666" points="1019.62,-224.86 1027.48,-217.76 1016.9,-218.41 1019.62,-224.86"/>
</g>
<!-- pop&#45;&gt;resume -->
<g id="edge12" class="edge">
<title>pop&#45;&gt;resume</title>
<path fill="none" stroke="#666666" d="M897.7,-272.91C902.13,-269.12 906.27,-265.03 910,-260.63 939.3,-226.09 905.12,-193.79 938,-162.63 946.31,-154.76 956.09,-148.63 966.58,-143.87"/>
<polygon fill="#666666" stroke="#666666" points="968.04,-147.06 975.97,-140.03 965.39,-140.58 968.04,-147.06"/>
</g>
<!-- pop&#45;&gt;SpinWait_spin -->
<g id="edge13" class="edge">
<title>pop&#45;&gt;SpinWait_spin</title>
<path fill="none" stroke="#666666" d="M796.94,-364.41C813.45,-432.99 854.14,-561.97 938,-633.63 953.56,-646.93 973.1,-656.12 992.73,-662.46"/>
<polygon fill="#666666" stroke="#666666" points="991.78,-665.83 1002.36,-665.36 993.79,-659.13 991.78,-665.83"/>
</g>
<!-- pop&#45;&gt;local_pop -->
<g id="edge14" class="edge">
<title>pop&#45;&gt;local_pop</title>
<path fill="none" stroke="#666666" d="M859.11,-364.24C883.6,-378.82 911.5,-394.35 938,-406.63 951.96,-413.11 966.98,-419.26 981.88,-424.9"/>
<polygon fill="#666666" stroke="#666666" points="981.05,-428.33 991.64,-428.53 983.49,-421.77 981.05,-428.33"/>
</g>
<!-- pop&#45;&gt;local_pop_or_sleep -->
<g id="edge15" class="edge">
<title>pop&#45;&gt;local_pop_or_sleep</title>
<path fill="none" stroke="#666666" d="M813.45,-364.24C839.74,-406.57 884.14,-468.49 938,-505.63 939.85,-506.91 941.74,-508.16 943.66,-509.37"/>
<polygon fill="#666666" stroke="#666666" points="941.9,-512.39 952.29,-514.48 945.47,-506.37 941.9,-512.39"/>
</g>
<!-- task -->
<g id="node16" class="node">
<title>task</title>
<path fill="none" stroke="#1c2123" d="M1098.5,-322.63C1098.5,-322.63 1068.5,-322.63 1068.5,-322.63 1062.5,-322.63 1056.5,-316.63 1056.5,-310.63 1056.5,-310.63 1056.5,-298.63 1056.5,-298.63 1056.5,-292.63 1062.5,-286.63 1068.5,-286.63 1068.5,-286.63 1098.5,-286.63 1098.5,-286.63 1104.5,-286.63 1110.5,-292.63 1110.5,-298.63 1110.5,-298.63 1110.5,-310.63 1110.5,-310.63 1110.5,-316.63 1104.5,-322.63 1098.5,-322.63"/>
<text text-anchor="middle" x="1083.5" y="-300.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">task</text>
</g>
<!-- pop&#45;&gt;task -->
<g id="edge16" class="edge">
<title>pop&#45;&gt;task</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M910.04,-312.82C959.04,-310.49 1011.82,-307.99 1045.9,-306.37"/>
<polygon fill="green" stroke="green" points="1046.46,-309.85 1056.28,-305.88 1046.13,-302.86 1046.46,-309.85"/>
</g>
<!-- task&#45;&gt;handle -->
<g id="edge17" class="edge">
<title>task&#45;&gt;handle</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1110.57,-301.1C1140.98,-296.02 1191.82,-284.51 1229,-260.63 1261.87,-239.52 1290.38,-204.65 1308.46,-179.23"/>
<polygon fill="green" stroke="green" points="1311.34,-181.21 1314.18,-171 1305.6,-177.21 1311.34,-181.21"/>
</g>
<!-- build -->
<g id="node17" class="node">
<title>build</title>
<path fill="none" stroke="#1c2123" d="M58,-453.63C58,-453.63 28,-453.63 28,-453.63 22,-453.63 16,-447.63 16,-441.63 16,-441.63 16,-429.63 16,-429.63 16,-423.63 22,-417.63 28,-417.63 28,-417.63 58,-417.63 58,-417.63 64,-417.63 70,-423.63 70,-429.63 70,-429.63 70,-441.63 70,-441.63 70,-447.63 64,-453.63 58,-453.63"/>
<text text-anchor="middle" x="43" y="-431.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">build</text>
</g>
<!-- build&#45;&gt;run -->
<g id="edge18" class="edge">
<title>build&#45;&gt;run</title>
<path fill="none" stroke="#666666" d="M44.95,-417.37C47.65,-386.54 58.05,-324.9 98,-297.63 201.89,-226.73 353.55,-251.73 450.12,-279.3"/>
<polygon fill="#666666" stroke="#666666" points="449.29,-282.7 459.87,-282.14 451.25,-275.98 449.29,-282.7"/>
</g>
<!-- thread_Builder_new -->
<g id="node18" class="node">
<title>thread_Builder_new</title>
<path fill="none" stroke="#1c2123" d="M118,-328.63C118,-328.63 222,-328.63 222,-328.63 228,-328.63 234,-334.63 234,-340.63 234,-340.63 234,-352.63 234,-352.63 234,-358.63 228,-364.63 222,-364.63 222,-364.63 118,-364.63 118,-364.63 112,-364.63 106,-358.63 106,-352.63 106,-352.63 106,-340.63 106,-340.63 106,-334.63 112,-328.63 118,-328.63"/>
<text text-anchor="middle" x="170" y="-342.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">thread::Builder::new</text>
</g>
<!-- build&#45;&gt;thread_Builder_new -->
<g id="edge19" class="edge">
<title>build&#45;&gt;thread_Builder_new</title>
<path fill="none" stroke="#666666" d="M54.68,-417.5C63.22,-404.29 76.36,-386.58 97.8,-370.56"/>
<polygon fill="#666666" stroke="#666666" points="99.91,-373.35 106.08,-364.74 95.89,-367.63 99.91,-373.35"/>
</g>
<!-- thread_Builder_spawn -->
<g id="node19" class="node">
<title>thread_Builder_spawn</title>
<path fill="none" stroke="#1c2123" d="M282,-310.13C282,-310.13 412,-310.13 412,-310.13 418,-310.13 424,-316.13 424,-322.13 424,-322.13 424,-359.13 424,-359.13 424,-365.13 418,-371.13 412,-371.13 412,-371.13 282,-371.13 282,-371.13 276,-371.13 270,-365.13 270,-359.13 270,-359.13 270,-322.13 270,-322.13 270,-316.13 276,-310.13 282,-310.13"/>
<text text-anchor="middle" x="347" y="-355.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">spawn</text>
<polyline fill="none" stroke="#1c2123" points="270,-348.13 424,-348.13 "/>
<text text-anchor="start" x="278" y="-332.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">生成新线程</text>
<text text-anchor="start" x="278" y="-317.93" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 执行WorkerThread::run</text>
</g>
<!-- build&#45;&gt;thread_Builder_spawn -->
<g id="edge20" class="edge">
<title>build&#45;&gt;thread_Builder_spawn</title>
<path fill="none" stroke="#666666" d="M50.16,-453.72C57.9,-473.27 73.26,-503.4 98,-516.63 151.29,-545.15 181.01,-545.72 234,-516.63 286.28,-487.93 317.65,-423.33 333.37,-380.89"/>
<polygon fill="#666666" stroke="#666666" points="336.69,-382 336.76,-371.4 330.1,-379.64 336.69,-382"/>
</g>
<!-- Local_new -->
<g id="node20" class="node">
<title>Local_new</title>
<path fill="none" stroke="#1c2123" d="M196.5,-453.63C196.5,-453.63 143.5,-453.63 143.5,-453.63 137.5,-453.63 131.5,-447.63 131.5,-441.63 131.5,-441.63 131.5,-429.63 131.5,-429.63 131.5,-423.63 137.5,-417.63 143.5,-417.63 143.5,-417.63 196.5,-417.63 196.5,-417.63 202.5,-417.63 208.5,-423.63 208.5,-429.63 208.5,-429.63 208.5,-441.63 208.5,-441.63 208.5,-447.63 202.5,-453.63 196.5,-453.63"/>
<text text-anchor="middle" x="170" y="-431.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">Local_new</text>
</g>
<!-- build&#45;&gt;Local_new -->
<g id="edge21" class="edge">
<title>build&#45;&gt;Local_new</title>
<path fill="none" stroke="#666666" d="M70.2,-435.63C85.05,-435.63 104.07,-435.63 121.45,-435.63"/>
<polygon fill="#666666" stroke="#666666" points="121.45,-439.13 131.45,-435.63 121.45,-432.13 121.45,-439.13"/>
</g>
<!-- WorkerThread_new -->
<g id="node21" class="node">
<title>WorkerThread_new</title>
<path fill="none" stroke="#1c2123" d="M220.5,-507.63C220.5,-507.63 119.5,-507.63 119.5,-507.63 113.5,-507.63 107.5,-501.63 107.5,-495.63 107.5,-495.63 107.5,-483.63 107.5,-483.63 107.5,-477.63 113.5,-471.63 119.5,-471.63 119.5,-471.63 220.5,-471.63 220.5,-471.63 226.5,-471.63 232.5,-477.63 232.5,-483.63 232.5,-483.63 232.5,-495.63 232.5,-495.63 232.5,-501.63 226.5,-507.63 220.5,-507.63"/>
<text text-anchor="middle" x="170" y="-485.93" font-family="Times,serif" font-size="14.00" fill="#2f3638">WorkerThread_new</text>
</g>
<!-- build&#45;&gt;WorkerThread_new -->
<g id="edge22" class="edge">
<title>build&#45;&gt;WorkerThread_new</title>
<path fill="none" stroke="#666666" d="M70.12,-449.35C78.89,-453.78 88.79,-458.59 98,-462.63 101.87,-464.33 105.89,-466.03 109.95,-467.7"/>
<polygon fill="#666666" stroke="#666666" points="108.89,-471.04 119.47,-471.53 111.5,-464.55 108.89,-471.04"/>
</g>
<!-- thread_Builder_new&#45;&gt;thread_Builder_spawn -->
<g id="edge23" class="edge">
<title>thread_Builder_new&#45;&gt;thread_Builder_spawn</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M234.18,-344.47C242.48,-344.18 251.1,-343.89 259.71,-343.59"/>
<polygon fill="green" stroke="green" points="259.91,-347.09 269.78,-343.25 259.67,-340.09 259.91,-347.09"/>
</g>
<!-- thread_Builder_spawn&#45;&gt;run -->
<g id="edge24" class="edge">
<title>thread_Builder_spawn&#45;&gt;run</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M424.03,-329.3C432.46,-328.04 441.11,-326.75 449.71,-325.47"/>
<polygon fill="green" stroke="green" points="450.39,-328.91 459.76,-323.97 449.36,-321.98 450.39,-328.91"/>
</g>
</g>
</svg>
